/*! For license information please see main.038a2619.js.LICENSE.txt */
(()=>{var e={147:e=>{"use strict";var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n={"{":"\\{","}":"\\}","\\":"\\textbackslash{}","#":"\\#",$:"\\$","%":"\\%","&":"\\&","^":"\\textasciicircum{}",_:"\\_","~":"\\textasciitilde{}"},r={"\u2013":"\\--","\u2014":"\\---"," ":"~","\t":"\\qquad{}","\r\n":"\\newline{}","\n":"\\newline{}"},a=function(e,n){return t({},e,n)};e.exports=function(e){for(var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.preserveFormatting,s=void 0!==o&&o,u=i.escapeMapFn,c=void 0===u?a:u,l=String(e),p="",h=c(t({},n),s?t({},r):{}),d=Object.keys(h),f=function(){var e=!1;d.forEach((function(t,n){e||l.length>=t.length&&l.slice(0,t.length)===t&&(p+=h[d[n]],l=l.slice(t.length,l.length),e=!0)})),e||(p+=l.slice(0,1),l=l.slice(1,l.length))};l;)f();return p}},939:e=>{e.exports=function e(t,n){"use strict";var r,a,i=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,o=/(^[ ]*|[ ]*$)/g,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,u=/^0x[0-9a-f]+$/i,c=/^0/,l=function(t){return e.insensitive&&(""+t).toLowerCase()||""+t},p=l(t).replace(o,"")||"",h=l(n).replace(o,"")||"",d=p.replace(i,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),f=h.replace(i,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),m=parseInt(p.match(u),16)||1!==d.length&&p.match(s)&&Date.parse(p),g=parseInt(h.match(u),16)||m&&h.match(s)&&Date.parse(h)||null;if(g){if(m<g)return-1;if(m>g)return 1}for(var y=0,v=Math.max(d.length,f.length);y<v;y++){if(r=!(d[y]||"").match(c)&&parseFloat(d[y])||d[y]||0,a=!(f[y]||"").match(c)&&parseFloat(f[y])||f[y]||0,isNaN(r)!==isNaN(a))return isNaN(r)?1:-1;if(typeof r!==typeof a&&(r+="",a+=""),r<a)return-1;if(r>a)return 1}return 0}},353:e=>{e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(E){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var a={},i={};function o(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=i[e])?r:(n=u(e,(0|e)<0?-1:0,!0),o&&(i[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=a[e])?r:(n=u(e,e<0?-1:0,!1),o&&(a[e]=n),n)}function s(e,t){if(isNaN(e))return t?y:g;if(t){if(e<0)return y;if(e>=d)return N}else{if(e<=-f)return S;if(e+1>=f)return w}return e<0?s(-e,t).neg():u(e%h|0,e/h|0,t)}function u(e,t,r){return new n(e,t,r)}n.fromInt=o,n.fromNumber=s,n.fromBits=u;var c=Math.pow;function l(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"===typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return l(e.substring(1),t,n).neg();for(var a=s(c(n,8)),i=g,o=0;o<e.length;o+=8){var u=Math.min(8,e.length-o),p=parseInt(e.substring(o,o+u),n);if(u<8){var h=s(c(n,u));i=i.mul(h).add(s(p))}else i=(i=i.mul(a)).add(s(p))}return i.unsigned=t,i}function p(e,t){return"number"===typeof e?s(e,t):"string"===typeof e?l(e,t):u(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}n.fromString=l,n.fromValue=p;var h=4294967296,d=h*h,f=d/2,m=o(1<<24),g=o(0);n.ZERO=g;var y=o(0,!0);n.UZERO=y;var v=o(1);n.ONE=v;var b=o(1,!0);n.UONE=b;var x=o(-1);n.NEG_ONE=x;var w=u(-1,2147483647,!1);n.MAX_VALUE=w;var N=u(-1,-1,!0);n.MAX_UNSIGNED_VALUE=N;var S=u(0,-2147483648,!1);n.MIN_VALUE=S;var k=n.prototype;k.toInt=function(){return this.unsigned?this.low>>>0:this.low},k.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},k.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var t=s(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var a=s(c(e,6),this.unsigned),i=this,o="";;){var u=i.div(a),l=(i.sub(u.mul(a)).toInt()>>>0).toString(e);if((i=u).isZero())return l+o;for(;l.length<6;)l="0"+l;o=""+l+o}},k.getHighBits=function(){return this.high},k.getHighBitsUnsigned=function(){return this.high>>>0},k.getLowBits=function(){return this.low},k.getLowBitsUnsigned=function(){return this.low>>>0},k.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},k.isZero=function(){return 0===this.high&&0===this.low},k.eqz=k.isZero,k.isNegative=function(){return!this.unsigned&&this.high<0},k.isPositive=function(){return this.unsigned||this.high>=0},k.isOdd=function(){return 1===(1&this.low)},k.isEven=function(){return 0===(1&this.low)},k.equals=function(e){return r(e)||(e=p(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},k.eq=k.equals,k.notEquals=function(e){return!this.eq(e)},k.neq=k.notEquals,k.ne=k.notEquals,k.lessThan=function(e){return this.comp(e)<0},k.lt=k.lessThan,k.lessThanOrEqual=function(e){return this.comp(e)<=0},k.lte=k.lessThanOrEqual,k.le=k.lessThanOrEqual,k.greaterThan=function(e){return this.comp(e)>0},k.gt=k.greaterThan,k.greaterThanOrEqual=function(e){return this.comp(e)>=0},k.gte=k.greaterThanOrEqual,k.ge=k.greaterThanOrEqual,k.compare=function(e){if(r(e)||(e=p(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},k.comp=k.compare,k.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(v)},k.neg=k.negate,k.add=function(e){r(e)||(e=p(e));var t=this.high>>>16,n=65535&this.high,a=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,c=e.low>>>16,l=0,h=0,d=0,f=0;return d+=(f+=i+(65535&e.low))>>>16,h+=(d+=a+c)>>>16,l+=(h+=n+s)>>>16,l+=t+o,u((d&=65535)<<16|(f&=65535),(l&=65535)<<16|(h&=65535),this.unsigned)},k.subtract=function(e){return r(e)||(e=p(e)),this.add(e.neg())},k.sub=k.subtract,k.multiply=function(e){if(this.isZero())return g;if(r(e)||(e=p(e)),t)return u(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(S))return e.isOdd()?S:g;if(e.eq(S))return this.isOdd()?S:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return s(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,a=65535&this.high,i=this.low>>>16,o=65535&this.low,c=e.high>>>16,l=65535&e.high,h=e.low>>>16,d=65535&e.low,f=0,y=0,v=0,b=0;return v+=(b+=o*d)>>>16,y+=(v+=i*d)>>>16,v&=65535,y+=(v+=o*h)>>>16,f+=(y+=a*d)>>>16,y&=65535,f+=(y+=i*h)>>>16,y&=65535,f+=(y+=o*l)>>>16,f+=n*d+a*h+i*l+o*c,u((v&=65535)<<16|(b&=65535),(f&=65535)<<16|(y&=65535),this.unsigned)},k.mul=k.multiply,k.divide=function(e){if(r(e)||(e=p(e)),e.isZero())throw Error("division by zero");var n,a,i;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return y;if(e.gt(this.shru(1)))return b;i=y}else{if(this.eq(S))return e.eq(v)||e.eq(x)?S:e.eq(S)?v:(n=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?v:x:(a=this.sub(e.mul(n)),i=n.add(a.div(e)));if(e.eq(S))return this.unsigned?y:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=g}for(a=this;a.gte(e);){n=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),l=o<=48?1:c(2,o-48),h=s(n),d=h.mul(e);d.isNegative()||d.gt(a);)d=(h=s(n-=l,this.unsigned)).mul(e);h.isZero()&&(h=v),i=i.add(h),a=a.sub(d)}return i},k.div=k.divide,k.modulo=function(e){return r(e)||(e=p(e)),t?u((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},k.mod=k.modulo,k.rem=k.modulo,k.not=function(){return u(~this.low,~this.high,this.unsigned)},k.and=function(e){return r(e)||(e=p(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},k.or=function(e){return r(e)||(e=p(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},k.xor=function(e){return r(e)||(e=p(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},k.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},k.shl=k.shiftLeft,k.shiftRight=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},k.shr=k.shiftRight,k.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):u(32===e?t:t>>>e-32,0,this.unsigned)},k.shru=k.shiftRightUnsigned,k.shr_u=k.shiftRightUnsigned,k.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},k.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},k.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},k.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},k.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},4:(e,t,n)=>{"use strict";var r=n(853),a=n(43),i=n(950);function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}var u=Symbol.for("react.element"),c=Symbol.for("react.transitional.element"),l=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),m=Symbol.for("react.consumer"),g=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),b=Symbol.for("react.suspense_list"),x=Symbol.for("react.memo"),w=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var N=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var S=Symbol.for("react.memo_cache_sentinel"),k=Symbol.iterator;function E(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=k&&e[k]||e["@@iterator"])?e:null}var C=Symbol.for("react.client.reference");function T(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===C?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case p:return"Fragment";case l:return"Portal";case d:return"Profiler";case h:return"StrictMode";case v:return"Suspense";case b:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case g:return(e.displayName||"Context")+".Provider";case m:return(e._context.displayName||"Context")+".Consumer";case y:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case x:return null!==(t=e.displayName||null)?t:T(e.type)||"Memo";case w:t=e._payload,e=e._init;try{return T(e(t))}catch(n){}}return null}var D,I,A=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F=Object.assign;function _(e){if(void 0===D)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||"",I=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+D+e+I}var M=!1;function O(e,t){if(!e||M)return"";M=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(a){var r=a}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(o){r=o}(n=e())&&"function"===typeof n.catch&&n.catch((function(){}))}}catch(s){if(s&&r&&"string"===typeof s.stack)return[s.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=r.DetermineComponentFrameRoot(),o=i[0],s=i[1];if(o&&s){var u=o.split("\n"),c=s.split("\n");for(a=r=0;r<u.length&&!u[r].includes("DetermineComponentFrameRoot");)r++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(r===u.length||a===c.length)for(r=u.length-1,a=c.length-1;1<=r&&0<=a&&u[r]!==c[a];)a--;for(;1<=r&&0<=a;r--,a--)if(u[r]!==c[a]){if(1!==r||1!==a)do{if(r--,0>--a||u[r]!==c[a]){var l="\n"+u[r].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=r&&0<=a);break}}}finally{M=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?_(n):""}function R(e){switch(e.tag){case 26:case 27:case 5:return _(e.type);case 16:return _("Lazy");case 13:return _("Suspense");case 19:return _("SuspenseList");case 0:case 15:return e=O(e.type,!1);case 11:return e=O(e.type.render,!1);case 1:return e=O(e.type,!0);default:return""}}function z(e){try{var t="";do{t+=R(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function B(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function L(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function P(e){if(B(e)!==e)throw Error(o(188))}function U(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=U(e)))return t;e=e.sibling}return null}var W=Array.isArray,V=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q={pending:!1,data:null,method:null,action:null},j=[],G=-1;function H(e){return{current:e}}function K(e){0>G||(e.current=j[G],j[G]=null,G--)}function X(e,t){G++,j[G]=e.current,e.current=t}var Y=H(null),$=H(null),Z=H(null),Q=H(null);function J(e,t){switch(X(Z,t),X($,e),X(Y,null),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)&&(t=t.namespaceURI)?$l(t):0;break;default:if(t=(e=8===e?t.parentNode:t).tagName,e=e.namespaceURI)t=Zl(e=$l(e),t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}K(Y),X(Y,t)}function ee(){K(Y),K($),K(Z)}function te(e){null!==e.memoizedState&&X(Q,e);var t=Y.current,n=Zl(t,e.type);t!==n&&(X($,e),X(Y,n))}function ne(e){$.current===e&&(K(Y),K($)),Q.current===e&&(K(Q),zp._currentValue=q)}var re=Object.prototype.hasOwnProperty,ae=r.unstable_scheduleCallback,ie=r.unstable_cancelCallback,oe=r.unstable_shouldYield,se=r.unstable_requestPaint,ue=r.unstable_now,ce=r.unstable_getCurrentPriorityLevel,le=r.unstable_ImmediatePriority,pe=r.unstable_UserBlockingPriority,he=r.unstable_NormalPriority,de=r.unstable_LowPriority,fe=r.unstable_IdlePriority,me=r.log,ge=r.unstable_setDisableYieldValue,ye=null,ve=null;function be(e){if("function"===typeof me&&ge(e),ve&&"function"===typeof ve.setStrictMode)try{ve.setStrictMode(ye,e)}catch(t){}}var xe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(we(e)/Ne|0)|0},we=Math.log,Ne=Math.LN2;var Se=128,ke=4194304;function Ee(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194176&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ce(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,o=e.warmLanes;e=0!==e.finishedLanes;var s=134217727&n;return 0!==s?0!==(n=s&~a)?r=Ee(n):0!==(i&=s)?r=Ee(i):e||0!==(o=s&~o)&&(r=Ee(o)):0!==(s=n&~a)?r=Ee(s):0!==i?r=Ee(i):e||0!==(o=n&~o)&&(r=Ee(o)),0===r?0:0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(o=t&-t)||32===a&&0!==(4194176&o))?t:r}function Te(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function De(e,t){switch(e){case 1:case 2:case 4:case 8:return t+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ie(){var e=Se;return 0===(4194176&(Se<<=1))&&(Se=128),e}function Ae(){var e=ke;return 0===(62914560&(ke<<=1))&&(ke=4194304),e}function Fe(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function _e(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Me(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-xe(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194218&n}function Oe(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-xe(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}function Re(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function ze(){var e=V.p;return 0!==e?e:void 0===(e=window.event)?32:Zp(e.type)}var Be=Math.random().toString(36).slice(2),Le="__reactFiber$"+Be,Pe="__reactProps$"+Be,Ue="__reactContainer$"+Be,We="__reactEvents$"+Be,Ve="__reactListeners$"+Be,qe="__reactHandles$"+Be,je="__reactResources$"+Be,Ge="__reactMarker$"+Be;function He(e){delete e[Le],delete e[Pe],delete e[We],delete e[Ve],delete e[qe]}function Ke(e){var t=e[Le];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ue]||n[Le]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=up(e);null!==e;){if(n=e[Le])return n;e=up(e)}return t}n=(e=n).parentNode}return null}function Xe(e){if(e=e[Le]||e[Ue]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Ye(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(o(33))}function $e(e){var t=e[je];return t||(t=e[je]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ze(e){e[Ge]=!0}var Qe=new Set,Je={};function et(e,t){tt(e,t),tt(e+"Capture",t)}function tt(e,t){for(Je[e]=t,e=0;e<t.length;e++)Qe.add(t[e])}var nt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),rt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),at={},it={};function ot(e,t,n){if(a=t,re.call(it,a)||!re.call(at,a)&&(rt.test(a)?it[a]=!0:(at[a]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var a}function st(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function ut(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function lt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function pt(e){e._valueTracker||(e._valueTracker=function(e){var t=lt(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ht(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=lt(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function dt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var ft=/[\n"\\]/g;function mt(e){return e.replace(ft,(function(e){return"\\"+e.charCodeAt(0).toString(16)+" "}))}function gt(e,t,n,r,a,i,o,s){e.name="",null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.type=o:e.removeAttribute("type"),null!=t?"number"===o?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==o&&"reset"!==o||e.removeAttribute("value"),null!=t?vt(e,o,ct(t)):null!=n?vt(e,o,ct(n)):null!=r&&e.removeAttribute("value"),null==a&&null!=i&&(e.defaultChecked=!!i),null!=a&&(e.checked=a&&"function"!==typeof a&&"symbol"!==typeof a),null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.name=""+ct(s):e.removeAttribute("name")}function yt(e,t,n,r,a,i,o,s){if(null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.type=i),null!=t||null!=n){if(!("submit"!==i&&"reset"!==i||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,s||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:a)&&"symbol"!==typeof r&&!!r,e.checked=s?e.checked:!!r,e.defaultChecked=!!r,null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.name=o)}function vt(e,t,n){"number"===t&&dt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function bt(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function xt(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function wt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(o(92));if(W(r)){if(1<r.length)throw Error(o(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r)}function Nt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var St=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function kt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||St.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Et(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(o(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var a in t)r=t[a],t.hasOwnProperty(a)&&n[a]!==r&&kt(e,a,r)}else for(var i in t)t.hasOwnProperty(i)&&kt(e,i,t[i])}function Ct(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Dt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function It(e){return Dt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var At=null;function Ft(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _t=null,Mt=null;function Ot(e){var t=Xe(e);if(t&&(e=t.stateNode)){var n=e[Pe]||null;e:switch(e=t.stateNode,t.type){case"input":if(gt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+mt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=r[Pe]||null;if(!a)throw Error(o(90));gt(r,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&ht(r)}break e;case"textarea":xt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&bt(e,!!n.multiple,t,!1)}}}var Rt=!1;function zt(e,t,n){if(Rt)return e(t,n);Rt=!0;try{return e(t)}finally{if(Rt=!1,(null!==_t||null!==Mt)&&(Lc(),_t&&(t=_t,e=Mt,Mt=_t=null,Ot(t),e)))for(t=0;t<e.length;t++)Ot(e[t])}}function Bt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[Pe]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Lt=!1;if(nt)try{var Pt={};Object.defineProperty(Pt,"passive",{get:function(){Lt=!0}}),window.addEventListener("test",Pt,Pt),window.removeEventListener("test",Pt,Pt)}catch(wh){Lt=!1}var Ut=null,Wt=null,Vt=null;function qt(){if(Vt)return Vt;var e,t,n=Wt,r=n.length,a="value"in Ut?Ut.value:Ut.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return Vt=a.slice(e,1<t?1-t:void 0)}function jt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Gt(){return!0}function Ht(){return!1}function Kt(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?Gt:Ht,this.isPropagationStopped=Ht,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Gt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Gt)},persist:function(){},isPersistent:Gt}),t}var Xt,Yt,$t,Zt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qt=Kt(Zt),Jt=F({},Zt,{view:0,detail:0}),en=Kt(Jt),tn=F({},Jt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$t&&($t&&"mousemove"===e.type?(Xt=e.screenX-$t.screenX,Yt=e.screenY-$t.screenY):Yt=Xt=0,$t=e),Xt)},movementY:function(e){return"movementY"in e?e.movementY:Yt}}),nn=Kt(tn),rn=Kt(F({},tn,{dataTransfer:0})),an=Kt(F({},Jt,{relatedTarget:0})),on=Kt(F({},Zt,{animationName:0,elapsedTime:0,pseudoElement:0})),sn=Kt(F({},Zt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),un=Kt(F({},Zt,{data:0})),cn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ln={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=pn[e])&&!!t[e]}function dn(){return hn}var fn=Kt(F({},Jt,{key:function(e){if(e.key){var t=cn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=jt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?ln[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dn,charCode:function(e){return"keypress"===e.type?jt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?jt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),mn=Kt(F({},tn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),gn=Kt(F({},Jt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dn})),yn=Kt(F({},Zt,{propertyName:0,elapsedTime:0,pseudoElement:0})),vn=Kt(F({},tn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),bn=Kt(F({},Zt,{newState:0,oldState:0})),xn=[9,13,27,32],wn=nt&&"CompositionEvent"in window,Nn=null;nt&&"documentMode"in document&&(Nn=document.documentMode);var Sn=nt&&"TextEvent"in window&&!Nn,kn=nt&&(!wn||Nn&&8<Nn&&11>=Nn),En=String.fromCharCode(32),Cn=!1;function Tn(e,t){switch(e){case"keyup":return-1!==xn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var In=!1;var An={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!An[e.type]:"textarea"===t}function _n(e,t,n,r){_t?Mt?Mt.push(r):Mt=[r]:_t=r,0<(t=zl(t,"onChange")).length&&(n=new Qt("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Mn=null,On=null;function Rn(e){Dl(e,0)}function zn(e){if(ht(Ye(e)))return e}function Bn(e,t){if("change"===e)return t}var Ln=!1;if(nt){var Pn;if(nt){var Un="oninput"in document;if(!Un){var Wn=document.createElement("div");Wn.setAttribute("oninput","return;"),Un="function"===typeof Wn.oninput}Pn=Un}else Pn=!1;Ln=Pn&&(!document.documentMode||9<document.documentMode)}function Vn(){Mn&&(Mn.detachEvent("onpropertychange",qn),On=Mn=null)}function qn(e){if("value"===e.propertyName&&zn(On)){var t=[];_n(t,On,e,Ft(e)),zt(Rn,t)}}function jn(e,t,n){"focusin"===e?(Vn(),On=n,(Mn=t).attachEvent("onpropertychange",qn)):"focusout"===e&&Vn()}function Gn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return zn(On)}function Hn(e,t){if("click"===e)return zn(t)}function Kn(e,t){if("input"===e||"change"===e)return zn(t)}var Xn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Yn(e,t){if(Xn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!re.call(t,a)||!Xn(e[a],t[a]))return!1}return!0}function $n(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Zn(e,t){var n,r=$n(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=$n(r)}}function Qn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Qn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function Jn(e){for(var t=dt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=dt((e=t.contentWindow).document)}return t}function er(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function tr(e,t){var n=Jn(t);t=e.focusedElem;var r=e.selectionRange;if(n!==t&&t&&t.ownerDocument&&Qn(t.ownerDocument.documentElement,t)){if(null!==r&&er(t))if(e=r.start,void 0===(n=r.end)&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if((n=(e=t.ownerDocument||document)&&e.defaultView||window).getSelection){n=n.getSelection();var a=t.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!n.extend&&i>r&&(a=r,r=i,i=a),a=Zn(t,i);var o=Zn(t,r);a&&o&&(1!==n.rangeCount||n.anchorNode!==a.node||n.anchorOffset!==a.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&((e=e.createRange()).setStart(a.node,a.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}for(e=[],n=t;n=n.parentNode;)1===n.nodeType&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for("function"===typeof t.focus&&t.focus(),t=0;t<e.length;t++)(n=e[t]).element.scrollLeft=n.left,n.element.scrollTop=n.top}}var nr=nt&&"documentMode"in document&&11>=document.documentMode,rr=null,ar=null,ir=null,or=!1;function sr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;or||null==rr||rr!==dt(r)||("selectionStart"in(r=rr)&&er(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},ir&&Yn(ir,r)||(ir=r,0<(r=zl(ar,"onSelect")).length&&(t=new Qt("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=rr)))}function ur(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var cr={animationend:ur("Animation","AnimationEnd"),animationiteration:ur("Animation","AnimationIteration"),animationstart:ur("Animation","AnimationStart"),transitionrun:ur("Transition","TransitionRun"),transitionstart:ur("Transition","TransitionStart"),transitioncancel:ur("Transition","TransitionCancel"),transitionend:ur("Transition","TransitionEnd")},lr={},pr={};function hr(e){if(lr[e])return lr[e];if(!cr[e])return e;var t,n=cr[e];for(t in n)if(n.hasOwnProperty(t)&&t in pr)return lr[e]=n[t];return e}nt&&(pr=document.createElement("div").style,"AnimationEvent"in window||(delete cr.animationend.animation,delete cr.animationiteration.animation,delete cr.animationstart.animation),"TransitionEvent"in window||delete cr.transitionend.transition);var dr=hr("animationend"),fr=hr("animationiteration"),mr=hr("animationstart"),gr=hr("transitionrun"),yr=hr("transitionstart"),vr=hr("transitioncancel"),br=hr("transitionend"),xr=new Map,wr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Nr(e,t){xr.set(e,t),et(t,[e])}var Sr=[],kr=0,Er=0;function Cr(){for(var e=kr,t=Er=kr=0;t<e;){var n=Sr[t];Sr[t++]=null;var r=Sr[t];Sr[t++]=null;var a=Sr[t];Sr[t++]=null;var i=Sr[t];if(Sr[t++]=null,null!==r&&null!==a){var o=r.pending;null===o?a.next=a:(a.next=o.next,o.next=a),r.pending=a}0!==i&&Ar(n,a,i)}}function Tr(e,t,n,r){Sr[kr++]=e,Sr[kr++]=t,Sr[kr++]=n,Sr[kr++]=r,Er|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Dr(e,t,n,r){return Tr(e,t,n,r),Fr(e)}function Ir(e,t){return Tr(e,null,null,t),Fr(e)}function Ar(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var a=!1,i=e.return;null!==i;)i.childLanes|=n,null!==(r=i.alternate)&&(r.childLanes|=n),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(a=!0)),e=i,i=i.return;a&&null!==t&&3===e.tag&&(i=e.stateNode,a=31-xe(n),null===(e=(i=i.hiddenUpdates)[a])?i[a]=[t]:e.push(t),t.lane=536870912|n)}function Fr(e){if(50<Dc)throw Dc=0,Ic=null,Error(o(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var _r={},Mr=new WeakMap;function Or(e,t){if("object"===typeof e&&null!==e){var n=Mr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:z(t)},Mr.set(e,t),t)}return{value:e,source:t,stack:z(t)}}var Rr=[],zr=0,Br=null,Lr=0,Pr=[],Ur=0,Wr=null,Vr=1,qr="";function jr(e,t){Rr[zr++]=Lr,Rr[zr++]=Br,Br=e,Lr=t}function Gr(e,t,n){Pr[Ur++]=Vr,Pr[Ur++]=qr,Pr[Ur++]=Wr,Wr=e;var r=Vr;e=qr;var a=32-xe(r)-1;r&=~(1<<a),n+=1;var i=32-xe(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Vr=1<<32-xe(t)+a|n<<a|r,qr=i+e}else Vr=1<<i|n<<a|r,qr=e}function Hr(e){null!==e.return&&(jr(e,1),Gr(e,1,0))}function Kr(e){for(;e===Br;)Br=Rr[--zr],Rr[zr]=null,Lr=Rr[--zr],Rr[zr]=null;for(;e===Wr;)Wr=Pr[--Ur],Pr[Ur]=null,qr=Pr[--Ur],Pr[Ur]=null,Vr=Pr[--Ur],Pr[Ur]=null}var Xr=null,Yr=null,$r=!1,Zr=null,Qr=!1,Jr=Error(o(519));function ea(e){throw ia(Or(Error(o(418,"")),e)),Jr}function ta(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Le]=e,t[Pe]=r,n){case"dialog":Il("cancel",t),Il("close",t);break;case"iframe":case"object":case"embed":Il("load",t);break;case"video":case"audio":for(n=0;n<Cl.length;n++)Il(Cl[n],t);break;case"source":Il("error",t);break;case"img":case"image":case"link":Il("error",t),Il("load",t);break;case"details":Il("toggle",t);break;case"input":Il("invalid",t),yt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),pt(t);break;case"select":Il("invalid",t);break;case"textarea":Il("invalid",t),wt(t,r.value,r.defaultValue,r.children),pt(t)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||Vl(t.textContent,n)?(null!=r.popover&&(Il("beforetoggle",t),Il("toggle",t)),null!=r.onScroll&&Il("scroll",t),null!=r.onScrollEnd&&Il("scrollend",t),null!=r.onClick&&(t.onclick=ql),t=!0):t=!1,t||ea(e)}function na(e){for(Xr=e.return;Xr;)switch(Xr.tag){case 3:case 27:return void(Qr=!0);case 5:case 13:return void(Qr=!1);default:Xr=Xr.return}}function ra(e){if(e!==Xr)return!1;if(!$r)return na(e),$r=!0,!1;var t,n=!1;if((t=3!==e.tag&&27!==e.tag)&&((t=5===e.tag)&&(t=!("form"!==(t=e.type)&&"button"!==t)||Ql(e.type,e.memoizedProps)),t=!t),t&&(n=!0),n&&Yr&&ea(e),na(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){Yr=sp(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}Yr=null}}else Yr=Xr?sp(e.stateNode.nextSibling):null;return!0}function aa(){Yr=Xr=null,$r=!1}function ia(e){null===Zr?Zr=[e]:Zr.push(e)}var oa=Error(o(460)),sa=Error(o(474)),ua={then:function(){}};function ca(e){return"fulfilled"===(e=e.status)||"rejected"===e}function la(){}function pa(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(la,la),t=n),t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===oa)throw Error(o(483));throw e;default:if("string"===typeof t.status)t.then(la,la);else{if(null!==(e=tc)&&100<e.shellSuspendCounter)throw Error(o(482));(e=t).status="pending",e.then((function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}}),(function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}}))}switch(t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===oa)throw Error(o(483));throw e}throw ha=t,oa}}var ha=null;function da(){if(null===ha)throw Error(o(459));var e=ha;return ha=null,e}var fa=null,ma=0;function ga(e){var t=ma;return ma+=1,null===fa&&(fa=[]),pa(fa,e,t)}function ya(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function va(e,t){if(t.$$typeof===u)throw Error(o(525));throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ba(e){return(0,e._init)(e._payload)}function xa(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function a(e,t){return(e=Bu(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=33554434,n):r:(t.flags|=33554434,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=33554434),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Vu(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n,r){var i=n.type;return i===p?f(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===w&&ba(i)===t.type)?(ya(t=a(t,n.props),n),t.return=e,t):(ya(t=Pu(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=qu(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function f(e,t,n,r,i){return null===t||7!==t.tag?((t=Uu(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function m(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Vu(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case c:return ya(n=Pu(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case l:return(t=qu(t,e.mode,n)).return=e,t;case w:return m(e,t=(0,t._init)(t._payload),n)}if(W(t)||E(t))return(t=Uu(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return m(e,ga(t),n);if(t.$$typeof===g)return m(e,Cs(e,t),n);va(e,t)}return null}function y(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==a?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case c:return n.key===a?h(e,t,n,r):null;case l:return n.key===a?d(e,t,n,r):null;case w:return y(e,t,n=(a=n._init)(n._payload),r)}if(W(n)||E(n))return null!==a?null:f(e,t,n,r,null);if("function"===typeof n.then)return y(e,t,ga(n),r);if(n.$$typeof===g)return y(e,t,Cs(e,n),r);va(e,n)}return null}function v(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return u(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case c:return h(t,e=e.get(null===r.key?n:r.key)||null,r,a);case l:return d(t,e=e.get(null===r.key?n:r.key)||null,r,a);case w:return v(e,t,n,r=(0,r._init)(r._payload),a)}if(W(r)||E(r))return f(t,e=e.get(n)||null,r,a,null);if("function"===typeof r.then)return v(e,t,n,ga(r),a);if(r.$$typeof===g)return v(e,t,n,Cs(t,r),a);va(t,r)}return null}function b(u,h,d,f){if("object"===typeof d&&null!==d&&d.type===p&&null===d.key&&(d=d.props.children),"object"===typeof d&&null!==d){switch(d.$$typeof){case c:e:{for(var x=d.key;null!==h;){if(h.key===x){if((x=d.type)===p){if(7===h.tag){n(u,h.sibling),(f=a(h,d.props.children)).return=u,u=f;break e}}else if(h.elementType===x||"object"===typeof x&&null!==x&&x.$$typeof===w&&ba(x)===h.type){n(u,h.sibling),ya(f=a(h,d.props),d),f.return=u,u=f;break e}n(u,h);break}t(u,h),h=h.sibling}d.type===p?((f=Uu(d.props.children,u.mode,f,d.key)).return=u,u=f):(ya(f=Pu(d.type,d.key,d.props,null,u.mode,f),d),f.return=u,u=f)}return s(u);case l:e:{for(x=d.key;null!==h;){if(h.key===x){if(4===h.tag&&h.stateNode.containerInfo===d.containerInfo&&h.stateNode.implementation===d.implementation){n(u,h.sibling),(f=a(h,d.children||[])).return=u,u=f;break e}n(u,h);break}t(u,h),h=h.sibling}(f=qu(d,u.mode,f)).return=u,u=f}return s(u);case w:return b(u,h,d=(x=d._init)(d._payload),f)}if(W(d))return function(a,o,s,u){for(var c=null,l=null,p=o,h=o=0,d=null;null!==p&&h<s.length;h++){p.index>h?(d=p,p=null):d=p.sibling;var f=y(a,p,s[h],u);if(null===f){null===p&&(p=d);break}e&&p&&null===f.alternate&&t(a,p),o=i(f,o,h),null===l?c=f:l.sibling=f,l=f,p=d}if(h===s.length)return n(a,p),$r&&jr(a,h),c;if(null===p){for(;h<s.length;h++)null!==(p=m(a,s[h],u))&&(o=i(p,o,h),null===l?c=p:l.sibling=p,l=p);return $r&&jr(a,h),c}for(p=r(p);h<s.length;h++)null!==(d=v(p,a,h,s[h],u))&&(e&&null!==d.alternate&&p.delete(null===d.key?h:d.key),o=i(d,o,h),null===l?c=d:l.sibling=d,l=d);return e&&p.forEach((function(e){return t(a,e)})),$r&&jr(a,h),c}(u,h,d,f);if(E(d)){if("function"!==typeof(x=E(d)))throw Error(o(150));return function(a,s,u,c){if(null==u)throw Error(o(151));for(var l=null,p=null,h=s,d=s=0,f=null,g=u.next();null!==h&&!g.done;d++,g=u.next()){h.index>d?(f=h,h=null):f=h.sibling;var b=y(a,h,g.value,c);if(null===b){null===h&&(h=f);break}e&&h&&null===b.alternate&&t(a,h),s=i(b,s,d),null===p?l=b:p.sibling=b,p=b,h=f}if(g.done)return n(a,h),$r&&jr(a,d),l;if(null===h){for(;!g.done;d++,g=u.next())null!==(g=m(a,g.value,c))&&(s=i(g,s,d),null===p?l=g:p.sibling=g,p=g);return $r&&jr(a,d),l}for(h=r(h);!g.done;d++,g=u.next())null!==(g=v(h,a,d,g.value,c))&&(e&&null!==g.alternate&&h.delete(null===g.key?d:g.key),s=i(g,s,d),null===p?l=g:p.sibling=g,p=g);return e&&h.forEach((function(e){return t(a,e)})),$r&&jr(a,d),l}(u,h,d=x.call(d),f)}if("function"===typeof d.then)return b(u,h,ga(d),f);if(d.$$typeof===g)return b(u,h,Cs(u,d),f);va(u,d)}return"string"===typeof d&&""!==d||"number"===typeof d||"bigint"===typeof d?(d=""+d,null!==h&&6===h.tag?(n(u,h.sibling),(f=a(h,d)).return=u,u=f):(n(u,h),(f=Vu(d,u.mode,f)).return=u,u=f),s(u)):n(u,h)}return function(e,t,n,r){try{ma=0;var a=b(e,t,n,r);return fa=null,a}catch(o){if(o===oa)throw o;var i=Ru(29,o,null,e.mode);return i.lanes=r,i.return=e,i}}}var wa=xa(!0),Na=xa(!1),Sa=H(null),ka=H(0);function Ea(e,t){X(ka,e=cc),X(Sa,t),cc=e|t.baseLanes}function Ca(){X(ka,cc),X(Sa,Sa.current)}function Ta(){cc=ka.current,K(Sa),K(ka)}var Da=H(null),Ia=null;function Aa(e){var t=e.alternate;X(Oa,1&Oa.current),X(Da,e),null===Ia&&(null===t||null!==Sa.current||null!==t.memoizedState)&&(Ia=e)}function Fa(e){if(22===e.tag){if(X(Oa,Oa.current),X(Da,e),null===Ia){var t=e.alternate;null!==t&&null!==t.memoizedState&&(Ia=e)}}else _a()}function _a(){X(Oa,Oa.current),X(Da,Da.current)}function Ma(e){K(Da),Ia===e&&(Ia=null),K(Oa)}var Oa=H(0);function Ra(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var za="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach((function(e){return e()}))}},Ba=r.unstable_scheduleCallback,La=r.unstable_NormalPriority,Pa={$$typeof:g,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ua(){return{controller:new za,data:new Map,refCount:0}}function Wa(e){e.refCount--,0===e.refCount&&Ba(La,(function(){e.controller.abort()}))}var Va=null,qa=0,ja=0,Ga=null;function Ha(){if(0===--qa&&null!==Va){null!==Ga&&(Ga.status="fulfilled");var e=Va;Va=null,ja=0,Ga=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Ka=A.S;A.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Va){var n=Va=[];qa=0,ja=wl(),Ga={status:"pending",value:void 0,then:function(e){n.push(e)}}}qa++,t.then(Ha,Ha)}(0,t),null!==Ka&&Ka(e,t)};var Xa=H(null);function Ya(){var e=Xa.current;return null!==e?e:tc.pooledCache}function $a(e,t){X(Xa,null===t?Xa.current:t.pool)}function Za(){var e=Ya();return null===e?null:{parent:Pa._currentValue,pool:e}}var Qa=0,Ja=null,ei=null,ti=null,ni=!1,ri=!1,ai=!1,ii=0,oi=0,si=null,ui=0;function ci(){throw Error(o(321))}function li(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Xn(e[n],t[n]))return!1;return!0}function pi(e,t,n,r,a,i){return Qa=i,Ja=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,A.H=null===e||null===e.memoizedState?Co:To,ai=!1,i=n(r,a),ai=!1,ri&&(i=di(t,n,r,a)),hi(e),i}function hi(e){A.H=Eo;var t=null!==ei&&null!==ei.next;if(Qa=0,ti=ei=Ja=null,ni=!1,oi=0,si=null,t)throw Error(o(300));null===e||jo||null!==(e=e.dependencies)&&Ss(e)&&(jo=!0)}function di(e,t,n,r){Ja=e;var a=0;do{if(ri&&(si=null),oi=0,ri=!1,25<=a)throw Error(o(301));if(a+=1,ti=ei=null,null!=e.updateQueue){var i=e.updateQueue;i.lastEffect=null,i.events=null,i.stores=null,null!=i.memoCache&&(i.memoCache.index=0)}A.H=Do,i=t(n,r)}while(ri);return i}function fi(){var e=A.H,t=e.useState()[0];return t="function"===typeof t.then?xi(t):t,e=e.useState()[0],(null!==ei?ei.memoizedState:null)!==e&&(Ja.flags|=1024),t}function mi(){var e=0!==ii;return ii=0,e}function gi(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function yi(e){if(ni){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}ni=!1}Qa=0,ti=ei=Ja=null,ri=!1,oi=ii=0,si=null}function vi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ti?Ja.memoizedState=ti=e:ti=ti.next=e,ti}function bi(){if(null===ei){var e=Ja.alternate;e=null!==e?e.memoizedState:null}else e=ei.next;var t=null===ti?Ja.memoizedState:ti.next;if(null!==t)ti=t,ei=e;else{if(null===e){if(null===Ja.alternate)throw Error(o(467));throw Error(o(310))}e={memoizedState:(ei=e).memoizedState,baseState:ei.baseState,baseQueue:ei.baseQueue,queue:ei.queue,next:null},null===ti?Ja.memoizedState=ti=e:ti=ti.next=e}return ti}function xi(e){var t=oi;return oi+=1,null===si&&(si=[]),e=pa(si,e,t),t=Ja,null===(null===ti?t.memoizedState:ti.next)&&(t=t.alternate,A.H=null===t||null===t.memoizedState?Co:To),e}function wi(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return xi(e);if(e.$$typeof===g)return Es(e)}throw Error(o(438,String(e)))}function Ni(e){var t=null,n=Ja.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=Ja.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map((function(e){return e.slice()})),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Ja.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=S;return t.index++,n}function Si(e,t){return"function"===typeof t?t(e):t}function ki(e){return Ei(bi(),ei,e)}function Ei(e,t,n){var r=e.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=n;var a=e.baseQueue,i=r.pending;if(null!==i){if(null!==a){var s=a.next;a.next=i.next,i.next=s}t.baseQueue=a=i,r.pending=null}if(i=e.baseState,null===a)e.memoizedState=i;else{var u=s=null,c=null,l=t=a.next,p=!1;do{var h=-536870913&l.lane;if(h!==l.lane?(rc&h)===h:(Qa&h)===h){var d=l.revertLane;if(0===d)null!==c&&(c=c.next={lane:0,revertLane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),h===ja&&(p=!0);else{if((Qa&d)===d){l=l.next,d===ja&&(p=!0);continue}h={lane:0,revertLane:l.revertLane,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null},null===c?(u=c=h,s=i):c=c.next=h,Ja.lanes|=d,pc|=d}h=l.action,ai&&n(i,h),i=l.hasEagerState?l.eagerState:n(i,h)}else d={lane:h,revertLane:l.revertLane,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null},null===c?(u=c=d,s=i):c=c.next=d,Ja.lanes|=h,pc|=h;l=l.next}while(null!==l&&l!==t);if(null===c?s=i:c.next=u,!Xn(i,e.memoizedState)&&(jo=!0,p&&null!==(n=Ga)))throw n;e.memoizedState=i,e.baseState=s,e.baseQueue=c,r.lastRenderedState=i}return null===a&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Ci(e){var t=bi(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{i=e(i,s.action),s=s.next}while(s!==a);Xn(i,t.memoizedState)||(jo=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Ti(e,t,n){var r=Ja,a=bi(),i=$r;if(i){if(void 0===n)throw Error(o(407));n=n()}else n=t();var s=!Xn((ei||a).memoizedState,n);if(s&&(a.memoizedState=n,jo=!0),a=a.queue,Qi(Ai.bind(null,r,a,e),[e]),a.getSnapshot!==t||s||null!==ti&&1&ti.memoizedState.tag){if(r.flags|=2048,Ki(9,Ii.bind(null,r,a,n,t),{destroy:void 0},null),null===tc)throw Error(o(349));i||0!==(60&Qa)||Di(r,t,n)}return n}function Di(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Ja.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Ja.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ii(e,t,n,r){t.value=n,t.getSnapshot=r,Fi(t)&&_i(e)}function Ai(e,t,n){return n((function(){Fi(t)&&_i(e)}))}function Fi(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Xn(e,n)}catch(r){return!0}}function _i(e){var t=Ir(e,2);null!==t&&_c(t,e,2)}function Mi(e){var t=vi();if("function"===typeof e){var n=e;if(e=n(),ai){be(!0);try{n()}finally{be(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Si,lastRenderedState:e},t}function Oi(e,t,n,r){return e.baseState=n,Ei(e,ei,"function"===typeof r?r:Si)}function Ri(e,t,n,r,a){if(No(e))throw Error(o(485));if(null!==(e=t.action)){var i={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){i.listeners.push(e)}};null!==A.T?n(!0):i.isTransition=!1,r(i),null===(n=t.pending)?(i.next=t.pending=i,zi(t,i)):(i.next=n.next,t.pending=n.next=i)}}function zi(e,t){var n=t.action,r=t.payload,a=e.state;if(t.isTransition){var i=A.T,o={};A.T=o;try{var s=n(a,r),u=A.S;null!==u&&u(o,s),Bi(e,t,s)}catch(c){Pi(e,t,c)}finally{A.T=i}}else try{Bi(e,t,i=n(a,r))}catch(l){Pi(e,t,l)}}function Bi(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then((function(n){Li(e,t,n)}),(function(n){return Pi(e,t,n)})):Li(e,t,n)}function Li(e,t,n){t.status="fulfilled",t.value=n,Ui(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,zi(e,n)))}function Pi(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,Ui(t),t=t.next}while(t!==r)}e.action=null}function Ui(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Wi(e,t){return t}function Vi(e,t){if($r){var n=tc.formState;if(null!==n){e:{var r=Ja;if($r){if(Yr){t:{for(var a=Yr,i=Qr;8!==a.nodeType;){if(!i){a=null;break t}if(null===(a=sp(a.nextSibling))){a=null;break t}}a="F!"===(i=a.data)||"F"===i?a:null}if(a){Yr=sp(a.nextSibling),r="F!"===a.data;break e}}ea(r)}r=!1}r&&(t=n[0])}}return(n=vi()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wi,lastRenderedState:t},n.queue=r,n=bo.bind(null,Ja,r),r.dispatch=n,r=Mi(!1),i=wo.bind(null,Ja,!1,r.queue),a={state:t,dispatch:null,action:e,pending:null},(r=vi()).queue=a,n=Ri.bind(null,Ja,a,i,n),a.dispatch=n,r.memoizedState=e,[t,n,!1]}function qi(e){return ji(bi(),ei,e)}function ji(e,t,n){t=Ei(e,t,Wi)[0],e=ki(Si)[0],t="object"===typeof t&&null!==t&&"function"===typeof t.then?xi(t):t;var r=bi(),a=r.queue,i=a.dispatch;return n!==r.memoizedState&&(Ja.flags|=2048,Ki(9,Gi.bind(null,a,n),{destroy:void 0},null)),[t,i,e]}function Gi(e,t){e.action=t}function Hi(e){var t=bi(),n=ei;if(null!==n)return ji(t,n,e);bi(),t=t.memoizedState;var r=(n=bi()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Ki(e,t,n,r){return e={tag:e,create:t,inst:n,deps:r,next:null},null===(t=Ja.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Ja.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Xi(){return bi().memoizedState}function Yi(e,t,n,r){var a=vi();Ja.flags|=e,a.memoizedState=Ki(1|t,n,{destroy:void 0},void 0===r?null:r)}function $i(e,t,n,r){var a=bi();r=void 0===r?null:r;var i=a.memoizedState.inst;null!==ei&&null!==r&&li(r,ei.memoizedState.deps)?a.memoizedState=Ki(t,n,i,r):(Ja.flags|=e,a.memoizedState=Ki(1|t,n,i,r))}function Zi(e,t){Yi(8390656,8,e,t)}function Qi(e,t){$i(2048,8,e,t)}function Ji(e,t){return $i(4,2,e,t)}function eo(e,t){return $i(4,4,e,t)}function to(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function no(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,$i(4,4,to.bind(null,t,e),n)}function ro(){}function ao(e,t){var n=bi();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&li(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function io(e,t){var n=bi();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&li(t,r[1]))return r[0];if(r=e(),ai){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[r,t],r}function oo(e,t,n){return void 0===n||0!==(1073741824&Qa)?e.memoizedState=t:(e.memoizedState=n,e=Fc(),Ja.lanes|=e,pc|=e,n)}function so(e,t,n,r){return Xn(n,t)?n:null!==Sa.current?(e=oo(e,n,r),Xn(e,t)||(jo=!0),e):0===(42&Qa)?(jo=!0,e.memoizedState=n):(e=Fc(),Ja.lanes|=e,pc|=e,t)}function uo(e,t,n,r,a){var i=V.p;V.p=0!==i&&8>i?i:8;var o=A.T,s={};A.T=s,wo(e,!1,t,n);try{var u=a(),c=A.S;if(null!==c&&c(s,u),null!==u&&"object"===typeof u&&"function"===typeof u.then)xo(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then((function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)}),(function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)})),r}(u,r),Ac());else xo(e,t,r,Ac())}catch(l){xo(e,t,{then:function(){},status:"rejected",reason:l},Ac())}finally{V.p=i,A.T=o}}function co(){}function lo(e,t,n,r){if(5!==e.tag)throw Error(o(476));var a=po(e).queue;uo(e,a,t,q,null===n?co:function(){return ho(e),n(r)})}function po(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:q,baseState:q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Si,lastRenderedState:q},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Si,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function ho(e){xo(e,po(e).next.queue,{},Ac())}function fo(){return Es(zp)}function mo(){return bi().memoizedState}function go(){return bi().memoizedState}function yo(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Ac(),r=_s(t,e=Fs(n),n);return null!==r&&(_c(r,t,n),Ms(r,t,n)),t={cache:Ua()},void(e.payload=t)}t=t.return}}function vo(e,t,n){var r=Ac();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},No(e)?So(t,n):null!==(n=Dr(e,t,n,r))&&(_c(n,e,r),ko(n,t,r))}function bo(e,t,n){xo(e,t,n,Ac())}function xo(e,t,n,r){var a={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(No(e))So(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,Xn(s,o))return Tr(e,t,a,0),null===tc&&Cr(),!1}catch(u){}if(null!==(n=Dr(e,t,a,r)))return _c(n,e,r),ko(n,t,r),!0}return!1}function wo(e,t,n,r){if(r={lane:2,revertLane:wl(),action:r,hasEagerState:!1,eagerState:null,next:null},No(e)){if(t)throw Error(o(479))}else null!==(t=Dr(e,n,r,2))&&_c(t,e,2)}function No(e){var t=e.alternate;return e===Ja||null!==t&&t===Ja}function So(e,t){ri=ni=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ko(e,t,n){if(0!==(4194176&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Oe(e,n)}}var Eo={readContext:Es,use:wi,useCallback:ci,useContext:ci,useEffect:ci,useImperativeHandle:ci,useLayoutEffect:ci,useInsertionEffect:ci,useMemo:ci,useReducer:ci,useRef:ci,useState:ci,useDebugValue:ci,useDeferredValue:ci,useTransition:ci,useSyncExternalStore:ci,useId:ci};Eo.useCacheRefresh=ci,Eo.useMemoCache=ci,Eo.useHostTransitionStatus=ci,Eo.useFormState=ci,Eo.useActionState=ci,Eo.useOptimistic=ci;var Co={readContext:Es,use:wi,useCallback:function(e,t){return vi().memoizedState=[e,void 0===t?null:t],e},useContext:Es,useEffect:Zi,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Yi(4194308,4,to.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Yi(4194308,4,e,t)},useInsertionEffect:function(e,t){Yi(4,2,e,t)},useMemo:function(e,t){var n=vi();t=void 0===t?null:t;var r=e();if(ai){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=vi();if(void 0!==n){var a=n(t);if(ai){be(!0);try{n(t)}finally{be(!1)}}}else a=t;return r.memoizedState=r.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},r.queue=e,e=e.dispatch=vo.bind(null,Ja,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},vi().memoizedState=e},useState:function(e){var t=(e=Mi(e)).queue,n=bo.bind(null,Ja,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:ro,useDeferredValue:function(e,t){return oo(vi(),e,t)},useTransition:function(){var e=Mi(!1);return e=uo.bind(null,Ja,e.queue,!0,!1),vi().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=Ja,a=vi();if($r){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===tc)throw Error(o(349));0!==(60&rc)||Di(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,Zi(Ai.bind(null,r,i,e),[e]),r.flags|=2048,Ki(9,Ii.bind(null,r,i,n,t),{destroy:void 0},null),n},useId:function(){var e=vi(),t=tc.identifierPrefix;if($r){var n=qr;t=":"+t+"R"+(n=(Vr&~(1<<32-xe(Vr)-1)).toString(32)+n),0<(n=ii++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ui++).toString(32)+":";return e.memoizedState=t},useCacheRefresh:function(){return vi().memoizedState=yo.bind(null,Ja)}};Co.useMemoCache=Ni,Co.useHostTransitionStatus=fo,Co.useFormState=Vi,Co.useActionState=Vi,Co.useOptimistic=function(e){var t=vi();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=wo.bind(null,Ja,!0,n),n.dispatch=t,[e,t]};var To={readContext:Es,use:wi,useCallback:ao,useContext:Es,useEffect:Qi,useImperativeHandle:no,useInsertionEffect:Ji,useLayoutEffect:eo,useMemo:io,useReducer:ki,useRef:Xi,useState:function(){return ki(Si)},useDebugValue:ro,useDeferredValue:function(e,t){return so(bi(),ei.memoizedState,e,t)},useTransition:function(){var e=ki(Si)[0],t=bi().memoizedState;return["boolean"===typeof e?e:xi(e),t]},useSyncExternalStore:Ti,useId:mo};To.useCacheRefresh=go,To.useMemoCache=Ni,To.useHostTransitionStatus=fo,To.useFormState=qi,To.useActionState=qi,To.useOptimistic=function(e,t){return Oi(bi(),0,e,t)};var Do={readContext:Es,use:wi,useCallback:ao,useContext:Es,useEffect:Qi,useImperativeHandle:no,useInsertionEffect:Ji,useLayoutEffect:eo,useMemo:io,useReducer:Ci,useRef:Xi,useState:function(){return Ci(Si)},useDebugValue:ro,useDeferredValue:function(e,t){var n=bi();return null===ei?oo(n,e,t):so(n,ei.memoizedState,e,t)},useTransition:function(){var e=Ci(Si)[0],t=bi().memoizedState;return["boolean"===typeof e?e:xi(e),t]},useSyncExternalStore:Ti,useId:mo};function Io(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}Do.useCacheRefresh=go,Do.useMemoCache=Ni,Do.useHostTransitionStatus=fo,Do.useFormState=Hi,Do.useActionState=Hi,Do.useOptimistic=function(e,t){var n=bi();return null!==ei?Oi(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])};var Ao={isMounted:function(e){return!!(e=e._reactInternals)&&B(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ac(),a=Fs(r);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=_s(e,a,r))&&(_c(t,e,r),Ms(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ac(),a=Fs(r);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=_s(e,a,r))&&(_c(t,e,r),Ms(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ac(),r=Fs(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=_s(e,r,n))&&(_c(t,e,n),Ms(t,e,n))}};function Fo(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!Yn(n,r)||!Yn(a,i))}function _o(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ao.enqueueReplaceState(t,t.state,null)}function Mo(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var a in n===t&&(n=F({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}var Oo="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function Ro(e){Oo(e)}function zo(e){console.error(e)}function Bo(e){Oo(e)}function Lo(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout((function(){throw n}))}}function Po(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout((function(){throw r}))}}function Uo(e,t,n){return(n=Fs(n)).tag=3,n.payload={element:null},n.callback=function(){Lo(e,t)},n}function Wo(e){return(e=Fs(e)).tag=3,e}function Vo(e,t,n,r){var a=n.type.getDerivedStateFromError;if("function"===typeof a){var i=r.value;e.payload=function(){return a(i)},e.callback=function(){Po(t,n,r)}}var o=n.stateNode;null!==o&&"function"===typeof o.componentDidCatch&&(e.callback=function(){Po(t,n,r),"function"!==typeof a&&(null===Nc?Nc=new Set([this]):Nc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var qo=Error(o(461)),jo=!1;function Go(e,t,n,r){t.child=null===e?Na(t,null,n,r):wa(t,e.child,n,r)}function Ho(e,t,n,r,a){n=n.render;var i=t.ref;if("ref"in r){var o={};for(var s in r)"ref"!==s&&(o[s]=r[s])}else o=r;return ks(t),r=pi(e,t,n,o,i,a),s=mi(),null===e||jo?($r&&s&&Hr(t),t.flags|=1,Go(e,t,r,a),t.child):(gi(e,t,a),hs(e,t,a))}function Ko(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||zu(i)||void 0!==i.defaultProps||null!==n.compare?((e=Pu(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Xo(e,t,i,r,a))}if(i=e.child,!ds(e,a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:Yn)(o,r)&&e.ref===t.ref)return hs(e,t,a)}return t.flags|=1,(e=Bu(i,r)).ref=t.ref,e.return=t,t.child=e}function Xo(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(Yn(i,r)&&e.ref===t.ref){if(jo=!1,t.pendingProps=r=i,!ds(e,a))return t.lanes=e.lanes,hs(e,t,a);0!==(131072&e.flags)&&(jo=!0)}}return Qo(e,t,n,r,a)}function Yo(e,t,n){var r=t.pendingProps,a=r.children,i=0!==(2&t.stateNode._pendingVisibility),o=null!==e?e.memoizedState:null;if(Zo(e,t),"hidden"===r.mode||i){if(0!==(128&t.flags)){if(r=null!==o?o.baseLanes|n:n,null!==e){for(a=t.child=e.child,i=0;null!==a;)i=i|a.lanes|a.childLanes,a=a.sibling;t.childLanes=i&~r}else t.childLanes=0,t.child=null;return $o(e,t,r,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,$o(e,t,null!==o?o.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&$a(0,null!==o?o.cachePool:null),null!==o?Ea(t,o):Ca(),Fa(t)}else null!==o?($a(0,o.cachePool),Ea(t,o),_a(),t.memoizedState=null):(null!==e&&$a(0,null),Ca(),_a());return Go(e,t,a,n),t.child}function $o(e,t,n,r){var a=Ya();return a=null===a?null:{parent:Pa._currentValue,pool:a},t.memoizedState={baseLanes:n,cachePool:a},null!==e&&$a(0,null),Ca(),Fa(t),null!==e&&Ns(e,t,r,!0),null}function Zo(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=2097664);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(o(284));null!==e&&e.ref===n||(t.flags|=2097664)}}function Qo(e,t,n,r,a){return ks(t),n=pi(e,t,n,r,void 0,a),r=mi(),null===e||jo?($r&&r&&Hr(t),t.flags|=1,Go(e,t,n,a),t.child):(gi(e,t,a),hs(e,t,a))}function Jo(e,t,n,r,a,i){return ks(t),t.updateQueue=null,n=di(t,r,n,a),hi(e),r=mi(),null===e||jo?($r&&r&&Hr(t),t.flags|=1,Go(e,t,n,i),t.child):(gi(e,t,i),hs(e,t,i))}function es(e,t,n,r,a){if(ks(t),null===t.stateNode){var i=_r,o=n.contextType;"object"===typeof o&&null!==o&&(i=Es(o)),i=new n(r,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=Ao,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=r,i.state=t.memoizedState,i.refs={},Is(t),o=n.contextType,i.context="object"===typeof o&&null!==o?Es(o):_r,i.state=t.memoizedState,"function"===typeof(o=n.getDerivedStateFromProps)&&(Io(t,n,o,r),i.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(o=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),o!==i.state&&Ao.enqueueReplaceState(i,i.state,null),Bs(t,r,i,a),zs(),i.state=t.memoizedState),"function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){i=t.stateNode;var s=t.memoizedProps,u=Mo(n,s);i.props=u;var c=i.context,l=n.contextType;o=_r,"object"===typeof l&&null!==l&&(o=Es(l));var p=n.getDerivedStateFromProps;l="function"===typeof p||"function"===typeof i.getSnapshotBeforeUpdate,s=t.pendingProps!==s,l||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s||c!==o)&&_o(t,i,r,o),Ds=!1;var h=t.memoizedState;i.state=h,Bs(t,r,i,a),zs(),c=t.memoizedState,s||h!==c||Ds?("function"===typeof p&&(Io(t,n,p,r),c=t.memoizedState),(u=Ds||Fo(t,n,u,r,h,c,o))?(l||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=o,r=u):("function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,As(e,t),l=Mo(n,o=t.memoizedProps),i.props=l,p=t.pendingProps,h=i.context,c=n.contextType,u=_r,"object"===typeof c&&null!==c&&(u=Es(c)),(c="function"===typeof(s=n.getDerivedStateFromProps)||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==p||h!==u)&&_o(t,i,r,u),Ds=!1,h=t.memoizedState,i.state=h,Bs(t,r,i,a),zs();var d=t.memoizedState;o!==p||h!==d||Ds||null!==e&&null!==e.dependencies&&Ss(e.dependencies)?("function"===typeof s&&(Io(t,n,s,r),d=t.memoizedState),(l=Ds||Fo(t,n,l,r,h,d,u)||null!==e&&null!==e.dependencies&&Ss(e.dependencies))?(c||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,d,u),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,d,u)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=d),i.props=r,i.state=d,i.context=u,r=l):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return i=r,Zo(e,t),r=0!==(128&t.flags),i||r?(i=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&r?(t.child=wa(t,e.child,null,a),t.child=wa(t,null,n,a)):Go(e,t,n,a),t.memoizedState=i.state,e=t.child):e=hs(e,t,a),e}function ts(e,t,n,r){return aa(),t.flags|=256,Go(e,t,n,r),t.child}var ns={dehydrated:null,treeContext:null,retryLane:0};function rs(e){return{baseLanes:e,cachePool:Za()}}function as(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=fc),e}function is(e,t,n){var r,a=t.pendingProps,i=!1,s=0!==(128&t.flags);if((r=s)||(r=(null===e||null!==e.memoizedState)&&0!==(2&Oa.current)),r&&(i=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if($r){if(i?Aa(t):_a(),$r){var u,c=Yr;if(u=c){e:{for(u=c,c=Qr;8!==u.nodeType;){if(!c){c=null;break e}if(null===(u=sp(u.nextSibling))){c=null;break e}}c=u}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Wr?{id:Vr,overflow:qr}:null,retryLane:536870912},(u=Ru(18,null,null,0)).stateNode=c,u.return=t,t.child=u,Xr=t,Yr=null,u=!0):u=!1}u||ea(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return"$!"===c.data?t.lanes=16:t.lanes=536870912,null;Ma(t)}return c=a.children,a=a.fallback,i?(_a(),c=ss({mode:"hidden",children:c},i=t.mode),a=Uu(a,i,n,null),c.return=t,a.return=t,c.sibling=a,t.child=c,(i=t.child).memoizedState=rs(n),i.childLanes=as(e,r,n),t.memoizedState=ns,a):(Aa(t),os(t,c))}if(null!==(u=e.memoizedState)&&null!==(c=u.dehydrated)){if(s)256&t.flags?(Aa(t),t.flags&=-257,t=us(e,t,n)):null!==t.memoizedState?(_a(),t.child=e.child,t.flags|=128,t=null):(_a(),i=a.fallback,c=t.mode,a=ss({mode:"visible",children:a.children},c),(i=Uu(i,c,n,null)).flags|=2,a.return=t,i.return=t,a.sibling=i,t.child=a,wa(t,e.child,null,n),(a=t.child).memoizedState=rs(n),a.childLanes=as(e,r,n),t.memoizedState=ns,t=i);else if(Aa(t),"$!"===c.data){if(r=c.nextSibling&&c.nextSibling.dataset)var l=r.dgst;r=l,(a=Error(o(419))).stack="",a.digest=r,ia({value:a,source:null,stack:null}),t=us(e,t,n)}else if(jo||Ns(e,t,n,!1),r=0!==(n&e.childLanes),jo||r){if(null!==(r=tc)){if(0!==(42&(a=n&-n)))a=1;else switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=64;break;case 268435456:a=134217728;break;default:a=0}if(0!==(a=0!==(a&(r.suspendedLanes|n))?0:a)&&a!==u.retryLane)throw u.retryLane=a,Ir(e,a),_c(r,e,a),qo}"$?"===c.data||jc(),t=us(e,t,n)}else"$?"===c.data?(t.flags|=128,t.child=e.child,t=sl.bind(null,e),c._reactRetry=t,t=null):(e=u.treeContext,Yr=sp(c.nextSibling),Xr=t,$r=!0,Zr=null,Qr=!1,null!==e&&(Pr[Ur++]=Vr,Pr[Ur++]=qr,Pr[Ur++]=Wr,Vr=e.id,qr=e.overflow,Wr=t),(t=os(t,a.children)).flags|=4096);return t}return i?(_a(),i=a.fallback,c=t.mode,l=(u=e.child).sibling,(a=Bu(u,{mode:"hidden",children:a.children})).subtreeFlags=31457280&u.subtreeFlags,null!==l?i=Bu(l,i):(i=Uu(i,c,n,null)).flags|=2,i.return=t,a.return=t,a.sibling=i,t.child=a,a=i,i=t.child,null===(c=e.child.memoizedState)?c=rs(n):(null!==(u=c.cachePool)?(l=Pa._currentValue,u=u.parent!==l?{parent:l,pool:l}:u):u=Za(),c={baseLanes:c.baseLanes|n,cachePool:u}),i.memoizedState=c,i.childLanes=as(e,r,n),t.memoizedState=ns,a):(Aa(t),e=(n=e.child).sibling,(n=Bu(n,{mode:"visible",children:a.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function os(e,t){return(t=ss({mode:"visible",children:t},e.mode)).return=e,e.child=t}function ss(e,t){return Wu(e,t,0,null)}function us(e,t,n){return wa(t,e.child,null,n),(e=os(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function cs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),xs(e.return,t,n)}function ls(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function ps(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(Go(e,t,r.children,n),0!==(2&(r=Oa.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&cs(e,n,t);else if(19===e.tag)cs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(X(Oa,r),a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===Ra(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),ls(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===Ra(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}ls(t,!0,n,null,i);break;case"together":ls(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),pc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Ns(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Bu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Bu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function ds(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ss(e))}function fs(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)jo=!0;else{if(!ds(e,n)&&0===(128&t.flags))return jo=!1,function(e,t,n){switch(t.tag){case 3:J(t,t.stateNode.containerInfo),vs(t,Pa,e.memoizedState.cache),aa();break;case 27:case 5:te(t);break;case 4:J(t,t.stateNode.containerInfo);break;case 10:vs(t,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(Aa(t),t.flags|=128,null):0!==(n&t.child.childLanes)?is(e,t,n):(Aa(t),null!==(e=hs(e,t,n))?e.sibling:null);Aa(t);break;case 19:var a=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(Ns(e,t,n,!1),r=0!==(n&t.childLanes)),a){if(r)return ps(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),X(Oa,Oa.current),r)break;return null;case 22:case 23:return t.lanes=0,Yo(e,t,n);case 24:vs(t,Pa,e.memoizedState.cache)}return hs(e,t,n)}(e,t,n);jo=0!==(131072&e.flags)}else jo=!1,$r&&0!==(1048576&t.flags)&&Gr(t,Lr,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,a=r._init;if(r=a(r._payload),t.type=r,"function"!==typeof r){if(void 0!==r&&null!==r){if((a=r.$$typeof)===y){t.tag=11,t=Ho(null,t,r,e,n);break e}if(a===x){t.tag=14,t=Ko(null,t,r,e,n);break e}}throw t=T(r)||r,Error(o(306,t,""))}zu(r)?(e=Mo(r,e),t.tag=1,t=es(null,t,r,e,n)):(t.tag=0,t=Qo(null,t,r,e,n))}return t;case 0:return Qo(e,t,t.type,t.pendingProps,n);case 1:return es(e,t,r=t.type,a=Mo(r,t.pendingProps),n);case 3:e:{if(J(t,t.stateNode.containerInfo),null===e)throw Error(o(387));var i=t.pendingProps;r=(a=t.memoizedState).element,As(e,t),Bs(t,i,null,n);var s=t.memoizedState;if(i=s.cache,vs(t,Pa,i),i!==a.cache&&ws(t,[Pa],n,!0),zs(),i=s.element,a.isDehydrated){if(a={element:i,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=ts(e,t,i,n);break e}if(i!==r){ia(r=Or(Error(o(424)),t)),t=ts(e,t,i,n);break e}for(Yr=sp(t.stateNode.containerInfo.firstChild),Xr=t,$r=!0,Zr=null,Qr=!0,n=Na(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(aa(),i===r){t=hs(e,t,n);break e}Go(e,t,i,n)}t=t.child}return t;case 26:return Zo(e,t),null===e?(n=gp(t.type,null,t.pendingProps,null))?t.memoizedState=n:$r||(n=t.type,e=t.pendingProps,(r=Yl(Z.current).createElement(n))[Le]=t,r[Pe]=e,Hl(r,n,e),Ze(r),t.stateNode=r):t.memoizedState=gp(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return te(t),null===e&&$r&&(r=t.stateNode=cp(t.type,t.pendingProps,Z.current),Xr=t,Qr=!0,Yr=sp(r.firstChild)),r=t.pendingProps.children,null!==e||$r?Go(e,t,r,n):t.child=wa(t,null,r,n),Zo(e,t),t.child;case 5:return null===e&&$r&&((a=r=Yr)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var a=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Ge])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(i=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(i!==a.rel||e.getAttribute("href")!==(null==a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((i=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var i=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===i)return e}if(null===(e=sp(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,Qr))?(t.stateNode=r,Xr=t,Yr=sp(r.firstChild),Qr=!1,a=!0):a=!1),a||ea(t)),te(t),a=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,r=i.children,Ql(a,i)?r=null:null!==s&&Ql(a,s)&&(t.flags|=32),null!==t.memoizedState&&(a=pi(e,t,fi,null,null,n),zp._currentValue=a),Zo(e,t),Go(e,t,r,n),t.child;case 6:return null===e&&$r&&((e=n=Yr)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=sp(e.nextSibling)))return null}return e}(n,t.pendingProps,Qr))?(t.stateNode=n,Xr=t,Yr=null,e=!0):e=!1),e||ea(t)),null;case 13:return is(e,t,n);case 4:return J(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wa(t,null,r,n):Go(e,t,r,n),t.child;case 11:return Ho(e,t,t.type,t.pendingProps,n);case 7:return Go(e,t,t.pendingProps,n),t.child;case 8:case 12:return Go(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,vs(t,t.type,r.value),Go(e,t,r.children,n),t.child;case 9:return a=t.type._context,r=t.pendingProps.children,ks(t),r=r(a=Es(a)),t.flags|=1,Go(e,t,r,n),t.child;case 14:return Ko(e,t,t.type,t.pendingProps,n);case 15:return Xo(e,t,t.type,t.pendingProps,n);case 19:return ps(e,t,n);case 22:return Yo(e,t,n);case 24:return ks(t),r=Es(Pa),null===e?(null===(a=Ya())&&(a=tc,i=Ua(),a.pooledCache=i,i.refCount++,null!==i&&(a.pooledCacheLanes|=n),a=i),t.memoizedState={parent:r,cache:a},Is(t),vs(t,Pa,a)):(0!==(e.lanes&n)&&(As(e,t),Bs(t,null,null,n),zs()),a=e.memoizedState,i=t.memoizedState,a.parent!==r?(a={parent:r,cache:r},t.memoizedState=a,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=a),vs(t,Pa,r)):(r=i.cache,vs(t,Pa,r),r!==a.cache&&ws(t,[Pa],n,!0))),Go(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(o(156,t.tag))}var ms=H(null),gs=null,ys=null;function vs(e,t,n){X(ms,t._currentValue),t._currentValue=n}function bs(e){e._currentValue=ms.current,K(ms)}function xs(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ws(e,t,n,r){var a=e.child;for(null!==a&&(a.return=e);null!==a;){var i=a.dependencies;if(null!==i){var s=a.child;i=i.firstContext;e:for(;null!==i;){var u=i;i=a;for(var c=0;c<t.length;c++)if(u.context===t[c]){i.lanes|=n,null!==(u=i.alternate)&&(u.lanes|=n),xs(i.return,n,e),r||(s=null);break e}i=u.next}}else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=n,null!==(i=s.alternate)&&(i.lanes|=n),xs(s,n,e),s=null}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===e){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}}function Ns(e,t,n,r){e=null;for(var a=t,i=!1;null!==a;){if(!i)if(0!==(524288&a.flags))i=!0;else if(0!==(262144&a.flags))break;if(10===a.tag){var s=a.alternate;if(null===s)throw Error(o(387));if(null!==(s=s.memoizedProps)){var u=a.type;Xn(a.pendingProps.value,s.value)||(null!==e?e.push(u):e=[u])}}else if(a===Q.current){if(null===(s=a.alternate))throw Error(o(387));s.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(null!==e?e.push(zp):e=[zp])}a=a.return}null!==e&&ws(t,e,n,r),t.flags|=262144}function Ss(e){for(e=e.firstContext;null!==e;){if(!Xn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function ks(e){gs=e,ys=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Es(e){return Ts(gs,e)}function Cs(e,t){return null===gs&&ks(e),Ts(e,t)}function Ts(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===ys){if(null===e)throw Error(o(308));ys=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ys=ys.next=t;return n}var Ds=!1;function Is(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function As(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Fs(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function _s(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&ec)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,t=Fr(e),Ar(e,null,n),t}return Tr(e,r,t,n),Fr(e)}function Ms(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194176&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Oe(e,n)}}function Os(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Rs=!1;function zs(){if(Rs){if(null!==Ga)throw Ga}}function Bs(e,t,n,r){Rs=!1;var a=e.updateQueue;Ds=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var u=s,c=u.next;u.next=null,null===o?i=c:o.next=c,o=u;var l=e.alternate;null!==l&&((s=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===s?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(null!==i){var p=a.baseState;for(o=0,l=c=u=null,s=i;;){var h=-536870913&s.lane,d=h!==s.lane;if(d?(rc&h)===h:(r&h)===h){0!==h&&h===ja&&(Rs=!0),null!==l&&(l=l.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});e:{var f=e,m=s;h=t;var g=n;switch(m.tag){case 1:if("function"===typeof(f=m.payload)){p=f.call(g,p,h);break e}p=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(g,p,h):f)||void 0===h)break e;p=F({},p,h);break e;case 2:Ds=!0}}null!==(h=s.callback)&&(e.flags|=64,d&&(e.flags|=8192),null===(d=a.callbacks)?a.callbacks=[h]:d.push(h))}else d={lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(c=l=d,u=p):l=l.next=d,o|=h;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(d=s).next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}null===l&&(u=p),a.baseState=u,a.firstBaseUpdate=c,a.lastBaseUpdate=l,null===i&&(a.shared.lanes=0),pc|=o,e.lanes=o,e.memoizedState=p}}function Ls(e,t){if("function"!==typeof e)throw Error(o(191,e));e.call(t)}function Ps(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Ls(n[e],t)}function Us(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var a=r.next;n=a;do{if((n.tag&e)===e){r=void 0;var i=n.create,o=n.inst;r=i(),o.destroy=r}n=n.next}while(n!==a)}}catch(s){rl(t,t.return,s)}}function Ws(e,t,n){try{var r=t.updateQueue,a=null!==r?r.lastEffect:null;if(null!==a){var i=a.next;r=i;do{if((r.tag&e)===e){var o=r.inst,s=o.destroy;if(void 0!==s){o.destroy=void 0,a=t;var u=n;try{s()}catch(c){rl(a,u,c)}}}r=r.next}while(r!==i)}}catch(c){rl(t,t.return,c)}}function Vs(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Ps(t,n)}catch(r){rl(e,e.return,r)}}}function qs(e,t,n){n.props=Mo(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){rl(e,t,r)}}function js(e,t){try{var n=e.ref;if(null!==n){var r=e.stateNode;switch(e.tag){case 26:case 27:case 5:var a=r;break;default:a=r}"function"===typeof n?e.refCleanup=n(a):n.current=a}}catch(i){rl(e,t,i)}}function Gs(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(a){rl(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(i){rl(e,t,i)}else n.current=null}function Hs(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(a){rl(e,e.return,a)}}function Ks(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,i=null,s=null,u=null,c=null,l=null,p=null;for(f in n){var h=n[f];if(n.hasOwnProperty(f)&&null!=h)switch(f){case"checked":case"value":break;case"defaultValue":c=h;default:r.hasOwnProperty(f)||jl(e,t,f,null,r,h)}}for(var d in r){var f=r[d];if(h=n[d],r.hasOwnProperty(d)&&(null!=f||null!=h))switch(d){case"type":i=f;break;case"name":a=f;break;case"checked":l=f;break;case"defaultChecked":p=f;break;case"value":s=f;break;case"defaultValue":u=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(o(137,t));break;default:f!==h&&jl(e,t,d,f,r,h)}}return void gt(e,s,u,c,l,p,i,a);case"select":for(i in f=s=u=d=null,n)if(c=n[i],n.hasOwnProperty(i)&&null!=c)switch(i){case"value":break;case"multiple":f=c;default:r.hasOwnProperty(i)||jl(e,t,i,null,r,c)}for(a in r)if(i=r[a],c=n[a],r.hasOwnProperty(a)&&(null!=i||null!=c))switch(a){case"value":d=i;break;case"defaultValue":u=i;break;case"multiple":s=i;default:i!==c&&jl(e,t,a,i,r,c)}return t=u,n=s,r=f,void(null!=d?bt(e,!!n,d,!1):!!r!==!!n&&(null!=t?bt(e,!!n,t,!0):bt(e,!!n,n?[]:"",!1)));case"textarea":for(u in f=d=null,n)if(a=n[u],n.hasOwnProperty(u)&&null!=a&&!r.hasOwnProperty(u))switch(u){case"value":case"children":break;default:jl(e,t,u,null,r,a)}for(s in r)if(a=r[s],i=n[s],r.hasOwnProperty(s)&&(null!=a||null!=i))switch(s){case"value":d=a;break;case"defaultValue":f=a;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=a)throw Error(o(91));break;default:a!==i&&jl(e,t,s,a,r,i)}return void xt(e,d,f);case"option":for(var m in n)if(d=n[m],n.hasOwnProperty(m)&&null!=d&&!r.hasOwnProperty(m))if("selected"===m)e.selected=!1;else jl(e,t,m,null,r,d);for(c in r)if(d=r[c],f=n[c],r.hasOwnProperty(c)&&d!==f&&(null!=d||null!=f))if("selected"===c)e.selected=d&&"function"!==typeof d&&"symbol"!==typeof d;else jl(e,t,c,d,r,f);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)d=n[g],n.hasOwnProperty(g)&&null!=d&&!r.hasOwnProperty(g)&&jl(e,t,g,null,r,d);for(l in r)if(d=r[l],f=n[l],r.hasOwnProperty(l)&&d!==f&&(null!=d||null!=f))switch(l){case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(o(137,t));break;default:jl(e,t,l,d,r,f)}return;default:if(Ct(t)){for(var y in n)d=n[y],n.hasOwnProperty(y)&&void 0!==d&&!r.hasOwnProperty(y)&&Gl(e,t,y,void 0,r,d);for(p in r)d=r[p],f=n[p],!r.hasOwnProperty(p)||d===f||void 0===d&&void 0===f||Gl(e,t,p,d,r,f);return}}for(var v in n)d=n[v],n.hasOwnProperty(v)&&null!=d&&!r.hasOwnProperty(v)&&jl(e,t,v,null,r,d);for(h in r)d=r[h],f=n[h],!r.hasOwnProperty(h)||d===f||null==d&&null==f||jl(e,t,h,d,r,f)}(r,e.type,n,t),r[Pe]=t}catch(a){rl(e,e.return,a)}}function Xs(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag||4===e.tag}function Ys(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Xs(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&27!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function $s(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=ql));else if(4!==r&&27!==r&&null!==(e=e.child))for($s(e,t,n),e=e.sibling;null!==e;)$s(e,t,n),e=e.sibling}function Zs(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&27!==r&&null!==(e=e.child))for(Zs(e,t,n),e=e.sibling;null!==e;)Zs(e,t,n),e=e.sibling}var Qs=!1,Js=!1,eu=!1,tu="function"===typeof WeakSet?WeakSet:Set,nu=null,ru=!1;function au(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:yu(e,n),4&r&&Us(5,n);break;case 1:if(yu(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(s){rl(n,n.return,s)}else{var a=Mo(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(u){rl(n,n.return,u)}}64&r&&Vs(n),512&r&&js(n,n.return);break;case 3:if(yu(e,n),64&r&&null!==(r=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:e=n.child.stateNode}try{Ps(r,e)}catch(s){rl(n,n.return,s)}}break;case 26:yu(e,n),512&r&&js(n,n.return);break;case 27:case 5:yu(e,n),null===t&&4&r&&Hs(n),512&r&&js(n,n.return);break;case 12:default:yu(e,n);break;case 13:yu(e,n),4&r&&lu(e,n);break;case 22:if(!(a=null!==n.memoizedState||Qs)){t=null!==t&&null!==t.memoizedState||Js;var i=Qs,o=Js;Qs=a,(Js=t)&&!o?bu(e,n,0!==(8772&n.subtreeFlags)):yu(e,n),Qs=i,Js=o}512&r&&("manual"===n.memoizedProps.mode?js(n,n.return):Gs(n,n.return))}}function iu(e){var t=e.alternate;null!==t&&(e.alternate=null,iu(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&He(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var ou=null,su=!1;function uu(e,t,n){for(n=n.child;null!==n;)cu(e,t,n),n=n.sibling}function cu(e,t,n){if(ve&&"function"===typeof ve.onCommitFiberUnmount)try{ve.onCommitFiberUnmount(ye,n)}catch(o){}switch(n.tag){case 26:Js||Gs(n,t),uu(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Js||Gs(n,t);var r=ou,a=su;for(ou=n.stateNode,uu(e,t,n),t=(n=n.stateNode).attributes;t.length;)n.removeAttributeNode(t[0]);He(n),ou=r,su=a;break;case 5:Js||Gs(n,t);case 6:a=ou;var i=su;if(ou=null,uu(e,t,n),su=i,null!==(ou=a))if(su)try{e=ou,r=n.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)}catch(s){rl(n,t,s)}else try{ou.removeChild(n.stateNode)}catch(s){rl(n,t,s)}break;case 18:null!==ou&&(su?(t=ou,n=n.stateNode,8===t.nodeType?ip(t.parentNode,n):1===t.nodeType&&ip(t,n),mh(t)):ip(ou,n.stateNode));break;case 4:r=ou,a=su,ou=n.stateNode.containerInfo,su=!0,uu(e,t,n),ou=r,su=a;break;case 0:case 11:case 14:case 15:Js||Ws(2,n,t),Js||Ws(4,n,t),uu(e,t,n);break;case 1:Js||(Gs(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&qs(n,t,r)),uu(e,t,n);break;case 21:uu(e,t,n);break;case 22:Js||Gs(n,t),Js=(r=Js)||null!==n.memoizedState,uu(e,t,n),Js=r;break;default:uu(e,t,n)}}function lu(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{mh(e)}catch(n){rl(t,t.return,n)}}function pu(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new tu),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new tu),t;default:throw Error(o(435,e.tag))}}(e);t.forEach((function(t){var r=ul.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}function hu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r],i=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 27:case 5:ou=u.stateNode,su=!1;break e;case 3:case 4:ou=u.stateNode.containerInfo,su=!0;break e}u=u.return}if(null===ou)throw Error(o(160));cu(i,s,a),ou=null,su=!1,null!==(i=a.alternate)&&(i.return=null),a.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)fu(t,e),t=t.sibling}var du=null;function fu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:hu(t,e),mu(e),4&r&&(Ws(3,e,e.return),Us(3,e),Ws(5,e,e.return));break;case 1:hu(t,e),mu(e),512&r&&(Js||null===n||Gs(n,n.return)),64&r&&Qs&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var a=du;if(hu(t,e),mu(e),512&r&&(Js||null===n||Gs(n,n.return)),4&r){var i=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,a=a.ownerDocument||a;t:switch(r){case"title":(!(i=a.getElementsByTagName("title")[0])||i[Ge]||i[Le]||"http://www.w3.org/2000/svg"===i.namespaceURI||i.hasAttribute("itemprop"))&&(i=a.createElement(r),a.head.insertBefore(i,a.querySelector("head > title"))),Hl(i,r,n),i[Le]=e,Ze(i),r=i;break e;case"link":var s=Tp("link","href",a).get(r+(n.href||""));if(s)for(var u=0;u<s.length;u++)if((i=s[u]).getAttribute("href")===(null==n.href?null:n.href)&&i.getAttribute("rel")===(null==n.rel?null:n.rel)&&i.getAttribute("title")===(null==n.title?null:n.title)&&i.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){s.splice(u,1);break t}Hl(i=a.createElement(r),r,n),a.head.appendChild(i);break;case"meta":if(s=Tp("meta","content",a).get(r+(n.content||"")))for(u=0;u<s.length;u++)if((i=s[u]).getAttribute("content")===(null==n.content?null:""+n.content)&&i.getAttribute("name")===(null==n.name?null:n.name)&&i.getAttribute("property")===(null==n.property?null:n.property)&&i.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&i.getAttribute("charset")===(null==n.charSet?null:n.charSet)){s.splice(u,1);break t}Hl(i=a.createElement(r),r,n),a.head.appendChild(i);break;default:throw Error(o(468,r))}i[Le]=e,Ze(i),r=i}e.stateNode=r}else Dp(a,e.type,e.stateNode);else e.stateNode=Np(a,r,e.memoizedProps);else i!==r?(null===i?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):i.count--,null===r?Dp(a,e.type,e.stateNode):Np(a,r,e.memoizedProps)):null===r&&null!==e.stateNode&&Ks(e,e.memoizedProps,n.memoizedProps)}break;case 27:if(4&r&&null===e.alternate){a=e.stateNode,i=e.memoizedProps;try{for(var c=a.firstChild;c;){var l=c.nextSibling,p=c.nodeName;c[Ge]||"HEAD"===p||"BODY"===p||"SCRIPT"===p||"STYLE"===p||"LINK"===p&&"stylesheet"===c.rel.toLowerCase()||a.removeChild(c),c=l}for(var h=e.type,d=a.attributes;d.length;)a.removeAttributeNode(d[0]);Hl(a,h,i),a[Le]=e,a[Pe]=i}catch(m){rl(e,e.return,m)}}case 5:if(hu(t,e),mu(e),512&r&&(Js||null===n||Gs(n,n.return)),32&e.flags){a=e.stateNode;try{Nt(a,"")}catch(m){rl(e,e.return,m)}}4&r&&null!=e.stateNode&&Ks(e,a=e.memoizedProps,null!==n?n.memoizedProps:a),1024&r&&(eu=!0);break;case 6:if(hu(t,e),mu(e),4&r){if(null===e.stateNode)throw Error(o(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(m){rl(e,e.return,m)}}break;case 3:if(Cp=null,a=du,du=hp(t.containerInfo),hu(t,e),du=a,mu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{mh(t.containerInfo)}catch(m){rl(e,e.return,m)}eu&&(eu=!1,gu(e));break;case 4:r=du,du=hp(e.stateNode.containerInfo),hu(t,e),mu(e),du=r;break;case 12:hu(t,e),mu(e);break;case 13:hu(t,e),mu(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(bc=ue()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,pu(e,r)));break;case 22:if(512&r&&(Js||null===n||Gs(n,n.return)),c=null!==e.memoizedState,l=null!==n&&null!==n.memoizedState,Qs=(p=Qs)||c,Js=(h=Js)||l,hu(t,e),Js=h,Qs=p,mu(e),(t=e.stateNode)._current=e,t._visibility&=-3,t._visibility|=2&t._pendingVisibility,8192&r&&(t._visibility=c?-2&t._visibility:1|t._visibility,c&&(t=Qs||Js,null===n||l||t||vu(e)),null===e.memoizedProps||"manual"!==e.memoizedProps.mode))e:for(n=null,t=e;;){if(5===t.tag||26===t.tag||27===t.tag){if(null===n){l=n=t;try{if(a=l.stateNode,c)"function"===typeof(i=a.style).setProperty?i.setProperty("display","none","important"):i.display="none";else{s=l.stateNode;var f=void 0!==(u=l.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null;s.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(m){rl(l,l.return,m)}}}else if(6===t.tag){if(null===n){l=t;try{l.stateNode.nodeValue=c?"":l.memoizedProps}catch(m){rl(l,l.return,m)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,pu(e,n))));break;case 19:hu(t,e),mu(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,pu(e,r)));break;case 21:break;default:hu(t,e),mu(e)}}function mu(e){var t=e.flags;if(2&t){try{if(27!==e.tag){e:{for(var n=e.return;null!==n;){if(Xs(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 27:var a=r.stateNode;Zs(e,Ys(e),a);break;case 5:var i=r.stateNode;32&r.flags&&(Nt(i,""),r.flags&=-33),Zs(e,Ys(e),i);break;case 3:case 4:var s=r.stateNode.containerInfo;$s(e,Ys(e),s);break;default:throw Error(o(161))}}}catch(u){rl(e,e.return,u)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function gu(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;gu(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function yu(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)au(e,t.alternate,t),t=t.sibling}function vu(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Ws(4,t,t.return),vu(t);break;case 1:Gs(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&qs(t,t.return,n),vu(t);break;case 26:case 27:case 5:Gs(t,t.return),vu(t);break;case 22:Gs(t,t.return),null===t.memoizedState&&vu(t);break;default:vu(t)}e=e.sibling}}function bu(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,a=e,i=t,o=i.flags;switch(i.tag){case 0:case 11:case 15:bu(a,i,n),Us(4,i);break;case 1:if(bu(a,i,n),"function"===typeof(a=(r=i).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){rl(r,r.return,c)}if(null!==(a=(r=i).updateQueue)){var s=r.stateNode;try{var u=a.shared.hiddenCallbacks;if(null!==u)for(a.shared.hiddenCallbacks=null,a=0;a<u.length;a++)Ls(u[a],s)}catch(c){rl(r,r.return,c)}}n&&64&o&&Vs(i),js(i,i.return);break;case 26:case 27:case 5:bu(a,i,n),n&&null===r&&4&o&&Hs(i),js(i,i.return);break;case 12:default:bu(a,i,n);break;case 13:bu(a,i,n),n&&4&o&&lu(a,i);break;case 22:null===i.memoizedState&&bu(a,i,n),js(i,i.return)}t=t.sibling}}function xu(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Wa(n))}function wu(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Wa(e))}function Nu(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Su(e,t,n,r),t=t.sibling}function Su(e,t,n,r){var a=t.flags;switch(t.tag){case 0:case 11:case 15:Nu(e,t,n,r),2048&a&&Us(9,t);break;case 3:Nu(e,t,n,r),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Wa(e)));break;case 12:if(2048&a){Nu(e,t,n,r),e=t.stateNode;try{var i=t.memoizedProps,o=i.id,s=i.onPostCommit;"function"===typeof s&&s(o,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(u){rl(t,t.return,u)}}else Nu(e,t,n,r);break;case 23:break;case 22:i=t.stateNode,null!==t.memoizedState?4&i._visibility?Nu(e,t,n,r):Eu(e,t):4&i._visibility?Nu(e,t,n,r):(i._visibility|=4,ku(e,t,n,r,0!==(10256&t.subtreeFlags))),2048&a&&xu(t.alternate,t);break;case 24:Nu(e,t,n,r),2048&a&&wu(t.alternate,t);break;default:Nu(e,t,n,r)}}function ku(e,t,n,r,a){for(a=a&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var i=e,o=t,s=n,u=r,c=o.flags;switch(o.tag){case 0:case 11:case 15:ku(i,o,s,u,a),Us(8,o);break;case 23:break;case 22:var l=o.stateNode;null!==o.memoizedState?4&l._visibility?ku(i,o,s,u,a):Eu(i,o):(l._visibility|=4,ku(i,o,s,u,a)),a&&2048&c&&xu(o.alternate,o);break;case 24:ku(i,o,s,u,a),a&&2048&c&&wu(o.alternate,o);break;default:ku(i,o,s,u,a)}t=t.sibling}}function Eu(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,a=r.flags;switch(r.tag){case 22:Eu(n,r),2048&a&&xu(r.alternate,r);break;case 24:Eu(n,r),2048&a&&wu(r.alternate,r);break;default:Eu(n,r)}t=t.sibling}}var Cu=8192;function Tu(e){if(e.subtreeFlags&Cu)for(e=e.child;null!==e;)Du(e),e=e.sibling}function Du(e){switch(e.tag){case 26:Tu(e),e.flags&Cu&&null!==e.memoizedState&&function(e,t,n){if(null===Ap)throw Error(o(475));var r=Ap;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var a=yp(n.href),i=e.querySelector(vp(a));if(i)return null!==(e=i._p)&&"object"===typeof e&&"function"===typeof e.then&&(r.count++,r=_p.bind(r),e.then(r,r)),t.state.loading|=4,t.instance=i,void Ze(i);i=e.ownerDocument||e,n=bp(n),(a=lp.get(a))&&kp(n,a),Ze(i=i.createElement("link"));var s=i;s._p=new Promise((function(e,t){s.onload=e,s.onerror=t})),Hl(i,"link",n),t.instance=i}null===r.stylesheets&&(r.stylesheets=new Map),r.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(r.count++,t=_p.bind(r),e.addEventListener("load",t),e.addEventListener("error",t))}}(du,e.memoizedState,e.memoizedProps);break;case 5:default:Tu(e);break;case 3:case 4:var t=du;du=hp(e.stateNode.containerInfo),Tu(e),du=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Cu,Cu=16777216,Tu(e),Cu=t):Tu(e))}}function Iu(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Au(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];nu=r,Mu(r,e)}Iu(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Fu(e),e=e.sibling}function Fu(e){switch(e.tag){case 0:case 11:case 15:Au(e),2048&e.flags&&Ws(9,e,e.return);break;case 3:case 12:default:Au(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&4&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-5,_u(e)):Au(e)}}function _u(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];nu=r,Mu(r,e)}Iu(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:Ws(8,t,t.return),_u(t);break;case 22:4&(n=t.stateNode)._visibility&&(n._visibility&=-5,_u(t));break;default:_u(t)}e=e.sibling}}function Mu(e,t){for(;null!==nu;){var n=nu;switch(n.tag){case 0:case 11:case 15:Ws(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Wa(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,nu=r;else e:for(n=e;null!==nu;){var a=(r=nu).sibling,i=r.return;if(iu(r),r===n){nu=null;break e}if(null!==a){a.return=i,nu=a;break e}nu=i}}}function Ou(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ru(e,t,n,r){return new Ou(e,t,n,r)}function zu(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Bu(e,t){var n=e.alternate;return null===n?((n=Ru(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=31457280&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Lu(e,t){e.flags&=31457282;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Pu(e,t,n,r,a,i){var s=0;if(r=e,"function"===typeof e)zu(e)&&(s=1);else if("string"===typeof e)s=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,Y.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case p:return Uu(n.children,a,i,t);case h:s=8,a|=24;break;case d:return(e=Ru(12,n,t,2|a)).elementType=d,e.lanes=i,e;case v:return(e=Ru(13,n,t,a)).elementType=v,e.lanes=i,e;case b:return(e=Ru(19,n,t,a)).elementType=b,e.lanes=i,e;case N:return Wu(n,a,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case f:case g:s=10;break e;case m:s=9;break e;case y:s=11;break e;case x:s=14;break e;case w:s=16,r=null;break e}s=29,n=Error(o(130,null===e?"null":typeof e,"")),r=null}return(t=Ru(s,n,t,a)).elementType=e,t.type=r,t.lanes=i,t}function Uu(e,t,n,r){return(e=Ru(7,e,r,t)).lanes=n,e}function Wu(e,t,n,r){(e=Ru(22,e,r,t)).elementType=N,e.lanes=n;var a={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var e=a._current;if(null===e)throw Error(o(456));if(0===(2&a._pendingVisibility)){var t=Ir(e,2);null!==t&&(a._pendingVisibility|=2,_c(t,e,2))}},attach:function(){var e=a._current;if(null===e)throw Error(o(456));if(0!==(2&a._pendingVisibility)){var t=Ir(e,2);null!==t&&(a._pendingVisibility&=-3,_c(t,e,2))}}};return e.stateNode=a,e}function Vu(e,t,n){return(e=Ru(6,e,null,t)).lanes=n,e}function qu(e,t,n){return(t=Ru(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ju(e){e.flags|=4}function Gu(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!Ip(t)){if(null!==(t=Da.current)&&((4194176&rc)===rc?null!==Ia:(62914560&rc)!==rc&&0===(536870912&rc)||t!==Ia))throw ha=ua,sa;e.flags|=8192}}function Hu(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ae():536870912,e.lanes|=t,mc|=t)}function Ku(e,t){if(!$r)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Xu(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=31457280&a.subtreeFlags,r|=31457280&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Yu(e,t,n){var r=t.pendingProps;switch(Kr(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return Xu(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),bs(Pa),ee(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ra(t)?ju(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==Zr&&(Oc(Zr),Zr=null))),Xu(t),null;case 26:return n=t.memoizedState,null===e?(ju(t),null!==n?(Xu(t),Gu(t,n)):(Xu(t),t.flags&=-16777217)):n?n!==e.memoizedState?(ju(t),Xu(t),Gu(t,n)):(Xu(t),t.flags&=-16777217):(e.memoizedProps!==r&&ju(t),Xu(t),t.flags&=-16777217),null;case 27:ne(t),n=Z.current;var a=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==r&&ju(t);else{if(!r){if(null===t.stateNode)throw Error(o(166));return Xu(t),null}e=Y.current,ra(t)?ta(t):(e=cp(a,r,n),t.stateNode=e,ju(t))}return Xu(t),null;case 5:if(ne(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&ju(t);else{if(!r){if(null===t.stateNode)throw Error(o(166));return Xu(t),null}if(e=Y.current,ra(t))ta(t);else{switch(a=Yl(Z.current),e){case 1:e=a.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=a.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=a.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof r.is?a.createElement("select",{is:r.is}):a.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e="string"===typeof r.is?a.createElement(n,{is:r.is}):a.createElement(n)}}e[Le]=t,e[Pe]=r;e:for(a=t.child;null!==a;){if(5===a.tag||6===a.tag)e.appendChild(a.stateNode);else if(4!==a.tag&&27!==a.tag&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;null===a.sibling;){if(null===a.return||a.return===t)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}t.stateNode=e;e:switch(Hl(e,n,r),n){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&ju(t)}}return Xu(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&ju(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(e=Z.current,ra(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(a=Xr))switch(a.tag){case 27:case 5:r=a.memoizedProps}e[Le]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||Vl(e.nodeValue,n)))||ea(t)}else(e=Yl(e).createTextNode(r))[Le]=t,t.stateNode=e}return Xu(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(a=ra(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(o(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(o(317));a[Le]=t}else aa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Xu(t),a=!1}else null!==Zr&&(Oc(Zr),Zr=null),a=!0;if(!a)return 256&t.flags?(Ma(t),t):(Ma(t),null)}if(Ma(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==r,e=null!==e&&null!==e.memoizedState,n){a=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(a=r.alternate.memoizedState.cachePool.pool);var i=null;null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(i=r.memoizedState.cachePool.pool),i!==a&&(r.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),Hu(t,t.updateQueue),Xu(t),null;case 4:return ee(),null===e&&_l(t.stateNode.containerInfo),Xu(t),null;case 10:return bs(t.type),Xu(t),null;case 19:if(K(Oa),null===(a=t.memoizedState))return Xu(t),null;if(r=0!==(128&t.flags),null===(i=a.rendering))if(r)Ku(a,!1);else{if(0!==lc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(i=Ra(e))){for(t.flags|=128,Ku(a,!1),e=i.updateQueue,t.updateQueue=e,Hu(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Lu(n,e),n=n.sibling;return X(Oa,1&Oa.current|2),t.child}e=e.sibling}null!==a.tail&&ue()>xc&&(t.flags|=128,r=!0,Ku(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=Ra(i))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,Hu(t,e),Ku(a,!0),null===a.tail&&"hidden"===a.tailMode&&!i.alternate&&!$r)return Xu(t),null}else 2*ue()-a.renderingStartTime>xc&&536870912!==n&&(t.flags|=128,r=!0,Ku(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(null!==(e=a.last)?e.sibling=i:t.child=i,a.last=i)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=ue(),t.sibling=null,e=Oa.current,X(Oa,r?1&e|2:1&e),t):(Xu(t),null);case 22:case 23:return Ma(t),Ta(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(Xu(t),6&t.subtreeFlags&&(t.flags|=8192)):Xu(t),null!==(n=t.updateQueue)&&Hu(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&K(Xa),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),bs(Pa),Xu(t),null;case 25:return null}throw Error(o(156,t.tag))}function $u(e,t){switch(Kr(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return bs(Pa),ee(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return ne(t),null;case 13:if(Ma(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));aa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return K(Oa),null;case 4:return ee(),null;case 10:return bs(t.type),null;case 22:case 23:return Ma(t),Ta(),null!==e&&K(Xa),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return bs(Pa),null;default:return null}}function Zu(e,t){switch(Kr(t),t.tag){case 3:bs(Pa),ee();break;case 26:case 27:case 5:ne(t);break;case 4:ee();break;case 13:Ma(t);break;case 19:K(Oa);break;case 10:bs(t.type);break;case 22:case 23:Ma(t),Ta(),null!==e&&K(Xa);break;case 24:bs(Pa)}}var Qu={getCacheForType:function(e){var t=Es(Pa),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},Ju="function"===typeof WeakMap?WeakMap:Map,ec=0,tc=null,nc=null,rc=0,ac=0,ic=null,oc=!1,sc=!1,uc=!1,cc=0,lc=0,pc=0,hc=0,dc=0,fc=0,mc=0,gc=null,yc=null,vc=!1,bc=0,xc=1/0,wc=null,Nc=null,Sc=!1,kc=null,Ec=0,Cc=0,Tc=null,Dc=0,Ic=null;function Ac(){if(0!==(2&ec)&&0!==rc)return rc&-rc;if(null!==A.T){return 0!==ja?ja:wl()}return ze()}function Fc(){0===fc&&(fc=0===(536870912&rc)||$r?Ie():536870912);var e=Da.current;return null!==e&&(e.flags|=32),fc}function _c(e,t,n){(e===tc&&2===ac||null!==e.cancelPendingCommit)&&(Uc(e,0),Bc(e,rc,fc,!1)),_e(e,n),0!==(2&ec)&&e===tc||(e===tc&&(0===(2&ec)&&(hc|=n),4===lc&&Bc(e,rc,fc,!1)),ml(e))}function Mc(e,t,n){if(0!==(6&ec))throw Error(o(327));for(var r=!n&&0===(60&t)&&0===(t&e.expiredLanes)||Te(e,t),a=r?function(e,t){var n=ec;ec|=2;var r=Vc(),a=qc();tc!==e||rc!==t?(wc=null,xc=ue()+500,Uc(e,t)):sc=Te(e,t);e:for(;;)try{if(0!==ac&&null!==nc){t=nc;var i=ic;t:switch(ac){case 1:ac=0,ic=null,$c(e,t,i,1);break;case 2:if(ca(i)){ac=0,ic=null,Yc(t);break}t=function(){2===ac&&tc===e&&(ac=7),ml(e)},i.then(t,t);break e;case 3:ac=7;break e;case 4:ac=5;break e;case 7:ca(i)?(ac=0,ic=null,Yc(t)):(ac=0,ic=null,$c(e,t,i,7));break;case 5:var s=null;switch(nc.tag){case 26:s=nc.memoizedState;case 5:case 27:var u=nc;if(!s||Ip(s)){ac=0,ic=null;var c=u.sibling;if(null!==c)nc=c;else{var l=u.return;null!==l?(nc=l,Zc(l)):nc=null}break t}}ac=0,ic=null,$c(e,t,i,5);break;case 6:ac=0,ic=null,$c(e,t,i,6);break;case 8:Pc(),lc=6;break e;default:throw Error(o(462))}}Kc();break}catch(p){Wc(e,p)}return ys=gs=null,A.H=r,A.A=a,ec=n,null!==nc?0:(tc=null,rc=0,Cr(),lc)}(e,t):Gc(e,t,!0),i=r;;){if(0===a){sc&&!r&&Bc(e,t,0,!1);break}if(6===a)Bc(e,t,0,!oc);else{if(n=e.current.alternate,i&&!zc(n)){a=Gc(e,t,!1),i=!1;continue}if(2===a){if(i=t,e.errorRecoveryDisabledLanes&i)var s=0;else s=0!==(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var u=e;a=gc;var c=u.current.memoizedState.isDehydrated;if(c&&(Uc(u,s).flags|=256),2!==(s=Gc(u,s,!1))){if(uc&&!c){u.errorRecoveryDisabledLanes|=i,hc|=i,a=4;break e}i=yc,yc=a,null!==i&&Oc(i)}a=s}if(i=!1,2!==a)continue}}if(1===a){Uc(e,0),Bc(e,t,0,!0);break}e:{switch(r=e,a){case 0:case 1:throw Error(o(345));case 4:if((4194176&t)===t){Bc(r,t,fc,!oc);break e}break;case 2:yc=null;break;case 3:case 5:break;default:throw Error(o(329))}if(r.finishedWork=n,r.finishedLanes=t,(62914560&t)===t&&10<(i=bc+300-ue())){if(Bc(r,t,fc,!oc),0!==Ce(r,0))break e;r.timeoutHandle=ep(Rc.bind(null,r,n,yc,wc,vc,t,fc,hc,mc,oc,2,-0,0),i)}else Rc(r,n,yc,wc,vc,t,fc,hc,mc,oc,0,-0,0)}}break}ml(e)}function Oc(e){null===yc?yc=e:yc.push.apply(yc,e)}function Rc(e,t,n,r,a,i,s,u,c,l,p,h,d){var f=t.subtreeFlags;if((8192&f||16785408===(16785408&f))&&(Ap={stylesheets:null,count:0,unsuspend:Fp},Du(t),null!==(t=function(){if(null===Ap)throw Error(o(475));var e=Ap;return e.stylesheets&&0===e.count&&Op(e,e.stylesheets),0<e.count?function(t){var n=setTimeout((function(){if(e.stylesheets&&Op(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}}),6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=t(Jc.bind(null,e,n,r,a,s,u,c,1,h,d)),void Bc(e,i,s,!l);Jc(e,n,r,a,s,u,c,p,h,d)}function zc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!Xn(i(),a))return!1}catch(o){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bc(e,t,n,r){t&=~dc,t&=~hc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var a=t;0<a;){var i=31-xe(a),o=1<<i;r[i]=-1,a&=~o}0!==n&&Me(e,n,t)}function Lc(){return 0!==(6&ec)||(gl(0,!1),!1)}function Pc(){if(null!==nc){if(0===ac)var e=nc.return;else ys=gs=null,yi(e=nc),fa=null,ma=0,e=nc;for(;null!==e;)Zu(e.alternate,e),e=e.return;nc=null}}function Uc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,tp(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Pc(),tc=e,nc=n=Bu(e.current,null),rc=t,ac=0,ic=null,oc=!1,sc=Te(e,t),uc=!1,mc=fc=dc=hc=pc=lc=0,yc=gc=null,vc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var a=31-xe(r),i=1<<a;t|=e[a],r&=~i}return cc=t,Cr(),n}function Wc(e,t){Ja=null,A.H=Eo,t===oa?(t=da(),ac=3):t===sa?(t=da(),ac=4):ac=t===qo?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,ic=t,null===nc&&(lc=1,Lo(e,Or(t,e.current)))}function Vc(){var e=A.H;return A.H=Eo,null===e?Eo:e}function qc(){var e=A.A;return A.A=Qu,e}function jc(){lc=4,oc||(4194176&rc)!==rc&&null!==Da.current||(sc=!0),0===(134217727&pc)&&0===(134217727&hc)||null===tc||Bc(tc,rc,fc,!1)}function Gc(e,t,n){var r=ec;ec|=2;var a=Vc(),i=qc();tc===e&&rc===t||(wc=null,Uc(e,t)),t=!1;var o=lc;e:for(;;)try{if(0!==ac&&null!==nc){var s=nc,u=ic;switch(ac){case 8:Pc(),o=6;break e;case 3:case 2:case 6:null===Da.current&&(t=!0);var c=ac;if(ac=0,ic=null,$c(e,s,u,c),n&&sc){o=0;break e}break;default:c=ac,ac=0,ic=null,$c(e,s,u,c)}}Hc(),o=lc;break}catch(l){Wc(e,l)}return t&&e.shellSuspendCounter++,ys=gs=null,ec=r,A.H=a,A.A=i,null===nc&&(tc=null,rc=0,Cr()),o}function Hc(){for(;null!==nc;)Xc(nc)}function Kc(){for(;null!==nc&&!oe();)Xc(nc)}function Xc(e){var t=fs(e.alternate,e,cc);e.memoizedProps=e.pendingProps,null===t?Zc(e):nc=t}function Yc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Jo(n,t,t.pendingProps,t.type,void 0,rc);break;case 11:t=Jo(n,t,t.pendingProps,t.type.render,t.ref,rc);break;case 5:yi(t);default:Zu(n,t),t=fs(n,t=nc=Lu(t,cc),cc)}e.memoizedProps=e.pendingProps,null===t?Zc(e):nc=t}function $c(e,t,n,r){ys=gs=null,yi(t),fa=null,ma=0;var a=t.return;try{if(function(e,t,n,r,a){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&Ns(t,n,a,!0),null!==(n=Da.current)){switch(n.tag){case 13:return null===Ia?jc():null===n.alternate&&0===lc&&(lc=3),n.flags&=-257,n.flags|=65536,n.lanes=a,r===ua?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),al(e,r,a)),!1;case 22:return n.flags|=65536,r===ua?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),al(e,r,a)),!1}throw Error(o(435,n.tag))}return al(e,r,a),jc(),!1}if($r)return null!==(t=Da.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=a,r!==Jr&&ia(Or(e=Error(o(422),{cause:r}),n))):(r!==Jr&&ia(Or(t=Error(o(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,a&=-a,e.lanes|=a,r=Or(r,n),Os(e,a=Uo(e.stateNode,r,a)),4!==lc&&(lc=2)),!1;var i=Error(o(520),{cause:r});if(i=Or(i,n),null===gc?gc=[i]:gc.push(i),4!==lc&&(lc=2),null===t)return!0;r=Or(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=a&-a,n.lanes|=e,Os(n,e=Uo(n.stateNode,r,e)),!1;case 1:if(t=n.type,i=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==i&&"function"===typeof i.componentDidCatch&&(null===Nc||!Nc.has(i))))return n.flags|=65536,a&=-a,n.lanes|=a,Vo(a=Wo(a),e,n,r),Os(n,a),!1}n=n.return}while(null!==n);return!1}(e,a,t,n,rc))return lc=1,Lo(e,Or(n,e.current)),void(nc=null)}catch(i){if(null!==a)throw nc=a,i;return lc=1,Lo(e,Or(n,e.current)),void(nc=null)}32768&t.flags?($r||1===r?e=!0:sc||0!==(536870912&rc)?e=!1:(oc=e=!0,(2===r||3===r||6===r)&&(null!==(r=Da.current)&&13===r.tag&&(r.flags|=16384))),Qc(t,e)):Zc(t)}function Zc(e){var t=e;do{if(0!==(32768&t.flags))return void Qc(t,oc);e=t.return;var n=Yu(t.alternate,t,cc);if(null!==n)return void(nc=n);if(null!==(t=t.sibling))return void(nc=t);nc=t=e}while(null!==t);0===lc&&(lc=5)}function Qc(e,t){do{var n=$u(e.alternate,e);if(null!==n)return n.flags&=32767,void(nc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(nc=e);nc=e=n}while(null!==e);lc=6,nc=null}function Jc(e,t,n,r,a,i,s,u,c,l){var p=A.T,h=V.p;try{V.p=2,A.T=null,function(e,t,n,r,a,i,s,u){do{tl()}while(null!==kc);if(0!==(6&ec))throw Error(o(327));var c=e.finishedWork;if(r=e.finishedLanes,null===c)return null;if(e.finishedWork=null,e.finishedLanes=0,c===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var l=c.lanes|c.childLanes;if(function(e,t,n,r,a,i){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var s=e.entanglements,u=e.expirationTimes,c=e.hiddenUpdates;for(n=o&~n;0<n;){var l=31-xe(n),p=1<<l;s[l]=0,u[l]=-1;var h=c[l];if(null!==h)for(c[l]=null,l=0;l<h.length;l++){var d=h[l];null!==d&&(d.lane&=-536870913)}n&=~p}0!==r&&Me(e,r,0),0!==i&&0===a&&0!==e.tag&&(e.suspendedLanes|=i&~(o&~t))}(e,r,l|=Er,i,s,u),e===tc&&(nc=tc=null,rc=0),0===(10256&c.subtreeFlags)&&0===(10256&c.flags)||Sc||(Sc=!0,Cc=l,Tc=n,function(e,t){ae(e,t)}(he,(function(){return tl(),null}))),n=0!==(15990&c.flags),0!==(15990&c.subtreeFlags)||n?(n=A.T,A.T=null,i=V.p,V.p=2,s=ec,ec|=4,function(e,t){if(e=e.containerInfo,Kl=jp,er(e=Jn(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(g){n=null;break e}var s=0,u=-1,c=-1,l=0,p=0,h=e,d=null;t:for(;;){for(var f;h!==n||0!==a&&3!==h.nodeType||(u=s+a),h!==i||0!==r&&3!==h.nodeType||(c=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(f=h.firstChild);)d=h,h=f;for(;;){if(h===e)break t;if(d===n&&++l===a&&(u=s),d===i&&++p===r&&(c=s),null!==(f=h.nextSibling))break;d=(h=d).parentNode}h=f}n=-1===u||-1===c?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Xl={focusedElem:e,selectionRange:n},jp=!1,nu=t;null!==nu;)if(e=(t=nu).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,nu=e;else for(;null!==nu;){switch(i=(t=nu).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==i){e=void 0,n=t,a=i.memoizedProps,i=i.memoizedState,r=n.stateNode;try{var m=Mo(n.type,a,(n.elementType,n.type));e=r.getSnapshotBeforeUpdate(m,i),r.__reactInternalSnapshotBeforeUpdate=e}catch(y){rl(n,n.return,y)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))op(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":op(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(o(163))}if(null!==(e=t.sibling)){e.return=t.return,nu=e;break}nu=t.return}m=ru,ru=!1}(e,c),fu(c,e),tr(Xl,e.containerInfo),jp=!!Kl,Xl=Kl=null,e.current=c,au(e,c.alternate,c),se(),ec=s,V.p=i,A.T=n):e.current=c,Sc?(Sc=!1,kc=e,Ec=r):el(e,l),l=e.pendingLanes,0===l&&(Nc=null),function(e){if(ve&&"function"===typeof ve.onCommitFiberRoot)try{ve.onCommitFiberRoot(ye,e,void 0,128===(128&e.current.flags))}catch(t){}}(c.stateNode),ml(e),null!==t)for(a=e.onRecoverableError,c=0;c<t.length;c++)l=t[c],a(l.value,{componentStack:l.stack});0!==(3&Ec)&&tl(),l=e.pendingLanes,0!==(4194218&r)&&0!==(42&l)?e===Ic?Dc++:(Dc=0,Ic=e):Dc=0,gl(0,!1)}(e,t,n,r,h,a,i,s)}finally{A.T=p,V.p=h}}function el(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Wa(t)))}function tl(){if(null!==kc){var e=kc,t=Cc;Cc=0;var n=Re(Ec),r=A.T,a=V.p;try{if(V.p=32>n?32:n,A.T=null,null===kc)var i=!1;else{n=Tc,Tc=null;var s=kc,u=Ec;if(kc=null,Ec=0,0!==(6&ec))throw Error(o(331));var c=ec;if(ec|=4,Fu(s.current),Su(s,s.current,u,n),ec=c,gl(0,!1),ve&&"function"===typeof ve.onPostCommitFiberRoot)try{ve.onPostCommitFiberRoot(ye,s)}catch(l){}i=!0}return i}finally{V.p=a,A.T=r,el(e,t)}}return!1}function nl(e,t,n){t=Or(n,t),null!==(e=_s(e,t=Uo(e.stateNode,t,2),2))&&(_e(e,2),ml(e))}function rl(e,t,n){if(3===e.tag)nl(e,e,n);else for(;null!==t;){if(3===t.tag){nl(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Nc||!Nc.has(r))){e=Or(n,e),null!==(r=_s(t,n=Wo(2),2))&&(Vo(n,r,t,e),_e(r,2),ml(r));break}}t=t.return}}function al(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new Ju;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(uc=!0,a.add(n),e=il.bind(null,e,t,n),t.then(e,e))}function il(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,tc===e&&(rc&n)===n&&(4===lc||3===lc&&(62914560&rc)===rc&&300>ue()-bc?0===(2&ec)&&Uc(e,0):dc|=n,mc===rc&&(mc=0)),ml(e)}function ol(e,t){0===t&&(t=Ae()),null!==(e=Ir(e,t))&&(_e(e,t),ml(e))}function sl(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),ol(e,n)}function ul(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(o(314))}null!==r&&r.delete(t),ol(e,n)}var cl=null,ll=null,pl=!1,hl=!1,dl=!1,fl=0;function ml(e){var t;e!==ll&&null===e.next&&(null===ll?cl=ll=e:ll=ll.next=e),hl=!0,pl||(pl=!0,t=yl,rp((function(){0!==(6&ec)?ae(le,t):t()})))}function gl(e,t){if(!dl&&hl){dl=!0;do{for(var n=!1,r=cl;null!==r;){if(!t)if(0!==e){var a=r.pendingLanes;if(0===a)var i=0;else{var o=r.suspendedLanes,s=r.pingedLanes;i=(1<<31-xe(42|e)+1)-1,i=201326677&(i&=a&~(o&~s))?201326677&i|1:i?2|i:0}0!==i&&(n=!0,xl(r,i))}else i=rc,0===(3&(i=Ce(r,r===tc?i:0)))||Te(r,i)||(n=!0,xl(r,i));r=r.next}}while(n);dl=!1}}function yl(){hl=pl=!1;var e=0;0!==fl&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==Jl&&(Jl=e,!0);return Jl=null,!1}()&&(e=fl),fl=0);for(var t=ue(),n=null,r=cl;null!==r;){var a=r.next,i=vl(r,t);0===i?(r.next=null,null===n?cl=a:n.next=a,null===a&&(ll=n)):(n=r,(0!==e||0!==(3&i))&&(hl=!0)),r=a}gl(e,!1)}function vl(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=-62914561&e.pendingLanes;0<i;){var o=31-xe(i),s=1<<o,u=a[o];-1===u?0!==(s&n)&&0===(s&r)||(a[o]=De(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}if(n=rc,n=Ce(e,e===(t=tc)?n:0),r=e.callbackNode,0===n||e===t&&2===ac||null!==e.cancelPendingCommit)return null!==r&&null!==r&&ie(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Te(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&ie(r),Re(n)){case 2:case 8:n=pe;break;case 32:default:n=he;break;case 268435456:n=fe}return r=bl.bind(null,e),n=ae(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&ie(r),e.callbackPriority=2,e.callbackNode=null,2}function bl(e,t){var n=e.callbackNode;if(tl()&&e.callbackNode!==n)return null;var r=rc;return 0===(r=Ce(e,e===tc?r:0))?null:(Mc(e,r,t),vl(e,ue()),null!=e.callbackNode&&e.callbackNode===n?bl.bind(null,e):null)}function xl(e,t){if(tl())return null;Mc(e,t,!0)}function wl(){return 0===fl&&(fl=Ie()),fl}function Nl(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:It(""+e)}function Sl(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var kl=0;kl<wr.length;kl++){var El=wr[kl];Nr(El.toLowerCase(),"on"+(El[0].toUpperCase()+El.slice(1)))}Nr(dr,"onAnimationEnd"),Nr(fr,"onAnimationIteration"),Nr(mr,"onAnimationStart"),Nr("dblclick","onDoubleClick"),Nr("focusin","onFocus"),Nr("focusout","onBlur"),Nr(gr,"onTransitionRun"),Nr(yr,"onTransitionStart"),Nr(vr,"onTransitionCancel"),Nr(br,"onTransitionEnd"),tt("onMouseEnter",["mouseout","mouseover"]),tt("onMouseLeave",["mouseout","mouseover"]),tt("onPointerEnter",["pointerout","pointerover"]),tt("onPointerLeave",["pointerout","pointerover"]),et("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),et("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),et("onBeforeInput",["compositionend","keypress","textInput","paste"]),et("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),et("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),et("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Tl=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Cl));function Dl(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==i&&a.isPropagationStopped())break e;i=s,a.currentTarget=c;try{i(a)}catch(l){Oo(l)}a.currentTarget=null,i=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,c=s.currentTarget,s=s.listener,u!==i&&a.isPropagationStopped())break e;i=s,a.currentTarget=c;try{i(a)}catch(l){Oo(l)}a.currentTarget=null,i=u}}}}function Il(e,t){var n=t[We];void 0===n&&(n=t[We]=new Set);var r=e+"__bubble";n.has(r)||(Ml(t,e,2,!1),n.add(r))}function Al(e,t,n){var r=0;t&&(r|=4),Ml(n,e,r,t)}var Fl="_reactListening"+Math.random().toString(36).slice(2);function _l(e){if(!e[Fl]){e[Fl]=!0,Qe.forEach((function(t){"selectionchange"!==t&&(Tl.has(t)||Al(t,!1,e),Al(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Fl]||(t[Fl]=!0,Al("selectionchange",!1,t))}}function Ml(e,t,n,r){switch(Zp(t)){case 2:var a=Gp;break;case 8:a=Hp;break;default:a=Kp}n=a.bind(null,t,n,e),a=void 0,!Lt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Ol(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===a||8===u.nodeType&&u.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=Ke(s)))return;if(5===(u=o.tag)||6===u||26===u||27===u){r=i=o;continue e}s=s.parentNode}}r=r.return}zt((function(){var r=i,a=Ft(n),o=[];e:{var s=xr.get(e);if(void 0!==s){var u=Qt,c=e;switch(e){case"keypress":if(0===jt(n))break e;case"keydown":case"keyup":u=fn;break;case"focusin":c="focus",u=an;break;case"focusout":c="blur",u=an;break;case"beforeblur":case"afterblur":u=an;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=nn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=rn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=gn;break;case dr:case fr:case mr:u=on;break;case br:u=yn;break;case"scroll":case"scrollend":u=en;break;case"wheel":u=vn;break;case"copy":case"cut":case"paste":u=sn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=mn;break;case"toggle":case"beforetoggle":u=bn}var l=0!==(4&t),p=!l&&("scroll"===e||"scrollend"===e),h=l?null!==s?s+"Capture":null:s;l=[];for(var d,f=r;null!==f;){var m=f;if(d=m.stateNode,5!==(m=m.tag)&&26!==m&&27!==m||null===d||null===h||null!=(m=Bt(f,h))&&l.push(Rl(f,m,d)),p)break;f=f.return}0<l.length&&(s=new u(s,c,null,n,a),o.push({event:s,listeners:l}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===At||!(c=n.relatedTarget||n.fromElement)||!Ke(c)&&!c[Ue])&&(u||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(c=(c=n.relatedTarget||n.toElement)?Ke(c):null)&&(p=B(c),l=c.tag,c!==p||5!==l&&27!==l&&6!==l)&&(c=null)):(u=null,c=r),u!==c)){if(l=nn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(l=mn,m="onPointerLeave",h="onPointerEnter",f="pointer"),p=null==u?s:Ye(u),d=null==c?s:Ye(c),(s=new l(m,f+"leave",u,n,a)).target=p,s.relatedTarget=d,m=null,Ke(a)===r&&((l=new l(h,f+"enter",c,n,a)).target=d,l.relatedTarget=p,m=l),p=m,u&&c)e:{for(h=c,f=0,d=l=u;d;d=Bl(d))f++;for(d=0,m=h;m;m=Bl(m))d++;for(;0<f-d;)l=Bl(l),f--;for(;0<d-f;)h=Bl(h),d--;for(;f--;){if(l===h||null!==h&&l===h.alternate)break e;l=Bl(l),h=Bl(h)}l=null}else l=null;null!==u&&Ll(o,s,u,l,!1),null!==c&&null!==p&&Ll(o,p,c,l,!0)}if("select"===(u=(s=r?Ye(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var g=Bn;else if(Fn(s))if(Ln)g=Kn;else{g=Gn;var y=jn}else!(u=s.nodeName)||"input"!==u.toLowerCase()||"checkbox"!==s.type&&"radio"!==s.type?r&&Ct(r.elementType)&&(g=Bn):g=Hn;switch(g&&(g=g(e,r))?_n(o,g,n,a):(y&&y(e,s,r),"focusout"===e&&r&&"number"===s.type&&null!=r.memoizedProps.value&&vt(s,"number",s.value)),y=r?Ye(r):window,e){case"focusin":(Fn(y)||"true"===y.contentEditable)&&(rr=y,ar=r,ir=null);break;case"focusout":ir=ar=rr=null;break;case"mousedown":or=!0;break;case"contextmenu":case"mouseup":case"dragend":or=!1,sr(o,n,a);break;case"selectionchange":if(nr)break;case"keydown":case"keyup":sr(o,n,a)}var v;if(wn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else In?Tn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(kn&&"ko"!==n.locale&&(In||"onCompositionStart"!==b?"onCompositionEnd"===b&&In&&(v=qt()):(Wt="value"in(Ut=a)?Ut.value:Ut.textContent,In=!0)),0<(y=zl(r,b)).length&&(b=new un(b,e,null,n,a),o.push({event:b,listeners:y}),v?b.data=v:null!==(v=Dn(n))&&(b.data=v))),(v=Sn?function(e,t){switch(e){case"compositionend":return Dn(t);case"keypress":return 32!==t.which?null:(Cn=!0,En);case"textInput":return(e=t.data)===En&&Cn?null:e;default:return null}}(e,n):function(e,t){if(In)return"compositionend"===e||!wn&&Tn(e,t)?(e=qt(),Vt=Wt=Ut=null,In=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return kn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(b=zl(r,"onBeforeInput")).length&&(y=new un("onBeforeInput","beforeinput",null,n,a),o.push({event:y,listeners:b}),y.data=v)),function(e,t,n,r,a){if("submit"===t&&n&&n.stateNode===a){var i=Nl((a[Pe]||null).action),o=r.submitter;o&&null!==(t=(t=o[Pe]||null)?Nl(t.formAction):o.getAttribute("formAction"))&&(i=t,o=null);var s=new Qt("action","action",null,r,a);e.push({event:s,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==fl){var e=o?Sl(a,o):new FormData(a);lo(n,{pending:!0,data:e,method:a.method,action:i},null,e)}}else"function"===typeof i&&(s.preventDefault(),e=o?Sl(a,o):new FormData(a),lo(n,{pending:!0,data:e,method:a.method,action:i},i,e))},currentTarget:a}]})}}(o,e,r,n,a)}Dl(o,t)}))}function Rl(e,t,n){return{instance:e,listener:t,currentTarget:n}}function zl(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5!==(a=a.tag)&&26!==a&&27!==a||null===i||(null!=(a=Bt(e,n))&&r.unshift(Rl(e,a,i)),null!=(a=Bt(e,t))&&r.push(Rl(e,a,i))),e=e.return}return r}function Bl(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Ll(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(s=s.tag,null!==u&&u===r)break;5!==s&&26!==s&&27!==s||null===c||(u=c,a?null!=(c=Bt(n,i))&&o.unshift(Rl(n,c,u)):a||null!=(c=Bt(n,i))&&o.push(Rl(n,c,u))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Pl=/\r\n?/g,Ul=/\u0000|\uFFFD/g;function Wl(e){return("string"===typeof e?e:""+e).replace(Pl,"\n").replace(Ul,"")}function Vl(e,t){return t=Wl(t),Wl(e)===t}function ql(){}function jl(e,t,n,r,a,i){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||Nt(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&Nt(e,""+r);break;case"className":st(e,"class",r);break;case"tabIndex":st(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":st(e,n,r);break;case"style":Et(e,r,i);break;case"data":if("object"!==t){st(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=It(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof i&&("formAction"===n?("input"!==t&&jl(e,t,"name",a.name,a,null),jl(e,t,"formEncType",a.formEncType,a,null),jl(e,t,"formMethod",a.formMethod,a,null),jl(e,t,"formTarget",a.formTarget,a,null)):(jl(e,t,"encType",a.encType,a,null),jl(e,t,"method",a.method,a,null),jl(e,t,"target",a.target,a,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=It(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=ql);break;case"onScroll":null!=r&&Il("scroll",e);break;case"onScrollEnd":null!=r&&Il("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(o(61));if(null!=(n=r.__html)){if(null!=a.children)throw Error(o(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=It(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Il("beforetoggle",e),Il("toggle",e),ot(e,"popover",r);break;case"xlinkActuate":ut(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":ut(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":ut(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":ut(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":ut(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":ut(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":ut(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":ut(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":ut(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":ot(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&ot(e,n=Tt.get(n)||n,r)}}function Gl(e,t,n,r,a,i){switch(n){case"style":Et(e,r,i);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(o(61));if(null!=(n=r.__html)){if(null!=a.children)throw Error(o(60));e.innerHTML=n}}break;case"children":"string"===typeof r?Nt(e,r):("number"===typeof r||"bigint"===typeof r)&&Nt(e,""+r);break;case"onScroll":null!=r&&Il("scroll",e);break;case"onScrollEnd":null!=r&&Il("scrollend",e);break;case"onClick":null!=r&&(e.onclick=ql);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Je.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(a=n.endsWith("Capture"),t=n.slice(2,a?n.length-7:void 0),"function"===typeof(i=null!=(i=e[Pe]||null)?i[n]:null)&&e.removeEventListener(t,i,a),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):ot(e,n,r):("function"!==typeof i&&null!==i&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,a)))}}function Hl(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Il("error",e),Il("load",e);var r,a=!1,i=!1;for(r in n)if(n.hasOwnProperty(r)){var s=n[r];if(null!=s)switch(r){case"src":a=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:jl(e,t,r,s,n,null)}}return i&&jl(e,t,"srcSet",n.srcSet,n,null),void(a&&jl(e,t,"src",n.src,n,null));case"input":Il("invalid",e);var u=r=s=i=null,c=null,l=null;for(a in n)if(n.hasOwnProperty(a)){var p=n[a];if(null!=p)switch(a){case"name":i=p;break;case"type":s=p;break;case"checked":c=p;break;case"defaultChecked":l=p;break;case"value":r=p;break;case"defaultValue":u=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(o(137,t));break;default:jl(e,t,a,p,n,null)}}return yt(e,r,u,c,l,s,i,!1),void pt(e);case"select":for(i in Il("invalid",e),a=s=r=null,n)if(n.hasOwnProperty(i)&&null!=(u=n[i]))switch(i){case"value":r=u;break;case"defaultValue":s=u;break;case"multiple":a=u;default:jl(e,t,i,u,n,null)}return t=r,n=s,e.multiple=!!a,void(null!=t?bt(e,!!a,t,!1):null!=n&&bt(e,!!a,n,!0));case"textarea":for(s in Il("invalid",e),r=i=a=null,n)if(n.hasOwnProperty(s)&&null!=(u=n[s]))switch(s){case"value":a=u;break;case"defaultValue":i=u;break;case"children":r=u;break;case"dangerouslySetInnerHTML":if(null!=u)throw Error(o(91));break;default:jl(e,t,s,u,n,null)}return wt(e,a,i,r),void pt(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(a=n[c]))if("selected"===c)e.selected=a&&"function"!==typeof a&&"symbol"!==typeof a;else jl(e,t,c,a,n,null);return;case"dialog":Il("cancel",e),Il("close",e);break;case"iframe":case"object":Il("load",e);break;case"video":case"audio":for(a=0;a<Cl.length;a++)Il(Cl[a],e);break;case"image":Il("error",e),Il("load",e);break;case"details":Il("toggle",e);break;case"embed":case"source":case"link":Il("error",e),Il("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(l in n)if(n.hasOwnProperty(l)&&null!=(a=n[l]))switch(l){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,t));default:jl(e,t,l,a,n,null)}return;default:if(Ct(t)){for(p in n)n.hasOwnProperty(p)&&(void 0!==(a=n[p])&&Gl(e,t,p,a,n,void 0));return}}for(u in n)n.hasOwnProperty(u)&&(null!=(a=n[u])&&jl(e,t,u,a,n,null))}var Kl=null,Xl=null;function Yl(e){return 9===e.nodeType?e:e.ownerDocument}function $l(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Zl(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function Ql(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Jl=null;var ep="function"===typeof setTimeout?setTimeout:void 0,tp="function"===typeof clearTimeout?clearTimeout:void 0,np="function"===typeof Promise?Promise:void 0,rp="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof np?function(e){return np.resolve(null).then(e).catch(ap)}:ep;function ap(e){setTimeout((function(){throw e}))}function ip(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void mh(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);mh(t)}function op(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":op(n),He(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function sp(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}function up(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function cp(e,t,n){switch(t=Yl(n),e){case"html":if(!(e=t.documentElement))throw Error(o(452));return e;case"head":if(!(e=t.head))throw Error(o(453));return e;case"body":if(!(e=t.body))throw Error(o(454));return e;default:throw Error(o(451))}}var lp=new Map,pp=new Set;function hp(e){return"function"===typeof e.getRootNode?e.getRootNode():e.ownerDocument}var dp=V.d;V.d={f:function(){var e=dp.f(),t=Lc();return e||t},r:function(e){var t=Xe(e);null!==t&&5===t.tag&&"form"===t.type?ho(t):dp.r(e)},D:function(e){dp.D(e),mp("dns-prefetch",e,null)},C:function(e,t){dp.C(e,t),mp("preconnect",e,t)},L:function(e,t,n){dp.L(e,t,n);var r=fp;if(r&&e&&t){var a='link[rel="preload"][as="'+mt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(a+='[imagesrcset="'+mt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(a+='[imagesizes="'+mt(n.imageSizes)+'"]')):a+='[href="'+mt(e)+'"]';var i=a;switch(t){case"style":i=yp(e);break;case"script":i=xp(e)}lp.has(i)||(e=F({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),lp.set(i,e),null!==r.querySelector(a)||"style"===t&&r.querySelector(vp(i))||"script"===t&&r.querySelector(wp(i))||(Hl(t=r.createElement("link"),"link",e),Ze(t),r.head.appendChild(t)))}},m:function(e,t){dp.m(e,t);var n=fp;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+mt(r)+'"][href="'+mt(e)+'"]',i=a;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=xp(e)}if(!lp.has(i)&&(e=F({rel:"modulepreload",href:e},t),lp.set(i,e),null===n.querySelector(a))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(wp(i)))return}Hl(r=n.createElement("link"),"link",e),Ze(r),n.head.appendChild(r)}}},X:function(e,t){dp.X(e,t);var n=fp;if(n&&e){var r=$e(n).hoistableScripts,a=xp(e),i=r.get(a);i||((i=n.querySelector(wp(a)))||(e=F({src:e,async:!0},t),(t=lp.get(a))&&Ep(e,t),Ze(i=n.createElement("script")),Hl(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}},S:function(e,t,n){dp.S(e,t,n);var r=fp;if(r&&e){var a=$e(r).hoistableStyles,i=yp(e);t=t||"default";var o=a.get(i);if(!o){var s={loading:0,preload:null};if(o=r.querySelector(vp(i)))s.loading=5;else{e=F({rel:"stylesheet",href:e,"data-precedence":t},n),(n=lp.get(i))&&kp(e,n);var u=o=r.createElement("link");Ze(u),Hl(u,"link",e),u._p=new Promise((function(e,t){u.onload=e,u.onerror=t})),u.addEventListener("load",(function(){s.loading|=1})),u.addEventListener("error",(function(){s.loading|=2})),s.loading|=4,Sp(o,t,r)}o={type:"stylesheet",instance:o,count:1,state:s},a.set(i,o)}}},M:function(e,t){dp.M(e,t);var n=fp;if(n&&e){var r=$e(n).hoistableScripts,a=xp(e),i=r.get(a);i||((i=n.querySelector(wp(a)))||(e=F({src:e,async:!0,type:"module"},t),(t=lp.get(a))&&Ep(e,t),Ze(i=n.createElement("script")),Hl(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}}};var fp="undefined"===typeof document?null:document;function mp(e,t,n){var r=fp;if(r&&"string"===typeof t&&t){var a=mt(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"===typeof n&&(a+='[crossorigin="'+n+'"]'),pp.has(a)||(pp.add(a),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(a)&&(Hl(t=r.createElement("link"),"link",e),Ze(t),r.head.appendChild(t)))}}function gp(e,t,n,r){var a,i,s,u,c=(c=Z.current)?hp(c):null;if(!c)throw Error(o(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=yp(n.href),(r=(n=$e(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=yp(n.href);var l=$e(c).hoistableStyles,p=l.get(e);if(p||(c=c.ownerDocument||c,p={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},l.set(e,p),(l=c.querySelector(vp(e)))&&!l._p&&(p.instance=l,p.state.loading=5),lp.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},lp.set(e,n),l||(a=c,i=e,s=n,u=p.state,a.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=a.createElement("link"),u.preload=i,i.addEventListener("load",(function(){return u.loading|=1})),i.addEventListener("error",(function(){return u.loading|=2})),Hl(i,"link",s),Ze(i),a.head.appendChild(i))))),t&&null===r)throw Error(o(528,""));return p}if(t&&null!==r)throw Error(o(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=xp(n),(r=(n=$e(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,e))}}function yp(e){return'href="'+mt(e)+'"'}function vp(e){return'link[rel="stylesheet"]['+e+"]"}function bp(e){return F({},e,{"data-precedence":e.precedence,precedence:null})}function xp(e){return'[src="'+mt(e)+'"]'}function wp(e){return"script[async]"+e}function Np(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+mt(n.href)+'"]');if(r)return t.instance=r,Ze(r),r;var a=F({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return Ze(r=(e.ownerDocument||e).createElement("style")),Hl(r,"style",a),Sp(r,n.precedence,e),t.instance=r;case"stylesheet":a=yp(n.href);var i=e.querySelector(vp(a));if(i)return t.state.loading|=4,t.instance=i,Ze(i),i;r=bp(n),(a=lp.get(a))&&kp(r,a),Ze(i=(e.ownerDocument||e).createElement("link"));var s=i;return s._p=new Promise((function(e,t){s.onload=e,s.onerror=t})),Hl(i,"link",r),t.state.loading|=4,Sp(i,n.precedence,e),t.instance=i;case"script":return i=xp(n.src),(a=e.querySelector(wp(i)))?(t.instance=a,Ze(a),a):(r=n,(a=lp.get(i))&&Ep(r=F({},n),a),Ze(a=(e=e.ownerDocument||e).createElement("script")),Hl(a,"link",r),e.head.appendChild(a),t.instance=a);case"void":return null;default:throw Error(o(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Sp(r,n.precedence,e));return t.instance}function Sp(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=r.length?r[r.length-1]:null,i=a,o=0;o<r.length;o++){var s=r[o];if(s.dataset.precedence===t)i=s;else if(i!==a)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function kp(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Ep(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Cp=null;function Tp(e,t,n){if(null===Cp){var r=new Map,a=Cp=new Map;a.set(n,r)}else(r=(a=Cp).get(n))||(r=new Map,a.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),a=0;a<n.length;a++){var i=n[a];if(!(i[Ge]||i[Le]||"link"===e&&"stylesheet"===i.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==i.namespaceURI){var o=i.getAttribute(t)||"";o=e+o;var s=r.get(o);s?s.push(i):r.set(o,[i])}}return r}function Dp(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function Ip(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var Ap=null;function Fp(){}function _p(){if(this.count--,0===this.count)if(this.stylesheets)Op(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Mp=null;function Op(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Mp=new Map,t.forEach(Rp,e),Mp=null,_p.call(e))}function Rp(e,t){if(!(4&t.state.loading)){var n=Mp.get(e);if(n)var r=n.get(null);else{n=new Map,Mp.set(e,n);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<a.length;i++){var o=a[i];"LINK"!==o.nodeName&&"not all"===o.getAttribute("media")||(n.set(o.dataset.precedence,o),r=o)}r&&n.set(null,r)}o=(a=t.instance).getAttribute("data-precedence"),(i=n.get(o)||r)===r&&n.set(null,a),n.set(o,a),this.count++,r=_p.bind(this),a.addEventListener("load",r),a.addEventListener("error",r),i?i.parentNode.insertBefore(a,i.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var zp={$$typeof:g,Provider:null,Consumer:null,_currentValue:q,_currentValue2:q,_threadCount:0};function Bp(e,t,n,r,a,i,o,s){this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Fe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fe(0),this.hiddenUpdates=Fe(null),this.identifierPrefix=r,this.onUncaughtError=a,this.onCaughtError=i,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=s,this.incompleteTransitions=new Map}function Lp(e,t,n,r,a,i,o,s,u,c,l,p){return e=new Bp(e,t,n,o,s,u,c,p),t=1,!0===i&&(t|=24),i=Ru(3,null,null,t),e.current=i,i.stateNode=e,(t=Ua()).refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:r,isDehydrated:n,cache:t},Is(i),e}function Pp(e){return e?e=_r:_r}function Up(e,t,n,r,a,i){a=Pp(a),null===r.context?r.context=a:r.pendingContext=a,(r=Fs(t)).payload={element:n},null!==(i=void 0===i?null:i)&&(r.callback=i),null!==(n=_s(e,r,t))&&(_c(n,0,t),Ms(n,e,t))}function Wp(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Vp(e,t){Wp(e,t),(e=e.alternate)&&Wp(e,t)}function qp(e){if(13===e.tag){var t=Ir(e,67108864);null!==t&&_c(t,0,67108864),Vp(e,67108864)}}var jp=!0;function Gp(e,t,n,r){var a=A.T;A.T=null;var i=V.p;try{V.p=2,Kp(e,t,n,r)}finally{V.p=i,A.T=a}}function Hp(e,t,n,r){var a=A.T;A.T=null;var i=V.p;try{V.p=8,Kp(e,t,n,r)}finally{V.p=i,A.T=a}}function Kp(e,t,n,r){if(jp){var a=Xp(r);if(null===a)Ol(e,t,r,Yp,n),oh(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Jp=sh(Jp,e,t,n,r,a),!0;case"dragenter":return eh=sh(eh,e,t,n,r,a),!0;case"mouseover":return th=sh(th,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return nh.set(i,sh(nh.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,rh.set(i,sh(rh.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(oh(e,r),4&t&&-1<ih.indexOf(e)){for(;null!==a;){var i=Xe(a);if(null!==i)switch(i.tag){case 3:if((i=i.stateNode).current.memoizedState.isDehydrated){var o=Ee(i.pendingLanes);if(0!==o){var s=i;for(s.pendingLanes|=2,s.entangledLanes|=2;o;){var u=1<<31-xe(o);s.entanglements[1]|=u,o&=~u}ml(i),0===(6&ec)&&(xc=ue()+500,gl(0,!1))}}break;case 13:null!==(s=Ir(i,2))&&_c(s,0,2),Lc(),Vp(i,2)}if(null===(i=Xp(r))&&Ol(e,t,r,Yp,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Ol(e,t,r,null,n)}}function Xp(e){return $p(e=Ft(e))}var Yp=null;function $p(e){if(Yp=null,null!==(e=Ke(e))){var t=B(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=L(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Yp=e,null}function Zp(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case le:return 2;case pe:return 8;case he:case de:return 32;case fe:return 268435456;default:return 32}default:return 32}}var Qp=!1,Jp=null,eh=null,th=null,nh=new Map,rh=new Map,ah=[],ih="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function oh(e,t){switch(e){case"focusin":case"focusout":Jp=null;break;case"dragenter":case"dragleave":eh=null;break;case"mouseover":case"mouseout":th=null;break;case"pointerover":case"pointerout":nh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":rh.delete(t.pointerId)}}function sh(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=Xe(t))&&qp(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function uh(e){var t=Ke(e.target);if(null!==t){var n=B(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=L(n)))return e.blockedOn=t,void function(e,t){var n=V.p;try{return V.p=e,t()}finally{V.p=n}}(e.priority,(function(){if(13===n.tag){var e=Ac(),t=Ir(n,e);null!==t&&_c(t,0,e),Vp(n,e)}}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function ch(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xp(e.nativeEvent);if(null!==n)return null!==(t=Xe(n))&&qp(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);At=r,n.target.dispatchEvent(r),At=null,t.shift()}return!0}function lh(e,t,n){ch(e)&&n.delete(t)}function ph(){Qp=!1,null!==Jp&&ch(Jp)&&(Jp=null),null!==eh&&ch(eh)&&(eh=null),null!==th&&ch(th)&&(th=null),nh.forEach(lh),rh.forEach(lh)}function hh(e,t){e.blockedOn===t&&(e.blockedOn=null,Qp||(Qp=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,ph)))}var dh=null;function fh(e){dh!==e&&(dh=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,(function(){dh===e&&(dh=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],a=e[t+2];if("function"!==typeof r){if(null===$p(r||n))continue;break}var i=Xe(n);null!==i&&(e.splice(t,3),t-=3,lo(i,{pending:!0,data:a,method:n.method,action:r},r,a))}})))}function mh(e){function t(t){return hh(t,e)}null!==Jp&&hh(Jp,e),null!==eh&&hh(eh,e),null!==th&&hh(th,e),nh.forEach(t),rh.forEach(t);for(var n=0;n<ah.length;n++){var r=ah[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<ah.length&&null===(n=ah[0]).blockedOn;)uh(n),null===n.blockedOn&&ah.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var a=n[r],i=n[r+1],o=a[Pe]||null;if("function"===typeof i)o||fh(n);else if(o){var s=null;if(i&&i.hasAttribute("formAction")){if(a=i,o=i[Pe]||null)s=o.formAction;else if(null!==$p(a))continue}else s=o.action;"function"===typeof s?n[r+1]=s:(n.splice(r,3),r-=3),fh(n)}}}function gh(e){this._internalRoot=e}function yh(e){this._internalRoot=e}yh.prototype.render=gh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Up(t.current,Ac(),e,t,null,null)},yh.prototype.unmount=gh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;0===e.tag&&tl(),Up(e.current,2,null,e,null,null),Lc(),t[Ue]=null}},yh.prototype.unstable_scheduleHydration=function(e){if(e){var t=ze();e={blockedOn:null,target:e,priority:t};for(var n=0;n<ah.length&&0!==t&&t<ah[n].priority;n++);ah.splice(n,0,e),0===n&&uh(e)}};var vh=a.version;if("19.0.0"!==vh)throw Error(o(527,vh,"19.0.0"));V.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=B(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var i=a.alternate;if(null===i){if(null!==(r=a.return)){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return P(a),e;if(i===r)return P(a),t;i=i.sibling}throw Error(o(188))}if(n.return!==r.return)n=a,r=i;else{for(var s=!1,u=a.child;u;){if(u===n){s=!0,n=a,r=i;break}if(u===r){s=!0,r=a,n=i;break}u=u.sibling}if(!s){for(u=i.child;u;){if(u===n){s=!0,n=i,r=a;break}if(u===r){s=!0,r=i,n=a;break}u=u.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?U(e):null)?null:e.stateNode};var bh={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:A,findFiberByHostInstance:Ke,reconcilerVersion:"19.0.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var xh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xh.isDisabled&&xh.supportsFiber)try{ye=xh.inject(bh),ve=xh}catch(Nh){}}t.createRoot=function(e,t){if(!s(e))throw Error(o(299));var n=!1,r="",a=Ro,i=zo,u=Bo;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(a=t.onUncaughtError),void 0!==t.onCaughtError&&(i=t.onCaughtError),void 0!==t.onRecoverableError&&(u=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Lp(e,1,!1,null,0,n,r,a,i,u,0,null),e[Ue]=t.current,_l(8===e.nodeType?e.parentNode:e),new gh(t)},t.hydrateRoot=function(e,t,n){if(!s(e))throw Error(o(299));var r=!1,a="",i=Ro,u=zo,c=Bo,l=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onUncaughtError&&(i=n.onUncaughtError),void 0!==n.onCaughtError&&(u=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(l=n.formState)),(t=Lp(e,1,!0,t,0,r,a,i,u,c,0,l)).context=Pp(null),n=t.current,(a=Fs(r=Ac())).callback=null,_s(n,a,r),t.current.lanes=r,_e(t,r),ml(t),e[Ue]=t.current,_l(e),new yh(t)},t.version="19.0.0"},672:(e,t,n)=>{"use strict";var r=n(43);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var o={d:{f:i,r:function(){throw Error(a(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},s=Symbol.for("react.portal");var u=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=o,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(a(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:s,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=u.T,n=o.p;try{if(u.T=null,o.p=2,e)return e()}finally{u.T=t,o.p=n,o.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,o.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&o.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),a="string"===typeof t.integrity?t.integrity:void 0,i="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?o.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:a,fetchPriority:i}):"script"===n&&o.d.X(e,{crossOrigin:r,integrity:a,fetchPriority:i,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);o.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&o.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);o.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);o.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else o.d.m(e)},t.requestFormReset=function(e){o.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return u.H.useFormState(e,t,n)},t.useFormStatus=function(){return u.H.useHostTransitionStatus()},t.version="19.0.0"},391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)},799:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element");function r(e,t,r){var a=null;if(void 0!==r&&(a=""+r),void 0!==t.key&&(a=""+t.key),"key"in t)for(var i in r={},t)"key"!==i&&(r[i]=t[i]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:a,ref:void 0!==t?t:null,props:r}}Symbol.for("react.fragment"),t.jsx=r,t.jsxs=r},288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var x=b.prototype=new v;x.constructor=b,m(x,y.prototype),x.isPureReactComponent=!0;var w=Array.isArray,N={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function k(e,t,r,a,i,o){return r=o.ref,{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:o}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function D(){}function I(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u,c,l=!1;if(null===e)l=!0;else switch(s){case"bigint":case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0;break;case h:return I((l=e._init)(e._payload),t,a,i,o)}}if(l)return o=o(e),l=""===i?"."+T(e,0):i,w(o)?(a="",null!=l&&(a=l.replace(C,"$&/")+"/"),I(o,t,a,"",(function(e){return e}))):null!=o&&(E(o)&&(u=o,c=a+(null==o.key||e&&e.key===o.key?"":(""+o.key).replace(C,"$&/")+"/")+l,o=k(u.type,c,void 0,0,0,u.props)),t.push(o)),1;l=0;var p,f=""===i?".":i+":";if(w(e))for(var m=0;m<e.length;m++)l+=I(i=e[m],t,a,s=f+T(i,m),o);else if("function"===typeof(m=null===(p=e)||"object"!==typeof p?null:"function"===typeof(p=d&&p[d]||p["@@iterator"])?p:null))for(e=m.call(e),m=0;!(i=e.next()).done;)l+=I(i=i.value,t,a,s=f+T(i,m++),o);else if("object"===s){if("function"===typeof e.then)return I(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(D,D):(e.status="pending",e.then((function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)}),(function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)}))),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,a,i,o);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return l}function A(e,t,n){if(null==e)return e;var r=[],a=0;return I(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function F(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var _="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function M(){}t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=l,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,t.act=function(){throw Error("act(...) is not supported in production builds of React.")},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=m({},e.props),a=e.key;if(null!=t)for(i in void 0!==t.ref&&void 0,void 0!==t.key&&(a=""+t.key),t)!S.call(t,i)||"key"===i||"__self"===i||"__source"===i||"ref"===i&&void 0===t.ref||(r[i]=t[i]);var i=arguments.length-2;if(1===i)r.children=n;else if(1<i){for(var o=Array(i),s=0;s<i;s++)o[s]=arguments[s+2];r.children=o}return k(e.type,a,void 0,0,0,r)},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:s,_context:e},e},t.createElement=function(e,t,n){var r,a={},i=null;if(null!=t)for(r in void 0!==t.key&&(i=""+t.key),t)S.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(a[r]=t[r]);var o=arguments.length-2;if(1===o)a.children=n;else if(1<o){for(var s=Array(o),u=0;u<o;u++)s[u]=arguments[u+2];a.children=s}if(e&&e.defaultProps)for(r in o=e.defaultProps)void 0===a[r]&&(a[r]=o[r]);return k(e,i,void 0,0,0,a)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:F}},t.memo=function(e,t){return{$$typeof:p,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=N.T,n={};N.T=n;try{var r=e(),a=N.S;null!==a&&a(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(M,_)}catch(i){_(i)}finally{N.T=t}},t.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},t.use=function(e){return N.H.use(e)},t.useActionState=function(e,t,n){return N.H.useActionState(e,t,n)},t.useCallback=function(e,t){return N.H.useCallback(e,t)},t.useContext=function(e){return N.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return N.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return N.H.useEffect(e,t)},t.useId=function(){return N.H.useId()},t.useImperativeHandle=function(e,t,n){return N.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return N.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return N.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return N.H.useMemo(e,t)},t.useOptimistic=function(e,t){return N.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return N.H.useReducer(e,t,n)},t.useRef=function(e){return N.H.useRef(e)},t.useState=function(e){return N.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return N.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return N.H.useTransition()},t.version="19.0.0"},43:(e,t,n)=>{"use strict";e.exports=n(288)},579:(e,t,n)=>{"use strict";e.exports=n(799)},896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,u=e[s],c=s+1,l=e[c];if(0>i(u,n))c<a&&0>i(l,u)?(e[r]=l,e[c]=n,r=c):(e[r]=u,e[s]=n,r=s);else{if(!(c<a&&0>i(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var c=[],l=[],p=1,h=null,d=3,f=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(l);null!==t;){if(null===t.callback)a(l);else{if(!(t.startTime<=e))break;a(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function w(e){if(g=!1,x(e),!m)if(null!==r(c))m=!0,F();else{var t=r(l);null!==t&&_(w,t.startTime-e)}}var N,S=!1,k=-1,E=5,C=-1;function T(){return!(t.unstable_now()-C<E)}function D(){if(S){var e=t.unstable_now();C=e;var n=!0;try{e:{m=!1,g&&(g=!1,v(k),k=-1),f=!0;var i=d;try{t:{for(x(e),h=r(c);null!==h&&!(h.expirationTime>e&&T());){var o=h.callback;if("function"===typeof o){h.callback=null,d=h.priorityLevel;var s=o(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof s){h.callback=s,x(e),n=!0;break t}h===r(c)&&a(c),x(e)}else a(c);h=r(c)}if(null!==h)n=!0;else{var u=r(l);null!==u&&_(w,u.startTime-e),n=!1}}break e}finally{h=null,d=i,f=!1}n=void 0}}finally{n?N():S=!1}}}if("function"===typeof b)N=function(){b(D)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,A=I.port2;I.port1.onmessage=D,N=function(){A.postMessage(null)}}else N=function(){y(D,0)};function F(){S||(S=!0,N())}function _(e,n){k=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,F())},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:p++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,n(l,e),null===r(c)&&e===r(l)&&(g?(v(k),k=-1):g=!0,_(w,i-o))):(e.sortIndex=s,n(c,e),m||f||(m=!0,F())),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},853:(e,t,n)=>{"use strict";e.exports=n(896)},334:(e,t,n)=>{var r=n(359),a=n(66),i=n(16),o=n(538),s=n(907),u=n(262),c=n(430);c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=s,c.tychei=u,e.exports=c},359:function(e,t,n){var r;!function(e,a){function i(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function o(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var n=new i(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.alea=s}(0,e=n.nmd(e),n.amdD)},262:function(e,t,n){var r;!function(e,a){function i(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.tychei=s}(0,e=n.nmd(e),n.amdD)},66:function(e,t,n){var r;!function(e,a){function i(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xor128=s}(0,e=n.nmd(e),n.amdD)},907:function(e,t,n){var r;!function(e,a){function i(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function o(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xor4096=s}(0,e=n.nmd(e),n.amdD)},538:function(e,t,n){var r;!function(e,a){function i(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function o(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xorshift7=s}(0,e=n.nmd(e),n.amdD)},16:function(e,t,n){var r;!function(e,a){function i(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xorwow=s}(0,e=n.nmd(e),n.amdD)},430:function(e,t,n){var r;!function(a,i,o){var s,u=256,c=o.pow(u,6),l=o.pow(2,52),p=2*l,h=255;function d(e,t,n){var r=[],h=y(g((t=1==t?{entropy:!0}:t||{}).entropy?[e,v(i)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(u):(e=new Uint8Array(u),(a.crypto||a.msCrypto).getRandomValues(e)),v(e)}catch(r){var t=a.navigator,n=t&&t.plugins;return[+new Date,a,n,a.screen,v(i)]}}():e,3),r),d=new f(r),b=function(){for(var e=d.g(6),t=c,n=0;e<l;)e=(e+n)*u,t*=u,n=d.g(1);for(;e>=p;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|d.g(4)},b.quick=function(){return d.g(4)/4294967296},b.double=b,y(v(d.S),i),(t.pass||n||function(e,t,n,r){return r&&(r.S&&m(r,d),e.state=function(){return m(d,{})}),n?(o.random=e,t):e})(b,h,"global"in t?t.global:this==o,t.state)}function f(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<u;)o[a]=a++;for(a=0;a<u;a++)o[a]=o[i=h&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=h&a+1],n=n*u+o[h&(o[a]=o[i=h&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(u)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function g(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(g(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function y(e,t){for(var n,r=e+"",a=0;a<r.length;)t[h&a]=h&(n^=19*t[h&a])+r.charCodeAt(a++);return v(t)}function v(e){return String.fromCharCode.apply(0,e)}if(y(o.random(),i),e.exports){e.exports=d;try{s=n(234)}catch(b){}}else void 0===(r=function(){return d}.call(t,n,t,e))||(e.exports=r)}("undefined"!==typeof self?self:this,[],Math)},841:e=>{function t(){}t.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function a(){r.off(e,a),t.apply(n,arguments)}return a._=t,this.on(e,a,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,a=n.length;r<a;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],a=[];if(r&&t)for(var i=0,o=r.length;i<o;i++)r[i].fn!==t&&r[i].fn._!==t&&a.push(r[i]);return a.length?n[e]=a:delete n[e],this}},e.exports=t,e.exports.TinyEmitter=t},817:()=>{},590:()=>{},530:()=>{},108:()=>{},551:()=>{},234:()=>{},422:function(e){e.exports=function(){"use strict";function e(){return!0}function t(){return!1}function n(){}const r="Argument is not a typed-function.";function a(){function i(e){return"object"===typeof e&&null!==e&&e.constructor===Object}const o=[{name:"number",test:function(e){return"number"===typeof e}},{name:"string",test:function(e){return"string"===typeof e}},{name:"boolean",test:function(e){return"boolean"===typeof e}},{name:"Function",test:function(e){return"function"===typeof e}},{name:"Array",test:Array.isArray},{name:"Date",test:function(e){return e instanceof Date}},{name:"RegExp",test:function(e){return e instanceof RegExp}},{name:"Object",test:i},{name:"null",test:function(e){return null===e}},{name:"undefined",test:function(e){return void 0===e}}],s={name:"any",test:e,isAny:!0};let u,c,l=0,p={createCount:0};function h(e){const t=u.get(e);if(t)return t;let n='Unknown type "'+e+'"';const r=e.toLowerCase();let a;for(a of c)if(a.toLowerCase()===r){n+='. Did you mean "'+a+'" ?';break}throw new TypeError(n)}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any";const n=t?h(t).index:c.length,r=[];for(let i=0;i<e.length;++i){if(!e[i]||"string"!==typeof e[i].name||"function"!==typeof e[i].test)throw new TypeError("Object with properties {name: string, test: function} expected");const t=e[i].name;if(u.has(t))throw new TypeError('Duplicate type name "'+t+'"');r.push(t),u.set(t,{name:t,test:e[i].test,isAny:e[i].isAny,index:n+i,conversionsTo:[]})}const a=c.slice(n);c=c.slice(0,n).concat(r).concat(a);for(let i=n+r.length;i<c.length;++i)u.get(c[i]).index=i}function f(){u=new Map,c=[],l=0,d([s],!1)}function m(){let e;for(e of c)u.get(e).conversionsTo=[];l=0}function g(e){const t=c.filter((t=>{const n=u.get(t);return!n.isAny&&n.test(e)}));return t.length?t:["any"]}function y(e){return e&&"function"===typeof e&&"_typedFunctionData"in e}function v(e,t,n){if(!y(e))throw new TypeError(r);const a=n&&n.exact,i=E(Array.isArray(t)?t.join(","):t),o=w(i);if(!a||o in e.signatures){const t=e._typedFunctionData.signatureMap.get(o);if(t)return t}const s=i.length;let u,c;if(a){let t;for(t in u=[],e.signatures)u.push(e._typedFunctionData.signatureMap.get(t))}else u=e._typedFunctionData.signatures;for(let r=0;r<s;++r){const e=i[r],t=[];let n;for(n of u){const a=I(n.params,r);if(a&&(!e.restParam||a.restParam)){if(!a.hasAny){const t=k(a);if(e.types.some((e=>!t.has(e.name))))continue}t.push(n)}}if(u=t,0===u.length)break}for(c of u)if(c.params.length<=s)return c;throw new TypeError("Signature not found (signature: "+(e.name||"unnamed")+"("+w(i,", ")+"))")}function b(e,t,n){return v(e,t,n).implementation}function x(e,t){const n=h(t);if(n.test(e))return e;const r=n.conversionsTo;if(0===r.length)throw new Error("There are no conversions to "+t+" defined.");for(let a=0;a<r.length;a++)if(h(r[a].from).test(e))return r[a].convert(e);throw new Error("Cannot convert "+e+" to "+t)}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return e.map((e=>e.name)).join(t)}function N(e){const t=0===e.indexOf("..."),n=(t?e.length>3?e.slice(3):"any":e).split("|").map((e=>h(e.trim())));let r=!1,a=t?"...":"";return{types:n.map((function(e){return r=e.isAny||r,a+=e.name+"|",{name:e.name,typeIndex:e.index,test:e.test,isAny:e.isAny,conversion:null,conversionIndex:-1}})),name:a.slice(0,-1),hasAny:r,hasConversion:!1,restParam:t}}function S(e){const t=L(e.types.map((e=>e.name)));let n=e.hasAny,r=e.name;const a=t.map((function(e){const t=h(e.from);return n=t.isAny||n,r+="|"+e.from,{name:e.from,typeIndex:t.index,test:t.test,isAny:t.isAny,conversion:e,conversionIndex:e.index}}));return{types:e.types.concat(a),name:r,hasAny:n,hasConversion:a.length>0,restParam:e.restParam}}function k(e){return e.typeSet||(e.typeSet=new Set,e.types.forEach((t=>e.typeSet.add(t.name)))),e.typeSet}function E(e){const t=[];if("string"!==typeof e)throw new TypeError("Signatures must be strings");const n=e.trim();if(""===n)return t;const r=n.split(",");for(let a=0;a<r.length;++a){const e=N(r[a].trim());if(e.restParam&&a!==r.length-1)throw new SyntaxError('Unexpected rest parameter "'+r[a]+'": only allowed for the last parameter');if(0===e.types.length)return null;t.push(e)}return t}function C(e){const t=$(e);return!!t&&t.restParam}function T(t){if(t&&0!==t.types.length){if(1===t.types.length)return h(t.types[0].name).test;if(2===t.types.length){const e=h(t.types[0].name).test,n=h(t.types[1].name).test;return function(t){return e(t)||n(t)}}{const e=t.types.map((function(e){return h(e.name).test}));return function(t){for(let n=0;n<e.length;n++)if(e[n](t))return!0;return!1}}}return e}function D(e){let t,n,r;if(C(e)){t=Y(e).map(T);const n=t.length,r=T($(e)),a=function(e){for(let t=n;t<e.length;t++)if(!r(e[t]))return!1;return!0};return function(e){for(let n=0;n<t.length;n++)if(!t[n](e[n]))return!1;return a(e)&&e.length>=n+1}}return 0===e.length?function(e){return 0===e.length}:1===e.length?(n=T(e[0]),function(e){return n(e[0])&&1===e.length}):2===e.length?(n=T(e[0]),r=T(e[1]),function(e){return n(e[0])&&r(e[1])&&2===e.length}):(t=e.map(T),function(e){for(let n=0;n<t.length;n++)if(!t[n](e[n]))return!1;return e.length===t.length})}function I(e,t){return t<e.length?e[t]:C(e)?$(e):null}function A(e,t){const n=I(e,t);return n?k(n):new Set}function F(e){return null===e.conversion||void 0===e.conversion}function _(e,t){const n=new Set;return e.forEach((e=>{const r=A(e.params,t);let a;for(a of r)n.add(a)})),n.has("any")?["any"]:Array.from(n)}function M(e,t,n){let r,a;const i=e||"unnamed";let o,s=n;for(o=0;o<t.length;o++){const e=[];if(s.forEach((n=>{const r=T(I(n.params,o));(o<n.params.length||C(n.params))&&r(t[o])&&e.push(n)})),0===e.length){if(a=_(s,o),a.length>0){const e=g(t[o]);return r=new TypeError("Unexpected type of argument in function "+i+" (expected: "+a.join(" or ")+", actual: "+e.join(" | ")+", index: "+o+")"),r.data={category:"wrongType",fn:i,index:o,actual:e,expected:a},r}}else s=e}const u=s.map((function(e){return C(e.params)?1/0:e.params.length}));if(t.length<Math.min.apply(null,u))return a=_(s,o),r=new TypeError("Too few arguments in function "+i+" (expected: "+a.join(" or ")+", index: "+t.length+")"),r.data={category:"tooFewArgs",fn:i,index:t.length,expected:a},r;const c=Math.max.apply(null,u);if(t.length>c)return r=new TypeError("Too many arguments in function "+i+" (expected: "+c+", actual: "+t.length+")"),r.data={category:"tooManyArgs",fn:i,index:t.length,expectedLength:c},r;const l=[];for(let p=0;p<t.length;++p)l.push(g(t[p]).join("|"));return r=new TypeError('Arguments of type "'+l.join(", ")+'" do not match any of the defined signatures of function '+i+"."),r.data={category:"mismatch",actual:l},r}function O(e){let t=c.length+1;for(let n=0;n<e.types.length;n++)F(e.types[n])&&(t=Math.min(t,e.types[n].typeIndex));return t}function R(e){let t=l+1;for(let n=0;n<e.types.length;n++)F(e.types[n])||(t=Math.min(t,e.types[n].conversionIndex));return t}function z(e,t){if(e.hasAny){if(!t.hasAny)return 1}else if(t.hasAny)return-1;if(e.restParam){if(!t.restParam)return 1}else if(t.restParam)return-1;if(e.hasConversion){if(!t.hasConversion)return 1}else if(t.hasConversion)return-1;const n=O(e)-O(t);if(n<0)return-1;if(n>0)return 1;const r=R(e)-R(t);return r<0?-1:r>0?1:0}function B(e,t){const n=e.params,r=t.params,a=$(n),i=$(r),o=C(n),s=C(r);if(o&&a.hasAny){if(!s||!i.hasAny)return 1}else if(s&&i.hasAny)return-1;let u,c=0,l=0;for(u of n)u.hasAny&&++c,u.hasConversion&&++l;let p=0,h=0;for(u of r)u.hasAny&&++p,u.hasConversion&&++h;if(c!==p)return c-p;if(o&&a.hasConversion){if(!s||!i.hasConversion)return 1}else if(s&&i.hasConversion)return-1;if(l!==h)return l-h;if(o){if(!s)return 1}else if(s)return-1;const d=(n.length-r.length)*(o?-1:1);if(0!==d)return d;const f=[];let m,g=0;for(let y=0;y<n.length;++y){const e=z(n[y],r[y]);f.push(e),g+=e}if(0!==g)return g;for(m of f)if(0!==m)return m;return 0}function L(e){if(0===e.length)return[];const t=e.map(h);e.length>1&&t.sort(((e,t)=>e.index-t.index));let n=t[0].conversionsTo;if(1===e.length)return n;n=n.concat([]);const r=new Set(e);for(let a=1;a<t.length;++a){let e;for(e of t[a].conversionsTo)r.has(e.from)||(n.push(e),r.add(e.from))}return n}function P(e,t){let n=t;if(e.some((e=>e.hasConversion))){const r=C(e),a=e.map(U);n=function(){const e=[],n=r?arguments.length-1:arguments.length;for(let t=0;t<n;t++)e[t]=a[t](arguments[t]);return r&&(e[n]=arguments[n].map(a[n])),t.apply(this,e)}}let r=n;if(C(e)){const t=e.length-1;r=function(){return n.apply(this,Z(arguments,0,t).concat([Z(arguments,t)]))}}return r}function U(e){let t,n,r,a;const i=[],o=[];switch(e.types.forEach((function(e){e.conversion&&(i.push(h(e.conversion.from).test),o.push(e.conversion.convert))})),o.length){case 0:return function(e){return e};case 1:return t=i[0],r=o[0],function(e){return t(e)?r(e):e};case 2:return t=i[0],n=i[1],r=o[0],a=o[1],function(e){return t(e)?r(e):n(e)?a(e):e};default:return function(e){for(let t=0;t<o.length;t++)if(i[t](e))return o[t](e);return e}}}function W(e){function t(e,n,r){if(n<e.length){const a=e[n];let i=[];if(a.restParam){const e=a.types.filter(F);e.length<a.types.length&&i.push({types:e,name:"..."+e.map((e=>e.name)).join("|"),hasAny:e.some((e=>e.isAny)),hasConversion:!1,restParam:!0}),i.push(a)}else i=a.types.map((function(e){return{types:[e],name:e.name,hasAny:e.isAny,hasConversion:e.conversion,restParam:!1}}));return J(i,(function(a){return t(e,n+1,r.concat([a]))}))}return[r]}return t(e,0,[])}function V(e,t){const n=Math.max(e.length,t.length);for(let s=0;s<n;s++){const n=A(e,s),r=A(t,s);let a,i=!1;for(a of r)if(n.has(a)){i=!0;break}if(!i)return!1}const r=e.length,a=t.length,i=C(e),o=C(t);return i?o?r===a:a>=r:o?r>=a:r===a}function q(e){return e.map((e=>ae(e)?ne(e.referToSelf.callback):re(e)?te(e.referTo.references,e.referTo.callback):e))}function j(e,t,n){const r=[];let a;for(a of e){let e=n[a];if("number"!==typeof e)throw new TypeError('No definition for referenced signature "'+a+'"');if(e=t[e],"function"!==typeof e)return!1;r.push(e)}return r}function G(e,t,n){const r=q(e),a=new Array(r.length).fill(!1);let i=!0;for(;i;){i=!1;let e=!0;for(let o=0;o<r.length;++o){if(a[o])continue;const s=r[o];if(ae(s))r[o]=s.referToSelf.callback(n),r[o].referToSelf=s.referToSelf,a[o]=!0,e=!1;else if(re(s)){const n=j(s.referTo.references,r,t);n?(r[o]=s.referTo.callback.apply(this,n),r[o].referTo=s.referTo,a[o]=!0,e=!1):i=!0}}if(e&&i)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return r}function H(e){const t=/\bthis(\(|\.signatures\b)/;Object.keys(e).forEach((n=>{const r=e[n];if(t.test(r.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")}))}function K(e,r){if(p.createCount++,0===Object.keys(r).length)throw new SyntaxError("No signatures provided");p.warnAgainstDeprecatedThis&&H(r);const a=[],i=[],o={},s=[];let u;for(u in r){if(!Object.prototype.hasOwnProperty.call(r,u))continue;const e=E(u);if(!e)continue;a.forEach((function(t){if(V(t,e))throw new TypeError('Conflicting signatures "'+w(t)+'" and "'+w(e)+'".')})),a.push(e);const t=i.length;i.push(r[u]);const n=e.map(S);let c;for(c of W(n)){const e=w(c);s.push({params:c,name:e,fn:t}),c.every((e=>!e.hasConversion))&&(o[e]=t)}}s.sort(B);const c=G(i,o,ue);let l;for(l in o)Object.prototype.hasOwnProperty.call(o,l)&&(o[l]=c[o[l]]);const h=[],d=new Map;for(l of s)d.has(l.name)||(l.fn=c[l.fn],h.push(l),d.set(l.name,l));const f=h[0]&&h[0].params.length<=2&&!C(h[0].params),m=h[1]&&h[1].params.length<=2&&!C(h[1].params),g=h[2]&&h[2].params.length<=2&&!C(h[2].params),y=h[3]&&h[3].params.length<=2&&!C(h[3].params),v=h[4]&&h[4].params.length<=2&&!C(h[4].params),b=h[5]&&h[5].params.length<=2&&!C(h[5].params),x=f&&m&&g&&y&&v&&b;for(let t=0;t<h.length;++t)h[t].test=D(h[t].params);const N=f?T(h[0].params[0]):t,k=m?T(h[1].params[0]):t,I=g?T(h[2].params[0]):t,A=y?T(h[3].params[0]):t,F=v?T(h[4].params[0]):t,_=b?T(h[5].params[0]):t,M=f?T(h[0].params[1]):t,O=m?T(h[1].params[1]):t,R=g?T(h[2].params[1]):t,z=y?T(h[3].params[1]):t,L=v?T(h[4].params[1]):t,U=b?T(h[5].params[1]):t;for(let t=0;t<h.length;++t)h[t].implementation=P(h[t].params,h[t].fn);const q=f?h[0].implementation:n,j=m?h[1].implementation:n,K=g?h[2].implementation:n,X=y?h[3].implementation:n,Y=v?h[4].implementation:n,$=b?h[5].implementation:n,Z=f?h[0].params.length:-1,Q=m?h[1].params.length:-1,J=g?h[2].params.length:-1,ee=y?h[3].params.length:-1,te=v?h[4].params.length:-1,ne=b?h[5].params.length:-1,re=x?6:0,ae=h.length,ie=h.map((e=>e.test)),oe=h.map((e=>e.implementation)),se=function(){for(let e=re;e<ae;e++)if(ie[e](arguments))return oe[e].apply(this,arguments);return p.onMismatch(e,arguments,h)};function ue(e,t){return arguments.length===Z&&N(e)&&M(t)?q.apply(this,arguments):arguments.length===Q&&k(e)&&O(t)?j.apply(this,arguments):arguments.length===J&&I(e)&&R(t)?K.apply(this,arguments):arguments.length===ee&&A(e)&&z(t)?X.apply(this,arguments):arguments.length===te&&F(e)&&L(t)?Y.apply(this,arguments):arguments.length===ne&&_(e)&&U(t)?$.apply(this,arguments):se.apply(this,arguments)}try{Object.defineProperty(ue,"name",{value:e})}catch(ce){}return ue.signatures=o,ue._typedFunctionData={signatures:h,signatureMap:d},ue}function X(e,t,n){throw M(e,t,n)}function Y(e){return Z(e,0,e.length-1)}function $(e){return e[e.length-1]}function Z(e,t,n){return Array.prototype.slice.call(e,t,n)}function Q(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return e[n]}function J(e,t){return Array.prototype.concat.apply([],e.map(t))}function ee(){const e=Y(arguments).map((e=>w(E(e)))),t=$(arguments);if("function"!==typeof t)throw new TypeError("Callback function expected as last argument");return te(e,t)}function te(e,t){return{referTo:{references:e,callback:t}}}function ne(e){if("function"!==typeof e)throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:e}}}function re(e){return e&&"object"===typeof e.referTo&&Array.isArray(e.referTo.references)&&"function"===typeof e.referTo.callback}function ae(e){return e&&"object"===typeof e.referToSelf&&"function"===typeof e.referToSelf.callback}function ie(e,t){if(!e)return t;if(t&&t!==e){const n=new Error("Function names do not match (expected: "+e+", actual: "+t+")");throw n.data={actual:t,expected:e},n}return e}function oe(e){let t;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(y(e[n])||"string"===typeof e[n].signature)&&(t=ie(t,e[n].name));return t}function se(e,t){let n;for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(n in e&&t[n]!==e[n]){const r=new Error('Signature "'+n+'" is defined twice');throw r.data={signature:n,sourceFunction:t[n],destFunction:e[n]},r}e[n]=t[n]}}f(),d(o);const ue=p;function ce(e){if(!e||"string"!==typeof e.from||"string"!==typeof e.to||"function"!==typeof e.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(e.to===e.from)throw new SyntaxError('Illegal to define conversion from "'+e.from+'" to itself.')}return p=function(e){const t="string"===typeof e;let n=t?e:"";const r={};for(let a=t?1:0;a<arguments.length;++a){const e=arguments[a];let o,s={};if("function"===typeof e?(o=e.name,"string"===typeof e.signature?s[e.signature]=e:y(e)&&(s=e.signatures)):i(e)&&(s=e,t||(o=oe(e))),0===Object.keys(s).length){const t=new TypeError("Argument to 'typed' at index "+a+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw t.data={index:a,argument:e},t}t||(n=ie(n,o)),se(r,s)}return K(n||"",r)},p.create=a,p.createCount=ue.createCount,p.onMismatch=X,p.throwMismatchError=X,p.createError=M,p.clear=f,p.clearConversions=m,p.addTypes=d,p._findType=h,p.referTo=ee,p.referToSelf=ne,p.convert=x,p.findSignature=v,p.find=b,p.isTypedFunction=y,p.warnAgainstDeprecatedThis=!0,p.addType=function(e,t){let n="any";!1!==t&&u.has("Object")&&(n="Object"),p.addTypes([e],n)},p.addConversion=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{override:!1};ce(e);const n=h(e.to),r=n.conversionsTo.find((t=>t.from===e.from));if(r){if(!t||!t.override)throw new Error('There is already a conversion from "'+e.from+'" to "'+n.name+'"');p.removeConversion({from:r.from,to:e.to,convert:r.convert})}n.conversionsTo.push({from:e.from,convert:e.convert,index:l++})},p.addConversions=function(e,t){e.forEach((e=>p.addConversion(e,t)))},p.removeConversion=function(e){ce(e);const t=h(e.to),n=Q(t.conversionsTo,(t=>t.from===e.from));if(!n)throw new Error("Attempt to remove nonexistent conversion from "+e.from+" to "+e.to);if(n.convert!==e.convert)throw new Error("Conversion to remove does not match existing conversion");const r=t.conversionsTo.indexOf(n);t.conversionsTo.splice(r,1)},p.resolve=function(e,t){if(!y(e))throw new TypeError(r);const n=e._typedFunctionData.signatures;for(let r=0;r<n.length;++r)if(n[r].test(t))return n[r];return null},p}return a()}()}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=e,n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".22f7a6e4.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="tfjs-object-detection:";n.l=(r,a,i,o)=>{if(e[r])e[r].push(a);else{var s,u;if(void 0!==i)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var p=c[l];if(p.getAttribute("src")==r||p.getAttribute("data-webpack")==t+i){s=p;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+i),s.src=r),e[r]=[a];var h=(t,n)=>{s.onerror=s.onload=null,clearTimeout(d);var a=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach((e=>e(n))),t)return t(n)},d=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),u&&document.head.appendChild(s)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/simple-tfjs-demo/",(()=>{var e={792:0};n.f.j=(t,r)=>{var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise(((n,r)=>a=e[t]=[n,r]));r.push(a[2]=i);var o=n.p+n.u(t),s=new Error;n.l(o,(r=>{if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,a[1](s)}}),"chunk-"+t,t)}};var t=(t,r)=>{var a,i,o=r[0],s=r[1],u=r[2],c=0;if(o.some((t=>0!==e[t]))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(u)u(n)}for(t&&t(r);c<o.length;c++)i=o[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunktfjs_object_detection=self.webpackChunktfjs_object_detection||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{CompositeArrayBuffer:()=>ui,browserFiles:()=>is,browserHTTPRequest:()=>fs,concatenateArrayBuffers:()=>Ii,copyModel:()=>mo,decodeWeights:()=>xi,decodeWeightsStream:()=>Ei,encodeWeights:()=>bi,fromMemory:()=>vs,fromMemorySync:()=>bs,getLoadHandlers:()=>Ui,getModelArtifactsForJSON:()=>Mi,getModelArtifactsForJSONSync:()=>_i,getModelArtifactsInfoForJSON:()=>Oi,getSaveHandlers:()=>Pi,getWeightSpecs:()=>Ri,http:()=>ds,isHTTPScheme:()=>ps,listModels:()=>ho,loadWeights:()=>us,moveModel:()=>go,registerLoadRouter:()=>Li,registerSaveRouter:()=>Bi,removeModel:()=>fo,weightsLoaderFactory:()=>cs,withSaveHandler:()=>xs,withSaveHandlerSync:()=>ws});var t={};n.r(t),n.d(t,{assertParamsValid:()=>Ds,computeFlatOffset:()=>Ws,computeOutShape:()=>As,getNormalizedAxes:()=>Os,isSliceContinous:()=>Us,maskToAxes:()=>Is,parseSliceParams:()=>Vs,sliceInfo:()=>qs,startForAxis:()=>Ls,startIndicesWithElidedDims:()=>Rs,stopForAxis:()=>Ps,stopIndicesWithElidedDims:()=>zs,stridesForAxis:()=>Bs,stridesWithElidedDims:()=>Fs});var r={};n.r(r),n.d(r,{conv2d:()=>nh,depthwiseConv2d:()=>ih,matMul:()=>oh});var a={};n.r(a),n.d(a,{collectGatherOpShapeInfo:()=>vf,computeOutShape:()=>yf,segOpComputeOptimalWindowSize:()=>gf});var i={};n.r(i),n.d(i,{ERF_A1:()=>Md,ERF_A2:()=>Od,ERF_A3:()=>Rd,ERF_A4:()=>zd,ERF_A5:()=>Bd,ERF_P:()=>_d,PARALLELIZE_THRESHOLD:()=>wd,RowPartitionType:()=>gd,SELU_SCALE:()=>Fd,SELU_SCALEALPHA:()=>Ad,applyActivation:()=>eh,assertAndGetBroadcastShape:()=>Yo,assertAxesAreInnerMostDims:()=>gc,assertParamsConsistent:()=>fd,assignToTypedArray:()=>qd,axesAreInnerMostDims:()=>hc,calculateShapes:()=>Ap,checkEinsumDimSizes:()=>Qd,checkPadOnDimRoundingMode:()=>yu,combineLocations:()=>dc,combineRaggedTensorToTensorShapes:()=>yd,complexWithEvenIndex:()=>Ud,complexWithOddIndex:()=>Wd,computeConv2DInfo:()=>ou,computeConv3DInfo:()=>su,computeDefaultPad:()=>uu,computeDilation2DInfo:()=>ru,computeOptimalWindowSize:()=>Nd,computeOutAndReduceShapes:()=>fc,computeOutShape:()=>md,computePool2DInfo:()=>au,computePool3DInfo:()=>iu,convertConv2DDataFormat:()=>gu,decodeEinsumEquation:()=>$d,eitherStridesOrDilationsAreOne:()=>fu,expandShapeToKeepDim:()=>mc,exponent:()=>Gd,exponents:()=>jd,fromStringArrayToUint8:()=>xf,fromUint8ToStringArray:()=>bf,getAxesPermutation:()=>yc,getBroadcastDims:()=>Ko,getComplexWithIndex:()=>Vd,getEinsumComputePath:()=>Jd,getEinsumPermutation:()=>Zd,getFusedBiasGradient:()=>Jp,getFusedDyActivation:()=>Qp,getImageCenter:()=>Sd,getInnerMostAxes:()=>bc,getPermuted:()=>Ed,getRaggedRank:()=>bd,getReductionAxes:()=>Xo,getReshaped:()=>kd,getReshapedPermuted:()=>Cd,getRowPartitionTypesHelper:()=>vd,getSliceBeginCoords:()=>Td,getSliceSize:()=>Dd,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>rf,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>af,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>of,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>cf,getSparseReshapeInputOutputMismatchErrorMessage:()=>pf,getSparseReshapeInputOutputMultipleErrorMessage:()=>lf,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>sf,getSparseReshapeNegativeOutputDimErrorMessage:()=>uf,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>mf,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>hf,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>df,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>ff,getUndoAxesPermutation:()=>vc,isIdentityPermutation:()=>ef,log:()=>Rr,mergeRealAndImagArrays:()=>Ld,prepareAndValidate:()=>Id,prepareSplitSize:()=>nf,segment_util:()=>a,shouldFuse:()=>th,slice_util:()=>t,splitRealAndImagArrays:()=>Pd,stridesOrDilationsArePositive:()=>mu,tupleValuesAreOne:()=>du,upcastType:()=>Ma,validateDefaultValueShape:()=>xd,validateInput:()=>Ip,validateUpdateShape:()=>Dp,warn:()=>Or});var o={};n.r(o),n.d(o,{mx:()=>sg,XI:()=>pg,Nk:()=>hg,f6:()=>dg,ct:()=>ng,YG:()=>bg,hH:()=>Ng,z3:()=>Sg,sG:()=>Cg,uM:()=>Ig,vS:()=>_g,qB:()=>Rg,GG:()=>zg,lg:()=>Ug,rq:()=>Bg,cu:()=>Hg,WR:()=>qg,GE:()=>Yg,px:()=>$g,jC:()=>Jg,He:()=>ey,hE:()=>ry,BF:()=>oy,Dk:()=>ly,cl:()=>hy,_B:()=>vy,ub:()=>Sy,_f:()=>Ey,Ku:()=>Ay,qy:()=>Fy,Zy:()=>_y,bu:()=>Ry,zv:()=>zy,dH:()=>Hm,HS:()=>Py,yH:()=>Vy,l3:()=>qy,z9:()=>jy,x6:()=>Gy,_m:()=>Xy,eW:()=>Zy,GK:()=>Jy,SP:()=>tv,yr:()=>nv,dl:()=>rv,Dw:()=>sv,xT:()=>lv,_X:()=>my,wz:()=>pv});var s={};n.r(s),n.d(s,{json:()=>LM});var u={};n.r(u),n.d(u,{json:()=>PM});var c={};n.r(c),n.d(c,{json:()=>UM});var l={};n.r(l),n.d(l,{json:()=>WM});var p={};n.r(p),n.d(p,{json:()=>VM});var h={};n.r(h),n.d(h,{json:()=>qM});var d={};n.r(d),n.d(d,{json:()=>jM});var f={};n.r(f),n.d(f,{json:()=>GM});var m={};n.r(m),n.d(m,{json:()=>HM});var g={};n.r(g),n.d(g,{json:()=>KM});var y={};n.r(y),n.d(y,{json:()=>XM});var v={};n.r(v),n.d(v,{json:()=>YM});var b={};n.r(b),n.d(b,{json:()=>$M});var x={};n.r(x),n.d(x,{json:()=>ZM});var w={};n.r(w),n.d(w,{json:()=>QM});var N={};n.r(N),n.d(N,{json:()=>JM});var S={};n.r(S),n.d(S,{json:()=>eO});var k={};n.r(k),n.d(k,{json:()=>tO});var E={};n.r(E),n.d(E,{json:()=>nO});var C={};n.r(C),n.d(C,{OP_SCOPE_SUFFIX:()=>ni,abs:()=>Ho,acos:()=>Gs,acosh:()=>Hs,add:()=>Eo,addN:()=>Ks,all:()=>Xs,any:()=>Ys,argMax:()=>$s,argMin:()=>Zs,asin:()=>Qs,asinh:()=>Js,atan:()=>eu,atan2:()=>tu,atanh:()=>nu,avgPool:()=>bu,avgPool3d:()=>xu,basicLSTMCell:()=>Cu,batchNorm:()=>Du,batchNorm2d:()=>Iu,batchNorm3d:()=>Au,batchNorm4d:()=>Fu,batchToSpaceND:()=>Tu,bincount:()=>_u,bitwiseAnd:()=>Mu,booleanMaskAsync:()=>Wp,broadcastArgs:()=>Ou,broadcastTo:()=>Ru,buffer:()=>wo,cast:()=>No,ceil:()=>zu,clipByValue:()=>Bu,clone:()=>So,complex:()=>ai,concat:()=>wu,concat1d:()=>Lu,concat2d:()=>Pu,concat3d:()=>Uu,concat4d:()=>Wu,conv1d:()=>qu,conv2d:()=>Vu,conv2dTranspose:()=>Gu,conv3d:()=>Hu,conv3dTranspose:()=>Xu,cos:()=>Yu,cosh:()=>$u,cosineWindow:()=>Yp,cumprod:()=>Zu,cumsum:()=>Qu,denseBincount:()=>Ju,depthToSpace:()=>ec,depthwiseConv2d:()=>tc,diag:()=>nc,dilation2d:()=>rc,div:()=>To,divNoNan:()=>oc,dot:()=>sc,dropout:()=>Kp,einsum:()=>uc,elu:()=>cc,enclosingPowerOfTwo:()=>Xp,ensureShape:()=>lc,equal:()=>ac,erf:()=>pc,euclideanNorm:()=>Ec,exp:()=>Cc,expandDims:()=>Tc,expm1:()=>Dc,eye:()=>Ac,fft:()=>hp,fill:()=>Wo,floor:()=>Fc,floorDiv:()=>Co,fused:()=>r,gather:()=>_c,gatherND:()=>Hp,greater:()=>Mc,greaterEqual:()=>Oc,ifft:()=>dp,imag:()=>Rc,image:()=>od,inTopKAsync:()=>$p,irfft:()=>fp,isFinite:()=>zc,isInf:()=>Bc,isNaN:()=>Lc,leakyRelu:()=>Pc,less:()=>Uc,lessEqual:()=>Wc,linalg:()=>sd,linspace:()=>Vc,localResponseNormalization:()=>qc,log:()=>jc,log1p:()=>Gc,logSigmoid:()=>Xc,logSoftmax:()=>Yc,logSumExp:()=>$c,logicalAnd:()=>Zc,logicalNot:()=>Qc,logicalOr:()=>Jc,logicalXor:()=>el,losses:()=>ud,lowerBound:()=>rl,matMul:()=>Nu,max:()=>xc,maxPool:()=>al,maxPool3d:()=>il,maxPoolWithArgmax:()=>ol,maximum:()=>$o,mean:()=>sl,meshgrid:()=>ll,min:()=>wc,minimum:()=>pl,mirrorPad:()=>hl,mod:()=>dl,moments:()=>fl,movingAverage:()=>qp,mul:()=>Do,multiRNNCell:()=>ml,multinomial:()=>gl,neg:()=>Hc,norm:()=>kc,notEqual:()=>yl,oneHot:()=>vl,ones:()=>cl,onesLike:()=>bl,op:()=>ri,outerProduct:()=>xl,pad:()=>wl,pad1d:()=>Nl,pad2d:()=>Sl,pad3d:()=>kl,pad4d:()=>El,pool:()=>Tl,pow:()=>qo,prelu:()=>Dl,print:()=>ko,prod:()=>Il,raggedGather:()=>Al,raggedRange:()=>Fl,raggedTensorToTensor:()=>_l,rand:()=>Ml,randomGamma:()=>Ll,randomNormal:()=>Pl,randomStandardNormal:()=>Ul,randomUniform:()=>Wl,randomUniformInt:()=>Vl,range:()=>ql,real:()=>jl,reciprocal:()=>Gl,relu:()=>Hl,relu6:()=>Kl,reshape:()=>vu,reverse:()=>Xl,reverse1d:()=>Yl,reverse2d:()=>$l,reverse3d:()=>Zl,reverse4d:()=>Ql,rfft:()=>gp,round:()=>Jl,rsqrt:()=>ep,scalar:()=>Mo,scatterND:()=>jp,searchSorted:()=>nl,selu:()=>tp,separableConv2d:()=>np,setdiff1dAsync:()=>rp,sigmoid:()=>Su,sign:()=>ap,signal:()=>id,sin:()=>ip,sinh:()=>op,slice:()=>ku,slice1d:()=>sp,slice2d:()=>up,slice3d:()=>cp,slice4d:()=>lp,softmax:()=>pp,softplus:()=>Kc,spaceToBatchND:()=>Cl,sparse:()=>cd,sparseToDense:()=>Gp,spectral:()=>ad,split:()=>mp,sqrt:()=>Io,square:()=>Ao,squaredDifference:()=>yp,squeeze:()=>vp,stack:()=>bp,step:()=>xp,stridedSlice:()=>wp,string:()=>ld,sub:()=>jo,sum:()=>Nc,tan:()=>Np,tanh:()=>Eu,tensor:()=>oi,tensor1d:()=>Sp,tensor2d:()=>kp,tensor3d:()=>Ns,tensor4d:()=>Ep,tensor5d:()=>Cp,tensor6d:()=>Tp,tensorScatterUpdate:()=>Fp,tile:()=>Ic,topk:()=>_p,transpose:()=>Vp,truncatedNormal:()=>Mp,unique:()=>Op,unsortedSegmentSum:()=>Rp,unstack:()=>zp,upperBound:()=>Bp,variable:()=>Lp,where:()=>ic,whereAsync:()=>Up,zeros:()=>ul,zerosLike:()=>Fo});var T={};n.r(T),n.d(T,{createAbs:()=>hH,createAccessorNode:()=>NJ,createAcos:()=>LZ,createAcosh:()=>rQ,createAcot:()=>iQ,createAcoth:()=>sQ,createAcsc:()=>cQ,createAcsch:()=>pQ,createAdd:()=>uJ,createAddScalar:()=>yH,createAnd:()=>_$,createAndTransform:()=>G4,createApply:()=>fH,createApplyTransform:()=>g4,createArg:()=>nX,createArrayNode:()=>kJ,createAsec:()=>dQ,createAsech:()=>mQ,createAsin:()=>yQ,createAsinh:()=>vQ,createAssignmentNode:()=>FJ,createAtan:()=>bQ,createAtan2:()=>wQ,createAtanh:()=>SQ,createAtomicMass:()=>K3,createAvogadro:()=>X3,createBellNumbers:()=>x2,createBigNumberClass:()=>wq,createBigint:()=>NG,createBignumber:()=>TG,createBin:()=>WY,createBitAnd:()=>XK,createBitAndTransform:()=>K4,createBitNot:()=>$K,createBitOr:()=>QK,createBitOrTransform:()=>X4,createBitXor:()=>tX,createBlockNode:()=>MJ,createBohrMagneton:()=>T3,createBohrRadius:()=>M3,createBoltzmann:()=>Y3,createBoolean:()=>CG,createCatalan:()=>N2,createCbrt:()=>wH,createCeil:()=>DH,createChain:()=>$0,createChainClass:()=>q0,createClassicalElectronRadius:()=>O3,createClone:()=>Vj,createColumn:()=>vX,createColumnTransform:()=>y4,createCombinations:()=>B1,createCombinationsWithRep:()=>U1,createCompare:()=>O$,createCompareNatural:()=>L$,createCompareText:()=>W$,createCompile:()=>h0,createComplex:()=>DG,createComplexClass:()=>Aq,createComposition:()=>k2,createConcat:()=>gX,createConcatTransform:()=>M4,createConditionalNode:()=>RJ,createConductanceQuantum:()=>D3,createConj:()=>aX,createConstantNode:()=>jJ,createCorr:()=>M1,createCos:()=>EQ,createCosh:()=>TQ,createCot:()=>DQ,createCoth:()=>AQ,createCoulomb:()=>E3,createCount:()=>xX,createCreateUnit:()=>zZ,createCross:()=>NX,createCsc:()=>FQ,createCsch:()=>MQ,createCtranspose:()=>mY,createCube:()=>AH,createCumSum:()=>x1,createCumSumTransform:()=>U4,createDeepEqual:()=>oZ,createDenseMatrixClass:()=>Uj,createDerivative:()=>U2,createDet:()=>Z0,createDeuteronMass:()=>U3,createDiag:()=>kX,createDiff:()=>WX,createDiffTransform:()=>R4,createDistance:()=>g1,createDivide:()=>f1,createDivideScalar:()=>JY,createDot:()=>dJ,createDotDivide:()=>f$,createDotMultiply:()=>AK,createDotPow:()=>h$,createE:()=>i3,createEfimovFactor:()=>H3,createEigs:()=>r1,createElectricConstant:()=>S3,createElectronMass:()=>R3,createElementaryCharge:()=>C3,createEqual:()=>q$,createEqualScalar:()=>bG,createEqualText:()=>H$,createErf:()=>CY,createEvaluate:()=>f0,createExp:()=>FH,createExpm:()=>i1,createExpm1:()=>MH,createFactorial:()=>J1,createFalse:()=>J2,createFaraday:()=>$3,createFermiCoupling:()=>z3,createFft:()=>vY,createFibonacciHeapClass:()=>bZ,createFilter:()=>EX,createFilterTransform:()=>N4,createFineStructure:()=>B3,createFirstRadiation:()=>Z3,createFix:()=>BH,createFlatten:()=>DX,createFloor:()=>WH,createForEach:()=>AX,createForEachTransform:()=>S4,createFormat:()=>UY,createFraction:()=>IG,createFractionClass:()=>Xq,createFreqz:()=>H2,createFunctionAssignmentNode:()=>HJ,createFunctionNode:()=>u0,createGamma:()=>Y1,createGasConstant:()=>J3,createGcd:()=>nK,createGetMatrixDataType:()=>MX,createGravitationConstant:()=>b3,createGravity:()=>u4,createHartreeEnergy:()=>L3,createHasNumericValue:()=>uG,createHelp:()=>X0,createHelpClass:()=>W0,createHex:()=>qY,createHypot:()=>lJ,createI:()=>d3,createIdentity:()=>RX,createIfft:()=>xY,createIm:()=>iX,createImmutableDenseMatrixClass:()=>gZ,createIndex:()=>gJ,createIndexClass:()=>yZ,createIndexNode:()=>XJ,createIndexTransform:()=>k4,createInfinity:()=>t3,createIntersect:()=>y1,createInv:()=>Q0,createInverseConductanceQuantum:()=>I3,createInvmod:()=>TK,createIsInteger:()=>Zj,createIsNaN:()=>fG,createIsNegative:()=>aG,createIsNumeric:()=>oG,createIsPositive:()=>lG,createIsPrime:()=>$Y,createIsZero:()=>hG,createKldivergence:()=>t2,createKlitzing:()=>_3,createKron:()=>BX,createLN10:()=>u3,createLN2:()=>s3,createLOG10E:()=>l3,createLOG2E:()=>c3,createLarger:()=>eZ,createLargerEq:()=>rZ,createLcm:()=>aK,createLeafCount:()=>C2,createLeftShift:()=>T$,createLgamma:()=>Z1,createLog:()=>o$,createLog10:()=>cK,createLog1p:()=>u$,createLog2:()=>pK,createLoschmidt:()=>Q3,createLsolve:()=>y$,createLsolveAll:()=>w$,createLup:()=>v0,createLusolve:()=>z0,createLyap:()=>d1,createMad:()=>E1,createMagneticConstant:()=>N3,createMagneticFluxQuantum:()=>A3,createMap:()=>PX,createMapTransform:()=>E4,createMatrix:()=>FG,createMatrixClass:()=>$q,createMatrixFromColumns:()=>BG,createMatrixFromFunction:()=>MG,createMatrixFromRows:()=>RG,createMax:()=>fZ,createMaxTransform:()=>T4,createMean:()=>N1,createMeanTransform:()=>D4,createMedian:()=>k1,createMin:()=>mZ,createMinTransform:()=>I4,createMod:()=>XH,createMode:()=>RY,createMolarMass:()=>o4,createMolarMassC12:()=>s4,createMolarPlanckConstant:()=>e4,createMolarVolume:()=>t4,createMultinomial:()=>r2,createMultiply:()=>fK,createMultiplyScalar:()=>hK,createNaN:()=>n3,createNeutronMass:()=>W3,createNode:()=>vJ,createNorm:()=>hJ,createNot:()=>hX,createNthRoot:()=>gK,createNthRoots:()=>l$,createNuclearMagneton:()=>F3,createNull:()=>e3,createNumber:()=>wG,createNumeric:()=>ZY,createObjectNode:()=>$J,createOct:()=>VY,createOnes:()=>VX,createOperatorNode:()=>JJ,createOr:()=>dX,createOrTransform:()=>H4,createParenthesisNode:()=>t0,createParse:()=>l0,createParser:()=>y0,createParserClass:()=>m0,createPartitionSelect:()=>pZ,createPermutations:()=>i2,createPhi:()=>o3,createPi:()=>r3,createPickRandom:()=>l2,createPinv:()=>e1,createPlanckCharge:()=>h4,createPlanckConstant:()=>x3,createPlanckLength:()=>c4,createPlanckMass:()=>l4,createPlanckTemperature:()=>d4,createPlanckTime:()=>p4,createPolynomialRoot:()=>P0,createPow:()=>e$,createPrint:()=>HY,createPrintTransform:()=>j4,createProd:()=>LY,createProtonMass:()=>P3,createQr:()=>b0,createQuantileSeq:()=>A1,createQuantileSeqTransform:()=>L4,createQuantumOfCirculation:()=>V3,createRandom:()=>d2,createRandomInt:()=>g2,createRange:()=>KX,createRangeClass:()=>Yq,createRangeNode:()=>r0,createRangeTransform:()=>A4,createRationalize:()=>V2,createRe:()=>oX,createReducedPlanckConstant:()=>w3,createRelationalNode:()=>i0,createReplacer:()=>X2,createReshape:()=>YX,createResize:()=>$X,createResolve:()=>z2,createResultSet:()=>PW,createReviver:()=>K2,createRightArithShift:()=>I$,createRightLogShift:()=>F$,createRotate:()=>QX,createRotationMatrix:()=>eY,createRound:()=>r$,createRow:()=>tY,createRowTransform:()=>F4,createRydberg:()=>q3,createSQRT1_2:()=>p3,createSQRT2:()=>h3,createSackurTetrode:()=>n4,createSchur:()=>p1,createSec:()=>OQ,createSech:()=>zQ,createSecondRadiation:()=>r4,createSetCartesian:()=>qQ,createSetDifference:()=>GQ,createSetDistinct:()=>KQ,createSetIntersect:()=>YQ,createSetIsSubset:()=>ZQ,createSetMultiplicity:()=>JQ,createSetPowerset:()=>tJ,createSetSize:()=>rJ,createSetSymDifference:()=>iJ,createSetUnion:()=>sJ,createSign:()=>vK,createSimplify:()=>_2,createSimplifyConstant:()=>M2,createSimplifyCore:()=>R2,createSin:()=>BQ,createSinh:()=>PQ,createSize:()=>rY,createSlu:()=>_0,createSmaller:()=>X$,createSmallerEq:()=>Z$,createSolveODE:()=>EY,createSort:()=>dZ,createSpaClass:()=>xZ,createSparse:()=>OZ,createSparseMatrixClass:()=>xG,createSpeedOfLight:()=>v3,createSplitUnit:()=>PG,createSqrt:()=>bK,createSqrtm:()=>s1,createSquare:()=>wK,createSqueeze:()=>iY,createStd:()=>F1,createStdTransform:()=>z4,createStefanBoltzmann:()=>a4,createStirlingS2:()=>v2,createString:()=>kG,createSubset:()=>sY,createSubsetTransform:()=>_4,createSubtract:()=>SK,createSubtractScalar:()=>bH,createSum:()=>v1,createSumTransform:()=>B4,createSylvester:()=>c1,createSymbolNode:()=>o0,createSymbolicEqual:()=>L2,createTan:()=>UQ,createTanh:()=>WQ,createTau:()=>a3,createThomsonCrossSection:()=>j3,createTo:()=>XY,createTrace:()=>fJ,createTranspose:()=>dY,createTrue:()=>Q2,createTypeOf:()=>gG,createTyped:()=>MW,createUnaryMinus:()=>cH,createUnaryPlus:()=>pH,createUnequal:()=>uZ,createUnitClass:()=>AZ,createUnitFunction:()=>_Z,createUppercaseE:()=>m3,createUppercasePi:()=>f3,createUsolve:()=>b$,createUsolveAll:()=>S$,createVacuumImpedance:()=>k3,createVariance:()=>D1,createVarianceTransform:()=>V4,createVersion:()=>g3,createWeakMixingAngle:()=>G3,createWienDisplacement:()=>i4,createXgcd:()=>EK,createXor:()=>fX,createZeros:()=>yY,createZeta:()=>MY,createZpk2tf:()=>j2});var D=n(43),I=n(391);class A{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class F{refCount(e){return _("refCount")}incRef(e){return _("incRef")}timerAvailable(){return!0}time(e){return _("time")}read(e){return _("read")}readSync(e){return _("readSync")}readToGPU(e,t){return _("readToGPU")}numDataIds(){return _("numDataIds")}disposeData(e,t){return _("disposeData")}write(e,t,n){return _("write")}move(e,t,n,r,a){return _("move")}createTensorFromGPUData(e,t,n){return _("createTensorFromGPUData")}memory(){return _("memory")}floatPrecision(){return _("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return _("dispose")}}function _(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function M(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,z(e,t,n)}function O(e,t,n){return Math.max(e,Math.min(t,n))}function R(e){return e%2===0?e:e+1}function z(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function B(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function L(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";B(W(e,t),(()=>n+" Shapes ".concat(e," and ").concat(t," must match")))}function P(e){B(null!=e,(()=>"The input to the tensor constructor must be a non-null value."))}function U(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function W(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function V(e){return e%1===0}function q(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function j(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function G(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise(((a,i)=>{let o=0;const s=()=>{if(e())return void a();o++;const u=t(o);null!=n&&o>=n?i():null!=r?r(s,u):setTimeout(s,u)};s()}))}function H(e,t){let n=1,r=-1;for(let i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(-1===e[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(i));r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found ".concat(e[i]," at dim ").concat(i));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));const a=e.slice();return a[r]=t/n,a}function K(e,t){const n=t.length;return B((e=null==e?t.map(((e,t)=>t)):[].concat(e)).every((e=>e>=-n&&e<n)),(()=>"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e))),B(e.every((e=>V(e))),(()=>"All values in axis param must be integers but "+"got axis ".concat(e))),e.map((e=>e<0?n+e:e))}function X(e,t){const n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:K(t,e).sort();let o=0;for(let s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(e[s],"' is not 1"));(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function Y(e,t){return $(e,t)}function $(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function Z(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function Q(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function J(e){return"string"===typeof e||e instanceof String}function ee(e){return"number"===typeof e}function te(e){return Array.isArray(e)?te(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":ee(e)?"float32":J(e)?"string":"boolean"===typeof e?"bool":"float32"}function ne(e){return!!(e&&e.constructor&&e.call&&e.apply)}function re(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function ae(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function ie(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=new Array;if(1===t.length){const i=t[0]*(r?2:1);for(let t=0;t<i;t++)a[t]=n[e+t]}else{const i=t[0],o=t.slice(1),s=o.reduce(((e,t)=>e*t))*(r?2:1);for(let t=0;t<i;t++)a[t]=ie(e+t*s,o,n,r)}return a}function oe(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];const r=e.reduce(((e,t)=>e*t))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return ie(0,e,t,n)}function se(e,t){const n=ue(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function ue(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function ce(e,t){const n=e.reduce(((e,t)=>e*t),1);if(null==t||"float32"===t)return oe(e,new Float32Array(n));if("int32"===t)return oe(e,new Int32Array(n));if("bool"===t)return oe(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function le(e){e.forEach((t=>{B(Number.isInteger(t)&&t>=0,(()=>"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")))}))}function pe(e,t,n){if(0===t)return 0;if(1===t)return e[0];let r=e[e.length-1];for(let a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function he(e,t,n){if(0===t)return[];if(1===t)return[e];const r=new Array(t);for(let a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function de(e){return e&&e.then&&"function"===typeof e.then}const fe="tfjsflags";class me{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=ge,this.populateURLFlags()}setPlatform(e,t){null!=this.platform&&(ye().getBool("IS_TEST")||ye().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,"."))),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){const t=this.urlFlags[e];ye().getBool("IS_TEST")||ye().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(t,".")),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(de(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"===typeof this.global||"undefined"===typeof this.global.location||"undefined"===typeof this.global.location.search)return;const e=this.getQueryParams(this.global.location.search);if(fe in e){e[fe].split(",").forEach((e=>{const[t,n]=e.split(":");this.urlFlags[t]=function(e,t){const n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:t}(0,n)}))}}}function ge(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,r[0],r[1]),r.join("=")})),t}function ye(){return be}let ve,be=null;function xe(){if(null==ve){let e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof n.g)e=n.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}ve=e}return ve}function we(e,t){const n=function(){const e=xe();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{const r=t();return n.set(e,r),n.get(e)}}const Ne="Abs",Se="Acos",ke="Acosh",Ee="Add",Ce="AddN",Te="All",De="Any",Ie="ArgMax",Ae="ArgMin",Fe="Asin",_e="Asinh",Me="Atan",Oe="Atanh",Re="Atan2",ze="AvgPool",Be="AvgPoolGrad",Le="AvgPool3D",Pe="AvgPool3DGrad",Ue="BatchMatMul",We="BatchToSpaceND",Ve="Bincount",qe="BitwiseAnd",je="BroadcastArgs",Ge="Cast",He="Ceil",Ke="ClipByValue",Xe="Complex",Ye="ComplexAbs",$e="Concat",Ze="Conv2D",Qe="Conv2DBackpropFilter",Je="Conv2DBackpropInput",et="Conv3D",tt="Conv3DBackpropFilterV2",nt="Conv3DBackpropInputV2",rt="Cos",at="Cosh",it="Cumprod",ot="Cumsum",st="CropAndResize",ut="DenseBincount",ct="DepthToSpace",lt="DepthwiseConv2dNative",pt="DepthwiseConv2dNativeBackpropFilter",ht="DepthwiseConv2dNativeBackpropInput",dt="Diag",ft="Dilation2D",mt="Dilation2DBackpropInput",gt="Dilation2DBackpropFilter",yt="Draw",vt="RealDiv",bt="Einsum",xt="Elu",wt="EluGrad",Nt="Erf",St="Equal",kt="Exp",Et="ExpandDims",Ct="Expm1",Tt="FFT",Dt="Fill",It="FlipLeftRight",At="Floor",Ft="FloorDiv",_t="FusedBatchNorm",Mt="GatherV2",Ot="GatherNd",Rt="Greater",zt="GreaterEqual",Bt="Identity",Lt="IFFT",Pt="Imag",Ut="IsFinite",Wt="IsInf",Vt="IsNan",qt="LeakyRelu",jt="Less",Gt="LessEqual",Ht="LinSpace",Kt="Log",Xt="Log1p",Yt="LogicalAnd",$t="LogicalNot",Zt="LogicalOr",Qt="LRN",Jt="LRNGrad",en="Max",tn="Maximum",nn="MaxPool",rn="MaxPoolGrad",an="MaxPool3D",on="MaxPool3DGrad",sn="MaxPoolWithArgmax",un="Mean",cn="Min",ln="Minimum",pn="MirrorPad",hn="Mod",dn="Multinomial",fn="Multiply",mn="Neg",gn="NotEqual",yn="NonMaxSuppressionV3",vn="NonMaxSuppressionV4",bn="NonMaxSuppressionV5",xn="OnesLike",wn="OneHot",Nn="Pack",Sn="PadV2",kn="Pow",En="Prelu",Cn="Prod",Tn="RaggedGather",Dn="RaggedRange",In="RaggedTensorToTensor",An="Range",Fn="Real",_n="Reciprocal",Mn="Relu",On="Reshape",Rn="ResizeNearestNeighbor",zn="ResizeNearestNeighborGrad",Bn="ResizeBilinear",Ln="ResizeBilinearGrad",Pn="Relu6",Un="Reverse",Wn="Round",Vn="Rsqrt",qn="ScatterNd",jn="TensorScatterUpdate",Gn="SearchSorted",Hn="Select",Kn="Selu",Xn="Slice",Yn="Sin",$n="Sinh",Zn="Sign",Qn="Sigmoid",Jn="Softplus",er="Sqrt",tr="Sum",nr="SpaceToBatchND",rr="SplitV",ar="Softmax",ir="SparseFillEmptyRows",or="SparseReshape",sr="SparseSegmentMean",ur="SparseSegmentSum",cr="SparseToDense",lr="SquaredDifference",pr="Square",hr="StaticRegexReplace",dr="StridedSlice",fr="StringNGrams",mr="StringSplit",gr="StringToHashBucketFast",yr="Sub",vr="Tan",br="Tanh",xr="Tile",wr="TopK",Nr="Transform",Sr="Transpose",kr="Unique",Er="Unpack",Cr="UnsortedSegmentSum",Tr="ZerosLike",Dr="Step",Ir="FromPixels",Ar="RotateWithOffset",Fr="_FusedMatMul",_r="FusedConv2D",Mr="FusedDepthwiseConv2D";function Or(){ye().getBool("IS_TEST")||ye().getBool("PROD")||console.warn(...arguments)}function Rr(){ye().getBool("IS_TEST")||ye().getBool("PROD")||console.log(...arguments)}const zr=we("kernelRegistry",(()=>new Map)),Br=we("gradRegistry",(()=>new Map));function Lr(e,t){const n=qr(e,t);return zr.get(n)}function Pr(e){return Br.get(e)}function Ur(e){const t=zr.entries(),n=[];for(;;){const{done:r,value:a}=t.next();if(r)break;const[i,o]=a,[s]=i.split("_");s===e&&n.push(o)}return n}function Wr(e){const{kernelName:t,backendName:n}=e,r=qr(t,n);zr.has(r)&&Or("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),zr.set(r,e)}function Vr(e){const{kernelName:t}=e;Br.has(t)&&ye().getBool("DEBUG")&&Or("Overriding the gradient for '".concat(t,"'")),Br.set(t,e)}function qr(e,t){return"".concat(t,"_").concat(e)}function jr(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var Gr=n(353);const Hr=n.n(Gr)()||Gr;function Kr(e){return Hr.fromString(e,!0,16)}const Xr=Kr("c3a5c85c97cb3127"),Yr=Kr("b492b66fbe98f273"),$r=Kr("9ae16a3b2f90404f");function Zr(e){return e.xor(e.shru(47))}function Qr(e,t,n){const r=e.slice(t,t+n);return Hr.fromBytes(Array.from(r),!0,!0)}function Jr(e,t){return Qr(e,t,8)}function ea(e,t){return Qr(e,t,4)}function ta(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function na(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Kr("9ddfea08eb382d69"),r=e.xor(t).mul(n);r=r.xor(r.shru(47));let a=t.xor(r).mul(n);return a=a.xor(a.shru(47)),a=a.mul(n),a}function ra(e,t,n,r){return function(e,t,n,r,a,i){a=a.add(e),i=ta(i.add(a).add(r),21);const o=a;return a=(a=a.add(t)).add(n),i=i.add(ta(a,44)),[a.add(r),i.add(o)]}(Jr(e,t),Jr(e,t+8),Jr(e,t+16),Jr(e,t+24),n,r)}function aa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=Hr.fromNumber(81,!0);if(t<=32)return t<=16?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){const n=$r.add(2*t),r=Jr(e,0).add($r),a=Jr(e,t-8);return na(ta(a,37).mul(n).add(r),ta(r,25).add(a).mul(n),n)}if(t>=4){const n=$r.add(2*t);return na(ea(e,0).shl(3).add(t),ea(e,t-4),n)}if(t>0){const n=e[0]+(e[t>>1]<<8),r=t+(e[t-1]<<2);return Zr($r.mul(n).xor(Xr.mul(r))).mul($r)}return $r}(e,t):function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=$r.add(2*t),r=Jr(e,0).mul(Yr),a=Jr(e,8),i=Jr(e,t-8).mul(n),o=Jr(e,t-16).mul($r);return na(ta(r.add(a),43).add(ta(i,30)).add(o),r.add(ta(a.add($r),18)).add(i),n)}(e,t);if(t<=64)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=$r.add(2*t),r=Jr(e,0).mul($r),a=Jr(e,8),i=Jr(e,t-8).mul(n),o=Jr(e,t-16).mul($r),s=ta(r.add(a),43).add(ta(i,30)).add(o),u=na(s,r.add(ta(a.add($r),18)).add(i),n),c=Jr(e,16).mul(n),l=Jr(e,24),p=s.add(Jr(e,t-32)).mul(n),h=u.add(Jr(e,t-24)).mul(n);return na(ta(c.add(l),43).add(ta(p,30)).add(h),c.add(ta(l.add(r),18)).add(p),n)}(e,t);let r=n,a=n.mul(Yr).add(113),i=Zr(a.mul($r).add(113)).mul($r),o=[Hr.UZERO,Hr.UZERO],s=[Hr.UZERO,Hr.UZERO];r=r.mul($r).add(Jr(e,0));let u=0;const c=64*(t-1>>6),l=c+(t-1&63)-63;do{r=ta(r.add(a).add(o[0]).add(Jr(e,u+8)),37).mul(Yr),a=ta(a.add(o[1]).add(Jr(e,u+48)),42).mul(Yr),r=r.xor(s[1]),a=a.add(o[0]).add(Jr(e,u+40)),i=ta(i.add(s[0]),33).mul(Yr),o=ra(e,u,o[1].mul(Yr),r.add(s[0])),s=ra(e,u+32,i.add(s[1]),a.add(Jr(e,u+16))),[i,r]=[r,i],u+=64}while(u!==c);const p=Yr.add(i.and(255).shl(1));return u=l,s[0]=s[0].add(t-1&63),o[0]=o[0].add(s[0]),s[0]=s[0].add(o[0]),r=ta(r.add(a).add(o[0]).add(Jr(e,u+8)),37).mul(p),a=ta(a.add(o[1]).add(Jr(e,u+48)),42).mul(p),r=r.xor(s[1].mul(9)),a=a.add(o[0].mul(9).add(Jr(e,u+40))),i=ta(i.add(s[0]),33).mul(p),o=ra(e,u,o[1].mul(p),r.add(s[0])),s=ra(e,u+32,i.add(s[1]),a.add(Jr(e,u+16))),[i,r]=[r,i],na(na(o[0],s[0],p).add(Zr(a).mul(Xr)).add(i),na(o[1],s[1],p).add(r),p)}function ia(e,t){return"string"===t?ua(e):oa([e],t)}function oa(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=pa(e)),ye().getBool("DEBUG")&&function(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){const t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)0!==Math.round(e[n])&&(t[n]=1);return t}throw new Error("Unknown data type ".concat(t))}function sa(){return ye().platform.now()}function ua(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",ye().platform.encode(e,t)}function ca(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",ye().platform.decode(e,t)}function la(e){return null!=ye().platform.isTypedArray?ye().platform.isTypedArray(e):jr(e)}function pa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"===typeof e||"number"===typeof e||"string"===typeof e||de(e)||null==e||la(e)&&n)t.push(e);else if(Array.isArray(e)||la(e))for(let r=0;r<e.length;++r)pa(e[r],t,n);else{let r=-1;for(const t of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(t)&&(r=Math.max(r,Number(t)));for(let a=0;a<=r;a++)pa(e[a],t,n)}return t}class ha{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new fa)}profileKernel(e,t,n){let r;const a=()=>{r=n()};let i;const o=sa();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(a);else{a();for(const e of r)e.dataSync();i=Promise.resolve({kernelMs:sa()-o})}if(ye().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let s=0;s<r.length;s++){const t=r[s];t.data().then((n=>{da(n,t.dtype,e)}))}return{kernelName:e,outputs:r,inputs:t,timeMs:i.then((e=>e.kernelMs)),extraInfo:i.then((e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""))}}logKernelProfile(e){const{kernelName:t,outputs:n,timeMs:r,inputs:a,extraInfo:i}=e;n.forEach((e=>{Promise.all([e.data(),r,i]).then((n=>{this.logger.logKernelProfile(t,e,n[0],n[1],a,n[2])}))}))}}function da(e,t,n){if("float32"!==t)return!1;for(let r=0;r<e.length;r++){const t=e[r];if(isNaN(t)||!isFinite(t))return console.warn("Found ".concat(t," in the result of '").concat(n,"'")),!0}return!1}class fa{logKernelProfile(e,t,n,r,a,i){const o="number"===typeof r?j("".concat(r,"ms"),9):r.error,s=j(e,25),u=t.rank,c=t.size,l=j(t.shape.toString(),14);let p="";for(const h in a){const e=a[h];if(null!=e){const n=e.shape||t.shape,r=n.length;p+="".concat(h,": ").concat(r,"D ").concat(r>0?n:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(u,"D ").concat(l,"\t%c").concat(c,"\t%c").concat(p,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function ma(e,t,n,r){const a=ae(t),i=function(e,t,n,r){const a=U(t),i=r[r.length-1],o=new Array(i).fill(0),s=t.length,u="complex64"===n?ba(e):e;if(s>1)for(let c=0;c<a/i;c++){const e=c*i;for(let t=0;t<i;t++)o[t]=Math.max(o[t],ga(u[e+t],0,n).length)}return o}(e,t,n,a),o=t.length,s=va(e,t,n,a,i),u=["Tensor"];return r&&(u.push("  dtype: ".concat(n)),u.push("  rank: ".concat(o)),u.push("  shape: [".concat(t,"]")),u.push("  values:")),u.push(s.map((e=>"    "+e)).join("\n")),u.join("\n")}function ga(e,t,n){let r;return r=Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):J(e)?"'".concat(e,"'"):"bool"===n?ya(e):parseFloat(e.toFixed(7)).toString(),j(r,t)}function ya(e){return 0===e?"false":"true"}function va(e,t,n,r,a){let i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const o="complex64"===n?2:1,s=t[0],u=t.length;if(0===u){if("complex64"===n){return[ga(ba(e)[0],0,n)]}return"bool"===n?[ya(e[0])]:[e[0].toString()]}if(1===u){if(s>20){const t=3*o;let r=Array.from(e.slice(0,t)),i=Array.from(e.slice((s-3)*o,s*o));return"complex64"===n&&(r=ba(r),i=ba(i)),["["+r.map(((e,t)=>ga(e,a[t],n))).join(", ")+", ..., "+i.map(((e,t)=>ga(e,a[s-3+t],n))).join(", ")+"]"]}return["["+("complex64"===n?ba(e):Array.from(e)).map(((e,t)=>ga(e,a[t],n))).join(", ")+"]"]}const c=t.slice(1),l=r.slice(1),p=r[0]*o,h=[];if(s>20){for(let t=0;t<3;t++){const r=t*p,i=r+p;h.push(...va(e.slice(r,i),c,n,l,a,!1))}h.push("...");for(let t=s-3;t<s;t++){const r=t*p,i=r+p;h.push(...va(e.slice(r,i),c,n,l,a,t===s-1))}}else for(let m=0;m<s;m++){const t=m*p,r=t+p;h.push(...va(e.slice(t,r),c,n,l,a,m===s-1))}const d=2===u?",":"";h[0]="["+(s>0?h[0]+d:"");for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+d;let f=",\n";for(let m=2;m<u;m++)f+="\n";return h[h.length-1]=" "+h[h.length-1]+"]"+(i?"":f),h}function ba(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}class xa{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=U(e),null!=n){const e=n.length;B(e===this.size,(()=>"Length of values '".concat(e,"' does not match the size ")+"inferred by the shape '".concat(this.size,"'.")))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||$(t,this.size),this.strides=ae(e)}set(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),B(n.length===this.rank,(()=>"The number of provided coordinates (".concat(n.length,") must ")+"match the rank (".concat(this.rank,")")));const a=this.locToIndex(n);this.values[a]=e}get(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);let r=0;for(const i of t){if(i<0||i>=this.shape[r]){const e="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(e)}r++}let a=t[t.length-1];for(let i=0;i<t.length-1;++i)a+=this.strides[i]*t[i];return this.values[a]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];const t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return wa().makeTensor(this.values,this.shape,this.dtype)}}let wa=null,Na=null,Sa=null;class ka{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=U(e),this.strides=ae(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Na.buffer(this.shape,this.dtype,e)}bufferSync(){return Na.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return oe(this.shape,e,"complex64"===this.dtype)}arraySync(){return oe(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const e=wa().read(this.dataId);if("string"===this.dtype){const n=await e;try{return n.map((e=>ca(e)))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),wa().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=wa().readSync(this.dataId);if("string"===this.dtype)try{return e.map((e=>ca(e)))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await wa().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),wa().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Na.print(this,e)}clone(){return this.throwIfDisposed(),Na.clone(this)}toString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ma(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Na.cast(this,e)}variable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),wa().makeVariable(this,e,t,n)}}function Ea(){return we("Tensor",(()=>ka))}Object.defineProperty(ka,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),Ea();class Ca extends ka{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!W(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));wa().disposeTensor(this),this.dataId=e.dataId,wa().incRef(this,null)}dispose(){wa().disposeVariable(this),this.isDisposedInternal=!0}}var Ta,Da,Ia,Aa,Fa;Object.defineProperty(Ca,Symbol.hasInstance,{value:e=>e instanceof ka&&null!=e.assign&&e.assign instanceof Function}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(Ta||(Ta={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(Da||(Da={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Ia||(Ia={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Aa||(Aa={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Fa||(Fa={}));const _a={float32:Aa,int32:Da,bool:Ia,complex64:Fa};function Ma(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return _a[e][t]}function Oa(e){return Ma(e,"int32")}function Ra(e){return null!=e&&"object"===typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function za(e){return"undefined"!==typeof GPUBuffer&&null!=e&&"object"===typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}function Ba(e,t){if(e.dtype===t.dtype)return[e,t];const n=Ma(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function La(e,t){return t.some((t=>t.id===e.id))}function Pa(e){const t=[];return Ua(e,t,new Set),t}function Ua(e,t,n){if(null==e)return;if(e instanceof ka)return void t.push(e);if(r=e,!Array.isArray(r)&&"object"!==typeof r)return;var r;const a=e;for(const i in a){const e=a[i];n.has(e)||(n.add(e),Ua(e,t,n))}}function Wa(e){return null!=e.kernelName}class Va{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((e=>e.name))))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class qa{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Va}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error("The highest priority backend '".concat(e,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{const{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(Or("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw new Error("Backend name '".concat(e,"' not found in registry"));if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;const{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new ha(this.backendInstance),!0}setupRegisteredKernels(){Ur(this.backendName).forEach((e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(e){Ur(e).forEach((t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])}))}initializeBackend(e){const t=this.registryFactory[e];if(null==t)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{const n=t.factory();if(!n||n instanceof F||"function"!==typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{const t=++this.pendingBackendInitId,r=n.then((n=>!(t<this.pendingBackendInitId)&&(this.registry[e]=n,this.pendingBackendInit=null,!0))).catch((n=>(t<this.pendingBackendInitId||(this.pendingBackendInit=null,Or("Initialization of backend ".concat(e," failed")),Or(n.stack||n.message)),!1)));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(n){return Or("Initialization of backend ".concat(e," failed")),Or(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority))}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t],{success:r,asyncInit:a}=this.initializeBackend(n);if(a||r)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,r=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}return this.scopedRun((()=>this.startScope(r)),(()=>this.endScope(n)),(()=>(n=t(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(e,t,n){e();try{const e=n();return t(),e}catch(r){throw t(),r}}nextTensorId(){return qa.nextTensorId++}nextVariableId(){return qa.nextVariableId++}clone(e){const t=Ga.runKernel(Bt,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(e=>({x:()=>{const t={x:e},n={dtype:"float32"};return Ga.runKernel(Ge,t,n)}})),[],{}),t}runKernel(e,t,n){null==this.backendName&&this.backend;if(!(null!=Lr(e,this.backendName)))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){const r=this.backend.numDataIds();let a=0;n.forEach((e=>{a+="complex64"===e.dtype?3:1}));const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(e,"'"))}runKernelFunc(e){let t,n=[];const r=this.isTapeOn(),a=this.state.numBytes,i=this.state.numTensors;let o,s;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const u=Wa(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(Wa(e)){const{kernelName:t,inputs:a,attrs:i}=e;null==this.backendName&&this.backend;const u=Lr(t,this.backendName);B(null!=u,(()=>"Cannot find registered kernel '".concat(t,"' for backend '").concat(this.backendName,"'"))),o=()=>{const e=this.backend.numDataIds();s=u.kernelFunc({inputs:a,attrs:i,backend:this.backend});const o=Array.isArray(s)?s:[s];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,o);const c=o.map((e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e)));if(r){const e=this.getTensorsForGradient(t,a,c);n=this.saveTensorsForBackwardMode(e)}return c}}else{const{forwardFunc:t}=e,a=e=>{r&&(n=e.map((e=>this.keep(this.clone(e)))))};o=()=>{const e=this.backend.numDataIds();s=this.tidy((()=>t(this.backend,a)));const n=Array.isArray(s)?s:[s];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,e,n),n}}const{inputs:c,attrs:l}=e,p=Wa(e)?null:e.backwardsFunc;let h;return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(h=this.profiler.profileKernel(u,c,(()=>o())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),t=h.outputs):t=o()})),r&&this.addTapeNode(u,c,t,p,n,l),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map((e=>null!=c[e]?c[e].shape:null)),outputShapes:t.map((e=>e.shape)),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(s)?t:t[0]}saveTensorsForBackwardMode(e){const t=e.map((e=>this.keep(this.clone(e))));return t}getTensorsForGradient(e,t,n){const r=Pr(e);if(null!=r){const e=r.inputsToSave||[],a=r.outputsToSave||[];let i;r.saveAllInputs?(B(Array.isArray(t),(()=>"saveAllInputs is true, expected inputs to be an array.")),i=Object.keys(t).map((e=>t[e]))):i=e.map((e=>t[e]));const o=n.filter(((e,t)=>a[t]));return i.concat(o)}return[]}makeTensor(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let a=e;"string"===n&&J(e[0])&&(a=e.map((e=>ua(e))));const i=r.write(a,t,n),o=new ka(t,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){const e=this.state.tensorInfo.get(i),t=function(e){if(null==e)return 0;let t=0;return e.forEach((e=>t+=e.length)),t}(a);this.state.numBytes+=t-e.bytes,e.bytes=t}return o}makeTensorFromDataId(e,t,n,r){const a={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(e,t){const{dataId:n,shape:r,dtype:a}=e,i=new ka(r,a,n,this.nextTensorId());return this.trackTensor(i,t),i}makeVariable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));const a=new Ca(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*Q(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof Ca||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){const t=e.size*Q(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((e=>e.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,r,a,i){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},s=Pr(e);null!=s&&(r=s.gradFunc),null!=r&&(o.gradient=e=>(e=e.map(((e,t)=>{if(null==e){const e=n[t],r=ue(e.size,e.dtype);return this.makeTensor(r,e.shape,e.dtype)}return e})),r(e.length>1?e:e[0],a,i))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=Pa(e),n=new Set(t.map((e=>e.id)));for(let a=0;a<this.state.activeScope.track.length;a++){const e=this.state.activeScope.track[a];e.kept||n.has(e.id)||e.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach((e=>{e.kept||e.scopeId!==r.id||this.track(e)}))}gradients(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(B(t.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));const a=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",e)));B(a instanceof ka,(()=>"The result y returned by f() must be a tensor."));const i=function(e,t,n){const r={},a={};for(let u=0;u<t.length;u++)r[t[u].id]=!0;for(let u=0;u<e.length;u++){const n=e[u],i=n.inputs;for(const e in i){const o=i[e];let s=!1;for(let e=0;e<t.length;e++)if(r[o.id]){n.outputs.forEach((e=>r[e.id]=!0)),s=!0,a[n.id]=!0;break}if(s)break}}const i={};i[n.id]=!0;const o={};for(let u=e.length-1;u>=0;u--){const t=e[u],n=t.inputs;for(let e=0;e<t.outputs.length;e++)if(i[t.outputs[e].id]){for(const e in n)i[n[e].id]=!0,o[t.id]=!0;break}}const s=[];for(let u=0;u<e.length;u++){const t=e[u];if(a[t.id]&&o[t.id]){const e={};for(const a in t.inputs){const n=t.inputs[a];r[n.id]&&(e[a]=n)}const n=Object.assign({},t);n.inputs=e,n.outputs=t.outputs,s.push(n)}}return s}(this.state.activeTape,t,a);if(!r&&0===i.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const e={};e[a.id]=null==n?function(e){const t=se(U(e),"float32");return Ga.makeTensor(t,e,"float32")}(a.shape):n,function(e,t,n,r){for(let a=t.length-1;a>=0;a--){const i=t[a],o=[];if(i.outputs.forEach((t=>{const n=e[t.id];null!=n?o.push(n):o.push(null)})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(i.kernelName,"."));const s=i.gradient(o);for(const t in i.inputs){if(!(t in s))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(s),"."));const a=n((()=>s[t]()));if("float32"!==a.dtype)throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(a.dtype,"'"));const o=i.inputs[t];if(!W(a.shape,o.shape))throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(a.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==e[o.id])e[o.id]=a;else{const t=e[o.id];e[o.id]=r(t,a),t.dispose()}}}}(e,i,(e=>this.tidy(e)),Ha);const r=t.map((t=>e[t.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((e=>{for(const t of e.saved)t.dispose()})),this.state.activeTape=null),{value:a,grads:r}}))}customGrad(e){var t=this;return B(ne(e),(()=>"The f passed in customGrad(f) must be a function.")),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];let i;B(r.every((e=>e instanceof ka)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const o={};r.forEach(((e,t)=>{o[t]=e}));return t.runKernelFunc({forwardFunc:(t,n)=>(i=e(...r,n),B(i.value instanceof ka,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),B(ne(i.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),i.value),backwardsFunc:(e,t)=>{const n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];B(a.length===r.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),B(a.every((e=>e instanceof ka)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const o={};return a.forEach(((e,t)=>{o[t]=()=>e})),o},inputs:o})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=sa(),n=await this.backend.time(e);return n.wallMs=sa()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Va;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function ja(){const e=xe();if(null==e._tfengine){const t=new me(e);e._tfengine=new qa(t)}var t;return t=e._tfengine.ENV,be=t,wa=()=>e._tfengine,e._tfengine}qa.nextTensorId=0,qa.nextVariableId=0;const Ga=ja();function Ha(e,t){const n={a:e,b:t};return Ga.runKernel(Ee,n)}let Ka;function Xa(e){if(void 0!==Ka)return Ka;if(e||"undefined"!==typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;const t=e.userAgent||e.vendor||("undefined"!==typeof window?window.opera:"");if(!t){const t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function Ya(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}const $a=ye();function Za(e,t){let n=e;if(la(e))return"string"===t?[]:[e.length];if(Ra(e)){const t=e.channels||"RGBA";return[e.height,e.width*t.length]}if(za(e))return[e.buffer.size/(null==t?4:Q(t))];if(!Array.isArray(e))return[];const r=[];for(;Array.isArray(n)||la(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&ye().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Qa(e,r,[]),r}function Qa(e,t,n){if(n=n||[],!Array.isArray(e)&&!la(e))return void B(0===t.length,(()=>"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements")));B(t.length>0,(()=>"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements"))),B(e.length===t[0],(()=>"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements")));const r=t.slice(1);for(let a=0;a<e.length;++a)Qa(e[a],r,n.concat(a))}function Ja(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function ei(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof Ea())return Ja(r,e.dtype,t,n),e;let a=te(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),Ja(r,a,t,n),null==e||!la(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){const r=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(r,"'"))}const i=Za(e,a);la(e)||Array.isArray(e)||(e=[e]);const o="string"!==a?oa(e,a):pa(e,[],!0);return Ga.makeTensor(o,i,a)}function ti(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return e.map(((e,a)=>ei(e,"".concat(t,"[").concat(a,"]"),n,r)))}$a.registerFlag("DEBUG",(()=>!1),(e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),$a.registerFlag("IS_BROWSER",(()=>Ya())),$a.registerFlag("IS_NODE",(()=>"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node)),$a.registerFlag("IS_CHROME",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),$a.registerFlag("IS_SAFARI",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor))),$a.registerFlag("PROD",(()=>!1)),$a.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>$a.getBool("DEBUG"))),$a.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),$a.registerFlag("IS_TEST",(()=>!1)),$a.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>$a.getBool("DEBUG"))),$a.registerFlag("WRAP_TO_IMAGEBITMAP",(()=>!1)),$a.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(()=>!1)),$a.registerFlag("USE_SETTIMEOUTCUSTOM",(()=>!1));const ni="__op";function ri(e){const t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));let n=t[0];const r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=ni;const a=function(){Ga.startScope(n);try{const e=r(...arguments);return de(e)&&console.error("Cannot return a Promise inside of tidy."),Ga.endScope(e),e}catch(e){throw Ga.endScope(null),e}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}const ai=ri({complex_:function(e,t){const n=ei(e,"real","complex"),r=ei(t,"imag","complex");L(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex().");const a={real:n,imag:r};return Ga.runKernel(Xe,a)}});function ii(e,t,n,r){if(null==r)r=te(e);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(za(e)||Ra(e)){if("float32"!==r&&"int32"!==r)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(r,"."));return Ga.backend.createTensorFromGPUData(e,t||n,r)}if(!la(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){le(t);const e=U(t),r=U(n);B(e===r,(()=>"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(e," values but has ").concat(r)));for(let a=0;a<n.length;++a){const e=n[a],r=a!==n.length-1||e!==U(t.slice(a));B(n[a]===t[a]||!r,(()=>"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")))}}return la(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?oa(e,r):pa(e,[],!0),Ga.makeTensor(e,t,r)}function oi(e,t,n){return ii(e,t,Za(e,n),n)}const si={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class ui{static join(e){return new ui(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,null==e)return;if(e instanceof Array||(e=[e]),0===(e=e.map((e=>la(e)?e.buffer:e))).length)return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){const r=e[n];n!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const a=t+r.byteLength;this.shards.push({buffer:r,start:t,end:a}),t=a}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const n=this.findShardForByte(e);if(-1===n)throw new Error("Could not find start shard for byte ".concat(e));const r=new ArrayBuffer(t-e),a=new Uint8Array(r);let i=0;for(let o=n;o<this.shards.length;o++){const n=this.shards[o],r=e+i-n.start,s=i,u=Math.min(t,n.end)-n.start,c=new Uint8Array(n.buffer,r,u-r);if(a.set(c,s),i+=c.length,t<n.end)break}return r}findShardForByte(e){if(0===this.shards.length||e<0||e>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;const n=function(e,t){let n=0,r=e.length;for(;n<=r;){const a=Math.floor((r-n)/2)+n,i=t(e[a]);if(0===i)return a;i<0?r=a:n=a+1}return-1}(this.shards,t);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}function ci(){return Ga}function li(){return Ga.memory()}function pi(e,t){return Ga.tidy(e,t)}function hi(e){Pa(e).forEach((e=>e.dispose()))}function di(e){return Ga.keep(e)}function fi(e){return Ga.setBackend(e)}function mi(){return Ga.backendName}function gi(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Ga.registerBackend(e,t,n)}function yi(){return Ga.backend}Sa=function(e){ye().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")};const vi=4;async function bi(e,t){const n=[],r=[],a=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);for(let i=0;i<a.length;++i){const o=a[i],s=Array.isArray(e)?e[i].tensor:e[o];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s.dtype));const u={name:o,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){const e=new Promise((async e=>{const t=await s.bytes(),n=t.reduce(((e,t)=>e+t.length),0)+vi*t.length,r=new Uint8Array(n);let a=0;for(let i=0;i<t.length;i++){const e=t[i],n=new Uint8Array(new Uint32Array([e.length]).buffer);r.set(n,a),a+=vi,r.set(e,a),a+=e.length}e(r)}));r.push(e)}else r.push(s.data());null!=t&&(u.group=t),n.push(u)}return{data:Ci(await Promise.all(r)),specs:n}}function xi(e,t){const n=new ui(e),r={};let a=0;for(const i of t){const e=wi(i,((e,t)=>n.slice(a+e,a+t)));r[i.name]=Si(i,n.slice(a,a+e)),a+=e}return r}function wi(e,t){const n=U(e.shape);let r;if("quantization"in e){const t=e.quantization;r=si[t.dtype]}else{if("string"===e.dtype){let e=0;for(let r=0;r<n;r++)e+=vi+new Uint32Array(t(e,e+vi))[0];return e}r=si[e.dtype]}return n*r}async function Ni(e,t){const n=U(e.shape);let r;if("quantization"in e){const t=e.quantization;r=si[t.dtype]}else{if("string"===e.dtype){let e=0;for(let r=0;r<n;r++)e+=vi+new Uint32Array(await t(e,e+vi))[0];return e}r=si[e.dtype]}return n*r}function Si(e,t){const n=e.name,r=e.dtype,a=e.shape,i=U(a);let o,s=0;if("quantization"in e){const a=e.quantization;if("uint8"===a.dtype||"uint16"===a.dtype){if(!("min"in a)||!("scale"in a))throw new Error("Weight ".concat(e.name," with quantization ").concat(a.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==a.dtype)throw new Error("Weight ".concat(e.name," has unknown ")+"quantization dtype ".concat(a.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==r)throw new Error("Weight ".concat(e.name," is quantized with ").concat(a.dtype," ")+"which only supports weights of type float32 not ".concat(r,"."))}const u=si[a.dtype],c="uint8"===a.dtype?new Uint8Array(t):new Uint16Array(t);if("float32"===r)if("uint8"===a.dtype||"uint16"===a.dtype){o=new Float32Array(c.length);for(let e=0;e<c.length;e++){const t=c[e];o[e]=t*a.scale+a.min}}else{if("float16"!==a.dtype)throw new Error("Unsupported quantization type ".concat(a.dtype," ")+"for weight type float32.");{const e=function(){const e=function(){const e=e=>{let t=e<<13,n=0;for(;0===(8388608&t);)n-=8388608,t<<=1;return t&=-8388609,n+=947912704,t|n},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}(),t=function(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}(),n=function(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return r=>{const a=new ArrayBuffer(4*r.length),i=new Uint32Array(a);for(let o=0;o<r.length;o++){const a=r[o],s=e[n[a>>10]+(1023&a)]+t[a>>10];i[o]=s}return new Float32Array(a)}}();o=e(c)}}else{if("int32"!==r)throw new Error("Unsupported dtype in weight '".concat(n,"': ").concat(r));if("uint8"!==a.dtype&&"uint16"!==a.dtype)throw new Error("Unsupported quantization type ".concat(a.dtype," ")+"for weight type int32.");o=new Int32Array(c.length);for(let e=0;e<c.length;e++){const t=c[e];o[e]=Math.round(t*a.scale+a.min)}}s+=i*u}else if("string"===r){const n=U(e.shape);o=[];for(let e=0;e<n;e++){const e=new Uint32Array(t.slice(s,s+vi))[0];s+=vi;const n=new Uint8Array(t.slice(s,s+e));o.push(n),s+=e}}else{const e=si[r];if("float32"===r)o=new Float32Array(t);else if("int32"===r)o=new Int32Array(t);else{if("bool"!==r){if("complex64"===r){o=new Float32Array(t);const e=new Float32Array(o.length/2),n=new Float32Array(o.length/2);for(let t=0;t<e.length;t++)e[t]=o[2*t],n[t]=o[2*t+1];const r=oi(e,a,"float32"),i=oi(n,a,"float32"),s=ai(r,i);return r.dispose(),i.dispose(),s}throw new Error("Unsupported dtype in weight '".concat(n,"': ").concat(r))}o=new Uint8Array(t)}s+=i*e}return oi(o,a,r)}async function ki(e,t,n){let r=new Uint8Array(t);for(;r.byteLength<n;){const{done:t,value:a}=await e.read();if(t&&null==a){const e=n-r.byteLength;throw new Error("Reader is done but ".concat(e," bytes are still expected"))}const i=new Uint8Array(r.length+a.byteLength);i.set(r,0),i.set(new Uint8Array(a),r.length),r=i}return r.buffer}async function Ei(e,t){const n={},r=e.getReader();let a=new ArrayBuffer(0);for(const i of t){const e=await Ni(i,(async(e,t)=>(a=await ki(r,a,t),a.slice(e,t))));a=await ki(r,a,e);const t=a.slice(0,e);a=a.slice(e);const o=Si(i,t);if(n[i.name]=o,"webgpu"===mi()){const e=yi();"uploadToGPU"in e&&U(o.shape)>=ye().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&e.uploadToGPU(o.dataId)}}return n}function Ci(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));let t=0;const n=[];e.forEach((e=>{if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))}));const r=new Uint8Array(t);let a=0;return n.forEach((e=>{r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}const Ti="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function Di(e){return Ti?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function Ii(e){return ui.join(e)}function Ai(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);const t=e.split("/");return t[t.length-1]}function Fi(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function _i(e,t,n){const r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(r.initializerSignature=e.initializerSignature),r}async function Mi(e,t){let n,r;return null!=e.weightsManifest&&([n,r]=await t(e.weightsManifest)),_i(e,n,r)}function Oi(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:Di(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:Di(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new ui(e.weightData).byteLength}}function Ri(e){const t=[];for(const n of e)t.push(...n.weights);return t}class zi{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==zi.instance&&(zi.instance=new zi),zi.instance}static registerSaveRouter(e){zi.getInstance().saveRouters.push(e)}static registerLoadRouter(e){zi.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return zi.getHandlers(e,"save")}static getLoadHandlers(e,t){return zi.getHandlers(e,"load",t)}static getHandlers(e,t,n){const r=[];return("load"===t?zi.getInstance().loadRouters:zi.getInstance().saveRouters).forEach((t=>{const a=t(e,n);null!==a&&r.push(a)})),r}}const Bi=e=>zi.registerSaveRouter(e),Li=e=>zi.registerLoadRouter(e),Pi=e=>zi.getSaveHandlers(e),Ui=(e,t)=>zi.getLoadHandlers(e,t),Wi="tensorflowjs",Vi="models_store",qi="model_info_store";function ji(){if(!ye().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Gi(e){const t=e.result;t.createObjectStore(Vi,{keyPath:"modelPath"}),t.createObjectStore(qi,{keyPath:"modelPath"})}class Hi{constructor(e){if(this.indexedDB=ji(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise(((e,n)=>{const r=this.indexedDB.open(Wi,1);r.onupgradeneeded=()=>Gi(r),r.onsuccess=()=>{const a=r.result;if(null==t){const t=a.transaction(Vi,"readonly"),r=t.objectStore(Vi).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return a.close(),n(new Error("Cannot find model with path '".concat(this.modelPath,"' ")+"in IndexedDB."));e(r.result.modelArtifacts)},r.onerror=e=>(a.close(),n(r.error)),t.oncomplete=()=>a.close()}else{t.weightData=ui.join(t.weightData);const r=Oi(t),o=a.transaction(qi,"readwrite");let s,u,c=o.objectStore(qi);try{s=c.put({modelPath:this.modelPath,modelArtifactsInfo:r})}catch(i){return n(i)}s.onsuccess=()=>{u=a.transaction(Vi,"readwrite");const s=u.objectStore(Vi);let l;try{l=s.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:r})}catch(i){return n(i)}l.onsuccess=()=>e({modelArtifactsInfo:r}),l.onerror=e=>{c=o.objectStore(qi);const t=c.delete(this.modelPath);t.onsuccess=()=>(a.close(),n(l.error)),t.onerror=e=>(a.close(),n(l.error))}},s.onerror=e=>(a.close(),n(s.error)),o.oncomplete=()=>{null==u?a.close():u.oncomplete=()=>a.close()}}},r.onerror=e=>n(r.error)}))}}Hi.URL_SCHEME="indexeddb://";const Ki=e=>{return ye().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Hi.URL_SCHEME)?(t=e.slice(Hi.URL_SCHEME.length),new Hi(t)):null;var t};zi.registerSaveRouter(Ki),zi.registerLoadRouter(Ki);class Xi{constructor(){this.indexedDB=ji()}async listModels(){return new Promise(((e,t)=>{const n=this.indexedDB.open(Wi,1);n.onupgradeneeded=()=>Gi(n),n.onsuccess=()=>{const r=n.result,a=r.transaction(qi,"readonly"),i=a.objectStore(qi).getAll();i.onsuccess=()=>{const t={};for(const e of i.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},i.onerror=e=>(r.close(),t(i.error)),a.oncomplete=()=>r.close()},n.onerror=e=>t(n.error)}))}async removeModel(e){var t;return e=(t=e).startsWith(Hi.URL_SCHEME)?t.slice(Hi.URL_SCHEME.length):t,new Promise(((t,n)=>{const r=this.indexedDB.open(Wi,1);r.onupgradeneeded=()=>Gi(r),r.onsuccess=()=>{const a=r.result,i=a.transaction(qi,"readwrite"),o=i.objectStore(qi),s=o.get(e);let u;s.onsuccess=()=>{if(null==s.result)return a.close(),n(new Error("Cannot find model with path '".concat(e,"' ")+"in IndexedDB."));{const r=o.delete(e),i=()=>{u=a.transaction(Vi,"readwrite");const r=u.objectStore(Vi).delete(e);r.onsuccess=()=>t(s.result.modelArtifactsInfo),r.onerror=e=>n(s.error)};r.onsuccess=i,r.onerror=e=>(i(),a.close(),n(s.error))}},s.onerror=e=>(a.close(),n(s.error)),i.oncomplete=()=>{null==u?a.close():u.oncomplete=()=>a.close()}},r.onerror=e=>n(r.error)}))}}const Yi="/",$i="tensorflowjs_models",Zi="info",Qi="model_topology",Ji="weight_specs",eo="weight_data",to="model_metadata";function no(e){return{info:[$i,e,Zi].join(Yi),topology:[$i,e,Qi].join(Yi),weightSpecs:[$i,e,Ji].join(Yi),weightData:[$i,e,eo].join(Yi),modelMetadata:[$i,e,to].join(Yi)}}function ro(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function ao(e){const t=e.split(Yi);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(Yi)}class io{constructor(e){if(!ye().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=no(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),a=Oi(e),i=ui.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(e){if(Ti)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(i));const t={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(t)),{modelArtifactsInfo:a}}catch(t){throw ro(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."))}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");t.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");t.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(null!=a){const e=JSON.parse(a);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(t.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(null==i)throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));return t.weightData=function(e){if(Ti){const t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}(i),t}}io.URL_SCHEME="localstorage://";const oo=e=>{return ye().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(io.URL_SCHEME)?(t=e.slice(io.URL_SCHEME.length),new io(t)):null;var t};zi.registerSaveRouter(oo),zi.registerLoadRouter(oo);class so{constructor(){B(ye().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),B("undefined"===typeof window||"undefined"!==typeof window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){const e={},t=$i+Yi,n=Yi+Zi;for(let r=0;r<this.LS.length;++r){const a=this.LS.key(r);if(a.startsWith(t)&&a.endsWith(n)){e[ao(a)]=JSON.parse(this.LS.getItem(a))}}return e}async removeModel(e){var t;const n=no(e=(t=e).startsWith(io.URL_SCHEME)?t.slice(io.URL_SCHEME.length):t);if(null==this.LS.getItem(n.info))throw new Error("Cannot find model at path '".concat(e,"'"));const r=JSON.parse(this.LS.getItem(n.info));return ro(n),r}}const uo="://";class co{constructor(){this.managers={}}static getInstance(){return null==co.instance&&(co.instance=new co),co.instance}static registerManager(e,t){B(null!=e,(()=>"scheme must not be undefined or null.")),e.endsWith(uo)&&(e=e.slice(0,e.indexOf(uo))),B(e.length>0,(()=>"scheme must not be an empty string."));const n=co.getInstance();B(null==n.managers[e],(()=>"A model store manager is already registered for scheme '".concat(e,"'."))),n.managers[e]=t}static getManager(e){const t=co.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}static getSchemes(){return Object.keys(co.getInstance().managers)}}function lo(e){if(-1===e.indexOf(uo))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(co.getSchemes().join(",")));return{scheme:e.split(uo)[0],path:e.split(uo)[1]}}async function po(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];B(e!==t,(()=>"Old path and new path are the same: '".concat(e,"'")));const r=zi.getLoadHandlers(e);B(r.length>0,(()=>"Copying failed because no load handler is found for source URL ".concat(e,"."))),B(r.length<2,(()=>"Copying failed because more than one (".concat(r.length,") ")+"load handlers for source URL ".concat(e,".")));const a=r[0],i=zi.getSaveHandlers(t);B(i.length>0,(()=>"Copying failed because no save handler is found for destination "+"URL ".concat(t,"."))),B(i.length<2,(()=>"Copying failed because more than one (".concat(r.length,") ")+"save handlers for destination URL ".concat(t,".")));const o=i[0],s=lo(e).scheme,u=lo(e).path,c=s===lo(e).scheme,l=await a.load();n&&c&&await co.getManager(s).removeModel(u);const p=await o.save(l);return n&&!c&&await co.getManager(s).removeModel(u),p.modelArtifactsInfo}async function ho(){const e=co.getSchemes(),t={};for(const n of e){const e=await co.getManager(n).listModels();for(const r in e){t[n+uo+r]=e[r]}}return t}async function fo(e){const t=lo(e);return co.getManager(t.scheme).removeModel(t.path)}async function mo(e,t){return po(e,t,!1)}async function go(e,t){return po(e,t,!0)}class yo{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){"undefined"!==typeof window&&ye().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout((()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")}),t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(e=>{if(e.source===window&&e.data.name===this.messageName){e.stopPropagation();(0,this.functionRefs[e.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}}),!0))):setTimeout(e,t)}isTypedArray(e){return jr(e)}}if(ye().get("IS_BROWSER")){ye().setPlatform("browser",new yo);try{co.registerManager(io.URL_SCHEME,new so)}catch(r5){}try{co.registerManager(Hi.URL_SCHEME,new Xi)}catch(r5){}}const vo=()=>n(817);let bo;class xo{constructor(){this.util=n(590),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=ye().global.fetch?ye().global.fetch(e,t):(null==bo&&(bo=vo()),bo(e,t))}now(){const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}function wo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",le(e),new xa(e,t,n)}ye().get("IS_NODE")&&!ye().get("IS_BROWSER")&&ye().setPlatform("node",new xo);const No=ri({cast_:function(e,t){const n=ei(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const r={x:n},a={dtype:t};return Ga.runKernel(Ge,r,a)}});const So=ri({clone_:function(e){const t={x:ei(e,"x","clone","string_or_numeric")};return Ga.runKernel(Bt,t)}});function ko(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}ja();Na={buffer:wo,cast:No,clone:So,print:ko};const Eo=ri({add_:function(e,t){let n=ei(e,"a","add"),r=ei(t,"b","add");[n,r]=Ba(n,r);const a={a:n,b:r};return Ga.runKernel(Ee,a)}});const Co=ri({floorDiv_:function(e,t){let n=ei(e,"a","floorDiv"),r=ei(t,"b","floorDiv");[n,r]=Ba(n,r);const a={a:n,b:r};return Ga.runKernel(Ft,a)}});const To=ri({div_:function(e,t){let n=ei(e,"a","div"),r=ei(t,"b","div");if([n,r]=Ba(n,r),"int32"===n.dtype&&"int32"===r.dtype)return Co(n,r);const a={a:n,b:r};return Ga.runKernel(vt,a,{})}});const Do=ri({mul_:function(e,t){let n=ei(e,"a","mul"),r=ei(t,"b","mul");[n,r]=Ba(n,r);const a={a:n,b:r};return Ga.runKernel(fn,a)}});const Io=ri({sqrt_:function(e){const t={x:ei(e,"x","sqrt","float32")};return Ga.runKernel(er,t)}});const Ao=ri({square_:function(e){const t=ei(e,"x","square");return Ga.runKernel("Square",{x:t},{})}});const Fo=ri({zerosLike_:function(e){const t={x:ei(e,"x","zerosLike")};return Ga.runKernel(Tr,t)}});function _o(e){return Ga.customGrad(e)}function Mo(e,t){if((la(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&la(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return ii(e,[],[],t)}const Oo=new Map,Ro=new Map;class zo{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class Bo{constructor(){this.classNameMap={}}static getMap(){return null==Bo.instance&&(Bo.instance=new Bo),Bo.instance}static register(e){Bo.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Lo(e,t,n){B(null!=e.className,(()=>"Class being registered does not have the static className property defined.")),B("string"===typeof e.className,(()=>"className is required to be a string, but got type "+typeof e.className)),B(e.className.length>0,(()=>"Class being registered has an empty-string as its className, which is disallowed.")),"undefined"===typeof t&&(t="Custom"),"undefined"===typeof n&&(n=e.className);const r=t+">"+n;return Bo.register(e),Oo.set(r,e),Ro.set(e,r),e}class Po extends zo{minimize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const{value:r,grads:a}=this.computeGradients(e,n);if(null!=n){const e=n.map((e=>({name:e.name,tensor:a[e.name]})));this.applyGradients(e)}else this.applyGradients(a);return hi(a),t?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return function(e,t){B(ne(e),(()=>"The f passed in variableGrads(f) must be a function")),B(null==t||Array.isArray(t)&&t.every((e=>e instanceof Ca)),(()=>"The varList passed in variableGrads(f, varList) must be an array of variables"));const n=null!=t;if(!n){t=[];for(const e in Ga.registeredVariables)t.push(Ga.registeredVariables[e])}const r=n?t.filter((e=>!e.trainable)):null,a=t.length;t=t.filter((e=>e.trainable)),B(t.length>0,(()=>"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(a," variables is ")+"trainable."));const{value:i,grads:o}=Ga.gradients(e,t,null,!0);B(o.some((e=>null!=e)),(()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().")),B(0===i.rank,(()=>"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(i.rank," tensor")));const s={};return t.forEach(((e,t)=>{null!=o[t]&&(s[e.name]=o[t])})),null!=r&&r.forEach((e=>s[e.name]=null)),{value:i,grads:s}}(e,t)}dispose(){null!=this.iterations_&&hi(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:Mo(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()))}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Po,Symbol.hasInstance,{value:e=>null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients});class Uo extends Po{static get className(){return"Adadelta"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=Ga.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=Ga.registeredVariables[t],a=!1;null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(t,"/accum_grad"),variable:pi((()=>Fo(r).variable(a)))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:"".concat(t,"/accum_var"),variable:pi((()=>Fo(r).variable(a)))});const i=Array.isArray(e)?e[n].tensor:e[t];if(null==i)return;const o=this.accumulatedGrads[n].variable,s=this.accumulatedUpdates[n].variable;pi((()=>{const e=Eo(Do(o,this.rho),Do(Ao(i),1-this.rho)),t=Do(To(Io(Eo(s,this.epsilon)),Io(Eo(o,this.epsilon))),i),n=Eo(Do(s,this.rho),Do(Ao(t),1-this.rho));o.assign(e),s.assign(n);const a=Eo(Do(t,-this.learningRate),r);r.assign(a)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(hi(this.accumulatedGrads.map((e=>e.variable))),hi(this.accumulatedUpdates.map((e=>e.variable))))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){const t=(e=await this.extractIterations(e)).length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.accumulatedUpdates=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}function Wo(e,t,n){le(e);const r={shape:e,value:t,dtype:n=n||te(t)};return Ga.runKernel(Dt,{},r)}class Vo extends Po{static get className(){return"Adagrad"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=Ga.registeredVariables[t];if(null==this.accumulatedGrads[n]){const e=!1;this.accumulatedGrads[n]={originalName:"".concat(t,"/accumulator"),variable:pi((()=>Wo(r.shape,this.initialAccumulatorValue).variable(e)))}}const a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;const i=this.accumulatedGrads[n].variable;pi((()=>{const e=Eo(i,Ao(a));i.assign(e);const t=Eo(Do(To(a,Io(Eo(e,Ga.backend.epsilon()))),-this.learningRate),r);r.assign(t)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&hi(this.accumulatedGrads.map((e=>e.variable)))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e);this.accumulatedGrads=e.map((e=>({originalName:e.name,variable:e.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}const qo=ri({pow_:function(e,t){let n=ei(e,"base","pow"),r=ei(t,"exp","pow");[n,r]=Ba(n,r);const a={a:n,b:r};return Ga.runKernel(kn,a)}});const jo=ri({sub_:function(e,t){let n=ei(e,"a","sub"),r=ei(t,"b","sub");[n,r]=Ba(n,r);const a={a:n,b:r};return Ga.runKernel(yr,a)}});class Go extends Po{static get className(){return"Adam"}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],pi((()=>{this.accBeta1=Mo(t).variable(),this.accBeta2=Mo(n).variable()})),null==r&&(this.epsilon=Ga.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);pi((()=>{const n=jo(1,this.accBeta1),r=jo(1,this.accBeta2);t.forEach(((t,a)=>{const i=Ga.registeredVariables[t],o=!1;null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:"".concat(t,"/m"),variable:pi((()=>Fo(i).variable(o)))}),null==this.accumulatedSecondMoment[a]&&(this.accumulatedSecondMoment[a]={originalName:"".concat(t,"/v"),variable:pi((()=>Fo(i).variable(o)))});const s=Array.isArray(e)?e[a].tensor:e[t];if(null==s)return;const u=this.accumulatedFirstMoment[a].variable,c=this.accumulatedSecondMoment[a].variable,l=Eo(Do(u,this.beta1),Do(s,1-this.beta1)),p=Eo(Do(c,this.beta2),Do(Ao(s),1-this.beta2)),h=To(l,n),d=To(p,r);u.assign(l),c.assign(p);const f=Eo(Do(To(h,Eo(Io(d),this.epsilon)),-this.learningRate),i);i.assign(f)})),this.accBeta1.assign(Do(this.accBeta1,this.beta1)),this.accBeta2.assign(Do(this.accBeta2,this.beta2))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&hi(this.accumulatedFirstMoment.map((e=>e.variable))),null!=this.accumulatedSecondMoment&&hi(this.accumulatedSecondMoment.map((e=>e.variable)))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e),pi((()=>{this.accBeta1.assign(qo(this.beta1,this.iterations_+1)),this.accBeta2.assign(qo(this.beta2,this.iterations_+1))}));const t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.accumulatedSecondMoment=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}const Ho=ri({abs_:function(e){const t=ei(e,"x","abs");if("complex64"===t.dtype){const e={x:t};return Ga.runKernel(Ye,e)}{const e={x:t};return Ga.runKernel(Ne,e)}}});function Ko(e,t){const n=e.length,r=[];for(let a=0;a<n;a++){const i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function Xo(e,t){const n=[];for(let r=0;r<t.length;r++){const a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function Yo(e,t){const n=Math.max(e.length,t.length),r=new Array(n);for(let a=0;a<n;a++){let i=e[e.length-a-1];null==i&&(i=1);let o=t[t.length-a-1];if(null==o&&(o=1),1===i)r[n-a-1]=o;else if(1===o)r[n-a-1]=i;else{if(i!==o){const n="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(n)}r[n-a-1]=i}}return r}const $o=ri({maximum_:function(e,t){let n=ei(e,"a","maximum"),r=ei(t,"b","maximum");[n,r]=Ba(n,r),"bool"===n.dtype&&(n=No(n,"int32"),r=No(r,"int32")),Yo(n.shape,r.shape);const a={a:n,b:r};return Ga.runKernel(tn,a)}});class Zo extends Po{static get className(){return"Adamax"}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],pi((()=>{this.iteration=Mo(0).variable(),this.accBeta1=Mo(t).variable()})),null==r&&(this.epsilon=Ga.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);pi((()=>{const n=jo(1,this.accBeta1),r=To(-this.learningRate,Eo(Do(this.iteration,this.decay),1));t.forEach(((t,a)=>{const i=Ga.registeredVariables[t],o=!1;null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:"".concat(t,"/m"),variable:Fo(i).variable(o)}),null==this.accumulatedWeightedInfNorm[a]&&(this.accumulatedWeightedInfNorm[a]={originalName:"".concat(t,"/v"),variable:Fo(i).variable(o)});const s=Array.isArray(e)?e[a].tensor:e[t];if(null==s)return;const u=this.accumulatedFirstMoment[a].variable,c=this.accumulatedWeightedInfNorm[a].variable,l=Eo(Do(u,this.beta1),Do(s,1-this.beta1)),p=Do(c,this.beta2),h=Ho(s),d=$o(p,h);u.assign(l),c.assign(d);const f=Eo(Do(To(r,n),To(l,Eo(d,this.epsilon))),i);i.assign(f)})),this.iteration.assign(Eo(this.iteration,1)),this.accBeta1.assign(Do(this.accBeta1,this.beta1))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&hi(this.accumulatedFirstMoment.map((e=>e.variable))),null!=this.accumulatedWeightedInfNorm&&hi(this.accumulatedWeightedInfNorm.map((e=>e.variable)))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}class Qo extends Po{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;const a=Ga.registeredVariables[t];pi((()=>{const e=Eo(Do(this.c,r),a);a.assign(e)}))})),this.incrementIterations()}setLearningRate(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=di(Mo(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(0!==(e=await this.extractIterations(e)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}class Jo extends Qo{static get className(){return"Momentum"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=Mo(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=Ga.registeredVariables[t];if(null==this.accumulations[n]){const e=!1;this.accumulations[n]={originalName:"".concat(t,"/momentum"),variable:pi((()=>Fo(r).variable(e)))}}const a=this.accumulations[n].variable,i=Array.isArray(e)?e[n].tensor:e[t];null!=i&&pi((()=>{let e;const t=Eo(Do(this.m,a),i);e=this.useNesterov?Eo(Do(this.c,Eo(i,Do(t,this.m))),r):Eo(Do(this.c,t),r),a.assign(t),r.assign(e)}))})),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&hi(this.accumulations.map((e=>e.variable)))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e);this.accumulations=e.map((e=>({originalName:e.name,variable:e.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}class es extends Po{static get className(){return"RMSProp"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,null==r&&(this.epsilon=Ga.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map((e=>e.name)):Object.keys(e)).forEach(((t,n)=>{const r=Ga.registeredVariables[t],a=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:"".concat(t,"/rms"),variable:pi((()=>Fo(r).variable(a)))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:"".concat(t,"/momentum"),variable:pi((()=>Fo(r).variable(a)))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:"".concat(t,"/mg"),variable:pi((()=>Fo(r).variable(a)))});const i=Array.isArray(e)?e[n].tensor:e[t];if(null==i)return;const o=this.accumulatedMeanSquares[n].variable,s=this.accumulatedMoments[n].variable;pi((()=>{const e=Eo(Do(o,this.decay),Do(Ao(i),1-this.decay));if(this.centered){const t=this.accumulatedMeanGrads[n].variable,a=Eo(Do(t,this.decay),Do(i,1-this.decay)),u=To(Do(i,this.learningRate),Io(jo(e,Eo(Ao(a),this.epsilon)))),c=Eo(Do(s,this.momentum),u);o.assign(e),t.assign(a),s.assign(c);const l=jo(r,c);r.assign(l)}else{const e=Eo(Do(o,this.decay),Do(Ao(i),1-this.decay)),t=Eo(Do(s,this.momentum),To(Do(i,this.learningRate),Io(Eo(e,this.epsilon))));o.assign(e),s.assign(t);const n=jo(r,t);r.assign(n)}}))})),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&hi(this.accumulatedMeanSquares.map((e=>e.variable))),null!=this.accumulatedMeanGrads&&this.centered&&hi(this.accumulatedMeanGrads.map((e=>e.variable))),null!=this.accumulatedMoments&&hi(this.accumulatedMoments.map((e=>e.variable)))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map((e=>({name:e.originalName,tensor:e.variable}))))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.accumulatedMoments=e.slice(t,2*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map((e=>({originalName:e.name,variable:e.tensor.variable(n)}))))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}const ts=[Uo,Vo,Go,Zo,Jo,es,Qo];function ns(e){return new Promise((e=>setTimeout(e))).then(e)}class rs{constructor(e){if(!ye().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(rs.URL_SCHEME)&&(e=e.slice(rs.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}async save(e){if("undefined"===typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=ui.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const t=Fi(e,[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]),r=window.URL.createObjectURL(new Blob([JSON.stringify(t)],{type:"application/json"})),a=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=r,await ns((()=>a.dispatchEvent(new MouseEvent("click")))),null!=e.weightData){const e=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;e.download=this.weightDataFileName,e.href=n,await ns((()=>e.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:Oi(e)}}}}rs.URL_SCHEME="downloads://";class as{constructor(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(e));this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise(((e,t)=>{const n=new FileReader;n.onload=n=>{const r=JSON.parse(n.target.result),a=r.modelTopology;if(null==a)return void t(new Error("modelTopology field is missing from file ".concat(this.jsonFile.name)));if(null==r.weightsManifest)return void t(new Error("weightManifest field is missing from file ".concat(this.jsonFile.name)));if(0===this.weightsFiles.length)return void e({modelTopology:a});const i=Mi(r,(e=>this.loadWeights(e)));e(i)},n.onerror=e=>t("Failed to read model topology and weights manifest JSON "+"from file '".concat(this.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only."),n.readAsText(this.jsonFile)}))}loadWeights(e){const t=[],n=[];for(const i of e)t.push(...i.weights),n.push(...i.paths);const r=this.checkManifestAndWeightFiles(e),a=n.map((e=>this.loadWeightsFile(e,r[e])));return Promise.all(a).then((e=>[t,e]))}loadWeightsFile(e,t){return new Promise(((n,r)=>{const a=new FileReader;a.onload=e=>{const t=e.target.result;n(t)},a.onerror=t=>r("Failed to weights data from file of path '".concat(e,"'.")),a.readAsArrayBuffer(t)}))}checkManifestAndWeightFiles(e){const t=[],n=this.weightsFiles.map((e=>Ai(e.name))),r={};for(const a of e)a.paths.forEach((e=>{const a=Ai(e);if(-1!==t.indexOf(a))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(a,"'"));if(t.push(a),-1===n.indexOf(a))throw new Error("Weight file with basename '".concat(a,"' is not provided."));r[e]=this.weightsFiles[n.indexOf(a)]}));if(t.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(t.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return r}}function is(e){return new as(e)}function os(e,t,n,r){!function(e){B(null!=e&&Array.isArray(e)&&e.length>0,(()=>"promises must be a none empty array"))}(e),function(e,t){B(e>=0&&e<=1,(()=>"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e))),B(t>=0&&t<=1,(()=>"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t))),B(t>=e,(()=>"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t)))}(n=null==n?0:n,r=null==r?1:r);let a=0;return Promise.all(e.map((i=>(i.then((i=>{const o=n+ ++a/e.length*(r-n);return t(o),i})),i))))}async function ss(e,t){null==t&&(t={});const n=null==t.fetchFunc?ye().platform.fetch:t.fetchFunc,r=e.map((e=>n(e,t.requestInit,{isBinary:!0}))),a=(null==t.onProgress?await Promise.all(r):await os(r,t.onProgress,0,.5)).map((e=>e.arrayBuffer()));return null==t.onProgress?await Promise.all(a):await os(a,t.onProgress,.5,1)}async function us(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return cs((e=>ss(e,{requestInit:r})))(e,t,n)}function cs(e){return async function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;const a=t.map((()=>!1)),i={},o=null!=r?r.map((()=>!1)):[],s=[];if(t.forEach(((e,t)=>{let n=0;e.weights.forEach((e=>{const u="quantization"in e?e.quantization.dtype:e.dtype,c=si[u]*U(e.shape),l=()=>{a[t]=!0,null==i[t]&&(i[t]=[]),i[t].push({manifestEntry:e,groupOffset:n,sizeBytes:c})};null!=r?r.forEach(((t,n)=>{t===e.name&&(l(),o[n]=!0)})):l(),s.push(e.name),n+=c}))})),!o.every((e=>e))){const e=r.filter(((e,t)=>!o[t]));throw new Error("Could not find weights in manifest with names: "+"".concat(e.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(s.join(", "),"."))}const u=a.reduce(((e,t,n)=>(t&&e.push(n),e)),[]),c=[];u.forEach((e=>{t[e].paths.forEach((e=>{const t=n+(n.endsWith("/")?"":"/")+e;c.push(t)}))}));const l=await e(c),p={};let h=0;return u.forEach((e=>{const n=t[e].paths.length,r=new ui(l.slice(h,h+n));i[e].forEach((e=>{const t=xi(r.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(const n in t)p[n]=t[n]})),h+=n})),p}}zi.registerSaveRouter((e=>ye().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(rs.URL_SCHEME)?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new rs(e)}(e.slice(rs.URL_SCHEME.length)):null));class ls{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?(B("function"===typeof t.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=t.fetchFunc):this.fetch=ye().platform.fetch,B(null!=e&&e.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(e)&&B(2===e.length,(()=>"URL paths for http must have a length of 2, "+"(actual length is ".concat(e.length,")."))),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const n=Fi(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);if(t.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=e.weightData){const n=ui.join(e.weightData);t.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}const r=await this.fetch(this.path,t);if(r.ok)return{modelArtifactsInfo:Oi(e),responses:[r]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(r.status,"."))}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(e.status,". Please verify this URL points to ")+"the model JSON of the model to load.");let t;try{t=await e.json()}catch(Z2){let t="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=t.modelTopology,r=t.weightsManifest;if(null==n&&null==r)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();return Mi(await this.loadModelJSON(),(e=>this.loadWeights(e)))}async loadStream(){const e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=Ri(e.weightsManifest);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:()=>function(e,t){var n;const r=null==t.fetchFunc?ye().platform.fetch:t.fetchFunc;let a,i=0;return null===(n=t.onProgress)||void 0===n||n.call(t,0),new ReadableStream({pull:async n=>{for(var o;i<e.length;){if(!a){const n=(await r(e[i],t.requestInit,{isBinary:!0})).body;a=n.getReader()}const{done:s,value:u}=await a.read();if(!s)return void n.enqueue(u);i++,a=void 0,null===(o=t.onProgress)||void 0===o||o.call(t,i/e.length)}n.close()}})}(t,this.loadOptions)})}async getWeightUrls(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),a=n>t?e.substring(n):"";return[r+"/",a]}(t),a=this.weightPathPrefix||n,i=[],o=[];for(const s of e)for(const e of s.paths)null!=this.weightUrlConverter?o.push(this.weightUrlConverter(e)):i.push(a+e+r);return this.weightUrlConverter&&i.push(...await Promise.all(o)),i}async loadWeights(e){const t=await this.getWeightUrls(e);return[Ri(e),await ss(t,this.loadOptions)]}}function ps(e){return null!=e.match(ls.URL_SCHEME_REGEX)}ls.URL_SCHEME_REGEX=/^https?:\/\//;const hs=(e,t)=>{if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;{let n=!0;if(n=Array.isArray(e)?e.every((e=>ps(e))):ps(e),n)return ds(e,t)}return null};function ds(e,t){return new ls(e,t)}function fs(e,t){return ds(e,t)}zi.registerSaveRouter(hs),zi.registerLoadRouter(hs);class ms{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class gs{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class ys{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function vs(e,t,n,r){return new ys(bs(...arguments))}function bs(e,t,n,r){if(1===arguments.length){return null!=e.modelTopology||null!=e.weightSpecs?new ms(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new ms({modelTopology:e}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new ms({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r})}function xs(e){return new gs(e)}function ws(e){return new gs(e)}function Ns(e,t,n){if(P(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");const r=Za(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ii(e,t,r,n)}let Ss;function ks(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,a=!1,i=!1,o=!1,s=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else if(null!=e.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));s=!0}if(null!=Lr(Ir,Ga.backendName)){const n={pixels:e},r={numChannels:t};return Ga.runKernel(Ir,n,r)}const[u,c]=a?[e.videoWidth,e.videoHeight]:[e.width,e.height];let l,p;if(o)l=e.getContext("2d").getImageData(0,0,u,c).data;else if(r||n)l=e.data;else if(i||a||s){if(null==Ss)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");Ss=new OffscreenCanvas(1,1).getContext("2d")}else Ss=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Ss.canvas.width=u,Ss.canvas.height=c,Ss.drawImage(e,0,0,u,c),l=Ss.getImageData(0,0,u,c).data}if(4===t)p=new Int32Array(l);else{const e=u*c;p=new Int32Array(e*t);for(let n=0;n<e;n++)for(let e=0;e<t;++e)p[n*t+e]=l[4*n+e]}return Ns(p,[c,u,t],"int32")}const Es=ri({fromPixels_:ks}),Cs=-2,Ts=-1;function Ds(e,t,n){const r=e.shape.length;B(r===t.length,(()=>"Error in slice".concat(r,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(r,")."))),B(r===n.length,(()=>"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")));for(let a=0;a<r;++a)B(t[a]+n[a]<=e.shape[a],(()=>"Error in slice".concat(r,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(t[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(e.shape[a],")")))}function Is(e){const t=[];let n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t}function As(e,t,n){const r=[];for(let a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function Fs(e,t,n,r){const a=[...e];for(let i=a.length;i<r.length;i++)a.push(1);for(let i=0;i<n;i++)0===i?a[t]=1:(a.splice(t,0,1),a.pop());return a}function _s(e,t,n){return n<=e?n:n-(t-1)}function Ms(e,t){const n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function Os(e,t,n,r,a,i,o,s,u){const c=e.length;let l=new Array(c),p=new Array(c),h=new Array(c);if(t.length&&n>0){const u=t[0],c=n+1;l=Rs(o,u,c,r,e),p=zs(s,u,c,a,e),h=Fs(i,u,c,e)}else for(let d=0;d<c;d++)l[d]=Ls(o,r,i,e,d,u),p[d]=Ps(s,a,i,e,d,u),h[d]=Bs(i,d,u);return{begin:l,end:p,strides:h}}function Rs(e,t,n,r,a){const i=[...a],o=Ms(n,t);for(let s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=0;else{const a=_s(t,n,s);let o=r[a];e&1<<a&&(o=0),i[s]=o}return i}function zs(e,t,n,r,a){const i=[...a],o=Ms(n,t);for(let s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=Number.MAX_SAFE_INTEGER;else{const a=_s(t,n,s);let o=r[a];e&1<<a&&(o=Number.MAX_SAFE_INTEGER),i[s]=o}for(let s=0;s<i.length;s++){const e=a[s];i[s]<0&&(i[s]+=e),i[s]=O(0,i[s],a[s])}return i}function Bs(e,t,n){let r=e[t];return(n&1<<t||null==r)&&(r=1),r}function Ls(e,t,n,r,a,i){let o=t[a];const s=n[a]||1;(e&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const u=r[a];return o<0&&(o+=u),o=O(0,o,u-1),o}function Ps(e,t,n,r,a,i){let o=t[a];const s=n[a]||1;(e&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const u=r[a];return o<0&&(o+=u),o=s>0?O(0,o,u):O(-1,o,u-1),o}function Us(e,t,n){let r=n.length;for(let a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(let a=r+1;a<n.length;a++)if(t[a]>0||n[a]!==e[a])return!1;return!0}function Ws(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function Vs(e,t,n){let r;const a=e.shape.length;let i;return r="number"===typeof t?[t,...new Array(a-1).fill(0)]:t.length<a?t.concat(new Array(a-t.length).fill(0)):t.slice(),r.forEach((e=>{B(-1!==e,(()=>"slice() does not support negative begin indexing."))})),i=null==n?new Array(a).fill(-1):"number"===typeof n?[n,...new Array(a-1).fill(-1)]:n.length<a?n.concat(new Array(a-n.length).fill(-1)):n,i=i.map(((t,n)=>t>=0?t:(B(-1===t,(()=>"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,"."))),e.shape[n]-r[n]))),[r,i]}function qs(e,t,n,r,a,i,o,s,u){let c;if(null==r?(c=new Array(t.length),c.fill(1)):c=r,null!=o&&0!==(o&o-1))throw new Error("Multiple ellipses in slice is not allowed.");let l=!1;const p={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u};for(let v=0;v<p.dims;v++)l&&0!==(1<<v&s)&&p.numAddAxisAfterEllipsis++,1<<v&o&&(l=!0);l||(p.ellipsisMask|=1<<p.dims,p.dims++);const h={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){const a=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<a;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(Cs),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(t.dims," dims, ").concat(t.begin.length,"."));null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(Ts),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(p,h);let d=!0,f=!0,m=!0;const g=[],y=[];for(let v=0;v<e.length;++v){if(0===h.strides[v])throw Error("strides[".concat(v,"] must be non-zero"));const t=!!(h.shrinkAxisMask&1<<v),n=e[v];if(-1===n){g.push(t?1:-1);continue}const r=[h.beginMask&1<<v,h.endMask&1<<v],a=[h.strides[v]>0?0:-1,h.strides[v]>0?n:n-1];if(t&&h.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&1===h.strides[v];const i=!!(h.beginMask&1<<v&&h.endMask&1<<v);if(h.beginValid&&h.endValid){if(t){const e=h.begin[v]<0?n+h.begin[v]:h.begin[v];if(h.begin[v]=e,h.end[v]=h.begin[v]+1,e<0||e>=n)throw Error("slice index ".concat(h.begin[v]," of dimension ").concat(v," out of bounds."))}else h.begin[v]=js(h.begin[v],0,h.strides[v],n,r,a),h.end[v]=js(h.end[v],1,h.strides[v],n,r,a);const e=1===h.strides[v]&&0===h.begin[v]&&h.end[v]===n;d=d&&e,f=f&&(0===v&&1===h.strides[v]||e)}else d=d&&1===h.strides[v]&&i,f=f&&(0===v&&1===h.strides[v]||i);let o,s=!1;if(h.beginValid&&h.endValid?(o=h.end[v]-h.begin[v],s=!0):t?(o=1,s=!0):i&&n>=0&&(o=h.strides[v]<0?-n:n,s=!0),s){let e;e=0===o||o<0!==h.strides[v]<0?0:Math.trunc(o/h.strides[v])+(o%h.strides[v]!==0?1:0),g.push(e)}else g.push(-1)}for(let v=0;v<h.finalShapeGatherIndices.length;++v){const e=h.finalShapeGatherIndices[v];e>=0?y.push(g[e]):e===Cs&&y.push(1)}return{finalShapeSparse:y.filter(((e,t)=>h.finalShapeGatherIndices[t]!==Cs)),finalShape:y,isIdentity:d,sliceDim0:f,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function js(e,t,n,r,a,i){if(a[t])return n>0?i[t]:i[t+1&1];{const t=e<0?r+e:e;return t<i[0]?i[0]:t>i[1]?i[1]:t}}const Gs=ri({acos_:function(e){const t={x:ei(e,"x","acos")};return Ga.runKernel(Se,t)}});const Hs=ri({acosh_:function(e){const t={x:ei(e,"x","acosh")};return Ga.runKernel(ke,t)}});const Ks=ri({addN_:function(e){B(Array.isArray(e),(()=>"The argument passed to tf.addN() must be a list of tensors")),B(e.length>=1,(()=>"Must pass at least one tensor to tf.addN(), but got "+"".concat(e.length)));const t=e.map(((e,t)=>ei(e,"tensors".concat(t),"addN"))),n=t[0];t.forEach((e=>{if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((e=>{if(!W(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));const r=t;return Ga.runKernel(Ce,r)}});const Xs=ri({all_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:ei(e,"x","all","bool")},a={axis:t,keepDims:n};return Ga.runKernel(Te,r,a)}});const Ys=ri({any_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:ei(e,"x","any","bool")},a={axis:t,keepDims:n};return Ga.runKernel(De,r,a)}});const $s=ri({argMax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:ei(e,"x","argMax")},r={axis:t};return Ga.runKernel(Ie,n,r)}});const Zs=ri({argMin_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:ei(e,"x","argMin")},r={axis:t};return Ga.runKernel(Ae,n,r)}});const Qs=ri({asin_:function(e){const t={x:ei(e,"x","asin")};return Ga.runKernel(Fe,t)}});const Js=ri({asinh_:function(e){const t={x:ei(e,"x","asinh")};return Ga.runKernel(_e,t)}});const eu=ri({atan_:function(e){const t={x:ei(e,"x","atan")};return Ga.runKernel(Me,t)}});const tu=ri({atan2_:function(e,t){let n=ei(e,"a","atan2"),r=ei(t,"b","atan2");[n,r]=Ba(n,r);const a={a:n,b:r};return Ga.runKernel(Re,a)}});const nu=ri({atanh_:function(e){const t={x:ei(e,"x","atanh")};return Ga.runKernel(Oe,t)}});function ru(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5?arguments[5]:void 0;return ou(e,[...t,e[3]],n,i,r,null,null,gu(a))}function au(e,t,n,r,a,i){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast";const[s,u]=cu(t);let c;if("channelsLast"===o)c=[s,u,e[3],e[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));c=[s,u,e[1],e[1]]}return ou(e,c,n,r,a,i,!1,o)}function iu(e,t,n,r,a,i){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC";const[s,u,c]=lu(t);let l,p;if("NDHWC"===o)p="channelsLast",l=[s,u,c,e[4],e[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat ".concat(o));p="channelsFirst",l=[s,u,c,e[1],e[1]]}return su(e,l,n,r,a,!1,p,i)}function ou(e,t,n,r,a,i){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[u,c,l,p]=[-1,-1,-1,-1];if("channelsLast"===s)[u,c,l,p]=e;else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));[u,p,c,l]=e}const[h,d,,f]=t,[m,g]=cu(n),[y,v]=cu(r),b=pu(h,y),x=pu(d,v),{padInfo:w,outHeight:N,outWidth:S}=function(e,t,n,r,a,i,o,s,u){let c,l,p;if("number"===typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};const a=function(e,t,n,r,a){null==r&&(r=uu(e,t,n));const i=e[0],o=e[1],s=hu((i-t+2*r)/n+1,a),u=hu((o-t+2*r)/n+1,a);return[s,u]}([t,n],i,r,e,s);l=a[0],p=a[1]}else if("same"===e){l=Math.ceil(t/r),p=Math.ceil(n/a);const e=Math.max(0,(l-1)*r+i-t),s=Math.max(0,(p-1)*a+o-n),u=Math.floor(e/2),h=e-u,d=Math.floor(s/2);c={top:u,bottom:h,left:d,right:s-d,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-i+1)/r),p=Math.ceil((n-o+1)/a);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));{const h="channelsLast"===u?e[1][0]:e[2][0],d="channelsLast"===u?e[1][1]:e[2][1],f="channelsLast"===u?e[2][0]:e[3][0],m="channelsLast"===u?e[2][1]:e[3][1];c={top:h,bottom:d,left:f,right:m,type:0===h&&0===d&&0===f&&0===m?"VALID":"EXPLICIT"},l=hu((t-i+h+d)/r+1,s),p=hu((n-o+f+m)/a+1,s)}}return{padInfo:c,outHeight:l,outWidth:p}}(a,c,l,m,g,b,x,i,s),k=o?f*p:f;let E;return"channelsFirst"===s?E=[u,k,N,S]:"channelsLast"===s&&(E=[u,N,S,k]),{batchSize:u,dataFormat:s,inHeight:c,inWidth:l,inChannels:p,outHeight:N,outWidth:S,outChannels:k,padInfo:w,strideHeight:m,strideWidth:g,filterHeight:h,filterWidth:d,effectiveFilterHeight:b,effectiveFilterWidth:x,dilationHeight:y,dilationWidth:v,inShape:e,outShape:E,filterShape:t}}function su(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,[u,c,l,p,h]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[u,c,l,p,h]=e;else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));[u,h,c,l,p]=e}const[d,f,m,,g]=t,[y,v,b]=lu(n),[x,w,N]=lu(r),S=pu(d,x),k=pu(f,w),E=pu(m,N),{padInfo:C,outDepth:T,outHeight:D,outWidth:I}=function(e,t,n,r,a,i,o,s,u,c,l){let p,h,d,f;"valid"===e&&(e=0);if("number"===typeof e){p={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};const m=function(e,t,n,r,a,i){null==a&&(a=uu(e,t[0],r[0]));const o=[0,0,0,n];for(let s=0;s<3;s++)e[s]+2*a>=t[s]&&(o[s]=hu((e[s]-t[s]+2*a)/r[s]+1,i));return o}([t,n,r,1],[s,u,c],1,[a,i,o],e,l);h=m[0],d=m[1],f=m[2]}else{if("same"!==e)throw Error("Unknown padding parameter: ".concat(e));{h=Math.ceil(t/a),d=Math.ceil(n/i),f=Math.ceil(r/o);const e=(h-1)*a+s-t,l=(d-1)*i+u-n,m=(f-1)*o+c-r,g=Math.floor(e/2),y=e-g,v=Math.floor(l/2),b=l-v,x=Math.floor(m/2);p={top:v,bottom:b,left:x,right:m-x,front:g,back:y,type:"SAME"}}}return{padInfo:p,outDepth:h,outHeight:d,outWidth:f}}(a,c,l,p,y,v,b,S,k,E,s),A=i?g*h:g;let F;return"channelsFirst"===o?F=[u,A,T,D,I]:"channelsLast"===o&&(F=[u,T,D,I,A]),{batchSize:u,dataFormat:o,inDepth:c,inHeight:l,inWidth:p,inChannels:h,outDepth:T,outHeight:D,outWidth:I,outChannels:A,padInfo:C,strideDepth:y,strideHeight:v,strideWidth:b,filterDepth:d,filterHeight:f,filterWidth:m,effectiveFilterDepth:S,effectiveFilterHeight:k,effectiveFilterWidth:E,dilationDepth:x,dilationHeight:w,dilationWidth:N,inShape:e,outShape:F,filterShape:t}}function uu(e,t,n){const r=pu(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((e[0]*(n-1)-n+r)/2)}function cu(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function lu(e){return"number"===typeof e?[e,e,e]:e}function pu(e,t){return t<=1?e:e+(e-1)*(t-1)}function hu(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function du(e){const[t,n,r]=cu(e);return 1===t&&1===n&&1===r}function fu(e,t){return du(e)||du(t)}function mu(e){return cu(e).every((e=>e>0))}function gu(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}function yu(e,t,n){if(null!=n){if("string"===typeof t)throw Error("Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));if("number"===typeof t)B(V(t),(()=>"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")));else{if("object"!==typeof t)throw Error("Error in ".concat(e,": Unknown padding parameter: ").concat(t));t.forEach((t=>{t.forEach((t=>{B(V(t),(()=>"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")))}))}))}}}const vu=ri({reshape_:function(e,t){const n={x:ei(e,"x","reshape","string_or_numeric")},r={shape:t};return Ga.runKernel(On,n,r)}});const bu=ri({avgPool_:function(e,t,n,r,a){const i=ei(e,"x","avgPool","float32");B(fu(n,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")));let o=i,s=!1;3===i.rank&&(s=!0,o=vu(i,[1,i.shape[0],i.shape[1],i.shape[2]])),B(4===o.rank,(()=>"Error in avgPool: x must be rank 4 but got rank ".concat(o.rank,"."))),yu("avgPool",r,a);const u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a};let l=Ga.runKernel(ze,u,c);return l=No(l,i.dtype),s?vu(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});const xu=ri({avgPool3d_:function(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const o=ei(e,"x","avgPool3d","float32");let s=o,u=!1;4===o.rank&&(u=!0,s=vu(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),B(5===s.rank,(()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,"."))),B("NDHWC"===i,(()=>"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i))),B("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(()=>"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'"))),yu("avgPool3d",r,a);const c={x:s},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i};let p=Ga.runKernel(Le,c,l);return p=No(p,s.dtype),u?vu(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}});const wu=ri({concat_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;B(e.length>=1,(()=>"Pass at least one tensor to concat"));const n=ti(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((e=>{if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))})),1===n.length)return So(n[0]);const r=n,a={axis:t};return Ga.runKernel($e,r,a)}});const Nu=ri({matMul_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=ei(e,"a","matMul"),i=ei(t,"b","matMul");[a,i]=Ba(a,i);const o={a:a,b:i},s={transposeA:n,transposeB:r};return Ga.runKernel(Ue,o,s)}});const Su=ri({sigmoid_:function(e){const t={x:ei(e,"x","sigmoid","float32")};return Ga.runKernel(Qn,t)}});const ku=ri({slice_:function(e,t,n){const r=ei(e,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");const a={x:r},i={begin:t,size:n};return Ga.runKernel(Xn,a,i)}});const Eu=ri({tanh_:function(e){const t={x:ei(e,"x","tanh","float32")};return Ga.runKernel(br,t)}});const Cu=ri({basicLSTMCell_:function(e,t,n,r,a,i){const o=ei(e,"forgetBias","basicLSTMCell"),s=ei(t,"lstmKernel","basicLSTMCell"),u=ei(n,"lstmBias","basicLSTMCell"),c=ei(r,"data","basicLSTMCell"),l=ei(a,"c","basicLSTMCell"),p=ei(i,"h","basicLSTMCell"),h=wu([c,p],1),d=Nu(h,s),f=Eo(d,u),m=f.shape[0],g=f.shape[1]/4,y=[m,g],v=ku(f,[0,0],y),b=ku(f,[0,g],y),x=ku(f,[0,2*g],y),w=ku(f,[0,3*g],y),N=Eo(Do(Su(v),Eu(b)),Do(l,Su(Eo(o,x))));return[N,Do(Eu(N),Su(w))]}});const Tu=ri({batchToSpaceND_:function(e,t,n){const r=ei(e,"x","batchToSpaceND"),a=t.reduce(((e,t)=>e*t));B(r.rank>=1+t.length,(()=>"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(t.length))),B(n.length===t.length,(()=>"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length))),B(r.shape[0]%a===0,(()=>"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(a)));const i={x:r},o={blockShape:t,crops:n};return Ga.runKernel(We,i,o)}});const Du=ri({batchNorm_:function(e,t,n,r,a,i){null==i&&(i=.001);const o=ei(e,"x","batchNorm"),s=ei(t,"mean","batchNorm"),u=ei(n,"variance","batchNorm");let c,l;null!=a&&(c=ei(a,"scale","batchNorm")),null!=r&&(l=ei(r,"offset","batchNorm")),B(s.rank===u.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),B(null==l||s.rank===l.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),B(null==c||s.rank===c.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const p={x:function(e){let t;return t=0===e.rank||1===e.rank?vu(e,[1,1,1,e.size]):2===e.rank?vu(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?vu(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e,t}(o),scale:c,offset:l,mean:s,variance:u},h={varianceEpsilon:i},d=Ga.runKernel(_t,p,h);return vu(d,o.shape)}});const Iu=ri({batchNorm2d_:function(e,t,n,r,a,i){const o=ei(e,"x","batchNorm"),s=ei(t,"mean","batchNorm"),u=ei(n,"variance","batchNorm");let c,l;return null!=a&&(c=ei(a,"scale","batchNorm")),null!=r&&(l=ei(r,"offset","batchNorm")),B(2===o.rank,(()=>"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(o.rank,"."))),B(2===s.rank||1===s.rank,(()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(s.rank,"."))),B(2===u.rank||1===u.rank,(()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,"."))),null!=c&&B(2===c.rank||1===c.rank,(()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=l&&B(2===l.rank||1===l.rank,(()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,"."))),Du(o,s,u,l,c,i)}});const Au=ri({batchNorm3d_:function(e,t,n,r,a,i){const o=ei(e,"x","batchNorm"),s=ei(t,"mean","batchNorm"),u=ei(n,"variance","batchNorm");let c,l;return null!=a&&(c=ei(a,"scale","batchNorm")),null!=r&&(l=ei(r,"offset","batchNorm")),B(3===o.rank,(()=>"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(o.rank,"."))),B(3===s.rank||1===s.rank,(()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(s.rank,"."))),B(3===u.rank||1===u.rank,(()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,"."))),null!=c&&B(3===c.rank||1===c.rank,(()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=l&&B(3===l.rank||1===l.rank,(()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,"."))),Du(o,s,u,l,c,i)}});const Fu=ri({batchNorm4d_:function(e,t,n,r,a,i){const o=ei(e,"x","batchNorm"),s=ei(t,"mean","batchNorm"),u=ei(n,"variance","batchNorm");let c,l;return null!=a&&(c=ei(a,"scale","batchNorm")),null!=r&&(l=ei(r,"offset","batchNorm")),B(4===o.rank,(()=>"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(o.rank,"."))),B(4===s.rank||1===s.rank,(()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(s.rank,"."))),B(4===u.rank||1===u.rank,(()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,"."))),null!=c&&B(4===c.rank||1===c.rank,(()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=l&&B(4===l.rank||1===l.rank,(()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,"."))),Du(o,s,u,l,c,i)}});const _u=ri({bincount_:function(e,t,n){const r=ei(e,"x","bincount"),a=ei(t,"weights","bincount");B("int32"===r.dtype,(()=>"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype))),B(n>=0,(()=>"size must be non-negative, but got ".concat(n,"."))),B(a.size===r.size||0===a.size,(()=>"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(a.shape,".")));const i={x:r,weights:a},o={size:n};return Ga.runKernel(Ve,i,o)}});const Mu=ri({bitwiseAnd_:function(e,t){const n=ei(e,"x","bitwiseAnd"),r=ei(t,"y","bitwiseAnd");if(!W(n.shape,r.shape))throw new Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(n.shape,", y: ").concat(r.shape));if("int32"!==n.dtype||"int32"!==r.dtype)throw new Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(n.dtype," and type of y: ").concat(r.dtype));const a={a:n,b:r};return Ga.runKernel(qe,a)}});const Ou=ri({broadcastArgs_:function(e,t){const n=ei(e,"s0","broadcastArgs","int32"),r=ei(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(n.rank));if(1!==r.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(r.rank));const a={s0:n,s1:r};return Ga.runKernel(je,a)}});const Ru=ri({broadcastTo_:function(e,t){let n=ei(e,"broadcastTo","x");const r=n.shape;if(le(t),t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){const e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=vu(n,e)}const a=n.shape,i=Array.from(t);for(let u=t.length-1;u>=0;u--)if(a[u]===t[u])i[u]=1;else if(1!==n.shape[u])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(t,"]."));if(0===i.map(((e,t)=>e>1?t:-1)).filter((e=>e>=0)).length)return So(n);const o={x:n},s={reps:i};return Ga.runKernel(xr,o,s)}});const zu=ri({ceil_:function(e){const t={x:ei(e,"x","ceil","float32")};return Ga.runKernel(He,t)}});const Bu=ri({clipByValue_:function(e,t,n){const r=ei(e,"x","clipByValue");if(B(t<=n,(()=>"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,")."))),t===n)return Wo(r.shape,t,r.dtype);const a={x:r},i={clipValueMin:t,clipValueMax:n};return Ga.runKernel(Ke,a,i)}});const Lu=ri({concat1d_:function(e){return wu(e,0)}});const Pu=ri({concat2d_:function(e,t){return wu(e,t)}});const Uu=ri({concat3d_:function(e,t){return wu(e,t)}});const Wu=ri({concat4d_:function(e,t){return wu(e,t)}});const Vu=ri({conv2d_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0;const s=ei(e,"x","conv2d","float32"),u=ei(t,"filter","conv2d","float32");let c=s,l=!1;3===s.rank&&(l=!0,c=vu(s,[1,s.shape[0],s.shape[1],s.shape[2]])),B(4===c.rank,(()=>"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,"."))),B(4===u.rank,(()=>"Error in conv2d: filter must be rank 4, but got rank "+"".concat(u.rank,"."))),yu("conv2d",r,o);const p="NHWC"===a?c.shape[3]:c.shape[1];B(p===u.shape[2],(()=>"Error in conv2d: depth of input (".concat(p,") must match ")+"input depth for filter ".concat(u.shape[2],"."))),B(fu(n,i),(()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'"))),B(mu(i),(()=>"Error in conv2D: Dilated rates should be larger than 0.")),B(mu(n),(()=>"Error in conv2D: Strides should be larger than 0."));const h={x:c,filter:u},d={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},f=Ga.runKernel(Ze,h,d);return l?vu(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const qu=ri({conv1d_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0;const s=ei(e,"x","conv1d"),u=ei(t,"filter","conv1d");let c=s,l=!1;2===s.rank&&(l=!0,c=vu(s,[1,s.shape[0],s.shape[1]])),B(3===c.rank,(()=>"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,"."))),B(3===u.rank,(()=>"Error in conv1d: filter must be rank 3, but got rank "+"".concat(u.rank,"."))),yu("conv1d",r,o),B(c.shape[2]===u.shape[1],(()=>"Error in conv1d: depth of input (".concat(c.shape[2],") must match ")+"input depth for filter ".concat(u.shape[1],"."))),B(fu(n,i),(()=>"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(i,"'"))),B(mu(i),(()=>"Error in conv1D: Dilated rates should be larger than 0.")),B(mu(n),(()=>"Error in conv1D: Stride should be larger than 0.")),B("NWC"===a,(()=>"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported.")));const p=vu(u,[1,u.shape[0],u.shape[1],u.shape[2]]),h=vu(c,[c.shape[0],1,c.shape[1],c.shape[2]]),d=Vu(h,p,[1,n],r,"NHWC",[1,i],o);return vu(d,l?[d.shape[2],d.shape[3]]:[d.shape[0],d.shape[2],d.shape[3]])}});const ju=ri({conv2DBackpropInput_:function(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0;B(e.length===t.rank,(()=>"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")));let s=e,u=t,c=!1;3===t.rank&&(c=!0,u=vu(t,[1,t.shape[0],t.shape[1],t.shape[2]]),s=[1,e[0],e[1],e[2]]),B(4===s.length,(()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,"."))),B(4===u.rank,(()=>"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(u.rank))),B(4===n.rank,(()=>"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)));const l="NHWC"===i?s[3]:s[1],p="NHWC"===i?u.shape[3]:u.shape[1];B(l===n.shape[2],(()=>"Error in conv2dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[2],"."))),B(p===n.shape[3],(()=>"Error in conv2dDerInput: depth of output (".concat(p,") must ")+"match output depth for filter ".concat(n.shape[3],"."))),yu("conv2dDerInput",a,o);const h={dy:u,filter:n},d={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,inputShape:s},f=Ga.runKernel(Je,h,d);return c?vu(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const Gu=ri({conv2dTranspose_:function(e,t,n,r,a,i){const o=ei(e,"x","conv2dTranspose"),s=ei(t,"filter","conv2dTranspose");return ju(n,o,s,r,a,"NHWC",i)}});const Hu=ri({conv3d_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1];const o=ei(e,"x","conv3d"),s=ei(t,"filter","conv3d");let u=o,c=!1;4===o.rank&&(c=!0,u=vu(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),B(5===u.rank,(()=>"Error in conv3d: input must be rank 5, but got rank ".concat(u.rank,"."))),B(5===s.rank,(()=>"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,"."))),B(u.shape[4]===s.shape[3],(()=>"Error in conv3d: depth of input (".concat(u.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],"."))),B(fu(n,i),(()=>"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'"))),B("NDHWC"===a,(()=>"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported."))),B(mu(i),(()=>"Error in conv3D: Dilated rates should be larger than 0.")),B(mu(n),(()=>"Error in conv3D: Strides should be larger than 0."));const l={x:u,filter:s},p={strides:n,pad:r,dataFormat:a,dilations:i},h=Ga.runKernel(et,l,p);return c?vu(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const Ku=ri({conv3DBackpropInput_:function(e,t,n,r,a){B(e.length===t.rank,(()=>"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")));let i=e,o=t,s=!1;4===t.rank&&(s=!0,o=vu(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),i=[1,e[0],e[1],e[2],e[3]]);const u=i[4],c=o.shape[4];B(5===i.length,(()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(i.length,"."))),B(5===o.rank,(()=>"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(o.rank))),B(5===n.rank,(()=>"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank))),B(u===n.shape[3],(()=>"Error in conv3dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[3],"."))),B(c===n.shape[4],(()=>"Error in conv3dDerInput: depth of output (".concat(c,") must ")+"match output depth for filter ".concat(n.shape[4],".")));const l={dy:o,filter:n},p={pad:a,strides:r,inputShape:i},h=Ga.runKernel(nt,l,p);return s?vu(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const Xu=ri({conv3dTranspose_:function(e,t,n,r,a){const i=ei(e,"x","conv3dTranspose"),o=ei(t,"filter","conv3dTranspose");return Ku(n,i,o,r,a)}});const Yu=ri({cos_:function(e){const t={x:ei(e,"x","cos","float32")};return Ga.runKernel(rt,t)}});const $u=ri({cosh_:function(e){const t={x:ei(e,"x","cosh","float32")};return Ga.runKernel(at,t)}});const Zu=ri({cumprod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a={x:ei(e,"x","cumprod")},i={axis:t,exclusive:n,reverse:r};return Ga.runKernel(it,a,i)}});const Qu=ri({cumsum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a={x:ei(e,"x","cumsum")},i={axis:t,exclusive:n,reverse:r};return Ga.runKernel(ot,a,i)}});const Ju=ri({denseBincount_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=ei(e,"x","denseBincount"),i=ei(t,"weights","denseBincount");B("int32"===a.dtype,(()=>"Error in denseBincount: input "+"dtype must be int32, but got ".concat(a.dtype))),B(a.rank<=2,(()=>"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(a.rank,"."))),B(n>=0,(()=>"size must be non-negative, but got ".concat(n,"."))),B(i.size===a.size||0===i.size,(()=>"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(a.shape,", weights shape: ")+"".concat(i.shape,".")));const o={x:a,weights:i},s={size:n,binaryOutput:r};return Ga.runKernel(ut,o,s)}});const ec=ri({depthToSpace_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC";const r=ei(e,"x","depthToSpace","float32"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];B(t>1,(()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(t))),B(a*t>=0,(()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(r.shape))),B(i*t>=0,(()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(t," for depthToSpace with input shape\n        ").concat(r.shape))),B(o%(t*t)===0,(()=>"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(o," for depthToSpace with input shape ").concat(r.shape)));const s={x:r},u={blockSize:t,dataFormat:n};return Ga.runKernel(ct,s,u)}});const tc=ri({depthwiseConv2d_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0;const s=ei(e,"x","depthwiseConv2d","float32"),u=ei(t,"filter","depthwiseConv2d","float32");let c=s,l=!1;3===s.rank&&(l=!0,c=vu(s,[1,s.shape[0],s.shape[1],s.shape[2]])),B(4===c.rank,(()=>"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,"."))),B(4===u.rank,(()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")));const p="NHWC"===a?c.shape[3]:c.shape[1];B(p===u.shape[2],(()=>"Error in depthwiseConv2d: number of input channels "+"(".concat(p,") must match the inChannels dimension in ")+"filter ".concat(u.shape[2],"."))),yu("depthwiseConv2d",r,o);const h={x:c,filter:u},d={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},f=Ga.runKernel(lt,h,d);return l?vu(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const nc=ri({diag_:function(e){const t={x:ei(e,"x","diag")};return Ga.runKernel(dt,t)}});const rc=ri({dilation2d_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC";const o=ei(e,"x","dilation2d"),s=ei(t,"filter","dilation2d");B(3===o.rank||4===o.rank,(()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(o.rank,"."))),B(3===s.rank,(()=>"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(s.rank,"."))),B("NHWC"===i,(()=>"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(i)));let u=o,c=!1;3===o.rank&&(u=vu(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),B(u.shape[3]===s.shape[2],(()=>"Error in dilation2d:  input and filter must have the same depth: ".concat(u.shape[3]," vs ").concat(s.shape[2])));const l={x:u,filter:s},p={strides:n,pad:r,dilations:a},h=Ga.runKernel(ft,l,p);return c?vu(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});const ac=ri({equal_:function(e,t){let n=ei(e,"a","equal","string_or_numeric"),r=ei(t,"b","equal","string_or_numeric");[n,r]=Ba(n,r),Yo(n.shape,r.shape);const a={a:n,b:r};return Ga.runKernel(St,a)}});const ic=ri({where_:function(e,t,n){const r=ei(t,"a","where"),a=ei(n,"b","where"),i=ei(e,"condition","where","bool"),o=Yo(Yo(i.shape,r.shape),a.shape),s={condition:Ru(i,o),t:Ru(r,o),e:Ru(a,o)};return Ga.runKernel(Hn,s)}});const oc=ri({divNoNan_:function(e,t){let n=ei(e,"a","div"),r=ei(t,"b","div");[n,r]=Ba(n,r);const a=To(n,r),i=Fo(a),o=ac(r,i);return ic(o,i,a)}});const sc=ri({dot_:function(e,t){const n=ei(e,"t1","dot"),r=ei(t,"t2","dot");B((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),(()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")));const a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(B(a===i,(()=>"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(i,"."))),1===n.rank&&1===r.rank){const e=vu(n,[1,-1]),t=vu(r,[-1,1]),a=Nu(e,t);return vu(a,[])}if(1===n.rank&&2===r.rank){const e=vu(n,[1,-1]),t=vu(r,[r.shape[0],r.shape[1]]),a=Nu(e,t);return vu(a,[a.size])}if(2===n.rank&&1===r.rank){const e=vu(r,[-1,1]),t=Nu(n,e);return vu(t,[t.size])}{const e=vu(r,[r.shape[0],r.shape[1]]);return Nu(n,e)}}});const uc=ri({einsum_:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(((e,t)=>ei(e,"tensors".concat(t),"einsum"))),i={equation:e};return Ga.runKernel(bt,a,i)}});const cc=ri({elu_:function(e){const t={x:ei(e,"x","elu","float32")};return Ga.runKernel(xt,t)}});const lc=ri({ensureShape_:function(e,t){const n=ei(e,"x","ensureShape","string_or_numeric");if(!function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(null!==e[n]&&null!==t[n]&&e[n]!==t[n])return!1;return!0}(n.shape,t))throw new Error("EnsureShape: Shape of tensor ".concat(n.shape," is not compatible with expected shape ").concat(t));return e}});const pc=ri({erf_:function(e){let t=ei(e,"x","erf");B("int32"===t.dtype||"float32"===t.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===t.dtype&&(t=No(t,"float32"));const n={x:t};return Ga.runKernel(Nt,n)}});function hc(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function dc(e,t,n){const r=e.length+t.length,a=[];let i=0,o=0;for(let s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}function fc(e,t){const n=[],r=e.length;for(let a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map((t=>e[t]))]}function mc(e,t){return dc(e,t.map((e=>1)),t)}function gc(e,t,n){B(hc(t,n),(()=>"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")))}function yc(e,t){if(hc(e,t))return null;const n=[];for(let r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((e=>n.push(e))),n}function vc(e){return e.map(((e,t)=>[t,e])).sort(((e,t)=>e[1]-t[1])).map((e=>e[0]))}function bc(e,t){const n=[];for(let r=t-e;r<t;++r)n.push(r);return n}const xc=ri({max_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:ei(e,"x","max")},a={reductionIndices:t,keepDims:n};return Ga.runKernel(en,r,a)}});const wc=ri({min_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:ei(e,"x","min")},a={axis:t,keepDims:n};return Ga.runKernel(cn,r,a)}});const Nc=ri({sum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=ei(e,"x","sum");"bool"===r.dtype&&(r=No(r,"int32"));const a={x:r},i={axis:t,keepDims:n};return Ga.runKernel(tr,a,i)}});function Sc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return Ho(e);if(1!==e.rank&&null===n)return Sc(vu(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return Nc(Ho(e),n);if(t===1/0)return xc(Ho(e),n);if(t===-1/0)return wc(Ho(e),n);if("euclidean"===t||2===t)return Io(Nc(qo(Ho(e),Mo(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return xc(Nc(Ho(e),n[0]),n[1]-1);if(t===1/0)return xc(Nc(Ho(e),n[1]),n[0]);if(t===-1/0)return wc(Nc(Ho(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return Io(Nc(Ao(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}const kc=ri({norm_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=Sc(e=ei(e,"x","norm"),t,n);let i=a.shape;if(r){const t=K(n,e.shape);i=mc(a.shape,t)}return vu(a,i)}});const Ec=ri({euclideanNorm_:function(e){return kc(e,"euclidean",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}});const Cc=ri({exp_:function(e){const t={x:ei(e,"x","exp")};return Ga.runKernel(kt,t)}});const Tc=ri({expandDims_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=ei(e,"x","expandDims","string_or_numeric");B(t<=n.rank,(()=>"Axis must be <= rank of the tensor"));const r={input:n},a={dim:t};return Ga.runKernel(Et,r,a)}});const Dc=ri({expm1_:function(e){const t={x:ei(e,"x","expm1")};return Ga.runKernel(Ct,t)}});const Ic=ri({tile_:function(e,t){const n=ei(e,"x","tile","string_or_numeric");B(n.rank===t.length,(()=>"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")));const r={x:n},a={reps:t};return Ga.runKernel(xr,r,a)}});const Ac=ri({eye_:function(e,t,n){null==t&&(t=e);const r=wo([e,t],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),a=e<=t?e:t;for(let o=0;o<a;++o)r.set(1,o,o);const i=vu(r.toTensor(),[e,t]);if(null==n)return i;if(1===n.length)return Ic(Tc(i,0),[n[0],1,1]);if(2===n.length)return Ic(Tc(Tc(i,0),0),[n[0],n[1],1,1]);if(3===n.length)return Ic(Tc(Tc(Tc(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});const Fc=ri({floor_:function(e){const t={x:ei(e,"x","floor","float32")};return Ga.runKernel(At,t)}});const _c=ri({gather_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const a={x:ei(e,"x","gather"),indices:ei(t,"indices","gather","int32")},i={axis:n,batchDims:r};return Ga.runKernel(Mt,a,i)}});const Mc=ri({greater_:function(e,t){let n=ei(e,"a","greater","string_or_numeric"),r=ei(t,"b","greater","string_or_numeric");[n,r]=Ba(n,r),Yo(n.shape,r.shape);const a={a:n,b:r};return Ga.runKernel(Rt,a)}});const Oc=ri({greaterEqual_:function(e,t){let n=ei(e,"a","greaterEqual","string_or_numeric"),r=ei(t,"b","greaterEqual","string_or_numeric");[n,r]=Ba(n,r),Yo(n.shape,r.shape);const a={a:n,b:r};return Ga.runKernel(zt,a)}});const Rc=ri({imag_:function(e){const t={input:ei(e,"input","imag")};return Ga.runKernel(Pt,t)}});const zc=ri({isFinite_:function(e){const t={x:ei(e,"x","isFinite")};return Ga.runKernel(Ut,t)}});const Bc=ri({isInf_:function(e){const t={x:ei(e,"x","isInf")};return Ga.runKernel(Wt,t)}});const Lc=ri({isNaN_:function(e){const t={x:ei(e,"x","isNaN")};return Ga.runKernel(Vt,t)}});const Pc=ri({leakyRelu_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;const n={x:ei(e,"x","leakyRelu")},r={alpha:t};return Ga.runKernel(qt,n,r)}});const Uc=ri({less_:function(e,t){let n=ei(e,"a","less","string_or_numeric"),r=ei(t,"b","less","string_or_numeric");[n,r]=Ba(n,r),Yo(n.shape,r.shape);const a={a:n,b:r};return Ga.runKernel(jt,a)}});const Wc=ri({lessEqual_:function(e,t){let n=ei(e,"a","lessEqual","string_or_numeric"),r=ei(t,"b","lessEqual","string_or_numeric");[n,r]=Ba(n,r),Yo(n.shape,r.shape);const a={a:n,b:r};return Ga.runKernel(Gt,a)}});function Vc(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:e,stop:t,num:n};return Ga.runKernel(Ht,{},r)}const qc=ri({localResponseNormalization_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const i=ei(e,"x","localResponseNormalization");B(4===i.rank||3===i.rank,(()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(i.rank,"."))),B(V(t),(()=>"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")));let o=i,s=!1;3===i.rank&&(s=!0,o=vu(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const u={x:o},c={depthRadius:t,bias:n,alpha:r,beta:a},l=Ga.runKernel(Qt,u,c);return s?vu(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});const jc=ri({log_:function(e){const t={x:ei(e,"x","log","float32")};return Ga.runKernel(Kt,t)}});const Gc=ri({log1p_:function(e){const t={x:ei(e,"x","log1p")};return Ga.runKernel(Xt,t)}});const Hc=ri({neg_:function(e){const t={x:ei(e,"x","neg")};return Ga.runKernel(mn,t)}});const Kc=ri({softplus_:function(e){const t={x:ei(e,"x","softplus")};return Ga.runKernel(Jn,t)}});const Xc=ri({logSigmoid_:function(e){const t=ei(e,"x","logSigmoid");return _o((e=>({value:Hc(Kc(Hc(e))),gradFunc:t=>Do(t,Su(Hc(e)))})))(t)}});const Yc=ri({logSoftmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=ei(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));const r=_o(((e,n)=>{const r=xc(e,t,!0),a=jo(e,r),i=jo(No(a,"float32"),jc(Nc(Cc(a),t,!0)));n([i]);return{value:i,gradFunc:(e,n)=>{const[r]=n,a=Cc(r);return jo(e,Do(Nc(e,t,!0),a))}}}));return r(n)}});const $c=ri({logSumExp_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=ei(e,"x","logSumExp"),a=K(t,r.shape),i=xc(r,a,!0),o=jo(r,i),s=Cc(o),u=Nc(s,a),c=jc(u),l=Eo(vu(i,c.shape),c);if(n){const e=mc(l.shape,a);return vu(l,e)}return l}});const Zc=ri({logicalAnd_:function(e,t){const n=ei(e,"a","logicalAnd","bool"),r=ei(t,"b","logicalAnd","bool");Yo(n.shape,r.shape);const a={a:n,b:r};return Ga.runKernel(Yt,a)}});const Qc=ri({logicalNot_:function(e){const t={x:ei(e,"x","logicalNot","bool")};return Ga.runKernel($t,t)}});const Jc=ri({logicalOr_:function(e,t){const n=ei(e,"a","logicalOr","bool"),r=ei(t,"b","logicalOr","bool");Yo(n.shape,r.shape);const a={a:n,b:r};return Ga.runKernel(Zt,a)}});const el=ri({logicalXor_:function(e,t){const n=ei(e,"a","logicalXor","bool"),r=ei(t,"b","logicalXor","bool");return Yo(n.shape,r.shape),Zc(Jc(e,t),Qc(Zc(e,t)))}}),tl=2147483648;const nl=ri({searchSorted_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left";const r=ei(e,"sortedSequence","searchSorted"),a=ei(t,"values","searchSorted"),i=r.shape[r.shape.length-1],o=a.shape[a.shape.length-1],s=vu(r,[-1,i]),u=vu(a,[-1,o]);if(s.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(s.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(U(u.shape)>=tl)throw new Error("values tensor size must less than ".concat(tl));if(s.shape[1]>=tl)throw new Error("trailing dim_size must less than ".concat(tl," for int32 output type, was ").concat(s.shape[1]));const c={sortedSequence:s,values:u},l={side:n};return Ga.runKernel(Gn,c,l)}});function rl(e,t){return nl(e,t,"left")}const al=ri({maxPool_:function(e,t,n,r,a){const i=ei(e,"x","maxPool");let o=i,s=!1;3===i.rank&&(s=!0,o=vu(i,[1,i.shape[0],i.shape[1],i.shape[2]])),B(4===o.rank,(()=>"Error in maxPool: input must be rank 4 but got rank ".concat(o.rank,"."))),B(fu(n,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'"))),yu("maxPool",r,a);const u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a},l=Ga.runKernel(nn,u,c);return s?vu(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});const il=ri({maxPool3d_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const o=ei(e,"x","maxPool3d");let s=o,u=!1;4===o.rank&&(u=!0,s=vu(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),B(5===s.rank,(()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,"."))),B("NDHWC"===i,(()=>"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i))),yu("maxPool3d",r,a);const c={x:s},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},p=Ga.runKernel(an,c,l);return u?vu(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}});const ol=ri({maxPoolWithArgmax_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i={x:ei(e,"x","maxPoolWithArgmax")},o={filterSize:t,strides:n,pad:r,includeBatchInIndex:a},s=Ga.runKernel(sn,i,o);return{result:s[0],indexes:s[1]}}});const sl=ri({mean_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:ei(e,"x","mean")},a={axis:t,keepDims:n};return Ga.runKernel(un,r,a)}});function ul(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(le(e),"complex64"===t){const t=ul(e,"float32"),n=ul(e,"float32");return ai(t,n)}const n=ue(U(e),t);return Ga.makeTensor(n,e,t)}function cl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(le(e),"complex64"===t){const t=cl(e,"float32"),n=ul(e,"float32");return ai(t,n)}const n=se(U(e),t);return Ga.makeTensor(n,e,t)}function ll(e,t){let{indexing:n="xy"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("xy"!==n&&"ij"!==n)throw new TypeError("".concat(n," is not a valid third argument to meshgrid"));if(void 0===e)return[];let r=ei(e,"x","meshgrid",e instanceof ka?e.dtype:"float32");if(void 0===t)return[r];let a=ei(t,"y","meshgrid",t instanceof ka?t.dtype:"float32");const i=U(r.shape),o=U(a.shape);return"xy"===n?(r=vu(r,[1,-1]),a=vu(a,[-1,1]),[Nu(cl([o,1],r.dtype),r),Nu(a,cl([1,i],a.dtype))]):(r=vu(r,[-1,1]),a=vu(a,[1,-1]),[Nu(r,cl([1,o],r.dtype)),Nu(cl([i,1],a.dtype),a)])}const pl=ri({minimum_:function(e,t){let n=ei(e,"a","minimum"),r=ei(t,"b","minimum");[n,r]=Ba(n,r),"bool"===n.dtype&&(n=No(n,"int32"),r=No(r,"int32")),Yo(n.shape,r.shape);const a={a:n,b:r};return Ga.runKernel(ln,a)}});const hl=ri({mirrorPad_:function(e,t,n){B("reflect"===n||"symmetric"===n,(()=>"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")));const r=ei(e,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");B(t.length===r.rank,(()=>"Padding doesn't match input. Must be ".concat(r.rank,". ")+"Got ".concat(t.length,".")));const a="reflect"===n?1:0;for(let s=0;s<r.rank;s++)B(2===t[s].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),B(t[s][0]>=0&&t[s][0]<=r.shape[s]-a&&t[s][1]>=0&&t[s][1]<=r.shape[s]-a,(()=>"Padding in dimension ".concat(s," cannot be greater than or equal ")+"to ".concat(r.shape[s]-a," or less than 0 for input of ")+"shape ".concat(r.shape)));const i={paddings:t,mode:n},o={x:r};return Ga.runKernel(pn,o,i)}});const dl=ri({mod_:function(e,t){let n=ei(e,"a","mod"),r=ei(t,"b","mod");[n,r]=Ba(n,r);const a={a:n,b:r};return Ga.runKernel(hn,a)}});const fl=ri({moments_:function(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=K(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(e=ei(e,"x","moments")).shape),r=sl(e,n,t);let a=r.shape;t||(a=mc(r.shape,n));const i=Ao(jo(No(e,"float32"),vu(r,a)));return{mean:r,variance:sl(i,n,t)}}});const ml=ri({multiRNNCell_:function(e,t,n,r){const a=ei(t,"data","multiRNNCell"),i=ti(n,"c","multiRNNCell"),o=ti(r,"h","multiRNNCell");let s=a;const u=[];for(let p=0;p<e.length;p++){const t=e[p](s,i[p],o[p]);u.push(t[0]),u.push(t[1]),s=t[1]}const c=[],l=[];for(let p=0;p<u.length;p+=2)c.push(u[p]),l.push(u[p+1]);return[c,l]}});const gl=ri({multinomial_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=ei(e,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(i,"."));if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(o));n=n||Math.random();const s={logits:1===o?vu(a,[1,-1]):a},u={numSamples:t,seed:n,normalized:r},c=Ga.runKernel(dn,s,u);return 1===o?vu(c,[c.size]):c}});const yl=ri({notEqual_:function(e,t){let n=ei(e,"a","notEqual","string_or_numeric"),r=ei(t,"b","notEqual","string_or_numeric");[n,r]=Ba(n,r),Yo(n.shape,r.shape);const a={a:n,b:r};return Ga.runKernel(gn,a)}});const vl=ri({oneHot_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));const i={indices:ei(e,"indices","oneHot","int32")},o={dtype:a,depth:t,onValue:n,offValue:r};return Ga.runKernel(wn,i,o)}});const bl=ri({onesLike_:function(e){const t={x:ei(e,"x","onesLike")};return Ga.runKernel(xn,t)}});const xl=ri({outerProduct_:function(e,t){const n=ei(e,"v1","outerProduct"),r=ei(t,"v2","outerProduct");B(1===n.rank&&1===r.rank,(()=>"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")));const a=vu(n,[-1,1]),i=vu(r,[1,-1]);return Nu(a,i)}});const wl=ri({pad_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=ei(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const a={paddings:t,constantValue:n},i={x:r};return Ga.runKernel(Sn,i,a)}});const Nl=ri({pad1d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return B(2===t.length,(()=>"Invalid number of paddings. Must be length of 2.")),wl(e,[t],n)}});const Sl=ri({pad2d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return B(2===t.length&&2===t[0].length&&2===t[1].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),wl(e,t,n)}});const kl=ri({pad3d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return B(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),wl(e,t,n)}});const El=ri({pad4d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return B(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),wl(e,t,n)}});const Cl=ri({spaceToBatchND_:function(e,t,n){const r=ei(e,"x","spaceToBatchND");B(r.rank>=1+t.length,(()=>"input rank ".concat(r.rank," should be > than [blockShape] ").concat(t.length))),B(n.length===t.length,(()=>"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length))),B(r.shape.reduce(((e,r,a)=>a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]===0:e),!0),(()=>"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())));const a={x:r},i={blockShape:t,paddings:n};return Ga.runKernel(nr,a,i)}});const Tl=ri({pool_:function(e,t,n,r,a,i,o){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");const s=ei(e,"x","maxPool");let u=s,c=!1;3===s.rank&&(c=!0,u=vu(s,[1,s.shape[0],s.shape[1],s.shape[2]])),B(fu(i,a),(()=>"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(a,"'")));const l=au(u.shape,t,i,a,r),p=[l.dilationHeight,l.dilationWidth];let h;h="same"===r?function(e,t){const n=e.map(((e,n)=>e+(e-1)*(t[n]-1))),r=n.map((e=>e-1)),a=r.map((e=>Math.floor(e/2))),i=r.map(((e,t)=>e-a[t]));return r.map(((e,t)=>[a[t],i[t]]))}([l.filterHeight,l.filterWidth],p):[[0,0],[0,0]];const d=1===p[0]&&1===p[1],[f,m]=function(e,t,n){const r=n.map((e=>e[0])),a=n.map((e=>e[1])),i=e.concat(r,a),o=t.map(((e,t)=>(e-i[t]%e)%e)),s=a.map(((e,t)=>e+o[t])),u=t.map(((e,t)=>[r[t],s[t]])),c=t.map(((e,t)=>[0,o[t]]));return[u,c]}([l.inHeight,l.inWidth],p,h),g=d?r:"valid",y=d?u:Cl(u,p,f),v=("avg"===n?()=>bu(y,t,i,g,o):()=>al(y,t,i,g,o))(),b=d?v:Tu(v,p,m);return c?vu(b,[b.shape[1],b.shape[2],b.shape[3]]):b}});const Dl=ri({prelu_:function(e,t){const n={x:ei(e,"x","prelu"),alpha:ei(t,"alpha","prelu")};return Ga.runKernel(En,n)}});const Il=ri({prod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=ei(e,"x","prod");"bool"===r.dtype&&(r=No(r,"int32"));const a={x:r},i={axis:t,keepDims:n};return Ga.runKernel(Cn,a,i)}});const Al=ri({raggedGather_:function(e,t,n,r){const a={paramsNestedSplits:e.map(((e,t)=>ei(e,"tensors".concat(t),"raggedGather","int32"))),paramsDenseValues:ei(t,"paramsDenseValues","raggedGather"),indices:ei(n,"indices","raggedGather","int32")},i={outputRaggedRank:r},o=Ga.runKernel(Tn,a,i);return{outputNestedSplits:o.slice(0,o.length-1),outputDenseValues:o[o.length-1]}}});const Fl=ri({raggedRange_:function(e,t,n){const r=ei(e,"starts","raggedRange"),a={starts:r,limits:ei(t,"limits","raggedRange",r.dtype),deltas:ei(n,"deltas","raggedRange",r.dtype)},i=Ga.runKernel(Dn,a);return{rtNestedSplits:i[0],rtDenseValues:i[1]}}});const _l=ri({raggedTensorToTensor_:function(e,t,n,r,a){const i=ei(e,"shape","raggedTensorToTensor","int32"),o=ei(t,"values","raggedTensorToTensor"),s={shape:i,values:o,defaultValue:ei(n,"defaultValue","raggedTensorToTensor",o.dtype),rowPartitionTensors:r.map(((e,t)=>ei(e,"tensors".concat(t),"raggedTensorToTensor","int32")))},u={rowPartitionTypes:a};return Ga.runKernel(In,s,u)}});const Ml=ri({rand_:function(e,t,n){le(e);const r=U(e);let a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));a=new Uint8Array(r)}for(let i=0;i<r;i++)a[i]=t();return Ga.makeTensor(a,e,n)}});var Ol=n(334);class Rl{constructor(e,t,n,r,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const i=a||Math.random();this.random=Ol.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const e=this.nextVal;return this.nextVal=NaN,e}let e,t,n=!1;for(;!n;){let r,a,i;do{r=2*this.random()-1,a=2*this.random()-1,i=r*r+a*a}while(i>=1||0===i);const o=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*r*o,t=this.mean+this.stdDev*a*o,this.truncated&&!this.isValidTruncated(e)||(n=!0)}return this.truncated&&!this.isValidTruncated(t)||(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class zl{constructor(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;const a=r||Math.random();this.randu=Ol.alea(a.toString()),this.randn=new Rl(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,r,a,i;for(;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,e=r*r,t=1-.331*e*e,n=.5*e+this.d*(1-i+Math.log(i)),a=this.randu(),a<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return"float32"===this.dtype?e:Math.round(e)}}class Bl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"===typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(e," - ").concat(t," <= 1 and dtype is not float"));this.random=Ol.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const Ll=ri({randomGamma_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;if(le(e),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));const i=new zl(t,n,r,a),o=wo(e,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});const Pl=ri({randomNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(le(e),null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));const i=new Rl(t,n,r,!1,a),o=wo(e,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});const Ul=ri({randomStandardNormal_:function(e,t,n){if(null!=t&&"bool"===t)throw new Error("Unsupported data type ".concat(t));return Pl(e,0,1,t,n)}});const Wl=ri({randomUniform_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;le(e);const i=wo(e,r),o=new Bl(t,n,null,a);for(let s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}});const Vl=ri({randomUniformInt_:function(e,t,n,r){return Wl(e,t,n,"int32",r)}});function ql(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");const a={start:e,stop:t,step:n,dtype:r};return Ga.runKernel(An,{},a)}const jl=ri({real_:function(e){const t={input:ei(e,"input","real")};return Ga.runKernel(Fn,t)}});const Gl=ri({reciprocal_:function(e){const t={x:ei(e,"x","reciprocal")};return Ga.runKernel(_n,t)}});const Hl=ri({relu_:function(e){const t={x:ei(e,"x","relu")};return Ga.runKernel(Mn,t)}});const Kl=ri({relu6_:function(e){const t={x:ei(e,"x","relu6")};return Ga.runKernel(Pn,t)}});const Xl=ri({reverse_:function(e,t){const n={x:ei(e,"x","reverse")},r={dims:t};return Ga.runKernel(Un,n,r)}});const Yl=ri({reverse1d_:function(e){const t=ei(e,"x","reverse");return B(1===t.rank,(()=>"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,"."))),Xl(t,0)}});const $l=ri({reverse2d_:function(e,t){const n=ei(e,"x","reverse");return B(2===n.rank,(()=>"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,"."))),Xl(n,t)}});const Zl=ri({reverse3d_:function(e,t){const n=ei(e,"x","reverse");return B(3===n.rank,(()=>"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,"."))),Xl(n,t)}});const Ql=ri({reverse4d_:function(e,t){const n=ei(e,"x","reverse");return B(4===n.rank,(()=>"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,"."))),Xl(n,t)}});const Jl=ri({round_:function(e){const t={x:ei(e,"x","round")};return Ga.runKernel(Wn,t)}});const ep=ri({rsqrt_:function(e){const t={x:ei(e,"x","rsqrt","float32")};return Ga.runKernel(Vn,t)}});const tp=ri({selu_:function(e){const t={x:ei(e,"x","selu")};return Ga.runKernel(Kn,t)}});const np=ri({separableConv2d_:function(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC";const s=ei(e,"x","separableConv2d"),u=ei(t,"depthwiseFilter","separableConv2d"),c=ei(n,"pointwiseFilter","separableConv2d");let l=s,p=!1;if(3===s.rank&&(p=!0,l=vu(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");B(4===l.rank,(()=>"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,"."))),B(4===u.rank,(()=>"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(u.rank,"."))),B(4===c.rank,(()=>"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(u.rank,"."))),B(1===c.shape[0],(()=>"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(c.shape[0],"."))),B(1===c.shape[1],(()=>"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(c.shape[1],".")));const h=u.shape[2],d=u.shape[3];B(c.shape[2]===h*d,(()=>"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(h*d,", ")+"but got ".concat(c.shape[2],".")));const f=tc(l,u,r,a,o,i),m=Vu(f,c,1,"valid",o);return p?vu(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});const rp=async function(e,t){const n=ei(e,"x","setdiff1d"),r=ei(t,"y","setdiff1d");B(n.dtype===r.dtype,(()=>"x and y should have the same dtype, but got x (".concat(n.dtype,") and y (").concat(r.dtype,")."))),B(1===n.rank,(()=>"x should be 1D tensor, but got x (".concat(n.shape,")."))),B(1===r.rank,(()=>"y should be 1D tensor, but got y (".concat(r.shape,").")));const a=await n.data(),i=await r.data(),o=new Set(i);let s=0;for(let l=0;l<a.length;l++)o.has(a[l])||s++;const u=new xa([s],n.dtype),c=new xa([s],"int32");for(let l=0,p=0;l<a.length;l++)o.has(a[l])||(u.values[p]=a[l],c.values[p]=l,p++);return[u.toTensor(),c.toTensor()]};const ap=ri({sign_:function(e){const t={x:ei(e,"x","sign")};return Ga.runKernel(Zn,t)}});const ip=ri({sin_:function(e){const t={x:ei(e,"x","sin","float32")};return Ga.runKernel(Yn,t)}});const op=ri({sinh_:function(e){const t={x:ei(e,"x","sinh")};return Ga.runKernel($n,t)}});const sp=ri({slice1d_:function(e,t,n){const r=ei(e,"x","slice1d");return B(1===r.rank,(()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor"))),ku(r,[t],[n])}});const up=ri({slice2d_:function(e,t,n){const r=ei(e,"x","slice2d");return B(2===r.rank,(()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor"))),ku(r,t,n)}});const cp=ri({slice3d_:function(e,t,n){const r=ei(e,"x","slice3d");return B(3===r.rank,(()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor"))),ku(r,t,n)}});const lp=ri({slice4d_:function(e,t,n){const r=ei(e,"x","slice4d");return B(4===r.rank,(()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor"))),ku(r,t,n)}});const pp=ri({softmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=ei(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));const r={logits:n},a={dim:t};return Ga.runKernel(ar,r,a)}});const hp=ri({fft_:function(e){B("complex64"===e.dtype,(()=>"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")));const t={input:e};return Ga.runKernel(Tt,t)}});const dp=ri({ifft_:function(e){B("complex64"===e.dtype,(()=>"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")));const t={input:e};return Ga.runKernel(Lt,t)}});const fp=ri({irfft_:function(e){const t=e.shape[e.shape.length-1],n=e.size/t;let r;if(t<=2){const a=vu(e,[n,t]);r=dp(a)}else{const a=[n,2*(t-1)],i=vu(jl(e),[n,t]),o=vu(Rc(e),[n,t]),s=Xl(ku(i,[0,1],[n,t-2]),1),u=Do(Xl(ku(o,[0,1],[n,t-2]),1),Mo(-1)),c=wu([i,s],1),l=wu([o,u],1),p=vu(ai(c,l),[a[0],a[1]]);r=dp(p)}if(r=jl(r),3===e.rank&&0!==e.shape[0]){const t=r,n=e.shape[0];r=vu(r,[n,r.shape[0]/n,r.shape[1]]),t.dispose()}return r}});const mp=ri({split_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r={x:ei(e,"x","split")},a={numOrSizeSplits:t,axis:n};return Ga.runKernel(rr,r,a)}});const gp=ri({rfft_:function(e,t){B("float32"===e.dtype,(()=>"The dtype for rfft() must be real value but got ".concat(e.dtype)));let n=e.shape[e.shape.length-1];const r=e.size/n;let a;if(null!=t&&t<n){const r=e.shape.map((e=>0)),i=e.shape.map((e=>e));i[e.shape.length-1]=t,a=ku(e,r,i),n=t}else if(null!=t&&t>n){const r=e.shape.map((e=>e));r[e.shape.length-1]=t-n,a=wu([e,ul(r)],e.shape.length-1),n=t}else a=e;const i=Fo(a),o=vu(ai(a,i),[r,n]),s=hp(o),u=Math.floor(n/2)+1,c=jl(s),l=Rc(s),p=mp(c,[u,n-u],c.shape.length-1),h=mp(l,[u,n-u],l.shape.length-1),d=a.shape.slice();return d[a.shape.length-1]=u,vu(ai(p[0],h[0]),d)}});const yp=ri({squaredDifference_:function(e,t){let n=ei(e,"a","squaredDifference"),r=ei(t,"b","squaredDifference");[n,r]=Ba(n,r),Yo(n.shape,r.shape);const a={a:n,b:r};return Ga.runKernel(lr,a,{})}});const vp=ri({squeeze_:function(e,t){const n=ei(e,"x","squeeze","string_or_numeric");return vu(n,X(n.shape,t).newShape)}});const bp=ri({stack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=ti(e,"tensors","stack","string_or_numeric");B(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),n.length>0&&B(t<=n[0].rank,(()=>"Axis must be <= rank of the tensor"));const r=n,a={axis:t};return Ga.runKernel(Nn,r,a)}});const xp=ri({step_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:ei(e,"x","step")},r={alpha:t};return Ga.runKernel(Dr,n,r)}});const wp=ri({stridedSlice_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;const c={x:ei(e,"x","stridedSlice","string_or_numeric")},l={begin:t,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u};return Ga.runKernel(dr,c,l)}});const Np=ri({tan_:function(e){const t={x:ei(e,"x","tan","float32")};return Ga.runKernel(vr,t)}});function Sp(e,t){P(e);const n=Za(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return ii(e,null,n,t)}function kp(e,t,n){if(P(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");const r=Za(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ii(e,t,r,n)}function Ep(e,t,n){if(P(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");const r=Za(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ii(e,t,r,n)}function Cp(e,t,n){if(P(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");const r=Za(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ii(e,t,r,n)}function Tp(e,t,n){if(P(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");const r=Za(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return ii(e,t=t||r,r,n)}function Dp(e,t,n){const r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != ".concat(a+e.length-r));for(let o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(t.shape[o],")."));for(let o=0;o<n.rank-a;++o)if(n.shape[o+a]!==e[o+r])throw new Error(i+" updates.shape[".concat(o+a,"] (").concat(n.shape[o+a],") != shape[").concat(o+a,"] (").concat(e[o+a],")"))}function Ip(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}Dp(n,t,e)}function Ap(e,t,n){const r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length;let o=1;for(let u=a;u<i;++u)o*=n[u];const s=a<1?1:a;return{sliceRank:a,numUpdates:U(t.shape)/s,sliceSize:o,strides:[...ae(n.slice(0,a)),1],outputSize:U(n)}}const Fp=ri({tensorScatterUpdate_:function(e,t,n){const r=ei(e,"tensor","tensorScatterupdate"),a=ei(t,"indices","tensorScatterupdate","int32"),i=ei(n,"updates","tensorScatterupdate");if(Ip(i,a,r.shape),r.dtype!==i.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(r.dtype," and ").concat(i.dtype,"."));const o={tensor:r,indices:a,updates:i};return Ga.runKernel(jn,o,{})}});const _p=ri({topk_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=ei(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const a=r.shape[r.shape.length-1];if(t<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(t));if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") ")+"but got ".concat(t));const i={x:r},o={k:t,sorted:n},[s,u]=Ga.runKernel(wr,i,o);return{values:s,indices:u}}});const Mp=ri({truncatedNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(le(e),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const i=new Rl(t,n,r,!0,a),o=wo(e,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});const Op=ri({unique_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=ei(e,"x","unique","string_or_numeric");B(n.rank>0,(()=>"The input tensor must be at least 1D"));const r={x:n},a={axis:t},[i,o]=Ga.runKernel(kr,r,a);return{values:i,indices:o}}});const Rp=ri({unsortedSegmentSum_:function(e,t,n){const r=ei(e,"x","unsortedSegmentSum"),a=ei(t,"segmentIds","unsortedSegmentSum","int32");B(V(n),(()=>"numSegments must be of dtype int"));const i={x:r,segmentIds:a},o={numSegments:n};return Ga.runKernel(Cr,i,o)}});const zp=ri({unstack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=ei(e,"x","unstack","string_or_numeric");B(t>=-n.shape.length&&t<n.shape.length,(()=>"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")));const r={value:n},a={axis:t};return Ga.runKernel(Er,r,a)}});function Bp(e,t){return nl(e,t,"right")}function Lp(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return Ga.makeVariable(e,t,n,r)}function Pp(e,t){const n=[];for(let i=0;i<t.length;i++)t[i]&&n.push(i);const r=wo(e,"int32"),a=wo([n.length,e.length],"int32");for(let i=0;i<n.length;i++){const t=r.indexToLoc(n[i]),o=i*e.length;a.values.set(t,o)}return a.toTensor()}const Up=async function(e){const t=ei(e,"condition","whereAsync","bool"),n=await t.data(),r=Pp(t.shape,n);return e!==t&&t.dispose(),r};const Wp=async function(e,t,n){const r=ei(e,"tensor","boolMask"),a=ei(t,"mask","boolMask","bool"),i=null==n?0:n,o=a.rank,s=r.shape;B(o>0,(()=>"mask cannot be scalar")),L(s.slice(i,i+o),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let m=i;m<i+o;m++)u*=s[m];const c=s.slice(0,i).concat([u],s.slice(i+o)),l=vu(r,c),p=vu(a,[-1]),h=await Up(p),d=vp(h,[1]),f=_c(l,d,i);return e!==r&&r.dispose(),t!==a&&a.dispose(),d.dispose(),l.dispose(),p.dispose(),h.dispose(),f};const Vp=ri({transpose_:function(e,t,n){const r=ei(e,"x","transpose");if(null==t&&(t=r.shape.map(((e,t)=>t)).reverse()),B(r.rank===t.length,(()=>"Error in transpose: rank of input ".concat(r.rank," ")+"must match length of perm ".concat(t,"."))),t.forEach((e=>{B(e>=0&&e<r.rank,(()=>"All entries in 'perm' must be between 0 and ".concat(r.rank-1)+" but got ".concat(t)))})),r.rank<=1)return r.clone();const a={x:r},i={perm:t};return"complex64"===r.dtype?pi((()=>{let e=jl(r),t=Rc(r);return e=Ga.runKernel(Sr,{x:e},i),t=Ga.runKernel(Sr,{x:t},i),n&&(t=Hc(t)),ai(e,t)})):Ga.runKernel(Sr,a,i)}});const qp=ri({movingAverage_:function(e,t,n,r){let a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const i=ei(e,"v","movingAverage"),o=ei(t,"x","movingAverage"),s=ei(n,"decay","movingAverage");var u,c;c=o,B((u=i).dtype===c.dtype,(()=>"The dtypes of the first(".concat(u.dtype,") and")+" second(".concat(c.dtype,") input must match"))),B(W(i.shape,o.shape),(()=>"Shape mismatch in v and x"));const l=Mo(1),p=jo(l,s);let h=Do(jo(o,i),p);if(a){B(null!=r,(()=>"When using zeroDebias: true, step is required."));const e=ei(r,"step","movingAverage");h=To(h,jo(l,qo(s,e)))}return Eo(i,h)}});const jp=ri({scatterND_:function(e,t,n){le(n);const r=ei(e,"indices","scatterND","int32"),a=ei(t,"updates","scatterND");Ip(a,r,n);const i={indices:r,updates:a},o={shape:n};return Ga.runKernel(qn,i,o)}});const Gp=ri({sparseToDense_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;le(n);const a=ei(e,"sparseIndices","sparseToDense","int32"),i=ei(t,"sparseValues","sparseToDense","string_or_numeric"),o=ei(r,"defaultValue","sparseToDense",i.dtype);!function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(e.shape,"."));const a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(i,"."));const o=t.size;if(0!==t.rank&&(1!==t.rank||o!==a))throw new Error("sparseValues has incorrect shape "+"".concat(t.shape,", should be [] or [").concat(a,"]"));if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,n,o);const s={sparseIndices:a,sparseValues:i,defaultValue:o},u={outputShape:n};return Ga.runKernel(cr,s,u)}});const Hp=ri({gatherND_:function(e,t){const n=ei(t,"indices","gatherND","int32"),r={params:ei(e,"x","gatherND","string_or_numeric"),indices:n};return Ga.runKernel(Ot,r)}});const Kp=ri({dropout_:function(e,t,n,r){const a=ei(e,"x","dropout");if(B("float32"===a.dtype,(()=>"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead."))),B(t>=0&&t<1,(()=>"rate must be a float in the range [0, 1), but got ".concat(t,"."))),0===t)return e instanceof ka?a.clone():a;const i=function(e,t){if(null==t)return e.shape.slice();if(W(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,s=To(Fc(Eo(Wl(i,0,1,"float32",r),o)),o);return Do(a,s)}});function Xp(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function Yp(e,t,n){const r=1-e%2,a=new Float32Array(e);for(let i=0;i<e;++i){const o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return Sp(a,"float32")}const $p=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=ei(e,"predictions","inTopK"),a=ei(t,"targets","inTopK");B(r.rank>1,(()=>"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(r.rank))),B(r.rank-1===a.rank,(()=>"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(r.rank," and targets rank ").concat(a.rank))),L(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=r.shape[r.shape.length-1];B(n>0&&n<=i,(()=>"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(i,"), but got ").concat(n)));const o=await r.data(),s=await a.data(),[u,c]=[o.length/i,i],l=Y("bool",u);for(let p=0;p<u;p++){const e=p*c,t=o.subarray(e,e+c),r=[];for(let n=0;n<t.length;n++)r.push({value:t[n],index:n});r.sort(((e,t)=>t.value-e.value)),l[p]=0;for(let a=0;a<n;a++)if(r[a].index===s[p]){l[p]=1;break}}return e!==r&&r.dispose(),t!==a&&a.dispose(),oi(l,a.shape,"bool")};const Zp=ri({conv2DBackpropFilter_:function(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=vu(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let u=t;3===u.rank&&(u=vu(t,[1,t.shape[0],t.shape[1],t.shape[2]])),B(4===s.rank,(()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,"."))),B(4===u.rank,(()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(u.shape,"."))),B(4===n.length,(()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")));const c="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?u.shape[3]:u.shape[1];B(c===n[2],(()=>"Error in conv2dDerFilter: depth of input ".concat(c,") must ")+"match input depth in filter (".concat(n[2],"."))),B(l===n[3],(()=>"Error in conv2dDerFilter: depth of dy (".concat(l,") must ")+"match output depth for filter (".concat(n[3],")."))),yu("conv2dDerFilter",a,o);const p={x:s,dy:u},h={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,filterShape:n};return Ga.runKernel(Qe,p,h)}});function Qp(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return Do(e,xp(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function Jp(e,t){let n=t;const r=Xo(e.shape,t.shape);return r.length>0&&(n=Nc(n,r)),vu(n,e.shape)}function eh(e,t,n,r){if("linear"===t)return e;if("relu"===t)return Hl(e);if("elu"===t)return cc(e);if("relu6"===t)return Kl(e);if("prelu"===t)return Dl(e,n);if("leakyrelu"===t)return Pc(e,r);if("sigmoid"===t)return Su(e);throw new Error("Unknown fused activation ".concat(t,"."))}const th=(e,t)=>!(e>0)||"linear"===t;const nh=ri({fusedConv2d_:function(e){let{x:t,filter:n,strides:r,pad:a,dataFormat:i="NHWC",dilations:o=[1,1],dimRoundingMode:s,bias:u,activation:c="linear",preluActivationWeights:l,leakyreluAlpha:p}=e;if(c=c||"linear",!1===th(Ga.state.gradientDepth,c)){B("NHWC"===i,(()=>"Error in fused conv2d: got dataFormat of ".concat(i," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."));let e=Vu(t,n,r,a,i,o,s);return null!=u&&(e=Eo(e,u)),eh(e,c,l,p)}const h=ei(t,"x","conv2d","float32"),d=ei(n,"filter","conv2d","float32");let f=h,m=!1;3===h.rank&&(m=!0,f=vu(h,[1,h.shape[0],h.shape[1],h.shape[2]])),B(4===f.rank,(()=>"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(f.rank,"."))),B(4===d.rank,(()=>"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(d.rank,"."))),yu("fused conv2d",a,s);const g="NHWC"===i?f.shape[3]:f.shape[1];B(d.shape[2]===g,(()=>"Error in conv2d: depth of input (".concat(g,") must match ")+"input depth for filter ".concat(d.shape[2],"."))),B(fu(r,o),(()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(o,"'")));const y=ou(f.shape,d.shape,r,o,a,s);let v,b;if(null!=u&&(v=ei(u,"bias","fused conv2d"),[v]=Ba(v,h),"NHWC"===i?Yo(y.outShape,v.shape):(B(v.shape.length<=1,(()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(v.shape.length,"."))),B(0===v.shape.length||v.shape[0]===y.outChannels||1===v.shape[0],(()=>"Error in fused conv2d: bias shape (".concat(v.shape,") is not ")+"compatible with the number of output channels "+"(".concat(y.outChannels,")"))))),null!=l){const e=l.shape;if(B(e.length<=1||3===e.length,(()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(e.length,"."))),1===e.length)B(1===e[0]||e[0]===y.outChannels,(()=>"Error in fused conv2d: PReLU activation weights "+"(".concat(e,") is not compatible with the number of output ")+"channels (".concat(y.outChannels,").")));else if(3===e.length)try{Yo(e,y.outShape)}catch(Z2){const n="Error in fused conv2d: PReLU activation weights (".concat(e,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(y.outShape,").");throw Error(n)}b=ei(l,"prelu weights","fused conv2d")}const x=(e,t)=>{B("NHWC"===i,(()=>"Error in gradient of fused conv2D: got dataFormat of ".concat(i," but only NHWC is currently supported.")));const[n,s,u,l]=t,p=Qp(e,u,c);B(du(o),(()=>"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'")));const h=[ju(s.shape,p,n,r,a),Zp(s,p,n.shape,r,a)];if(null!=l){const e=Jp(l,p);h.push(e)}return h},w={x:f,filter:d,bias:v,preluActivationWeights:b},N={strides:r,pad:a,dataFormat:i,dilations:o,dimRoundingMode:s,activation:c,leakyreluAlpha:p};if(null==u){const e=_o(((e,t,n)=>{let r=Ga.runKernel(_r,w,N);return n([t,e,r]),m&&(r=vu(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:x}}));return e(f,d)}{const e=_o(((e,t,n,r)=>{let a=Ga.runKernel(_r,w,N);return r([t,e,a,n]),m&&(a=vu(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:x}}));return e(f,d,v)}}});const rh=ri({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=vu(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let u=t;3===u.rank&&(u=vu(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={x:s,dy:u},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,filterShape:n};return Ga.runKernel(pt,c,l)}});const ah=ri({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=t,u=!1;3===t.rank&&(u=!0,s=vu(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={dy:s,filter:n},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,inputShape:e},p=Ga.runKernel(ht,c,l);return u?vu(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});const ih=ri({fusedDepthwiseConv2d_:function(e){let{x:t,filter:n,strides:r,pad:a,dataFormat:i="NHWC",dilations:o=[1,1],dimRoundingMode:s,bias:u,activation:c="linear",preluActivationWeights:l,leakyreluAlpha:p}=e;if(!1===th(Ga.state.gradientDepth,c)){let e=tc(t,n,r,a,i,o,s);return null!=u&&(e=Eo(e,u)),eh(e,c,l,p)}const h=ei(t,"x","depthwiseConv2d","float32"),d=ei(n,"filter","depthwiseConv2d","float32");let f=h,m=!1;3===h.rank&&(m=!0,f=vu(h,[1,h.shape[0],h.shape[1],h.shape[2]])),B(4===f.rank,(()=>"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(f.rank,"."))),B(4===d.rank,(()=>"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(d.rank,"."))),B(f.shape[3]===d.shape[2],(()=>"Error in fused depthwiseConv2d: number of input channels "+"(".concat(f.shape[3],") must match the inChannels dimension in ")+"filter ".concat(d.shape[2],"."))),null==o&&(o=[1,1]),B(fu(r,o),(()=>"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(o,"'"))),yu("fused depthwiseConv2d",a,s);const g=ou(f.shape,d.shape,r,o,a,s,!0);let y,v;null!=u&&(y=ei(u,"bias","fused conv2d"),[y]=Ba(y,h),Yo(g.outShape,y.shape)),null!=l&&(v=ei(l,"prelu weights","fused depthwiseConv2d"));const b=(e,t)=>{B(du(o),(()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(o,"'")));const[n,i,u,l]=t,p=Qp(e,u,c),h=ah(i.shape,p,n,r,a,o,s),d=rh(i,p,n.shape,r,a,o,s);if(null!=l){return[h,d,Jp(y,p)]}return[h,d]},x={x:f,filter:d,bias:y,preluActivationWeights:v},w={strides:r,pad:a,dataFormat:i,dilations:o,dimRoundingMode:s,activation:c,leakyreluAlpha:p};if(null==u){const e=_o(((e,t,n)=>{let r=Ga.runKernel(Mr,x,w);return n([t,e,r]),m&&(r=vu(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:b}}));return e(f,d)}{const e=_o(((e,t,n,r)=>{let a=Ga.runKernel(Mr,x,w);return r([t,e,a,n]),m&&(a=vu(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:b}}));return e(f,d,y)}}});const oh=ri({fusedMatMul_:function(e){let{a:t,b:n,transposeA:r=!1,transposeB:a=!1,bias:i,activation:o="linear",preluActivationWeights:s,leakyreluAlpha:u=.2}=e;if(!1===th(Ga.state.gradientDepth,o)){let e=Nu(t,n,r,a);return null!=i&&(e=Eo(e,i)),eh(e,o,s,u)}let c=ei(t,"a","fused matMul"),l=ei(n,"b","fused matMul");[c,l]=Ba(c,l);const p=r?c.shape[c.rank-2]:c.shape[c.rank-1],h=a?l.shape[l.rank-1]:l.shape[l.rank-2],d=r?c.shape[c.rank-1]:c.shape[c.rank-2],f=a?l.shape[l.rank-2]:l.shape[l.rank-1],m=c.shape.slice(0,-2),g=l.shape.slice(0,-2),y=U(m),v=U(g);B(p===h,(()=>"Error in fused matMul: inner shapes (".concat(p,") and (")+"".concat(h,") of Tensors with shapes ").concat(c.shape," and ")+"".concat(l.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match.")));const b=Yo(c.shape.slice(0,-2),l.shape.slice(0,-2)).concat([d,f]),x=vu(c,r?[y,p,d]:[y,d,p]),w=vu(l,a?[v,f,h]:[v,h,f]);let N,S;null!=i&&(N=ei(i,"bias","fused matMul"),[N]=Ba(N,c),Yo(b,N.shape)),null!=s&&(S=ei(s,"prelu weights","fused matMul"));const k=(e,t)=>{const[n,s,u,c]=t,l=Qp(vu(e,u.shape),u,o);let p,h;if(r||a?!r&&a?(p=Nu(l,s,!1,!1),h=Nu(l,n,!0,!1)):r&&!a?(p=Nu(s,l,!1,!0),h=Nu(n,l,!1,!1)):(p=Nu(s,l,!0,!0),h=Nu(l,n,!0,!0)):(p=Nu(l,s,!1,!0),h=Nu(n,l,!0,!1)),null!=i){return[p,h,Jp(c,l)]}return[p,h]},E={a:x,b:w,bias:N,preluActivationWeights:S},C={transposeA:r,transposeB:a,activation:o,leakyreluAlpha:u};if(null==i){const e=_o(((e,t,n)=>{const r=Ga.runKernel(Fr,E,C);return n([e,t,r]),{value:vu(r,b),gradFunc:k}}));return e(x,w)}{const e=_o(((e,t,n,r)=>{const a=Ga.runKernel(Fr,E,C);return r([e,t,a,n]),{value:vu(a,b),gradFunc:k}}));return e(x,w,N)}}});const sh=ri({hammingWindow_:function(e){return Yp(e,.54,.46)}});const uh=ri({hannWindow_:function(e){return Yp(e,.5,.5)}});const ch=ri({frame_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0;const o=[];for(;i+t<=e.size;)o.push(ku(e,i,t)),i+=n;if(r)for(;i<e.size;){const r=i+t-e.size,s=wu([ku(e,i,t-r),Wo([r],a)]);o.push(s),i+=n}return 0===o.length?kp([],[0,t]):vu(wu(o),[o.length,t])}});const lh=ri({stft_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:uh;null==r&&(r=Xp(t));const i=ch(e,t,n),o=Do(i,a(t));return gp(o,r)}});const ph=ri({cropAndResize_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=ei(e,"image","cropAndResize"),s=ei(t,"boxes","cropAndResize","float32"),u=ei(n,"boxInd","cropAndResize","int32"),c=s.shape[0];B(4===o.rank,(()=>"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,"."))),B(2===s.rank&&4===s.shape[1],(()=>"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(s.shape,"."))),B(1===u.rank&&u.shape[0]===c,(()=>"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(s.shape,"."))),B(2===r.length,(()=>"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,"."))),B(r[0]>=1&&r[1]>=1,(()=>"cropSize must be atleast [1,1], but was ".concat(r))),B("bilinear"===a||"nearest"===a,(()=>"method must be bilinear or nearest, but was ".concat(a)));const l={image:o,boxes:s,boxInd:u},p={method:a,extrapolationValue:i,cropSize:r};return Ga.runKernel(st,l,p)}});const hh=ri({flipLeftRight_:function(e){const t=ei(e,"image","flipLeftRight","float32");B(4===t.rank,(()=>"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")));const n={image:t};return Ga.runKernel(It,n,{})}});const dh=ri({grayscaleToRGB_:function(e){const t=ei(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];B(t.rank>=2,(()=>"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(t.rank,"."))),B(1===r,(()=>"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,".")));const a=new Array(t.rank);return a.fill(1,0,n),a[n]=3,Ic(t,a)}});const fh=ri({rgbToGrayscale_:function(e){const t=ei(e,"image","RGBToGrayscale"),n=t.rank-1,r=t.shape[n];B(t.rank>=2,(()=>"Error in RGBToGrayscale: images must be at least rank 2, "+"but got rank ".concat(t.rank,"."))),B(3===r,(()=>"Error in RGBToGrayscale: last dimension of an RGB image "+"should be size 3, but got size ".concat(r,".")));const a=t.dtype,i=No(t,"float32"),o=Sp([.2989,.587,.114]);let s;switch(t.rank){case 2:s=uc("ij,j->i",i,o);break;case 3:s=uc("ijk,k->ij",i,o);break;case 4:s=uc("ijkl,l->ijk",i,o);break;case 5:s=uc("ijklm,m->ijkl",i,o);break;case 6:s=uc("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return s=Tc(s,-1),No(s,a)}});const mh=ri({rotateWithOffset_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const a=ei(e,"image","rotateWithOffset","float32");B(4===a.rank,(()=>"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,".")));const i={image:a},o={radians:t,fillValue:n,center:r};return Ga.runKernel(Ar,i,o)}});function gh(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);const o=e.shape[0];return n=Math.min(n,o),B(0<=r&&r<=1,(()=>"iouThreshold must be in [0, 1], but was '".concat(r,"'"))),B(2===e.rank,(()=>"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'"))),B(4===e.shape[1],(()=>"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1]))),B(1===t.rank,(()=>"scores must be a 1D tensor")),B(t.shape[0]===o,(()=>"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(t.shape[0]))),B(0<=i&&i<=1,(()=>"softNmsSigma must be in [0, 1], but was '".concat(i,"'"))),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}const yh=ri({nonMaxSuppression_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const i=ei(e,"boxes","nonMaxSuppression","float32"),o=ei(t,"scores","nonMaxSuppression","float32"),s=gh(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;const u={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return Ga.runKernel(yn,{boxes:i,scores:o},u)}});function vh(e,t,n){const r=function(e,t,n){return function(e,t,n){let r=0,a=e.length,i=0,o=!1;for(;r<a;){i=r+(a-r>>>1);const s=n(t,e[i]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||bh)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function bh(e,t){return e>t?1:e<t?-1:0}function xh(e,t,n,r,a){return Sh(e,t,n,r,a,0)}function wh(e,t,n,r,a,i){return Sh(e,t,n,r,a,0,!1,i,!0)}function Nh(e,t,n,r,a,i){return Sh(e,t,n,r,a,i,!0)}function Sh(e,t,n,r,a,i){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const c=[];for(let g=0;g<t.length;g++)t[g]>a&&c.push({score:t[g],boxIndex:g,suppressBeginIndex:0});c.sort(Ch);const l=i>0?-.5/i:0,p=[],h=[];for(;p.length<n&&c.length>0;){const t=c.pop(),{score:n,boxIndex:i,suppressBeginIndex:o}=t;if(n<a)break;let s=!1;for(let u=p.length-1;u>=o;--u){const n=kh(e,i,p[u]);if(n>=r){s=!0;break}if(t.score=t.score*Eh(r,l,n),t.score<=a)break}t.suppressBeginIndex=p.length,s||(t.score===n?(p.push(i),h.push(t.score)):t.score>a&&vh(c,t,Ch))}const d=p.length,f=n-d;s&&f>0&&(p.push(...new Array(f).fill(0)),h.push(...new Array(f).fill(0)));const m={selectedIndices:p};return o&&(m.selectedScores=h),u&&(m.validOutputs=d),m}function kh(e,t,n){const r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),p=Math.max(a[0],a[2]),h=Math.max(a[1],a[3]),d=(s-i)*(u-o),f=(p-c)*(h-l);if(d<=0||f<=0)return 0;const m=Math.max(i,c),g=Math.max(o,l),y=Math.min(s,p),v=Math.min(u,h),b=Math.max(y-m,0)*Math.max(v-g,0);return b/(d+f-b)}function Eh(e,t,n){const r=Math.exp(t*n*n);return n<=e?r:0}function Ch(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}const Th=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const i=ei(e,"boxes","nonMaxSuppressionAsync"),o=ei(t,"scores","nonMaxSuppressionAsync"),s=gh(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;const u=await Promise.all([i.data(),o.data()]),c=u[0],l=u[1],{selectedIndices:p}=xh(c,l,n,r,a);return i!==e&&i.dispose(),o!==t&&o.dispose(),Sp(p,"int32")};const Dh=ri({nonMaxSuppressionWithScore_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=ei(e,"boxes","nonMaxSuppression"),s=ei(t,"scores","nonMaxSuppression"),u=gh(o,s,n,r,a,i);n=u.maxOutputSize,r=u.iouThreshold,a=u.scoreThreshold,i=u.softNmsSigma;const c={boxes:o,scores:s},l={maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i},p=Ga.runKernel(bn,c,l);return{selectedIndices:p[0],selectedScores:p[1]}}});const Ih=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=ei(e,"boxes","nonMaxSuppressionAsync"),s=ei(t,"scores","nonMaxSuppressionAsync"),u=gh(o,s,n,r,a,i);n=u.maxOutputSize,r=u.iouThreshold,a=u.scoreThreshold,i=u.softNmsSigma;const c=await Promise.all([o.data(),s.data()]),l=c[0],p=c[1],{selectedIndices:h,selectedScores:d}=Nh(l,p,n,r,a,i);return o!==e&&o.dispose(),s!==t&&s.dispose(),{selectedIndices:Sp(h,"int32"),selectedScores:Sp(d)}};const Ah=ri({nonMaxSuppressionPadded_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=ei(e,"boxes","nonMaxSuppression"),s=ei(t,"scores","nonMaxSuppression"),u=gh(o,s,n,r,a,null),c={boxes:o,scores:s},l={maxOutputSize:u.maxOutputSize,iouThreshold:u.iouThreshold,scoreThreshold:u.scoreThreshold,padToMaxOutputSize:i},p=Ga.runKernel(vn,c,l);return{selectedIndices:p[0],validOutputs:p[1]}}});const Fh=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=ei(e,"boxes","nonMaxSuppressionAsync"),s=ei(t,"scores","nonMaxSuppressionAsync"),u=gh(o,s,n,r,a,null),c=u.maxOutputSize,l=u.iouThreshold,p=u.scoreThreshold,[h,d]=await Promise.all([o.data(),s.data()]),{selectedIndices:f,validOutputs:m}=wh(h,d,c,l,p,i);return o!==e&&o.dispose(),s!==t&&s.dispose(),{selectedIndices:Sp(f,"int32"),validOutputs:Mo(m,"int32")}};const _h=ri({resizeBilinear_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=ei(e,"images","resizeBilinear");B(3===a.rank||4===a.rank,(()=>"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,"."))),B(2===t.length,(()=>"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,"."))),B(!1===r||!1===n,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let i=a,o=!1;3===a.rank&&(o=!0,i=vu(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const[]=t,s={images:i},u={alignCorners:n,halfPixelCenters:r,size:t},c=Ga.runKernel(Bn,s,u);return o?vu(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});const Mh=ri({resizeNearestNeighbor_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=ei(e,"images","resizeNearestNeighbor");B(3===a.rank||4===a.rank,(()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,"."))),B(2===t.length,(()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,"."))),B("float32"===a.dtype||"int32"===a.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),B(!1===r||!1===n,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let i=a,o=!1;3===a.rank&&(o=!0,i=vu(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const[]=t,s={images:i},u={alignCorners:n,halfPixelCenters:r,size:t},c=Ga.runKernel(Rn,s,u);return o?vu(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});const Oh=ri({threshold_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const a=ei(e,"image","threshold"),i=a.shape[0]*a.shape[1];let o,s,u,c,l=Do(Sp([r]),255);if(B(3===a.rank,(()=>"Error in threshold: image must be rank 3,"+"but got rank ".concat(a.rank,"."))),B(3===a.shape[2]||1===a.shape[2],(()=>"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(a.shape[2],"."))),B("int32"===a.dtype||"float32"===a.dtype,(()=>"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(a.dtype,"."))),B("otsu"===t||"binary"===t,(()=>"Method must be binary or otsu, but was ".concat(t))),3===a.shape[2]){[o,s,u]=mp(a,[1,1,1],-1);const e=Do(o,.2989),t=Do(s,.587),n=Do(u,.114);c=Eo(Eo(e,t),n)}else c=e;if("otsu"===t){l=function(e,t){let n,r,a,i,o,s,u=Sp([-1]),c=Sp([0]),l=Sp([0]);for(let p=0;p<e.size-1;p++){n=ku(e,0,p+1),r=ku(e,p+1),o=To(Nc(n),t),s=To(Nc(r),t);const h=Nc(Do(n,ql(0,n.size)));a=To(h,Nc(n));const d=Wo(r.shape,n.size),f=Eo(ql(0,r.size),d),m=Do(r,f);i=To(Nc(m),Nc(r));const g=jo(a,i),y=jo(a,i),v=Do(o,s);l=Do(Do(v,g),y);const b=Mc(l,c);c=ic(b,l,c),u=ic(b,Sp([p]),u)}return u}(_u(No(Jl(c),"int32"),oi([]),256),i)}const p=n?Wc(c,l):Mc(c,l);return No(Do(p,255),"int32")}});const Rh=ri({transform_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0;const o=ei(e,"image","transform","float32"),s=ei(t,"transforms","transform","float32");B(4===o.rank,(()=>"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,"."))),B(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),B(null==i||2===i.length,(()=>"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(i,".")));const u={image:o,transforms:s},c={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return Ga.runKernel(Nr,u,c)}});const zh=ri({bandPart_:function(e,t,n){const r=ei(e,"a","bandPart");B(r.rank>=2,(()=>"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")));const a=r.shape,[i,o]=r.shape.slice(-2);let s,u;"number"===typeof t?(B(t%1===0,(()=>"bandPart(): numLower must be an integer, got ".concat(t,"."))),B(t<=i,(()=>"bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(i,")."))),s=ei(t<0?i:t,"numLower","bandPart")):(B("int32"===t.dtype,(()=>"bandPart(): numLower's dtype must be an int32.")),s=ic(Uc(t,0),i,pl(t,i))),"number"===typeof n?(B(n%1===0,(()=>"bandPart(): numUpper must be an integer, got ".concat(n,"."))),B(n<=o,(()=>"bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(o,")."))),u=ei(n<0?o:n,"numUpper","bandPart")):(B("int32"===n.dtype,(()=>"bandPart(): numUpper's dtype must be an int32.")),u=ic(Uc(n,0),o,pl(n,o)));const c=vu(ql(0,i,1,"int32"),[-1,1]),l=ql(0,o,1,"int32"),p=jo(c,l),h=Zc(Wc(p,s),Oc(p,Hc(u))),d=ul([i,o],r.dtype);return vu(bp(zp(vu(r,[-1,i,o])).map((e=>ic(h,e,d)))),a)}});const Bh=ri({gramSchmidt_:function(e){let t;if(Array.isArray(e)){t=!1,B(null!=e&&e.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const n=e[0].shape[0];for(let t=1;t<e.length;++t)B(e[t].shape[0]===n,(()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")")))}else t=!0,e=mp(e,e.shape[0],0).map((e=>vp(e,[0])));B(e.length<=e[0].shape[0],(()=>"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")));const n=[],r=e;for(let a=0;a<e.length;++a)n.push(Ga.tidy((()=>{let e=r[a];if(a>0)for(let t=0;t<a;++t){const r=Do(Nc(Do(n[t],e)),n[t]);e=jo(e,r)}return To(e,kc(e,"euclidean"))})));return t?bp(n,0):n}});function Lh(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Ga.tidy((()=>{B(2===e.shape.length,(()=>"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")));const n=e.shape[0],r=e.shape[1];let a=Ac(n),i=So(e);const o=kp([[1]],[1,1]);let s=So(o);const u=n>=r?r:n;for(let e=0;e<u;++e){const t=i,u=s,c=a;[s,i,a]=Ga.tidy((()=>{const t=ku(i,[e,e],[n-e,1]),u=kc(t),c=ku(i,[e,e],[1,1]),l=ic(Mc(c,0),kp([[-1]]),kp([[1]])),p=jo(c,Do(l,u)),h=To(t,p);s=1===h.shape[0]?So(o):wu([o,ku(h,[1,0],[h.shape[0]-1,h.shape[1]])],0);const d=Hc(To(Nu(l,p),u)),f=ku(i,[e,0],[n-e,r]),m=Do(d,s),g=Vp(s);if(0===e)i=jo(f,Nu(m,Nu(g,f)));else{const t=jo(f,Nu(m,Nu(g,f)));i=wu([ku(i,[0,0],[e,r]),t],0)}const y=Vp(m),v=ku(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=jo(v,Nu(Nu(v,s),y));else{const t=jo(v,Nu(Nu(v,s),y));a=wu([ku(a,[0,0],[n,e]),t],1)}return[s,i,a]})),hi([t,u,c])}return!t&&n>r&&(a=ku(a,[0,0],[n,r]),i=ku(i,[0,0],[r,r])),[a,i]}))}const Ph=ri({qr_:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(B(e.rank>=2,(()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank))),2===e.rank)return Lh(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce(((e,t)=>e*t)),r=zp(vu(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];r.forEach((e=>{const[n,r]=Lh(e,t);a.push(n),i.push(r)}));return[vu(bp(a,0),e.shape),vu(bp(i,0),e.shape)]}}});var Uh;!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Uh||(Uh={}));const Wh=ri({computeWeightedLoss_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Uh.SUM_BY_NONZERO_WEIGHTS;const r=ei(e,"losses","computeWeightedLoss");let a=null;null!=t&&(a=ei(t,"weights","computeWeightedLoss"));const i=null==a?r:Do(r,a);if(n===Uh.NONE)return i;if(n===Uh.SUM)return Nc(i);if(n===Uh.MEAN){if(null==a)return sl(i);{const e=r.size/a.size,t=To(Nc(i),Nc(a));return e>1?To(t,Mo(e)):t}}if(n===Uh.SUM_BY_NONZERO_WEIGHTS){if(null==a)return To(Nc(i),Mo(r.size));{const e=Do(a,cl(r.shape)),t=No(Nc(yl(e,Mo(0))),"float32");return To(Nc(i),t)}}throw Error("Unknown reduction: ".concat(n))}});const Vh=ri({absoluteDifference_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Uh.SUM_BY_NONZERO_WEIGHTS;const a=ei(e,"labels","absoluteDifference"),i=ei(t,"predictions","absoluteDifference");let o=null;null!=n&&(o=ei(n,"weights","absoluteDifference")),L(a.shape,i.shape,"Error in absoluteDifference: ");const s=Ho(jo(a,i));return Wh(s,o,r)}});const qh=ri({cosineDistance_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Uh.SUM_BY_NONZERO_WEIGHTS;const i=ei(e,"labels","cosineDistance"),o=ei(t,"predictions","cosineDistance");let s=null;null!=r&&(s=ei(r,"weights","cosineDistance")),L(i.shape,o.shape,"Error in cosineDistance: ");const u=Mo(1),c=jo(u,Nc(Do(i,o),n,!0));return Wh(c,s,a)}});const jh=ri({hingeLoss_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Uh.SUM_BY_NONZERO_WEIGHTS,a=ei(e,"labels","hingeLoss");const i=ei(t,"predictions","hingeLoss");let o=null;null!=n&&(o=ei(n,"weights","hingeLoss")),L(a.shape,i.shape,"Error in hingeLoss: ");const s=Mo(1);a=jo(Do(Mo(2),a),s);const u=Hl(jo(s,Do(a,i)));return Wh(u,o,r)}});const Gh=ri({huberLoss_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Uh.SUM_BY_NONZERO_WEIGHTS;const i=ei(e,"labels","huberLoss"),o=ei(t,"predictions","huberLoss");let s=null;null!=n&&(s=ei(n,"weights","huberLoss")),L(i.shape,o.shape,"Error in huberLoss: ");const u=Mo(r),c=Ho(jo(o,i)),l=pl(c,u),p=jo(c,l),h=Eo(Do(Mo(.5),Ao(l)),Do(u,p));return Wh(h,s,a)}});const Hh=ri({logLoss_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Uh.SUM_BY_NONZERO_WEIGHTS;const i=ei(e,"labels","logLoss"),o=ei(t,"predictions","logLoss");let s=null;null!=n&&(s=ei(n,"weights","logLoss")),L(i.shape,o.shape,"Error in logLoss: ");const u=Mo(1),c=Mo(r),l=Hc(Do(i,jc(Eo(o,c)))),p=Do(jo(u,i),jc(Eo(jo(u,o),c))),h=jo(l,p);return Wh(h,s,a)}});const Kh=ri({meanSquaredError_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Uh.SUM_BY_NONZERO_WEIGHTS;const a=ei(e,"labels","meanSquaredError"),i=ei(t,"predictions","meanSquaredError");let o=null;null!=n&&(o=ei(n,"weights","meanSquaredError")),L(a.shape,i.shape,"Error in meanSquaredError: ");const s=yp(a,i);return Wh(s,o,r)}});const Xh=ri({sigmoidCrossEntropy_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Uh.SUM_BY_NONZERO_WEIGHTS,i=ei(e,"multiClassLabels","sigmoidCrossEntropy");const o=ei(t,"logits","sigmoidCrossEntropy");let s=null;if(null!=n&&(s=ei(n,"weights","sigmoidCrossEntropy")),L(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const e=Mo(r),t=Mo(1),n=Mo(.5);i=Eo(Do(i,jo(t,e)),Do(n,e))}const u=function(e,t){const n=ei(e,"labels","sigmoidCrossEntropyWithLogits"),r=ei(t,"logits","sigmoidCrossEntropyWithLogits");L(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const a=Hl(r),i=Do(r,n),o=Gc(Cc(Hc(Ho(r))));return Eo(jo(a,i),o)}(i,o);return Wh(u,s,a)}});const Yh=ri({softmaxCrossEntropy_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Uh.SUM_BY_NONZERO_WEIGHTS,i=ei(e,"onehotLabels","softmaxCrossEntropy");const o=ei(t,"logits","softmaxCrossEntropy");let s=null;if(null!=n&&(s=ei(n,"weights","softmaxCrossEntropy")),L(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const e=Mo(r),t=Mo(1),n=Mo(i.shape[1]);i=Eo(Do(i,jo(t,e)),To(e,n))}const u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));const r=_o(((e,t,r)=>{const a=$c(t,[n],!0),i=jo(No(t,"float32"),a);r([e,i]);const o=Hc(Do(i,e));return{value:Nc(o,[n]),gradFunc:(e,t)=>{const[r,a]=t,i=mc(e.shape,[n]);return[Do(vu(e,i),jo(No(r,"float32"),Cc(a))),Do(vu(e,i),jo(Cc(a),No(r,"float32")))]}}}));return r(e,t)}(i,o);return Wh(u,s,a)}});const $h=ri({sparseFillEmptyRows_:function(e,t,n,r){const a=ei(e,"indices","sparseFillEmptyRows","int32"),i=ei(t,"values","sparseFillEmptyRows"),o=ei(n,"denseShape","sparseFillEmptyRows","int32"),s=ei(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(2!==a.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(a.shape));if(1!==i.rank)throw new Error("Values should be Tensor1D but received shape ".concat(i.shape));if(1!==o.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(o.shape));if(0!==s.rank)throw new Error("Default value should be a scalar but received shape ".concat(s.shape));const u={indices:a,values:i,denseShape:o,defaultValue:s},c=Ga.runKernel(ir,u);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}});const Zh=ri({sparseReshape_:function(e,t,n){const r=ei(e,"inputIndices","sparseReshape","int32"),a=ei(t,"inputShape","sparseReshape","int32"),i=ei(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==a.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(a.shape));if(1!==i.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(i.shape));const o={inputIndices:r,inputShape:a,newShape:i},s=Ga.runKernel(or,o);return{outputIndices:s[0],outputShape:s[1]}}});const Qh=ri({sparseSegmentMean_:function(e,t,n){const r=ei(e,"data","sparseSegmentMean"),a=ei(t,"indices","sparseSegmentMean","int32"),i=ei(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(a.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(i.shape));const o={data:r,indices:a,segmentIds:i};return Ga.runKernel(sr,o)}});const Jh=ri({sparseSegmentSum_:function(e,t,n){const r=ei(e,"data","sparseSegmentSum"),a=ei(t,"indices","sparseSegmentSum","int32"),i=ei(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(a.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(i.shape));const o={data:r,indices:a,segmentIds:i};return Ga.runKernel(ur,o)}});const ed=ri({stringNGrams_:function(e,t,n,r,a,i,o,s){const u=ei(e,"data","stringNGrams","string");if("string"!==u.dtype)throw new Error("Data must be of datatype string");if(1!==u.shape.length)throw new Error("Data must be a vector, saw: ".concat(u.shape));const c=ei(t,"dataSplits","stringNGrams");if("int32"!==c.dtype)throw new Error("Data splits must be of datatype int32");const l={separator:n,nGramWidths:r,leftPad:a,rightPad:i,padWidth:o,preserveShortSequences:s},p={data:u,dataSplits:c},h=Ga.runKernel(fr,p,l);return{nGrams:h[0],nGramsSplits:h[1]}}});const td=ri({stringSplit_:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=ei(e,"input","stringSplit","string"),a=ei(t,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==a.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(a.shape));const i={skipEmpty:n},o={input:r,delimiter:a},s=Ga.runKernel(mr,o,i);return{indices:s[0],values:s[1],shape:s[2]}}});const nd=ri({stringToHashBucketFast_:function(e,t){const n=ei(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const a={input:n};return Ga.runKernel(gr,a,r)}});const rd=ri({staticRegexReplace_:function(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const a=ei(e,"input","staticRegexReplace","string"),i={pattern:t,rewrite:n,replaceGlobal:r};return Ga.runKernel(hr,{x:a},i)}}),ad={fft:hp,ifft:dp,rfft:gp,irfft:fp},id={hammingWindow:sh,hannWindow:uh,frame:ch,stft:lh},od={flipLeftRight:hh,grayscaleToRGB:dh,resizeNearestNeighbor:Mh,resizeBilinear:_h,rgbToGrayscale:fh,rotateWithOffset:mh,cropAndResize:ph,nonMaxSuppression:yh,nonMaxSuppressionAsync:Th,nonMaxSuppressionWithScore:Dh,nonMaxSuppressionWithScoreAsync:Ih,nonMaxSuppressionPadded:Ah,nonMaxSuppressionPaddedAsync:Fh,threshold:Oh,transform:Rh},sd={bandPart:zh,gramSchmidt:Bh,qr:Ph},ud={absoluteDifference:Vh,computeWeightedLoss:Wh,cosineDistance:qh,hingeLoss:jh,huberLoss:Gh,logLoss:Hh,meanSquaredError:Kh,sigmoidCrossEntropy:Xh,softmaxCrossEntropy:Yh},cd={sparseFillEmptyRows:$h,sparseReshape:Zh,sparseSegmentMean:Qh,sparseSegmentSum:Jh},ld={stringNGrams:ed,stringSplit:td,stringToHashBucketFast:nd,staticRegexReplace:rd};const pd=class{static sgd(e){return new Qo(e)}static momentum(e,t){return new Jo(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}static rmsprop(e){return new es(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]&&arguments[4])}static adam(){return new Go(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)}static adadelta(){return new Uo(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}static adamax(){return new Zo(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)}static adagrad(e){return new Vo(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1)}},hd="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:e=>e();function dd(){return new Promise((e=>hd((()=>e()))))}function fd(e,t){const n=e[0].length;e.forEach(((e,t)=>{B(e.length===n,(()=>"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")))})),B(t>=0&&t<n,(()=>"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")));const r=e[0];e.forEach(((e,a)=>{for(let i=0;i<n;i++)B(i===t||e[i]===r[i],(()=>"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")))}))}function md(e,t){const n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}var gd;function yd(e,t,n){let r=new Array;if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.rank = ").concat(e+n.length,", but shape.rank = ").concat(r.length));for(let a=1;a<n.length;++a){const i=n[a],o=r[r.length-n.length+a],s=r[o];if(i>=0)if(s>=0){if(s!==i)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.shape[").concat(a+e,"] = ").concat(i," but shape[").concat(a+e,"] = ").concat(s))}else r[o]=i}return r}function vd(e){const t={FIRST_DIM_SIZE:gd.FIRST_DIM_SIZE,VALUE_ROWIDS:gd.VALUE_ROWIDS,ROW_LENGTHS:gd.ROW_LENGTHS,ROW_SPLITS:gd.ROW_SPLITS,ROW_LIMITS:gd.ROW_LIMITS,ROW_STARTS:gd.ROW_STARTS},n=[];for(const r of e){if(!(r in t))break;n.push(t[r])}return n}function bd(e){return 0===e.length?0:e[0]===gd.FIRST_DIM_SIZE?e.length-1:e.length}function xd(e,t){if(null==e||null==t)return;const n=e.length,r=t.length;if(n>=r)throw new Error("defaultValue.shape=".concat(e," and ragged tensor flatValues.shape=").concat(t,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(let a=0;a<Math.min(n,r-1);++a){const n=e[a],r=t[a+1];if(n>=0&&r>=0&&1!==n&&n!==r)throw new Error("defaultValue.shape=".concat(e,", and ragged tensor input flatValues.shape=").concat(t," are incompatible: defaultValue.shape[").concat(a-e.length,"] = ").concat(n," but ragged tensor input.flatValues.shape[").concat(a-e.length,"] = ").concat(r))}}!function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(gd||(gd={}));const wd=30;function Nd(e){return e<=wd?e:re(e,Math.floor(Math.sqrt(e)))}function Sd(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function kd(e,t,n){let r=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])r=r.concat(t.slice(0)),r.push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);const n=t.length;for(let a=0;a<n;++a)r=r.concat([e[a+1]/t[a],t[a]]);r=r.concat(e.slice(n+1))}return r}function Ed(e,t){const n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(t);for(let r=t+1;r<e;++r)r<=2*t?(n.push(r),n.push(r-(t+1))):n.push(r)}else{const r=[],a=[];for(let n=1;n<e;++n)n>=2*t+1||n%2===1?a.push(n):r.push(n);n.push(...r),n.push(0),n.push(...a)}return n}function Cd(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(let i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function Td(e,t){const n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function Dd(e,t,n){const r=e.slice(0,1);for(let a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}function Id(e,t){const n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[r-1]," vs. ").concat(n));if(0===U(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));const a=t.shape,i=a[a.length-1];let o=1;for(let p=0;p<a.length-1;++p)o*=a[p];const s=e.shape,u=a.slice();u.pop();let c=1;for(let p=i;p<n;++p)c*=s[p],u.push(s[p]);const l=[...ae(e.shape).map((e=>e/c)),1].slice(0,i);return[u,o,c,l]}const Ad=1.7580993408473768,Fd=1.0507009873554805,_d=.3275911,Md=.254829592,Od=-.284496736,Rd=1.421413741,zd=-1.453152027,Bd=1.061405429;function Ld(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));const n=new Float32Array(2*e.length);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function Pd(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function Ud(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function Wd(e){const t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function Vd(e,t){return{real:e[2*t],imag:e[2*t+1]}}function qd(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function jd(e,t){const n=new Float32Array(e/2),r=new Float32Array(e/2);for(let a=0;a<Math.ceil(e/2);a++){const i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function Gd(e,t,n){const r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}const Hd="->",Kd=/->/g,Xd=",",Yd="...";function $d(e,t){const n=((e=e.replace(/\s/g,"")).length-e.replace(Kd,"").length)/Hd.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(Hd,'").'));const[r,a]=e.split(Hd);B(-1===r.indexOf(Yd),(()=>'The ellipsis notation ("'.concat(Yd,'") is not supported yet.')));const i=r.split(Xd),o=i.length;if(t!==o)throw new Error("Expected ".concat(o," input tensors, received ").concat(t));if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const s=[];for(let p=0;p<a.length;++p){const e=a[p];if(!i.some((t=>-1!==t.indexOf(e))))throw new Error("Output subscripts contain the label ".concat(e," ")+"not present in the input subscripts.");-1===s.indexOf(e)&&s.push(e)}for(let p=0;p<r.length;++p){const e=r[p];-1===s.indexOf(e)&&e!==Xd&&s.push(e)}const u=new Array(i.length);for(let p=0;p<o;++p){if(new Set(i[p].split("")).size!==i[p].length)throw new Error("Found duplicate axes in input component ".concat(i[p],". ")+"Support for duplicate axes in input is not implemented yet.");u[p]=[];for(let e=0;e<i[p].length;++e)u[p].push(s.indexOf(i[p][e]))}const c=s.length,l=[];for(let p=a.length;p<c;++p)l.push(p);return{allDims:s,summedDims:l,idDims:u}}function Zd(e,t){let n=new Array(e);n.fill(-1);for(let a=0;a<t.length;++a)n[t[a]]=a;const r=[];for(let a=0;a<e;++a)-1===n[a]&&r.push(a);return n=n.filter((e=>-1!==e)),{permutationIndices:n,expandDims:r}}function Qd(e,t,n){const r=new Array(e);for(let a=0;a<n.length;++a){const e=n[a].shape;for(let n=0;n<t[a].length;++n)void 0===r[t[a][n]]?r[t[a][n]]=e[n]:B(r[t[a][n]]===e[n],(()=>"Expected dimension ".concat(r[t[a][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(e),", ")+"but got dimension ".concat(e[n])))}}function Jd(e,t){const n=e,r=[];let a=0;0===e.length&&n.push(-1),a=e.length+1;for(let o=0;o<a;++o)r.push([]);const i=[];for(let o=0;o<n.length;++o){const e=tf(t,n[o]);for(const t of e)-1===i.indexOf(t)&&(r[o].push(t),i.push(t))}return{path:n,steps:r}}function ef(e){return e.every(((e,t)=>e===t))}function tf(e,t){const n=[];for(let r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function nf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)B(e.shape[n]%t===0,(()=>"Number of splits must evenly divide the axis.")),r=new Array(t).fill(e.shape[n]/t);else{const a=t.reduce(((e,t)=>(-1===t&&(e+=1),e)),0);B(a<=1,(()=>"There should be only one negative value in split array."));const i=t.indexOf(-1);if(-1!==i){const r=t.reduce(((e,t)=>t>0?e+t:e));t[i]=e.shape[n]-r}B(e.shape[n]===t.reduce(((e,t)=>e+t)),(()=>"The sum of sizes must match the size of the axis dimension.")),r=t}return r}function rf(e){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(e)}function af(e,t){return"indices(".concat(e,", 0) is invalid: ").concat(t," < 0")}function of(e,t,n){return"indices(".concat(e,", 0) is invalid: ").concat(t," >= ").concat(n)}function sf(e,t){return"only one output dimension may be -1, not both ".concat(e," and ").concat(t)}function uf(e,t){return"size ".concat(e," must be non-negative, not ").concat(t)}function cf(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function lf(e,t){const n=U(e),r=U(t);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(e," outputShape= ").concat(t)}function pf(e,t){const n=U(e),r=U(t);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(e," outputShape=").concat(t)}function hf(){return"segment ids must be >= 0"}function df(){return"segment ids are not increasing"}function ff(e,t){return"Segment id ".concat(e," out of range [0, ").concat(t,"), possibly because segmentIds input is not sorted.")}function mf(e,t,n){return"Bad: indices[".concat(e,"] == ").concat(t," out of range [0, ").concat(n,")")}function gf(e,t){let n,r=!1;for(e<=wd?(n=e,r=!0):n=re(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=re(e,n+1);return n}function yf(e,t,n){const r=[],a=e.length;for(let i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}function vf(e,t,n,r){const a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(let p=0;p<r;++p)if(e.shape[p]!==t.shape[p])throw new Error("x.shape[".concat(p,"]: ").concat(e.shape[p]," should be equal to indices.shape[").concat(p,"]: ").concat(t.shape[p],"."));const o=e.shape[n],s=[];let u=1,c=1,l=1;for(let p=0;p<r;++p)s.push(e.shape[p]),u*=e.shape[p];for(let p=r;p<n;p++)s.push(e.shape[p]),c*=e.shape[p];for(let p=r;p<a;p++)s.push(t.shape[p]);for(let p=n+1;p<i;p++)s.push(e.shape[p]),l*=e.shape[p];return{batchSize:u,sliceSize:l,outerSize:c,dimSize:o,outputShape:s}}function bf(e){try{return e.map((e=>ca(e)))}catch(r5){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(r5))}}function xf(e){return e.map((e=>ua(e)))}!function(){for(const e of ts)Lo(e)}();const wf={},Nf={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Sf(e,t){if(!(e in wf)||null!=t){const n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=null==t?function(e){if(ye().getBool("IS_SAFARI")||"undefined"===typeof OffscreenCanvas||2!==e){if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(e):t;n.addEventListener("webglcontextlost",(t=>{t.preventDefault(),delete wf[e]}),!1),ye().getBool("SOFTWARE_WEBGL_ENABLED")&&(Nf.failIfMajorPerformanceCaveat=!1);if(1===e)return n.getContext("webgl",Nf)||n.getContext("experimental-webgl",Nf);return n.getContext("webgl2",Nf)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;wf[e]=n}const n=wf[e];return null==n||n.isContextLost()?(delete wf[e],Sf(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),wf[e])}var kf,Ef,Cf;function Tf(e,t){return[t,e]}function Df(e){const t=U(e);return q(Math.ceil(t/4))}function If(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Af(e,t){const n=e;let r,a,i,o,s,u,c,l,p,h;return 2===ye().getNumber("WEBGL_VERSION")?(r=n.R32F,a=n.R16F,i=n.RGBA16F,o=n.RGBA32F,s=n.RED,c=4,l=1,p=n.HALF_FLOAT,h=n.FLOAT,u=n.RGBA8):(r=e.RGBA,a=e.RGBA,i=e.RGBA,o=n.RGBA,s=e.RGBA,c=4,l=4,p=null!=t?t.HALF_FLOAT_OES:null,h=e.FLOAT,u=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:u,downloadUnpackNumChannels:c,defaultNumChannels:l,textureTypeHalfFloat:p,textureTypeFloat:h}}function Ff(e,t){const n=t();return ye().getBool("DEBUG")&&function(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(kf||(kf={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Ef||(Ef={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Cf||(Cf={}));function _f(e){return!!(ye().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function Mf(e,t){return Vf(e,(()=>e.getExtension(t)),'Extension "'+t+'" not supported on this browser.')}const Of=/ERROR: [0-9]+:([0-9]+):/g;function Rf(e,t){const n=Of.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);const r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map(((e,t)=>j((t+1).toString(),i)+e));let s=0;for(let p=0;p<o.length;p++)s=Math.max(o[p].length,s);const u=o.slice(0,r-1),c=o.slice(r-1,r),l=o.slice(r);console.log(u.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(j(c[0],s)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(l.join("\n"))}function zf(e,t){if(Ff(e,(()=>e.validateProgram(t))),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function Bf(e,t,n,r,a,i,o){const s=e.getAttribLocation(t,n);return-1!==s&&(Ff(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,r))),Ff(e,(()=>e.vertexAttribPointer(s,a,e.FLOAT,!1,i,o))),Ff(e,(()=>e.enableVertexAttribArray(s))),!0)}function Lf(e,t,n,r){Ff(e,(()=>function(e,t,n){qf(e,n),Ff(e,(()=>e.activeTexture(e.TEXTURE0+n))),Ff(e,(()=>e.bindTexture(e.TEXTURE_2D,t)))}(e,t,r))),Ff(e,(()=>e.uniform1i(n,r)))}function Pf(e,t,n){Ff(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,n))),Ff(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)))}function Uf(e,t){Ff(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,t))),Ff(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)))}function Wf(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function Vf(e,t,n){const r=Ff(e,(()=>t()));if(null==r)throw new Error(n);return r}function qf(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){const e="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(e,"."))}}function jf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return U(e.slice(0,e.length-t))}function Gf(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Hf(e){let t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[jf(e),...Gf(e)]),t}function Kf(e){return e%2===0}function Xf(e,t){if(W(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){const n=e[e.length-1],r=t[t.length-1];if(n===r)return!0;if(Kf(n)&&Kf(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&Kf(e[0])&&Kf(t[0])}let Yf,$f;function Zf(e,t){return null!=e.getExtension(t)}function Qf(e){try{if(null!=Sf(e))return!0}catch(Z2){return console.log("Error when getting WebGL context: ",Z2),!1}return!1}function Jf(e){if(0===e)return!1;const t=Sf(e);if(1!==e){if(Zf(t,"EXT_color_buffer_float"))return em(t);const e="EXT_color_buffer_half_float";if(Zf(t,e)){const n=t.getExtension(e);return function(e,t){const n=Af(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);const a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),s}(t,n)}return!1}if(!Zf(t,"OES_texture_float"))return!1;if(!Zf(t,"WEBGL_color_buffer_float"))return!1;return em(t)}function em(e){const t=Af(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function tm(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&B("complex64"!==e.dtype,(()=>"".concat(t," does not support complex64 tensors ")+"in the WebGL backend."))}))}const nm=ye();function rm(){let e,t,n,r,a,i,o,s,u,c;return 2===ye().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s=ye().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function am(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=ae(t);return r.map(((t,a)=>{const i="int ".concat(e[a]," = ").concat(n," / ").concat(t),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(i,"; ").concat(o,";")})).join("")}function im(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=ae(t);return r.map(((t,a)=>{const i="int ".concat(e[a]," = ").concat(n," / outShapeStrides[").concat(a,"]"),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * outShapeStrides[").concat(a,"]"):"index -= ".concat(e[a]," * outShapeStrides[").concat(a,"]");return"".concat(i,"; ").concat(o,";")})).join("")}function om(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=function(e,t){const n=e.length,r=e.map((e=>"".concat(t,"[").concat(e,"]"))),a=new Array(n-1);a[n-2]=r[n-1];for(let i=n-3;i>=0;--i)a[i]="(".concat(a[i+1]," * ").concat(r[i+1],")");return a}(e.map(((e,t)=>t)),t);return r.map(((t,a)=>{const i="int ".concat(e[a]," = ").concat(n," / ").concat(r[a]),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(r[a]):"index -= ".concat(e[a]," * ").concat(r[a]);return"".concat(i,"; ").concat(o,";")})).join("")}function sm(e){const t=ae(e).map((e=>e.toString()));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}nm.registerFlag("HAS_WEBGL",(()=>nm.getNumber("WEBGL_VERSION")>0)),nm.registerFlag("WEBGL_VERSION",(()=>Qf(2)?2:Qf(1)?1:0)),nm.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(()=>!1)),nm.registerFlag("WEBGL_BUFFER_SUPPORTED",(()=>2===nm.get("WEBGL_VERSION"))),nm.registerFlag("WEBGL_CPU_FORWARD",(()=>!0)),nm.registerFlag("WEBGL_FORCE_F16_TEXTURES",(()=>!1)),nm.registerFlag("WEBGL_PACK",(()=>nm.getBool("HAS_WEBGL"))),nm.registerFlag("WEBGL_PACK_NORMALIZATION",(()=>nm.getBool("WEBGL_PACK"))),nm.registerFlag("WEBGL_PACK_CLIP",(()=>nm.getBool("WEBGL_PACK"))),nm.registerFlag("WEBGL_PACK_DEPTHWISECONV",(()=>nm.getBool("WEBGL_PACK"))),nm.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(()=>nm.getBool("WEBGL_PACK"))),nm.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(()=>nm.getBool("WEBGL_PACK"))),nm.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(()=>nm.getBool("WEBGL_PACK"))),nm.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(()=>nm.getBool("WEBGL_PACK"))),nm.registerFlag("WEBGL_PACK_REDUCE",(()=>nm.getBool("WEBGL_PACK"))),nm.registerFlag("WEBGL_LAZILY_UNPACK",(()=>nm.getBool("WEBGL_PACK"))),nm.registerFlag("WEBGL_CONV_IM2COL",(()=>nm.getBool("WEBGL_PACK"))),nm.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",(()=>nm.getBool("WEBGL_PACK"))),nm.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(()=>function(e){if(null==Yf){const t=Sf(e);Yf=t.getParameter(t.MAX_TEXTURE_SIZE)}return Yf}(nm.getNumber("WEBGL_VERSION")))),nm.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(()=>function(e){if(null==$f){const t=Sf(e);$f=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,$f)}(nm.getNumber("WEBGL_VERSION")))),nm.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(()=>{const e=nm.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;let t;const n=Sf(e);return t=Zf(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:Zf(n,"EXT_disjoint_timer_query")?1:0,t}(e)})),nm.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(()=>nm.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Xa())),nm.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(()=>function(e){if(0===e)return!1;const t=Sf(e);if(1===e){if(!Zf(t,"OES_texture_float"))return!1}else if(!Zf(t,"EXT_color_buffer_float"))return!1;return em(t)}(nm.getNumber("WEBGL_VERSION")))),nm.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(()=>!nm.getBool("WEBGL_FORCE_F16_TEXTURES")&&nm.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))),nm.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(()=>Jf(nm.getNumber("WEBGL_VERSION")))),nm.registerFlag("WEBGL_FENCE_API_ENABLED",(()=>{return 2===(e=nm.getNumber("WEBGL_VERSION"))&&null!=Sf(e).fenceSync;var e})),nm.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(()=>nm.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0)),nm.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(()=>-1),(e=>{if("number"!==typeof e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but "+"got ".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))})),nm.registerFlag("WEBGL_FLUSH_THRESHOLD",(()=>Xa()?1:-1),(e=>{if("number"!==typeof e)throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got "+"".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))})),nm.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(()=>128)),nm.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(()=>!1)),nm.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(()=>1e5)),nm.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(()=>128)),nm.registerFlag("WEBGL_EXP_CONV",(()=>!1)),nm.registerFlag("SOFTWARE_WEBGL_ENABLED",(()=>nm.getBool("IS_TEST"))),nm.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(()=>1/0)),nm.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(()=>!1)),nm.registerFlag("WEBGL2_ISNAN_CUSTOM",(()=>!1)),nm.registerFlag("ENGINE_COMPILE_ONLY",(()=>!1));const um="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:cm}=i;function lm(e,t,n){const r=[];if(e.forEach((e=>{const t=U(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(r.push("uniform sampler2D ".concat(e.name,";")),r.push("uniform int offset".concat(e.name,";"))),n.enableShapeUniforms){const{uniformShape:t}=xm(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape);switch(t.length){case 1:r.push("uniform int ".concat(e.name,"Shape;"));break;case 2:r.push("uniform ivec2 ".concat(e.name,"Shape;"));break;case 3:r.push("uniform ivec3 ".concat(e.name,"Shape;"));break;case 4:r.push("uniform ivec4 ".concat(e.name,"Shape;"))}r.push("uniform ivec2 ".concat(e.name,"TexShape;"))}})),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((e=>{r.push("uniform ".concat(e.type," ").concat(e.name).concat(e.arrayIndex?"[".concat(e.arrayIndex,"]"):"",";"))}));const a=r.join("\n"),i=e.map((e=>function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,a="";a+=n?hm(e,r):pm(e,r);const i=e.shapeInfo.logicalShape,o=t.logicalShape;i.length<=o.length&&(a+=n?function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=e.shapeInfo.logicalShape.length,o=t.logicalShape.length,s=cm(e.shapeInfo.logicalShape,t.logicalShape),u=bm(o),c=o-i;let l;const p=["x","y","z","w","u","v"];l=0===i?"":o<2&&s.length>=1?"coords = 0;":s.map((e=>"coords.".concat(p[e+c]," = 0;"))).join("\n");let h="";h=o<2&&i>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>"coords.".concat(p[t+c]))).join(", ");let d="return outputValue;";const f=1===U(e.shapeInfo.logicalShape),m=U(t.logicalShape),g=1===m;if(1!==i||f||g){if(f&&!g)d=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(s.length){const e=i-2,t=i-1;s.indexOf(e)>-1&&s.indexOf(t)>-1?d="return vec4(outputValue.x);":s.indexOf(e)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(t)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}}else d="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(a,"() {\n      ").concat(u," coords = getOutputCoords();\n      ").concat(l,"\n      vec4 outputValue = get").concat(r,"(").concat(h,");\n      ").concat(d,"\n    }\n  ")}(e,t):function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===u&&null==e.shapeInfo.flatOffset&&W(o,i))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");const c=bm(u),l=cm(e.shapeInfo.logicalShape,t.logicalShape),p=u-s;let h;const d=["x","y","z","w","u","v"];h=0===s?"":u<2&&l.length>=1?"coords = 0;":l.map((e=>"coords.".concat(d[e+p]," = 0;"))).join("\n");let f="";f=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>"coords.".concat(d[t+p]))).join(", ");return"\n    float ".concat(a,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(h,"\n      return get").concat(r,"(").concat(f,");\n    }\n  ")}(e,t));return a}(e,t,n.packedInputs,n.enableShapeUniforms))).join("\n"),o=t.texShape,s=rm(),u=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(s);let c,l,p=function(e){const t="".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(dm,"\n    ").concat(fm,"\n    ").concat(mm,"\n  ");return t}(s);t.isPacked?(c=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    ");if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(W(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(r[0],", ").concat(r[1],"));\n      }\n    ");const a=Math.ceil(e[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[2]/2),i=a*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[e.length-1]/2),i=a*Math.ceil(e[e.length-2]/2);let o=i,s="",u="b, r, c";for(let c=2;c<e.length-1;c++)o*=e[e.length-c-1],s="\n      int b".concat(c," = index / ").concat(o,";\n      index -= b").concat(c," * ").concat(o,";\n    ")+s,u="b".concat(c,", ")+u;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(s,"\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec").concat(e.length,"(").concat(u,");\n    }\n  ")}(e,t,n)}}(t.logicalShape,o,n.enableShapeUniforms),l=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(s)):(c=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){if(1===t[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){if(W(e,t))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n){const t=im(["r","c","d"],e);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(t,"\n    return ivec3(r, c, d);\n  }\n")}const r=am(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t,n);case 4:return function(e,t,n){if(n){const t=im(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(t,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}const r=am(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t,n);case 5:return function(e,t){const n=am(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){const n=am(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,o,n.enableShapeUniforms),l=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(s)),n.packedInputs&&(p+=gm);return[p,u,l,a,c,i,n.userCode].join("\n")}function pm(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");const[a,i]=e.shapeInfo.texShape;if(1===a&&1===i)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const o=ym(n);if(t)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");const[s,u]=e.shapeInfo.texShape;return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(u,", ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(vm(e),"\n      }\n    ");const a=e.shapeInfo.texShape,i=a[0],o=a[1];if(1===o&&1===i)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const s=ym(n);if(1===o)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / ").concat(i,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(1===i)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / ").concat(o,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(t)return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(i,", ").concat(o,", index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape;if(null!=i&&W(n,i)){if(t)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");const e=i[0],n=i[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(n,".0, ").concat(e,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}const{newShape:o,keptDims:s}=X(n),u=o;if(u.length<n.length){const n=wm(e,u),r=["row","col"];return"\n      ".concat(pm(n,t),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(Nm(r,s),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(vm(e),"\n      }\n    ");const c=i[0],l=i[1],p=ym(r);if(1===l)return t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(p,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(p,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(c,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(1===c)return t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(p,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(p,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(l,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(t)return"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(p,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");return"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(p,";\n    vec2 uv = uvFromFlat(").concat(c,", ").concat(l,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],{newShape:s,keptDims:u}=X(n),c=s;if(c.length<n.length){const n=wm(e,c),r=["row","col","depth"];return"\n        ".concat(pm(n,t),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(Nm(r,u),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(i,", ").concat(o,", 1)));\n        ").concat(vm(e),"\n      }\n    ");const l=e.shapeInfo.texShape,p=l[0],h=l[1],d=e.shapeInfo.flatOffset;if(h===i&&null==d)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(o,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(h,".0, ").concat(p,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(h===o&&null==d)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(h,".0, ").concat(p,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");const f=ym(r);if(t)return"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    ");return"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(i," + col * ").concat(o," + depth + ").concat(f,";\n        vec2 uv = uvFromFlat(").concat(p,", ").concat(h,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}(e,t);case 4:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,s=n[1]*o,{newShape:u,keptDims:c}=X(n);if(u.length<n.length){const n=wm(e,u),r=["row","col","depth","depth2"];return"\n      ".concat(pm(n,t),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(Nm(r,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(s,", ").concat(o,", ").concat(i,", 1)));\n        ").concat(vm(e),"\n      }\n    ");const l=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,h=p[0],d=p[1],f="int stride2 = ".concat(r,"Shape[3];"),m="int stride1 = ".concat(r,"Shape[2] * stride2;"),g="int stride0 = ".concat(r,"Shape[1] * stride1;");if(d===s&&null==l)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(f,"\n        ").concat(m,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(o,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(d,".0, ").concat(h,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(d===i&&null==l)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(d,".0, ").concat(h,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");const y=ym(r);if(t)return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(f,"\n      ").concat(m,"\n      ").concat(g,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(y,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," +\n          depth * ").concat(i," + depth2;\n      vec2 uv = uvFromFlat(").concat(h,", ").concat(d,", index + ").concat(y,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}(e,t);case 5:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,o=t[2]*i,s=t[1]*o,{newShape:u,keptDims:c}=X(t);if(u.length<t.length){const t=wm(e,u),n=["row","col","depth","depth2","depth3"];return"\n      ".concat(pm(t),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(Nm(n,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(s,", ").concat(o,", ").concat(i,", ").concat(a,")) +\n          depth3;\n        ").concat(vm(e),"\n      }\n    ");const l=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,h=p[0],d=p[1];if(d===s&&null==l)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(o,", ").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(d,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(d===a&&null==l)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(d,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const f=ym(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," + depth * ").concat(i," +\n          depth2 * ").concat(a," + depth3 + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(h,", ").concat(d,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:a,keptDims:i}=X(t);if(a.length<t.length){const t=wm(e,a),n=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(pm(t),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(Nm(n,i),");\n      }\n    ")}const o=t[5],s=t[4]*o,u=t[3]*s,c=t[2]*u,l=t[1]*c;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(l,", ").concat(c,", ").concat(u,", ").concat(s,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(o,", 1)));\n        ").concat(vm(e),"\n      }\n    ");const p=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,d=h[0],f=h[1];if(f===l&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(c,", ").concat(u,", ").concat(s,", ").concat(o,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(f,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(f===o&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(f,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const m=ym(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(l," + col * ").concat(c," + depth * ").concat(u," +\n          depth2 * ").concat(s," + depth3 * ").concat(o," + depth4 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(d,", ").concat(f,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function hm(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){const t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=rm();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=rm();if(t)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ");const o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(o[0],", ").concat(o[1],", index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=i[0],s=i[1],u=rm();if(null!=i&&W(n,i))return t?"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n\n        return ").concat(u.texture2D,"(").concat(r,", uv);\n      }\n    "):"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n\n        return ").concat(u.texture2D,"(").concat(r,", uv);\n      }\n    ");if(t)return"\n    vec4 ".concat(a,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(u.texture2D,"(").concat(r,", uv);\n    }\n  ");const c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],l=Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(l,", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(u.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===n[0]){const r=[1,2],i=wm(e,n.slice(1)),o=["b","row","col"];return"\n        ".concat(hm(i,t),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(Nm(o,r),");\n        }\n      ")}const s=rm();if(t)return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ");const u=o[0],c=o[1],l=Math.ceil(n[2]/2),p=l*Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(u,", ").concat(c,", ").concat(p,", ").concat(l,", b, row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);default:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=rm();if(t)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");const i=e.shapeInfo.logicalShape,o=i.length,s=e.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=u[0],l=u[1],p=Math.ceil(i[o-1]/2);let h=p*Math.ceil(i[o-2]/2),d="int b, int row, int col",f="b * ".concat(h," + (row / 2) * ").concat(p," + (col / 2)");for(let m=2;m<o-1;m++)d="int b".concat(m,", ")+d,h*=i[o-m-1],f="b".concat(m," * ").concat(h," + ")+f;return"\n    vec4 ".concat(r,"(").concat(d,") {\n      int index = ").concat(f,";\n      int texR = index / ").concat(l,";\n      int texC = index - texR * ").concat(l,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(l,", ").concat(c,");\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t)}}const dm="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",fm="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",mm="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",gm="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function ym(e){return"offset".concat(e)}function vm(e){const t=e.name,n=U(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function bm(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function xm(e,t,n){const{newShape:r,keptDims:a}=X(t),i=t.length,o=e&&3===i&&1===t[0],s=o?t.slice(1):r,u=!e&&i>1&&!W(t,n)&&r.length<i||o;return{useSqueezeShape:u,uniformShape:u?s:t,keptDims:a}}function wm(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Nm(e,t){return t.map((t=>e[t])).join(", ")}function Sm(e,t,n,r){const a=n.map(((e,n)=>{const r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),i=a.map((e=>e.shapeInfo)),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=lm(a,o,t),u=function(e,t){const n=Vf(e,(()=>e.createShader(e.FRAGMENT_SHADER)),"Unable to create fragment WebGLShader.");if(Ff(e,(()=>e.shaderSource(n,t))),Ff(e,(()=>e.compileShader(n))),ye().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw Rf(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(e.gl,s),c=e.createProgram(u);return ye().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:u,source:s,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(c),Object.assign({program:t,fragmentShader:u,source:s,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},km(e,t,c)))}function km(e,t,n){const r=[],a=[];let i,o,s,u=null,c=null;c=e.getUniformLocation(n,"NAN",!1),1===ye().getNumber("WEBGL_VERSION")&&(u=e.getUniformLocation(n,"INFINITY",!1));const l=!1;for(const p of t.variableNames){const a={name:p,uniform:e.getUniformLocation(n,p,l),offset:e.getUniformLocation(n,"offset".concat(p),l)};t.enableShapeUniforms&&(a.shape=e.getUniformLocation(n,"".concat(p,"Shape"),l),a.texShape=e.getUniformLocation(n,"".concat(p,"TexShape"),l)),r.push(a)}if(t.enableShapeUniforms&&(i=e.getUniformLocation(n,"outShape",l),s=e.getUniformLocation(n,"outShapeStrides",l),o=e.getUniformLocation(n,"outTexShape",l)),t.customUniforms)for(const p of t.customUniforms)a.push(e.getUniformLocation(n,p.name,l));return{variablesLocations:r,customUniformLocations:a,infLoc:u,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:s,outTexShapeLocation:o}}function Em(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach(((e,n)=>{const r=e.logicalShape,a=t[n],i=a.shape;if(!W(r,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(i," must match"));if(e.isUniform&&a.isUniform)return;const o=e.texShape,s=a.isUniform?null:a.texData.texShape;if(!W(o,s))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(o," and ").concat(s," must match"))}))}function Cm(e){return ye().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}class Tm{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=kf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=rm();this.outputShape=e,this.enableShapeUniforms=Cm(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?im(["r","c","d"],e):am(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}class Dm{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=kf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=rm();this.outputShape=e,this.enableShapeUniforms=Cm(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?im(["r","c","d"],e):am(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}class Im{constructor(e){this.variableNames=["A"],this.outTexUsage=Ef.DOWNLOAD;const t=rm();this.outputShape=e,this.userCode="\n      ".concat(um,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}class Am{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ef.DOWNLOAD;const t=rm();this.outputShape=e,this.userCode="\n      ".concat(um,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}const Fm={R:0,G:1,B:2,A:3};class _m{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=rm();this.outputShape=e,this.enableShapeUniforms=Cm(this.outputShape.length);let a="result";t&&(a="floor(result * 255. + 0.5)");let i="";for(let o=0;o<n.length;o++){const e=n[o];i+="\n          if(offset == ".concat(o,") {\n            result = values[").concat(Fm[e],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":sm(e),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(n.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(n.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(r.texture2D,"(A, uv);\n          ").concat(i,"\n        }\n        ").concat(r.output," = vec4(").concat(a,", 0., 0., 0.);\n      }\n    ")}}class Mm{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=rm();this.outputShape=e,this.enableShapeUniforms=Cm(this.outputShape.length);let r="",a="result";t&&(a="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let t=0;t<=1;t++){const a=2*i+t;r+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(t," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(e[2]),") {\n          localCoords[2] += ").concat(t,";\n          if (localCoords[1] + ").concat(i," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(e[1]),") {\n            localCoords[1] += ").concat(i,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(a,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(a,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(a,"] = values[2];\n            } else {\n              result[").concat(a,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":sm(e),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(r,"\n\n          ").concat(n.output," = ").concat(a,";\n        }\n    ")}}function Om(e){const t=rm();return function(e,t){const n=Vf(e,(()=>e.createShader(e.VERTEX_SHADER)),"Unable to create vertex WebGLShader.");if(Ff(e,(()=>e.shaderSource(n,t))),Ff(e,(()=>e.compileShader(n))),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function Rm(e){return function(e,t){const n=Vf(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return Ff(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,n))),Ff(e,(()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW))),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function zm(e){return function(e,t){const n=Vf(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return Ff(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n))),Ff(e,(()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW))),n}(e,new Uint16Array([0,1,2,2,1,3]))}function Bm(e,t,n,r,a,i){!function(e,t){const n=ye().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){const n="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+n+" is invalid.")}if(e>n||t>n){const r="[".concat(e,"x").concat(t,"]"),a="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+a+".")}}(t,n);const o=function(e){return Vf(e,(()=>e.createTexture()),"Unable to create WebGLTexture.")}(e),s=e.TEXTURE_2D;return Ff(e,(()=>e.bindTexture(s,o))),Ff(e,(()=>e.texParameteri(s,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE))),Ff(e,(()=>e.texParameteri(s,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE))),Ff(e,(()=>e.texParameteri(s,e.TEXTURE_MIN_FILTER,e.NEAREST))),Ff(e,(()=>e.texParameteri(s,e.TEXTURE_MAG_FILTER,e.NEAREST))),1===ye().getNumber("WEBGL_VERSION")?Ff(e,(()=>e.texImage2D(s,0,r,t,n,0,a,i,null))):Ff(e,(()=>e.texStorage2D(s,1,r,t,n))),Ff(e,(()=>e.bindTexture(e.TEXTURE_2D,null))),{texture:o,texShape:[n,t]}}function Lm(e){return e.internalFormatFloat}function Pm(e){return e.internalFormatHalfFloat}function Um(e){return e.downloadTextureFormat}function Wm(e){return e.internalFormatPackedFloat}function Vm(e){return e.internalFormatPackedHalfFloat}function qm(e,t,n,r,a,i,o,s){const u=e,c=new Float32Array(function(e,t){const[n,r]=If(e,t);return n*r*4}(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}class jm{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=ye().getNumber("WEBGL_VERSION");if(null!=e?(this.gl=e,function(e,t){wf[e]=t}(t,e)):this.gl=Sf(t),e=this.gl,2===ye().getNumber("WEBGL_VERSION")){const t=e;this.createVertexArray=()=>Ff(t,(()=>t.createVertexArray())),this.bindVertexArray=e=>Ff(t,(()=>t.bindVertexArray(e))),this.deleteVertexArray=e=>Ff(t,(()=>t.deleteVertexArray(e))),this.getVertexArray=()=>Ff(t,(()=>t.getParameter(t.VERTEX_ARRAY_BINDING)))}else if(null!=e){const t=e.getExtension("OES_vertex_array_object");if(null==t)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ff(e,(()=>t.createVertexArrayOES())),this.bindVertexArray=n=>Ff(e,(()=>t.bindVertexArrayOES(n))),this.deleteVertexArray=n=>Ff(e,(()=>t.deleteVertexArrayOES(n))),this.getVertexArray=()=>Ff(e,(()=>e.getParameter(t.VERTEX_ARRAY_BINDING_OES)))}let n="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===ye().getNumber("WEBGL_VERSION")){const e="OES_texture_float",t="OES_texture_half_float";if(this.textureFloatExtension=Mf(this.gl,e),Zf(this.gl,t))this.textureHalfFloatExtension=Mf(this.gl,t);else if(ye().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Zf(this.gl,r))this.colorBufferHalfFloatExtension=Mf(this.gl,r);else if(ye().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",Zf(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!Zf(this.gl,r))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(r)}this.vertexBuffer=Rm(this.gl),this.indexBuffer=zm(this.gl),this.framebuffer=function(e){return Vf(e,(()=>e.createFramebuffer()),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=Af(this.gl,this.textureHalfFloatExtension)}get debug(){return ye().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Ff(e,(()=>e.finish())),Ff(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,null))),Ff(e,(()=>e.deleteFramebuffer(this.framebuffer))),Ff(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,null))),Ff(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null))),Ff(e,(()=>e.deleteBuffer(this.indexBuffer))),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[a,i]=Tf(t,n);return Bm(e,a,i,Lm(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[a,i]=Tf(t,n);return Bm(e,a,i,Pm(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[a,i]=Tf(t,n);return Bm(e,a,i,Um(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),function(e,t,n){Ff(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),n.data instanceof Uint8Array?2===ye().getNumber("WEBGL_VERSION")?Ff(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data))):Ff(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data))):2===ye().getNumber("WEBGL_VERSION")?Ff(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n))):Ff(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n))),Ff(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i){let o,s,u;Ff(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=e.UNSIGNED_BYTE,u=e.RGBA):(o=new Float32Array(n*r*4),s=e.FLOAT,u=i.internalFormatPackedFloat),o.set(a),2===ye().getNumber("WEBGL_VERSION")?Ff(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,s,o))):Ff(e,(()=>e.texImage2D(e.TEXTURE_2D,0,u,n,r,0,e.RGBA,s,o))),Ff(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}(this.gl,e,t,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[a,i]=If(t,n);return Bm(e,a,i,Vm(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[a,i]=If(t,n);return Bm(e,a,i,Wm(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(Uf(this.gl,this.framebuffer),this.outputTexture=null),Ff(this.gl,(()=>this.gl.deleteTexture(e)))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,(()=>function(e,t,n,r){const[a,i]=Tf(t,n),o=new Uint8Array(t*n*4);return Ff(e,(()=>e.readPixels(0,0,a,i,r.downloadTextureFormat,e.UNSIGNED_BYTE,o))),new Float32Array(o.buffer)}(this.gl,t,n,this.textureConfig)))}downloadPackedMatrixFromBuffer(e,t,n,r,a,i){return qm(this.gl,e,0,0,0,a,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return function(e,t,n){const r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);const r=function(e,t,n){const r=e.createBuffer();Ff(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,r)));const a=16*t*n;return Ff(e,(()=>e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ))),Ff(e,(()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0))),Ff(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null))),r}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(ye().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{const e=r.clientWaitSync(a,0,0);return e===r.ALREADY_SIGNALED||e===r.CONDITION_SATISFIED},t=a}else ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,(()=>function(e,t,n){const r=new Float32Array(t*n*4);return Ff(e,(()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r))),r}(this.gl,t,n)))}createProgram(e){this.throwIfDisposed();const t=this.gl;null==this.vertexShader&&(this.vertexShader=Om(t));const n=function(e){return Vf(e,(()=>e.createProgram()),"Unable to create WebGLProgram.")}(t);Ff(t,(()=>t.attachShader(n,this.vertexShader))),Ff(t,(()=>t.attachShader(n,e))),function(e,t){if(Ff(e,(()=>e.linkProgram(t))),!ye().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,n);const r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&zf(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;Ff(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer))),function(e,t,n){Ff(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,n))),Bf(e,t,"clipSpacePos",n,3,20,0)&&Bf(e,t,"uv",n,2,20,12)}(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(Ff(this.gl,(()=>this.gl.deleteProgram(e))),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&zf(this.gl,this.program),Ff(this.gl,(()=>this.gl.useProgram(e)))}getUniformLocation(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(e,t,n){return Vf(e,(()=>e.getUniformLocation(t,n)),'uniform "'+n+'" not present in program.')}(this.gl,e,t):function(e,t,n){return e.getUniformLocation(t,n)}(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),Ff(this.gl,(()=>this.gl.getAttribLocation(e,t)))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),Lf(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();const[r,a]=If(t,n);this.setOutputMatrixTextureDriver(e,r,a)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&zf(this.gl,this.program),Wf(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ff(e,(()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ff(this.gl,(()=>this.gl.finish()))}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=Mf(this.gl,2===ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(2===ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2();return void e.endQuery(t.TIME_ELAPSED_EXT)}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await G((()=>this.disposed||this.isQueryAvailable(e,ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")))),this.getQueryTime(e,ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){const t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}{const t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){const t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const t=this.getQueryTimerExtensionWebGL1(),n=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(t.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(e){return new Promise((t=>{this.addItemToPoll((()=>e.isFencePassed()),(()=>t()))}))}pollItems(){const e=function(e){let t=0;for(;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((e=>e.isDoneFn)));for(let t=0;t<=e;++t){const{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in ye().platform&&(n=ye().platform.setTimeoutCustom.bind(ye().platform)),G((()=>(this.pollItems(),0===this.itemsToPoll.length)),(()=>0),null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Pf(this.gl,e,this.framebuffer),this.debug&&Wf(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(Pf(this.gl,this.outputTexture,this.framebuffer),this.debug&&Wf(this.gl)):Uf(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();const r=this.gl;Pf(r,e,this.framebuffer),this.debug&&Wf(r),this.outputTexture=e,Ff(r,(()=>r.viewport(0,0,t,n))),Ff(r,(()=>r.scissor(0,0,t,n)))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),Ff(this.gl,(()=>this.gl.scissor(e,t,n,r)))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}function Gm(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&B("complex64"!==e.dtype,(()=>"".concat(t," does not support complex64 tensors in the CPU backend.")))}))}function Hm(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const Km={kernelName:Ne,backendName:"cpu",kernelFunc:e=>{const{x:t}=e.inputs,n=e.backend;Gm(t,"abs");let r=new Float32Array(U(t.shape));return r=Hm(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,t.dtype)}};function Xm(e){return(t,n,r,a,i)=>{const o=Yo(t,n),s=o.length,u=ae(o),c=Y(i,U(o)),l=t.length,p=n.length,h=ae(t),d=ae(n),f=Ko(t,o),m=Ko(n,o);if(f.length+m.length===0)for(let g=0;g<c.length;++g)c[g]=e(r[g%r.length],a[g%a.length]);else for(let g=0;g<c.length;++g){const t=he(g,s,u),n=t.slice(-l);f.forEach((e=>n[e]=0));const i=pe(n,l,h),o=t.slice(-p);m.forEach((e=>o[e]=0));const y=pe(o,p,d);c[g]=e(r[i],a[y])}return[c,o]}}function Ym(e){const{inputs:t,backend:n}=e,{real:r,imag:a}=t,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},s}const $m={kernelName:Xe,backendName:"cpu",kernelFunc:Ym};function Zm(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){return Ym({inputs:{real:Zm(e,t,"float32"),imag:Zm(e,t,"float32")},backend:e})}const r=ue(U(t),n);return e.makeTensorInfo(t,n,r)}function Qm(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Jm={kernelName:Bt,backendName:"cpu",kernelFunc:Qm};function eg(e){const{inputs:t,backend:n}=e,{input:r}=t,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}const tg={kernelName:Fn,backendName:"cpu",kernelFunc:eg};function ng(e,t,n,r){if("int32"===r){return[t,"int32",Int32Array.from(e)]}if("bool"===r){const r=oa([0],n),[a,i]=Xm(((e,t)=>e!==t?1:0))(t,[],e,r,"bool");return[i,"bool",a]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(r))}function rg(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dtype:i}=r;if("complex64"===i){if("complex64"===a.dtype)return Qm({inputs:{x:a},backend:n});const e=Zm(n,a.shape,a.dtype),t=rg({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),r=Ym({inputs:{real:t,imag:e},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),r}if("complex64"===a.dtype){const e=eg({inputs:{input:a},backend:n}),t=rg({inputs:{x:e},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(e),t}if(!Z(a.dtype,i)){const e=Qm({inputs:{x:a},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:i}}const o=n.data.get(a.dataId).values,[s,u,c]=ng(o,a.shape,a.dtype,i);return n.makeTensorInfo(s,u,c)}const ag={kernelName:Ge,backendName:"cpu",kernelFunc:rg};function ig(e,t,n,r){return null==n?n=>{let{inputs:a,backend:i}=n;const{a:o,b:s}=a,u=i;Gm([o,s],e);const c=u.data.get(o.dataId).values,l=u.data.get(s.dataId).values,p="string"===o.dtype?bf(c):c,h="string"===o.dtype?bf(l):l,d=r||o.dtype,[f,m]=t(o.shape,s.shape,p,h,d);return u.makeTensorInfo(m,d,f)}:e=>{let{inputs:a,backend:i}=e;const{a:o,b:s}=a,u=i;if("complex64"===o.dtype||"complex64"===s.dtype){const e=rg({inputs:{x:o},backend:u,attrs:{dtype:"complex64"}}),t=u.data.get(e.dataId),r=t.complexTensorInfos.real,a=t.complexTensorInfos.imag,i=u.data.get(r.dataId).values,c=u.data.get(a.dataId).values,l=rg({inputs:{x:s},backend:u,attrs:{dtype:"complex64"}}),p=u.data.get(l.dataId),h=p.complexTensorInfos.real,d=p.complexTensorInfos.imag,f=u.data.get(h.dataId).values,m=u.data.get(d.dataId).values,[g,y,v]=n(o.shape,s.shape,i,c,f,m),b=u.makeTensorInfo(v,"float32",g),x=u.makeTensorInfo(v,"float32",y),w=Ym({inputs:{real:b,imag:x},backend:u});return u.disposeIntermediateTensorInfo(e),u.disposeIntermediateTensorInfo(l),u.disposeIntermediateTensorInfo(b),u.disposeIntermediateTensorInfo(x),w}{const e=u.data.get(o.dataId).values,n=u.data.get(s.dataId).values,a=r||o.dtype,[i,c]=t(o.shape,s.shape,e,n,a);return u.makeTensorInfo(c,a,i)}}}function og(e){return(t,n,r,a,i,o)=>{const s=Yo(t,n),u=U(s),c=s.length,l=ae(s),p=Y("float32",u),h=Y("float32",u),d=Ko(t,s),f=Ko(n,s),m=Ld(r,a),g=Ld(i,o),y=t.length,v=ae(t),b=n.length,x=ae(n);if(d.length+f.length===0)for(let w=0;w<p.length;w++){const t=w%m.length,n=w%g.length,r=e(m[2*t],m[2*t+1],g[2*n],g[2*n+1]);p[w]=r.real,h[w]=r.imag}else for(let w=0;w<p.length;w++){const t=he(w,c,l),n=t.slice(-y);d.forEach((e=>n[e]=0));const r=pe(n,y,v),a=t.slice(-b);f.forEach((e=>a[e]=0));const i=pe(a,b,x),o=e(m[2*r],m[2*r+1],g[2*i],g[2*i+1]);p[w]=o.real,h[w]=o.imag}return[p,h,s]}}const sg=Xm(((e,t)=>e+t)),ug=og(((e,t,n,r)=>({real:e+n,imag:t+r}))),cg=ig(Ee,sg,ug),lg={kernelName:Ee,backendName:"cpu",kernelFunc:cg};function pg(e,t,n,r,a){const i=U(r),o=ue(a,n);for(let s=0;s<e.length;s++){const n=e[s];if(n<0)throw new Error("Input x must be non-negative!");n>=a||(o[n]+=i>0?t[s]:1)}return o}function hg(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=e.shape[0],i=e.shape[1],o=wo([a,n],t.dtype);for(let s=0;s<a;s++)for(let a=0;a<i;a++){const i=e.get(s,a);if(i<0)throw new Error("Input x must be non-negative!");i>=n||(r?o.set(1,s,i):t.size>0?o.set(o.get(s,i)+t.get(s,a),s,i):o.set(o.get(s,i)+1,s,i))}return o}const dg=Xm(((e,t)=>e&t)),fg=ig(qe,dg),mg={kernelName:qe,backendName:"cpu",kernelFunc:fg};function gg(e){return(t,n,r)=>{const a=$(n,t.length);for(let i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}function yg(e,t,n){return vg(e,gg(t),n)}function vg(e,t,n){return r=>{let{inputs:a,attrs:i,backend:o}=r;const{x:s}=a;Gm(s,e);const u=o,c=u.data.get(s.dataId).values;let l;if("string"===s.dtype){if(!Array.isArray(c))throw new Error("String tensor's value was not an instance of Array");l=bf(c)}else l=c;const p=n||s.dtype,h=t(l,p,i);return u.makeTensorInfo(s.shape,p,h)}}const bg=gg((e=>Math.ceil(e))),xg=vg(He,bg),wg={kernelName:He,backendName:"cpu",kernelFunc:xg};function Ng(e,t,n,r){const a=$(n,U(t));if(r&&"string"!==n){let t=0;e.forEach((e=>{const n=U(e.shape);a.set(e.vals,t),t+=n}))}else{let r=0;e.forEach((e=>{const i="string"===n?bf(e.vals):e.vals;let o=0;for(let n=0;n<e.shape[0];++n){const s=n*t[1]+r;for(let t=0;t<e.shape[1];++t)a[s+t]=i[o++]}r+=e.shape[1]}))}return a}const Sg=Xm(((e,t)=>e===t?1:0)),kg=ig(St,Sg,null,"bool"),Eg={kernelName:St,backendName:"cpu",kernelFunc:kg},Cg=gg((e=>Math.exp(e))),Tg=vg(kt,Cg,"float32"),Dg={kernelName:kt,backendName:"cpu",kernelFunc:Tg},Ig=gg((e=>Math.expm1(e))),Ag=vg(Ct,Ig),Fg={kernelName:Ct,backendName:"cpu",kernelFunc:Ag},_g=gg((e=>Math.floor(e))),Mg=vg(At,_g),Og={kernelName:At,backendName:"cpu",kernelFunc:Mg};function Rg(e,t,n,r,a,i,o,s,u){const c=wo([r,i],n);for(let l=0;l<r;l++){const n=[];let r=0;for(let t=0;t<a;t++){const i=e[l*a+t];r+=i*o[t],n.push(i)}if(r<0||r>=u/i)throw new Error("Invalid indices: ".concat(n," does not index into ").concat(s));for(let e=0;e<i;e++)c.values[l*i+e]=t.get(...t.indexToLoc(r*i+e))}return c}function zg(e,t,n){const r=wo(n,e.dtype);for(let a=0;a<r.size;++a){const n=r.indexToLoc(a).slice(),i=n[0],o=n[2],s=t.locToIndex([i,o]);n[2]=t.values[s];const u=e.locToIndex(n);0<=u&&u<e.values.length&&(r.values[a]=e.values[u])}return r}const Bg=Xm(((e,t)=>e>t?1:0)),Lg=ig(Rt,Bg,null,"bool"),Pg={kernelName:Rt,backendName:"cpu",kernelFunc:Lg},Ug=Xm(((e,t)=>e>=t?1:0)),Wg=ig(zt,Ug,null,"bool"),Vg={kernelName:zt,backendName:"cpu",kernelFunc:Wg},qg=Xm(((e,t)=>e<t?1:0)),jg=ig(jt,qg,null,"bool"),Gg={kernelName:jt,backendName:"cpu",kernelFunc:jg},Hg=Xm(((e,t)=>e<=t?1:0)),Kg=ig(Gt,Hg,null,"bool"),Xg={kernelName:Gt,backendName:"cpu",kernelFunc:Kg};function Yg(e,t,n){const r=(t-e)/(n-1),a=ue(n,"float32");a[0]=e;for(let i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}const $g=gg((e=>Math.log(e))),Zg=vg(Kt,$g),Qg={kernelName:Kt,backendName:"cpu",kernelFunc:Zg};function Jg(e,t,n,r){const a=Y(r,U(n));for(let i=0;i<a.length;++i){const n=i*t;let r=e[n];for(let a=0;a<t;++a){const t=e[n+a];(Number.isNaN(t)||t>r)&&(r=t)}a[i]=r}return a}const ey=Xm(((e,t)=>Math.max(e,t))),ty=ig(tn,ey),ny={kernelName:tn,backendName:"cpu",kernelFunc:ty},ry=Xm(((e,t)=>Math.min(e,t))),ay=ig(ln,ry),iy={kernelName:ln,backendName:"cpu",kernelFunc:ay},oy=Xm(((e,t)=>e*t)),sy=og(((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n}))),uy=ig(fn,oy,sy),cy={kernelName:fn,backendName:"cpu",kernelFunc:uy};function ly(e,t,n){const r=ia(-1,n);return oy([],t,r,e,n)}const py={kernelName:mn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;Gm(r,"neg");const a=n.data.get(r.dataId).values,[i,o]=ly(a,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,i)}},hy=Xm(((e,t)=>e!==t?1:0)),dy=ig(gn,hy,null,"bool"),fy={kernelName:gn,backendName:"cpu",kernelFunc:dy};function my(e,t,n,r,a){const i=t.length,o=U(t),s=ae(t),u=ae(a),c=Y(n,U(a));for(let l=0;l<o;++l){const t=he(l,i,s),n=new Array(t.length);for(let e=0;e<n.length;e++)n[e]=t[r[e]];c[pe(n,i,u)]=e[l]}return c}function gy(e){const{inputs:t,attrs:n,backend:r}=e,{x:a}=t,{perm:i}=n;Gm(a,"transpose");const o=a.shape.length,s=new Array(o);for(let c=0;c<s.length;c++)s[c]=a.shape[i[c]];const u=my(r.data.get(a.dataId).values,a.shape,a.dtype,i,s);return{dataId:r.write(u,s,a.dtype),shape:s,dtype:a.dtype}}const yy={kernelName:Sr,backendName:"cpu",kernelFunc:gy};function vy(e,t,n,r){const[a,i]=fc(e,r),o=Ma(t,"int32"),s=ue(U(a),o),u=U(i);for(let c=0;c<s.length;++c){const e=c*u;let t=1;for(let r=0;r<u;++r)t*=n[e+r];s[c]=t}return{outVals:s,outShape:a,outDtype:o}}const by={kernelName:Cn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r;Gm(a,"prod");const s=a.shape.length,u=K(i,a.shape),c=yc(u,s);let l=u,p=a;const h=[];null!=c&&(p=gy({inputs:{x:a},backend:n,attrs:{perm:c}}),h.push(p),l=bc(l.length,s));const d=n.data.get(p.dataId).values,{outVals:f,outShape:m,outDtype:g}=vy(p.shape,p.dtype,d,l);let y=m;return o&&(y=mc(m,u)),h.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(y,g,f)}};function xy(e,t,n,r){const a=[];let i=0;const o=t.length-1+n.length,s=new Array(o).fill(null).map((()=>[0]));!function(e,t){for(let n=0;n<e.length;++n){const r=e[n],a=n===e.length-1?t:e[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(let e=1;e<r.length;++e)if(r[e-1]>r[e])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);let u=1;for(let c=0;c<t.length-1;++c){u*=t[c];const e=t[c+1];for(let t=1;t<u+1;++t)s[c].push(t*e)}for(let c=0;c<e.length;++c){let r=e[c],o=e[c]+1;for(let e=0;e<n.length;++e){const a=n[e],i=e+t.length-1;if(i>=0){const e=s[i],t=e[e.length-1]-a[r];for(let n=r;n<o;++n)s[i].push(a[n+1]+t)}r=a[r],o=a[o]}o!==r&&(a.push([r,o]),i+=o-r)}return{outSplits:s,valueSlices:a,numValues:i}}function wy(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function Ny(e,t,n,r,a){const i=t.slice();i[0]=a;const o=$(n,U(i)),s=e.length;return function(e,t,n,r,a,i){const o=wy(t,2)[1],s=wy(i,2)[1];let u=0;for(const c of n)for(let t=c[0];t<c[1];++t){for(let n=0;n<r;++n)a[u*s+n]=e[t*o+n];++u}}(e,t,r,0===s?0:s/t[0],o,i),[o,i]}function Sy(e,t,n,r,a,i,o,s){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach(((e,r)=>{if(e<0||e>=n){const a=he(r,t.length,ae(t)).join(",");throw new Error("indices[".concat(a,"] = ").concat(e," is not in [0, ").concat(n,")"))}}))}(i,o,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:l,numValues:p}=xy(i,o,e,u),h=function(e){const t=[];for(let n=0;n<e.length;++n){const r=$("int32",e[n].length);t.push(r),e[n].forEach(((e,t)=>r[t]=e))}return t}(c),d=Ny(n,r,a,l,p);return[h,d[0],d[1]]}const ky=2147483647;function Ey(e,t,n,r,a,i,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const s=0===t.length,u=0===a.length,c=0===o.length,l=[];s||l.push(t[0]),u||l.push(a[0]),c||l.push(o[0]);for(let m=1;m<l.length;++m)if(l[m]!==l[m-1])throw new Error("starts, limits, and deltas must have the same shape");const p=0===l.length?1:l[0],h=$("int32",p+1);h[0]=0;for(let m=0;m<p;++m){const t=s?e[0]:e[m],n=u?r[0]:r[m],a=c?i[0]:i[m];if(0===a)throw new Error("Requires delta != 0");let o;if(a>0&&n<t||a<0&&n>t)o=0;else if(o=Math.ceil(Math.abs((n-t)/a)),o>ky)throw new Error("Requires ((limit - start) / delta) <= ".concat(ky));h[m+1]=h[m]+o}const d=$(n,h[p]);let f=0;for(let m=0;m<p;++m){const t=h[m+1]-h[m];let n=s?e[0]:e[m];const r=c?i[0]:i[m];for(let e=0;e<t;++e)d[f++]=n,n+=r}return[h,d]}var Cy=gd;class Ty{constructor(e,t,n,r,a,i,o,s,u,c){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=r,this.valuesDType=a,this.defaultValue=i,this.defaultValueShape=o,this.rowPartitionValues=s,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=vd(c),this.raggedRank=bd(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Cy.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Cy.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Cy.VALUE_ROWIDS:return Ty.getMaxWidthValueRowID(t);case Cy.ROW_SPLITS:return Ty.getMaxWidthRowSplit(t);default:throw new Error("Cannot handle partition type ".concat(Cy[this.getRowPartitionTypeByDimension(e-1)]))}}static getMaxWidthRowSplit(e){const t=e.length;if(0===t||1===t)return 0;let n=0;for(let r=0;r<t-1;++r){const t=e[r+1]-e[r];t>n&&(n=t)}return n}static getMaxWidthValueRowID(e){const t=e.length;if(0===t)return 0;let n=0,r=e[0],a=0;for(let i=1;i<t;++i){const t=e[i];t!==r&&(r=t,a=Math.max(i-n,a),n=i)}return Math.max(t-n,a)}tensorShapeFromTensor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return Iy(e,n)}calculateOutputSize(e){const t=this.valuesShape;xd(this.defaultValueShape,t);const n=this.tensorShapeFromTensor(this.shape,this.shapeShape),r=yd(this.raggedRank,n,t);r[0]<0&&(r[0]=e);for(let a=1;a<=this.raggedRank;++a)r[a]<0&&(r[a]=this.getMaxWidth(a));return r}calculateFirstParentOutputIndex(e,t,n){const r=Math.min(e,n),a=[];let i=0;for(let o=0;o<r;++o,i+=t)a.push(i);for(let o=r;o<e;++o)a.push(-1);return B(a.length===e,(()=>"Final length of result must be equal to firstDimension.")),a}calculateOutputIndexRowSplit(e,t,n,r){const a=e.length,i=[];for(let o=0;o<a-1;++o){const a=e[o+1]-e[o];let s=Math.min(r,a),u=t[o];-1===u&&(s=0);for(let e=0;e<s;++e)i.push(u),u+=n;for(let e=0;e<a-s;++e)i.push(-1)}if(a>0&&i.length!==e[a-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,t,n,r){const a=e.length,i=[];if(0===a)return[];let o=0,s=e[0];if(s>=t.length)throw new Error("Got currentValueRowId=".concat(s,", which is not less than ").concat(t.length));let u=t[s];i.push(u);for(let c=1;c<a;++c){const a=e[c];if(a===s)u>=0&&(++o,o<r?u+=n:u=-1);else{if(o=0,s=a,a>=t.length)throw new Error("Got nextValueRowId=".concat(a," which is not less than ").concat(t.length));u=t[a]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,t,n,r){const a=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case Cy.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,n,r);case Cy.ROW_SPLITS:if(a.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(a.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(a,t,n,r);default:throw new Error("Unsupported partition type: ".concat(Cy[i]))}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case Cy.FIRST_DIM_SIZE:return e[0];case Cy.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Cy.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(Cy[t]))}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let i=n.length-2;i>=0;--i)n[i]=n[i+1]*t[i+1];const r=Iy(t,!1),a=$(this.valuesDType,U(r));if(n[0]*t[0]>0){let i=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let e=1;e<=this.raggedRank;++e){i=this.calculateOutputIndex(e-1,i,n[e],t[e])}this.setOutput(this.raggedRank,i,a,r)}return[r,a]}setOutput(e,t,n,r){if(0===n.length)return;const a=this.values,i=n;let o=r.slice();o=o.slice(e+1);const s=U(o),u=t.length;let c=this.defaultValue;if(c.length!==s&&1!==c.length){const e=this.defaultValueShape;pi((()=>{const t=vu(c,e),n=Ru(t,o);c=n.dataSync()}))}let l=0,p=0,h=0;for(let d=0;d<=u;++d){let e=d<u?t[d]:-1;if(e!==h){if(p<h){const e=a.subarray(l*s);Dy(i.subarray(p*s),e,(h-p)*s)}if(d>=u){const t=n.length;e=Math.floor(t/s)}if(e>h)if(1===this.defaultValue.length)i.subarray(h*s,e*s).fill(this.defaultValue[0]),h=e;else for(;e>h;){Dy(i.slice(h*s),c,s),++h}e<0?(l=d+1,p=h):(l=d,p=h,h=p+1)}else++h}}}function Dy(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function Iy(e,t){const n=[];for(let r of e){if(r<0){if(!t)throw new Error("Dimension ".concat(r," must be >= 0"));if(r<-1)throw new Error("Dimension ".concat(r," must be >= -1"));r=-1}n.push(r)}return n}function Ay(e,t,n,r,a,i,o,s,u,c){return new Ty(e,t,n,r,a,i,o,s,u,c).compute()}function Fy(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return ue(0,r);const a=ue(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(let i=1;i<a.length;i++)a[i]=a[i-1]+n;return a}const _y=gg((e=>1/Math.sqrt(e))),My=vg(Vn,_y),Oy={kernelName:Vn,backendName:"cpu",kernelFunc:My};function Ry(e,t,n,r,a,i,o,s,u,c){const l=[r/a,a],p=e.values,h=t.values;if(0===r)return wo(n,t.dtype);const d=u instanceof xa?u:wo(l,t.dtype);"string"===typeof u||"number"===typeof u?d.values.fill(u):"boolean"===typeof u&&d.values.fill(+u);for(let f=0;f<i;f++){const e=[];let i=0;for(let t=0;t<o;t++){const n=p[f*o+t];e.push(n),i+=n*s[t]}if(i<0||i>=r/a)throw new Error("Invalid indices: ".concat(e," does not index into ").concat(n));for(let n=0;n<a;n++)c?d.values[i*a+n]+=h[f*a+n]:d.values[i*a+n]=0===t.rank?h[0]:h[f*a+n]}return d}const zy=gg((e=>1/(1+Math.exp(-e)))),By=yg(Qn,(e=>1/(1+Math.exp(-e)))),Ly={kernelName:Qn,backendName:"cpu",kernelFunc:By};function Py(e,t,n,r,a){const i=Us(r,t,n),o=U(n),s=ae(r);if(i){const n=Ws(t,s);return"string"===a?e.slice(n,n+o):e.subarray(n,n+o)}const u=wo(r,a,"string"===a?bf(e):e),c=wo(n,a);for(let l=0;l<c.size;++l){const e=c.indexToLoc(l),n=e.map(((e,n)=>e+t[n]));c.set(u.get(...n),...e)}return"string"===a?xf(c.values):c.values}function Uy(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,size:o}=r;Gm(a,"slice");const[s,u]=Vs(a,i,o);Ds(a,s,u);const c=Py(n.data.get(a.dataId).values,s,u,a.shape,a.dtype);return n.makeTensorInfo(u,a.dtype,c)}const Wy={kernelName:Xn,backendName:"cpu",kernelFunc:Uy};function Vy(e,t,n,r,a,i,o){const s=t[0],u=i[0],c=new Array(u),l=new Array(s),p=t[1];if(0===u){if(0!==s)throw new Error(rf(s));return[$(n,0),[0,p],$(a,0),c,l]}let h=!0,d=0;const f=new Array(u).fill(0);for(let g=0;g<s;++g){const t=e[g*p];if(t<0)throw new Error(af(g,t));if(t>=u)throw new Error(of(g,t,u));++f[t],h=h&&t>=d,d=t}let m=!0;for(let g=0;g<u;++g){const e=0===f[g];c[g]=e,m=m&&!e,f[g]=Math.max(f[g],1),g>0&&(f[g]+=f[g-1])}if(m&&h){const t=e,n=r;for(let e=0;e<s;++e)l[e]=e;return[t,[s,p],n,c,l]}{const t=f[u-1],i=$(n,t*p),h=$(a,t),d=new Array(u).fill(0);for(let n=0;n<s;++n){const t=e[n*p],a=d[t],o=(0===t?0:f[t-1])+a;d[t]++;for(let r=0;r<p;++r)i[o*p+r]=e[n*p+r];h[o]=r[n],l[n]=o}for(let e=0;e<u;++e){if(0===d[e]){const t=0===e?0:f[e-1];i[t*p+0]=e;for(let e=1;e<p;++e)i[t*p+e]=0;h[t]=o}}return[i,[t,p],h,c,l]}}function qy(e,t,n,r,a){const i=U(r),o=t[0],s=a.length,u=[];let c=1,l=-1;for(let m=0;m<s;++m){const e=a[m];if(-1===e){if(-1!==l)throw new Error(sf(l,m));l=m,u.push(1)}else{if(e<0)throw new Error(uf(m,e));c*=e,u.push(e)}}if(-1!==l){if(c<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");const e=Math.trunc(i/c);if(c*e!==i)throw new Error(lf(r,u));u[l]=e}if(U(u)!==i)throw new Error(pf(r,u));const p=r.length,h=[];if(p>0){h[p-1]=1;for(let e=p-2;e>=0;--e)h[e]=h[e+1]*r[e+1]}const d=[];if(s>0){d[s-1]=1;for(let e=s-2;e>=0;--e)d[e]=d[e+1]*u[e+1]}const f=$(n,o*s);for(let m=0;m<o;++m){let t=0;for(let n=0;n<p;++n)t+=e[m*p+n]*h[n];for(let e=0;e<s;++e)f[m*s+e]=Math.trunc(t/d[e]),t%=d[e]}return[f,[o,s],u]}function jy(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const s=r.length,u=[t[0],e.length/t[0]],c=u[1],l=s>0?a[s-1]+1:0;if(l<0)throw new Error("segment ids must be >= 0");const p=t.slice();p[0]=l;const h=p.reduce(((e,t)=>e*t),1),d=$(n,h);if(0===s)return l>0&&d.fill(o),[d,p];if(l<=0)throw new Error("segment ids must be >= 0");let f=0,m=1,g=0,y=a[f];for(;;){let t=0;if(m<s){if(t=a[m],y===t){++m;continue}if(y>=t)throw new Error("segment ids are not increasing")}if(y<0||y>=l)throw new Error(ff(y,l));y>g&&d.fill(o,g*c,y*c);for(let n=f;n<m;++n){const t=r[n];if(t<0||t>=u[0])throw new Error(mf(n,r[n],u[0]));for(let n=0;n<c;n++)d[y*c+n]+=e[t*c+n]}if(i)for(let e=0;e<c;e++)d[y*c+e]/=m-f;if(f=m,++m,g=y+1,y=t,m>s)break}return g<l&&d.fill(o,g*c,l*c),[d,p]}const Gy=gg((e=>Math.sqrt(e))),Hy=yg(er,(e=>Math.sqrt(e))),Ky={kernelName:er,backendName:"cpu",kernelFunc:Hy},Xy=gg(((e,t)=>{const{pattern:n,replaceGlobal:r,rewrite:a}=t;return e.replace(new RegExp(n,r?"g":""),a)})),Yy=vg(hr,Xy),$y={kernelName:hr,backendName:"cpu",kernelFunc:Yy};function Zy(e,t,n,r){const a=wo(e,t.dtype);for(let i=0;i<a.size;i++){const e=a.indexToLoc(i),o=new Array(e.length);for(let t=0;t<o.length;t++)o[t]=e[t]*n[t]+r[t];a.set(t.get(...o),...e)}return a}class Qy{constructor(e,t,n,r,a,i){this.separator=ua(e),this.nGramWidths=t,this.leftPad=ua(n),this.rightPad=ua(r),this.padWidth=a,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,r,a,i){for(let o=0;o<a;++o){const s=this.getPadWidth(i),u=Math.max(0,s-o),c=Math.max(0,s-(a-(o+1))),l=i-(u+c),p=t+(u>0?0:o-s);let h=0;h+=u*this.leftPad.length;for(let t=0;t<l;++t)h+=e[p+t].length;h+=c*this.rightPad.length;h+=(u+c+l-1)*this.separator.length,n[r+o]=new Uint8Array(h);const d=n[r+o];let f=0;const m=e=>e.forEach((e=>d[f++]=e));for(let e=0;e<u;++e)m(this.leftPad),m(this.separator);for(let t=0;t<l-1;++t)m(e[p+t]),m(this.separator);if(l>0){m(e[p+l-1]);for(let e=0;e<c;++e)m(this.separator),m(this.rightPad)}else{for(let e=0;e<c-1;++e)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,t){const n=e.length,r=t.length;if(r>0){let e=t[0];if(0!==e)throw new Error("First split value must be 0, got ".concat(e));for(let a=1;a<r;++a){let r=t[a]>=e;if(r=r&&t[a]<=n,!r)throw new Error("Invalid split value ".concat(t[a],", must be in [").concat(e,", ").concat(n,"]"));e=t[a]}if(e!==n)throw new Error("Last split value must be data size. Expected ".concat(n,", got ").concat(e))}const a=r-1,i=$("int32",r);if(0===n||0===r){const e=new Array(n);for(let t=0;t<=a;++t)i[t]=0;return[e,i]}i[0]=0;for(let s=1;s<=a;++s){const e=t[s]-t[s-1];let n=0;this.nGramWidths.forEach((t=>{n+=this.getNumNGrams(e,t)})),this.preserveShort&&e>0&&0===n&&(n=1),i[s]=i[s-1]+n}const o=new Array(i[a]);for(let s=0;s<a;++s){const n=t[s];let r=i[s];if(this.nGramWidths.forEach((a=>{const i=t[s+1]-t[s],u=this.getNumNGrams(i,a);this.createNGrams(e,n,o,r,u,a),r+=u})),this.preserveShort&&r===i[s]){const a=t[s+1]-t[s];if(0===a)continue;const i=a+2*this.padWidth,u=1;this.createNGrams(e,n,o,r,u,i)}}return[o,i]}}function Jy(e,t,n,r,a,i,o,s){return new Qy(n,r,a,i,o,s).compute(e,t)}function ev(e,t,n,r){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)r.push(e.subarray(t,t+1));return}if(1===t.length){const a=t[0];let i=e.indexOf(a);for(;-1!==i;){const t=e.subarray(0,i);n&&0===t.length||r.push(t),i=(e=e.subarray(i+1)).indexOf(a)}return void(n&&0===e.length||r.push(e))}let a=0;for(let i=0;i<e.length+1;i++)if(i===e.length||-1!==t.indexOf(e[i])){const t=e.subarray(a,i);n&&0===t.length||r.push(t),a=i+1}}function tv(e,t,n){const r=e.length,a=[];let i=0,o=0;const s=new Array(r);for(let h=0;h<r;++h){const r=a.length;ev(e[h],t,n,a);const u=a.length-r;s[h]=u,i+=u,o=Math.max(o,u)}const u=$("int32",2*i),c=new Array(i),l=[r,o];let p=0;for(let h=0;h<r;++h)for(let e=0;e<s[h];++e)u[2*p]=h,u[2*p+1]=e,c[p]=a[p],++p;return[u,c,l]}function nv(e,t){const n=$("int32",e.length);for(let r=0;r<e.length;++r)n[r]=aa(e[r]).modulo(t).getLowBitsUnsigned();return n}const rv=Xm(((e,t)=>e-t)),av=og(((e,t,n,r)=>({real:e-n,imag:t-r}))),iv=ig(yr,rv,av),ov={kernelName:yr,backendName:"cpu",kernelFunc:iv};function sv(e,t){const n=new Array(e.rank);for(let a=0;a<n.length;a++)n[a]=e.shape[a]*t[a];const r=wo(n,e.dtype);for(let a=0;a<r.values.length;++a){const t=r.indexToLoc(a),n=new Array(e.rank);for(let r=0;r<n.length;r++)n[r]=t[r]%e.shape[r];const i=e.locToIndex(n);r.values[a]=e.values[i]}return r}const uv=(e,t)=>{const n=t.value-e.value;return 0===n?e.index-t.index:n};function cv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;for(;r>n;){if(r-n>600){const a=r-n+1,i=t-n+1,o=Math.log(a),s=.5*Math.exp(2*o/3),u=.5*Math.sqrt(o*s*(a-s)/a)*Math.sign(i-a/2);cv(e,t,Math.max(n,Math.floor(t-i*s/a+u)),Math.min(r,Math.floor(t+(a-i)*s/a+u)))}const a=e[t];let i=n,o=r;for(z(e,n,t),uv(e[r],a)>0&&z(e,n,r);i<o;){for(z(e,i,o),i++,o--;uv(e[i],a)<0;)i+=1;for(;uv(e[o],a)>0;)o-=1}0===uv(e[n],a)?z(e,n,o):(o+=1,z(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}}function lv(e,t,n,r,a){const i=t[t.length-1],[o,s]=[e.length/i,i],u=Y(n,o*r),c=Y("int32",o*r);for(let p=0;p<o;p++){const t=p*s,n=e.subarray(t,t+s);let i=new Array(n.length);n.forEach(((e,t)=>i[t]={value:e,index:t})),r<i.length&&(cv(i,r),i=i.slice(0,r)),a&&i.sort(uv);const o=p*r,l=u.subarray(o,o+r),h=c.subarray(o,o+r);for(let e=0;e<r;e++)l[e]=i[e].value,h[e]=i[e].index}const l=t.slice();return l[l.length-1]=r,[wo(l,n,u),wo(l,"int32",c)]}function pv(e,t,n,r){const a=K(t,n)[0],i=[1,n[0],1];for(let f=0;f<a;f++)i[0]*=n[f];i[1]=n[a];for(let f=a+1;f<n.length;f++)i[2]*=n[f];const o=new Map,s=new Int32Array(n[a]),u=new xa(i,r,e),c=[],l=1===i[0]&&1===i[2];for(let f=0;f<n[a];f++){let t;if(l)t=e[f].toString();else{const e=[];for(let t=0;t<i[0];t++)for(let n=0;n<i[2];n++)e.push(u.get(t,f,n));t=e.join(",")}const n=o.get(t);if(null!=n)s[f]=n;else{const e=o.size;o.set(t,e),s[f]=e,c.push(f)}}const p=i.slice();p[1]=o.size;const h=new xa(p,r);c.forEach(((e,t)=>{for(let n=0;n<i[0];n++)for(let r=0;r<i[2];r++)h.set(u.get(n,e,r),n,t,r)}));const d=n.slice();return d[a]=p[1],{outputValues:h.values,outputShape:d,indices:s}}const{mx:hv,XI:dv,Nk:fv,f6:mv,ct:gv,YG:yv,hH:vv,z3:bv,sG:xv,uM:wv,vS:Nv,qB:Sv,GG:kv,rq:Ev,lg:Cv,WR:Tv,cu:Dv,GE:Iv,px:Av,jC:Fv,He:_v,hE:Mv,BF:Ov,Dk:Rv,cl:zv,_B:Bv,ub:Lv,_f:Pv,Ku:Uv,qy:Wv,Zy:Vv,bu:qv,zv:jv,dH:Gv,HS:Hv,yH:Kv,l3:Xv,z9:Yv,x6:$v,_m:Zv,eW:Qv,GK:Jv,SP:eb,yr:tb,dl:nb,Dw:rb,xT:ab,_X:ib,wz:ob}=o;function sb(e,t){return["x","y","z","w","u","v"].slice(0,t).map((t=>"".concat(e,".").concat(t)))}function ub(e,t){return 1===t?[e]:sb(e,t)}class cb{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Cm(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const e=ub("rc",this.rank),t=bm(this.rank),n=this.getOutOfBoundsCondition(e),r=this.getSetup(e),a=this.getOutput(e);this.userCode="\n        void main() {\n          ".concat(t," rc = getOutputCoords();\n\n          if(").concat(n,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(r,"\n\n            setOutput(vec4(").concat(a,"));\n          }\n        }\n      ")}}getSourceCoordsArr(e){const t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let a="".concat(0===n?"r":"rp1",", ").concat(0===r?"c":"cp1");for(let t=2;t<this.rank;t++)a="".concat(e[e.length-1-t],",")+a;t.push(a)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);let t="";for(let n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";const t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")}getOutput(e){const t=this.getSourceCoordsArr(e);if(1===this.rank){const e=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(e," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}}class lb{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Cm(this.outputShape.length);let n="";for(let r=0;r<4;r++){let e="thisRC = rc;";r%2===1&&(e+="thisRC.z += 1;"),r>1&&(e+="thisRC.y += 1;"),n+="\n        ".concat(e,"\n        ").concat(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(r,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(r>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e,t){const n=t?om(["r","c","d"],"inputShape"):am(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(t,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":sm(e),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":e[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":e[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}}class pb{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){const r=db(t,n),a=fb(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const i=hb(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const e=this.freeTextures[a].pop();return this.usedTextures[a].push(e),e}let o;return r===Cf.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Cf.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Cf.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Cf.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Cf.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(o),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),o}releaseTexture(e,t,n,r){if(null==this.freeTextures)return;const a=db(n,r),i=fb(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);const o=hb(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=ye().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==s&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const u=this.usedTextures[i],c=u&&u.indexOf(e);if(null==c||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));const t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const e in this.freeTextures)this.freeTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));for(const e in this.usedTextures)this.usedTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function hb(e,t,n,r,a){const i=function(e,t){switch(e){case Cf.PACKED_2X2_FLOAT32:return Wm(t);case Cf.PACKED_2X2_FLOAT16:return Vm(t);case Cf.UNPACKED_FLOAT32:return Lm(t);case Cf.UNPACKED_FLOAT16:return Pm(t);case Cf.PACKED_4X1_UNSIGNED_BYTE:return Um(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);let o;if(a){const[t,n]=If(e[0],e[1]);o=t*n}else{const[t,n]=Tf(e[0],e[1]);o=t*n}const s=function(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(t))}(n,i);return o*s}function db(e,t){if(e===Ef.UPLOAD)return Cf.PACKED_2X2_FLOAT32;if(e===Ef.RENDER||null==e)return function(e){return ye().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Cf.PACKED_2X2_FLOAT32:Cf.UNPACKED_FLOAT32:e?Cf.PACKED_2X2_FLOAT16:Cf.UNPACKED_FLOAT16}(t);if(e===Ef.DOWNLOAD||e===Ef.PIXELS)return Cf.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function fb(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}class mb{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Cm(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}const gb="if (isnan(x)) return x;",yb="return abs(x);";const vb=gb+"\n  return (x < 0.0) ? 0.0 : x;\n",bb=gb+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",xb="return x;";class wb{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Cm(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}class Nb{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Cm(this.outputShape.length);const t=e.length,n=ub("rc",t),r=bm(t),a=function(e,t){if(1===e)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),i=n.slice(-2),o=t<=1?"rc":"vec2(".concat(i.join(","),")");this.userCode="\n      void main() {\n        ".concat(r," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(a,");\n\n        setOutput(getChannel(packedInput, ").concat(o,"));\n      }\n    ")}}const Sb=Pp,kb={};const Eb=ye().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class Cb extends F{nextDataId(){return Cb.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ye().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(null!=e){if(e instanceof jm)t=e;else{const n=Sf(ye().getNumber("WEBGL_VERSION"),e);t=new jm(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const e=Sf(ye().getNumber("WEBGL_VERSION"));t=new jm(e),this.binaryCache=((n=ye().getNumber("WEBGL_VERSION"))in kb||(kb[n]={}),kb[n]),this.gpgpuCreatedLocally=!0}var n;this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new pb(this.gpgpu),this.numMBBeforeWarning=null==ye().global.screen?1024:ye().global.screen.height*ye().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new A(this,ci())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,r,a,i){const o=this.makeTensorInfo(t,n),s=this.texData.get(o.dataId);s.isPacked=!1,s.texture={texture:e,texShape:[r,a]},s.texShape=[r,a];const u=Hf(t),c=new _m(u,!1,i),l=this.runWebGLProgram(c,[o],n,[[r,a]]);return l.shape=t,s.texture=null,this.disposeIntermediateTensorInfo(o),l.dataId}write(e,t,n){if((ye().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ye().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:Ef.UPLOAD,refCount:1}),r}refCount(e){if(this.texData.has(e)){return this.texData.get(e).refCount}return 0}incRef(e){this.texData.get(e).refCount++}decRef(e){if(this.texData.has(e)){this.texData.get(e).refCount--}}move(e,t,n,r,a){if(ye().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:Ef.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:n,dtype:r,complexTensorInfos:a,slice:i,shape:o,isPacked:s}=t;if(null!=i){let t;t=s?new wb(o,xb):new mb(o,xb);const n=this.runWebGLProgram(t,[{dataId:e,shape:o,dtype:r}],r),a=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),a}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;const u=null!=this.activeTimers;let c,l;if(u&&(c=sa()),"complex64"===r){l=Ld(this.readSync(a.real.dataId),this.readSync(a.imag.dataId))}else l=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=sa()-c),this.convertAndCacheOnCPU(e,l)}async read(e){if(this.pendingRead.has(e)){const t=this.pendingRead.get(e);return new Promise((e=>t.push(e)))}const t=this.texData.get(e),{values:n,shape:r,slice:a,dtype:i,complexTensorInfos:o,isPacked:s}=t;if(null!=a){let t;t=s?new wb(r,xb):new mb(r,xb);const n=this.runWebGLProgram(t,[{dataId:e,shape:r,dtype:i}],i),a=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),a}if(null!=n)return this.convertAndCacheOnCPU(e);if(ye().getBool("DEBUG")&&!ye().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===ye().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u,c,l=null;if("complex64"!==i&&ye().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const t=this.texData.get(u.dataId);l=this.gpgpu.createBufferFromTexture(t.texture.texture,...Df(r))}if(this.pendingRead.set(e,[]),"complex64"!==i&&await this.gpgpu.createAndWaitForFence(),"complex64"===i){const e=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]);c=Ld(e[0],e[1])}else if(null==l)c=this.getValuesFromTexture(e);else{const e=U(r);c=this.gpgpu.downloadFloat32MatrixFromBuffer(l,e)}if(null!=u&&this.disposeIntermediateTensorInfo(u),null!=l){const e=this.gpgpu.gl;Ff(e,(()=>e.deleteBuffer(l)))}const p=this.convertAndCacheOnCPU(e,c),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach((e=>e(p))),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ci().removeDataId(e,this),this.pendingDeletes--),p}readToGPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.texData.get(e),{values:r,shape:a,slice:i,dtype:o,isPacked:s,texture:u}=n;if("complex64"===o)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=i){let n;n=s?new wb(a,xb):new mb(a,xb);const r=this.runWebGLProgram(n,[{dataId:e,shape:a,dtype:o}],o),i=this.readToGPU(r,t);return this.disposeIntermediateTensorInfo(r),i}if(null==u)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,t.customTexShape),l=ci().makeTensorFromTensorInfo(c),p=this.texData.get(c.dataId);return Object.assign({tensorRef:l},p.texture)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map((e=>ca(e)));return wo(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return wo(e.shape,e.dtype,t)}checkNumericalProblems(e){if(null!=e)for(let t=0;t<e.length;t++){const n=e[t];if(!_f(n)){if(ye().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}getValuesFromTexture(e){const{shape:t,dtype:n,isPacked:r}=this.texData.get(e),a=U(t);if(ye().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(e),r=this.texData.get(n.dataId),i=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,...Df(t)).subarray(0,a);return this.disposeIntermediateTensorInfo(n),i}const i=ye().getBool("WEBGL_PACK")&&!0===r,o=i?Hf(t):t,s=i?new Am(o):new Im(o),u=this.runWebGLProgram(s,[{shape:o,dtype:n,dataId:e}],"float32"),c=this.texData.get(u.dataId),l=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(u),l}timerAvailable(){return ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,n=[];let r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e();const a=pa(this.activeTimers.map((e=>e.query))).filter((e=>null!=e)),i=pa(this.activeTimers.map((e=>e.name))).filter((e=>null!=e));this.activeTimers=t,r&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const e=await Promise.all(a);o.kernelMs=function(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}(e),o.getExtraProfileInfo=()=>e.map(((e,t)=>({name:i[t],ms:e}))).map((e=>"".concat(e.name,": ").concat(e.ms))).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:sa(),endMs:null}}endTimer(e){return ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=sa(),e)}async getQueryTime(e){if(ye().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:n}=this.texData.get(e);return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:n,texShape:r,usage:a,isPacked:i,slice:o}=this.texData.get(e),s=o&&o.origDataId||e,u=this.dataRefCount.get(s);u>1?this.dataRefCount.set(s,u-1):(this.dataRefCount.delete(s),null!=t&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(t,r,a,i)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Eb;return ye().getBool("WEBGL_CPU_FORWARD")&&e.every((e=>null==this.texData.get(e.dataId).texture&&U(e.shape)<t))}getGPGPUContext(){return this.gpgpu}where(e){Or("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return Sb(e.shape,t)}packedUnaryOp(e,t,n){const r=new wb(e.shape,t),a=this.compileAndRun(r,[e],n);return ci().makeTensorFromTensorInfo(a)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){const t=Gv(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(ye().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,yb,e.dtype);const t=new mb(e.shape,yb),n=this.compileAndRun(t,[e]);return ci().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&J(n[0])){const a=n.map((e=>ua(e)));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,n){return ci().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){const t=new Nb(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new cb(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const n=[jf(e.shape),...Gf(e.shape)],r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[jf(t),...Gf(t)],i=new lb(a,n),o=[n],s=this.runWebGLProgram(i,[r],e.dtype,o,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}decode(e,t){const n=this.texData.get(e),{isPacked:r,shape:a,dtype:i}=n;if(null!=t){B(U(a)<=t[0]*t[1]*4,(()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."))}const o=Hf(a);let s;s=r?new Dm(o):new Tm(o);const u=[null!=t?t:Df(o)];return{dtype:i,shape:a,dataId:this.runWebGLProgram(s,[{shape:o,dtype:i,dataId:e}],i,u,!0,t).dataId}}runWebGLProgram(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5?arguments[5]:void 0;const o=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(o.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===kf.DENSE){const t=null!=i?i:Df(e.outputShape);s.texShape=t.map((e=>2*e))}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===U(o.shape))return s.values=Y(o.dtype,0),o;const u=[],c=t.map((t=>{if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&U(t.shape)<=ye().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!n.isPacked!==!!e.packedInputs)t=n.isPacked?this.unpackTensor(t):this.packTensor(t),u.push(t),n=this.texData.get(t.dataId);else if(n.isPacked&&!Xf(n.shape,t.shape)){const e=t,r=t.shape;t.shape=n.shape,t=this.packedReshape(t,r),u.push(t),n=this.texData.get(t.dataId),e.shape=r}return{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(o.dataId);const l={shape:o.shape,texData:s,isUniform:!1},p=function(e,t,n){let r="";t.concat(n).forEach((t=>{const a=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){const i=t.texData.texShape,{useSqueezeShape:o,uniformShape:s,keptDims:u}=xm(e.packedInputs,t.shape,i);let c="",l="",p="";if(1===s.length&&e.packedInputs){const e=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];c="".concat(e[0]>1,"_").concat(e[1]>1)}else if(2!==s.length||e.packedInputs){if(s.length>2&&!e.packedInputs){const e=ae(s);p="".concat(e[0]===i[1],"_").concat(e[e.length-1]===i[1])}}else l="".concat(s[0]>1,"_").concat(s[1]>1);const h=t.shape.length,d=2===s.length&&W(t.shape,i),f=1===U(t.shape),m=Ko(t.shape,n.shape),g=!e.packedInputs&&h===n.shape.length&&W(i,n.texData.texShape),y=e.packedInputs||s.length>2?"":"".concat(i[0]>1,"_").concat(i[1]>1);r+="".concat(h,"_").concat(g,"_").concat(o?u:"","_").concat(s.length,"_").concat(f,"_").concat(m,"_").concat(d,"_").concat(c,"_").concat(l,"_").concat(p,"_").concat(y,"_").concat(a)}else{const e=t.isUniform?"uniform":t.texData.texShape;r+="".concat(t.shape,"_").concat(e,"_").concat(a)}}));const a=e.userCode;let i=e.constructor.name;return i+="_"+r+"_"+a+"".concat(ye().getNumber("WEBGL_VERSION")),i}(e,c,l),h=this.getAndSaveBinary(p,(()=>Sm(this.gpgpu,e,c,l))),d=null!=this.activeTimers;let f;d&&(f=this.startTimer()),ye().get("ENGINE_COMPILE_ONLY")||function(e,t,n,r,a){t.program.enableShapeUniforms||(Em(t.inShapeInfos,n),Em([t.outShapeInfo],[r]));const i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):e.setOutputMatrixTexture(i.texture,o[0],o[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===ye().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(let u=0;u<n.length;++u){const r=n[u],{uniform:a,offset:i,shape:o,texShape:s}=t.variablesLocations[u];if(o){const{uniformShape:n}=xm(t.program.packedInputs,r.shape,r.texData.texShape);switch(n.length){case 1:e.gl.uniform1iv(o,new Int32Array(n));break;case 2:e.gl.uniform2iv(o,new Int32Array(n));break;case 3:e.gl.uniform3iv(o,new Int32Array(n));break;case 4:e.gl.uniform4iv(o,new Int32Array(n))}}if(s&&e.gl.uniform2i(s,r.texData.texShape[0],r.texData.texShape[1]),null!=a)if(r.isUniform)if(U(r.shape)<2)e.gl.uniform1f(a,r.uniformValues[0]);else{let t=r.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(a,t)}else null!=r.texData.slice&&null!=i&&e.gl.uniform1i(i,r.texData.slice.flatOffset),e.setInputMatrixTexture(r.texData.texture.texture,a,u)}const s=t.outShapeLocation;if(s)switch(r.shape.length){case 1:e.gl.uniform1iv(s,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(s,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(s,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(s,new Int32Array(r.shape))}if(t.outShapeStridesLocation){const n=ae(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(n));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(n));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(n))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&a)for(let u=0;u<t.program.customUniforms.length;++u){const n=t.program.customUniforms[u],r=t.customUniformLocations[u],i=a[u];if("float"===n.type)e.gl.uniform1fv(r,i);else if("vec2"===n.type)e.gl.uniform2fv(r,i);else if("vec3"===n.type)e.gl.uniform3fv(r,i);else if("vec4"===n.type)e.gl.uniform4fv(r,i);else if("int"===n.type)e.gl.uniform1iv(r,i);else if("ivec2"===n.type)e.gl.uniform2iv(r,i);else if("ivec3"===n.type)e.gl.uniform3iv(r,i);else{if("ivec4"!==n.type)throw Error("uniform type ".concat(n.type," is not supported yet."));e.gl.uniform4iv(r,i)}}e.executeProgram()}(this.gpgpu,h,c,l,r),u.forEach((e=>this.disposeIntermediateTensorInfo(e))),d&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)}));const m=ye().getNumber("WEBGL_FLUSH_THRESHOLD");if(m>0){const e=sa();e-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=e)}if(!ye().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===a){const e=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),e}return o}compileAndRun(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;return this.runWebGLProgram(e,t,n,r,a)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!ye().getBool("IS_TEST")){Object.keys(this.binaryCache).forEach((e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}))}this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=pi((()=>{if(!ye().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=ye().getBool("DEBUG");ye().set("DEBUG",!1);const t=this.abs(Mo(1e-8)).dataSync()[0];if(ye().set("DEBUG",e),t>0)return 32}return 16}))),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){const t=this.texData.get(e),{shape:n,dtype:r,values:a,texture:i,usage:o,isPacked:s}=t;if(null!=i)return;const u=null!=this.activeTimers;let c;u&&(c=sa());let l=t.texShape;if(null==l&&(l=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=ye().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=ye().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&ye().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,1===(e=e.map(((t,n)=>n>=e.length-2?R(e[n]):e[n]))).length&&(e=[2,e[0]])),2!==e.length){const t=X(e);e=t.newShape}let a=U(e),i=null;e.length<=1&&a<=n?i=[1,a]:2===e.length&&e[0]<=n&&e[1]<=n?i=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?i=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?i=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?i=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(i=[e[0],e[1]*e[2]*e[3]]);const o=null!=i&&Math.max(...i)>r&&Math.min(...i)<=(t?2:1)&&Math.min(...i)>0;if(null==i||o)if(t){const t=jf(e);let n=2,r=2;e.length&&([n,r]=Gf(e)),a=t*(n/2)*(r/2),i=q(a).map((e=>2*e))}else i=q(a);return i}(n,s),t.texShape=l),null!=a){const e=Hf(n);let i,o=l[1],p=l[0];const h=a instanceof Uint8Array||a instanceof Uint8ClampedArray;!s&&h||([o,p]=If(l[0],l[1])),i=s?new Mm(e,h):new _m(e,h);const d=h?[p,o]:l,f=this.makeTensorInfo(d,r),m=this.texData.get(f.dataId);m.usage=h?Ef.PIXELS:Ef.UPLOAD,m.texShape=d,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),o,p,a);const g=[[p,o]],y=!0,v=this.runWebGLProgram(i,[f],r,g,y),b=this.texData.get(v.dataId);t.texShape=b.texShape,t.isPacked=b.isPacked,t.usage=b.usage,ye().get("ENGINE_COMPILE_ONLY")?this.disposeData(v.dataId):(t.texture=b.texture,t.values=null,this.texData.delete(v.dataId)),this.disposeIntermediateTensorInfo(f),u&&(this.uploadWaitMs+=sa()-c)}else{const e=this.acquireTexture(l,o,r,s);t.texture=e}}convertAndCacheOnCPU(e,t){const n=this.texData.get(e),{dtype:r}=n;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){const n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length);for(let t=0;t<n.length;++t)n[t]=Math.round(e[t]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}acquireTexture(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const e=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(e," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*Q(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}for(const[,t]of Object.entries(this.binaryCache)){const n=new Promise((e=>{try{this.checkCompletion_(t),e(!0)}catch(n){throw n}}));e.push(n)}return Promise.all(e)}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await dd(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw Rf(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:n,infLoc:r,nanLoc:a,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:s}=km(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=r,e.nanLoc=a,e.outShapeLocation=i,e.outShapeStridesLocation=o,e.outTexShapeLocation=s}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";const{texture:r,height:a,width:i,channels:o}=e,s=ci().backend;if(!s.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=s.writeTexture(r,t,n,a,i,o);return ci().makeTensorFromDataId(u,t,n,s)}}Cb.nextDataId=0;Ya()&&gi("webgl",(()=>new Cb),2);const Tb="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class Db{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=Yo(t,n),this.enableShapeUniforms=Cm(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}}const Ib="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class Ab{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Yo(t,n);const a=this.outputShape.length;this.enableShapeUniforms=Cm(a);let i="";if(r)if(0===a||1===U(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{const e=bm(a);if(i="\n          ".concat(e," coords = getOutputCoords();\n        "),1===a)this.enableShapeUniforms?i+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":i+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{const e=ub("coords",a);this.enableShapeUniforms?i+="\n            bool nextRowOutOfBounds =\n              (".concat(e[a-2]," + 1) >= outShape[").concat(a," - 2];\n            bool nextColOutOfBounds =\n              (").concat(e[a-1]," + 1) >= outShape[").concat(a," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):i+="\n            bool nextRowOutOfBounds =\n              (".concat(e[a-2]," + 1) >= ").concat(this.outputShape[a-2],";\n            bool nextColOutOfBounds =\n              (").concat(e[a-1]," + 1) >= ").concat(this.outputShape[a-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(i,"\n\n        setOutput(result);\n      }\n    ")}}function Fb(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const _b={kernelName:Bt,backendName:"webgl",kernelFunc:Fb};function Mb(e){const{inputs:t,backend:n}=e,{real:r,imag:a}=t,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),s=Fb({inputs:{x:r},backend:n}),u=Fb({inputs:{x:a},backend:n});return o.complexTensorInfos={real:s,imag:u},i}const Ob={kernelName:Xe,backendName:"webgl",kernelFunc:Mb},Rb="return (a < 0.) ? b * a : a;",zb="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const Bb={kernelName:qt,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:i}=r,o=n.makeTensorInfo([],"float32",ia(i,"float32")),s=ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ab(zb,a.shape,o.shape):new Db(Rb,a.shape,o.shape),u=n.runWebGLProgram(s,[a,o],"float32");return n.disposeIntermediateTensorInfo(o),u}},Lb="return (a < 0.) ? b * a : a;",Pb="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const Ub={kernelName:En,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r,alpha:a}=t,i=ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ab(Pb,r.shape,a.shape):new Db(Lb,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],"float32")}},Wb="if (isnan(x)) return x;";function Vb(e){let{opSnippet:t,packedOpSnippet:n,cpuKernelImpl:r,dtype:a}=e;return e=>{let{inputs:i,backend:o}=e;const{x:s}=i,u=o,c=a||s.dtype;if(u.shouldExecuteOnCPU([s])&&null!=r){const e=u.texData.get(s.dataId),t=r(e.values,c);return u.makeTensorInfo(s.shape,c,t)}let l;return l=ye().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new wb(s.shape,n):new mb(s.shape,t),u.runWebGLProgram(l,[s],c)}}function qb(e){let{opSnippet:t,packedOpSnippet:n,checkOutOfBounds:r=!1,supportsComplex:a=!1,cpuKernelImpl:i,dtype:o}=e;return e=>{let{inputs:s,backend:u}=e;const{a:c,b:l}=s,p=u;if(a&&"complex64"===c.dtype){const e=p.texData.get(c.dataId),n=p.texData.get(l.dataId),[r,a]=[[e.complexTensorInfos.real,n.complexTensorInfos.real],[e.complexTensorInfos.imag,n.complexTensorInfos.imag]].map((e=>{const[n,r]=e,a={dataId:n.dataId,dtype:n.dtype,shape:c.shape},i={dataId:r.dataId,dtype:r.dtype,shape:l.shape},o=new Db(t,c.shape,l.shape);return p.runWebGLProgram(o,[a,i],Ma(n.dtype,r.dtype))})),i=Mb({inputs:{real:r,imag:a},backend:p});return p.disposeIntermediateTensorInfo(r),p.disposeIntermediateTensorInfo(a),i}const h=o||Ma(c.dtype,l.dtype);if(("string"===c.dtype||"string"===l.dtype||p.shouldExecuteOnCPU([c,l]))&&null!=i){const e=p.texData.get(c.dataId).values,t=p.texData.get(l.dataId).values,n="string"===c.dtype?bf(e):e,r="string"===c.dtype?bf(t):t,[a,o]=i(c.shape,l.shape,n,r,h),s=p.makeTensorInfo(o,h);return p.texData.get(s.dataId).values=a,s}let d;return d=ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new Ab(n,c.shape,l.shape,r):new Db(t,c.shape,l.shape),p.runWebGLProgram(d,[c,l],h)}}function jb(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return"return x;";if("relu"===e)return t?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":vb;if("elu"===e)return t?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===e)return t?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":bb;if("prelu"===e)return t?Pb:Lb;if("leakyrelu"===e)return t?zb:Rb;if("sigmoid"===e)return"return 1.0 / (1.0 + exp(-1.0 * x));";throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}class Gb{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=Cm(this.outputShape.length);const c=r?e[1]:e[2],l=Math.ceil(c/2),p=r?"i * 2, rc.y":"rc.y, i * 2",h=a?"rc.z, i * 2":"i * 2, rc.z",d=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",g="";o&&(m=s?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(o,"\n        }"):u?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(o,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(o,"\n        }"),g="result = activation(result);");const y=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let v="rc.x",b="rc.x";e[0]<t[0]?v="imod(rc.x, ".concat(e[0],")"):t[0]<e[0]&&(b="imod(rc.x, ".concat(t[0],")")),this.userCode="\n      ".concat(m,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(l,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(v,";\n        int batchB = ").concat(b,";\n        for (int i = 0; i < ").concat(l,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(p,");\n          vec4 b = getMatrixB(batchB, ").concat(h,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(d[0]," * ").concat(f[0],");\n          result += (").concat(d[1]," * ").concat(f[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")}}const Hb="return areal * breal - aimag * bimag;",Kb="return areal * bimag + aimag * breal;";class Xb{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Yo(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}}const Yb="return a * b;";function $b(e){const{inputs:t,backend:n}=e,{a:r,b:a}=t,i=Ma(r.dtype,a.dtype);if("complex64"===r.dtype){const e=n.texData.get(r.dataId),t=n.texData.get(a.dataId),i=new Xb(Hb,r.shape,a.shape),o=new Xb(Kb,r.shape,a.shape),s=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:r.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:a.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:a.shape}],u=n.runWebGLProgram(i,s,"float32"),c=n.runWebGLProgram(o,s,"float32"),l=Mb({inputs:{real:u,imag:c},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),l}if(n.shouldExecuteOnCPU([r,a])){const e=n.texData.get(r.dataId),t=n.texData.get(a.dataId),[o,s]=Ov(r.shape,a.shape,e.values,t.values,i),u=n.makeTensorInfo(s,i);return n.texData.get(u.dataId).values=o,u}let o;return o=ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ab(Yb,r.shape,a.shape):new Db(Yb,r.shape,a.shape),n.runWebGLProgram(o,[r,a],i)}const Zb={kernelName:fn,backendName:"webgl",kernelFunc:$b};function Qb(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{shape:i}=r,o=n,s=U(a.shape),u=H(i,s),c=U(u);B(s===c,(()=>"The new shape (".concat(u,") has ").concat(c," elements and the old ")+"shape (".concat(a.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements."));const l=o.texData.get(a.dataId);return!l.isPacked||Xf(a.shape,u)||null!==l.texture&&Xf(l.shape,u)?(o.incRef(a.dataId),{dataId:a.dataId,shape:u,dtype:a.dtype}):function(e,t,n){const r=[jf(e.shape),...Gf(e.shape)],a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[jf(t),...Gf(t)],o=new lb(i,r),s=[r],u=n.runWebGLProgram(o,[a],e.dtype,s,!0);return{dataId:u.dataId,shape:t,dtype:u.dtype}}(a,u,o)}const Jb={kernelName:On,backendName:"webgl",kernelFunc:Qb};class ex{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];const o=4*Math.floor(n/4),s=n%4;let u="sumValue += dot(values, ones);";if(null!=t){const e=1/t;u="sumValue += dot(values * ".concat(V(e)?e.toPrecision(2):e,", ones);")}let c="";a%n>0&&(c="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(c,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(o,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(u,"\n        }\n\n        int inIdx = inOffset + ").concat(o,";\n        if (").concat(1===s,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(u,"\n        } else if (").concat(2===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(u,"\n        } else if (").concat(3===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(u,"\n        }\n        setOutput(sumValue);\n      }\n    ")}}class tx{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];let o="0.0",s="";"prod"===t?o="1.0":"min"===t?(o="1.0 / 1e-20",s="min"):"max"===t&&(o="-1.0 / 1e-20",s="max");let u="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?u="sumValue":"prod"===t?u="prodValue":"all"===t?u="allValue":"any"===t&&(u="anyValue");const c=4*Math.floor(n/4),l=n%4;let p="\n      if (".concat("sum"===t,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===t,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(s,"(values, minMaxValue);\n        if (").concat("min"===t," || ").concat("max"===t,") {\n          minMaxValue = ").concat(s,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),h="vec4";"all"===t?(o="1.0",p="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===t&&(o="0.0",p="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");let d="";a%n>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(o,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(d,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(o,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(p,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===l,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(p,"\n        } else if (").concat(2===l,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(p,"\n        } else if (").concat(3===l,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(p,"\n        }\n        setOutput(").concat(u,");\n      }\n    ")}}function nx(e,t,n,r){const a=function(e){const t=[];for(;0===t.length||1!==t[t.length-1].outSize;){const n=t.length?t[t.length-1].outSize:e[1],r=Nd(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape);let i=e;for(let o=0;o<a.length;o++){const{inSize:s,windowSize:u,outSize:c}=a[o];let l,p;l="mean"===n?0===o?new ex({windowSize:u,inSize:s,batchSize:e.shape[0],outSize:c},s):new ex({windowSize:u,inSize:s,batchSize:e.shape[0],outSize:c}):new tx({windowSize:u,inSize:s,batchSize:e.shape[0],outSize:c},n),p=i,i=r.runWebGLProgram(l,[i],t),p.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(p)}return i}class rx{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[t[i]];this.outputShape=n,this.rank=n.length;const r=bm(this.rank),a=function(e){const t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(t);this.userCode="\n    void main() {\n      ".concat(r," resRC = getOutputCoords();\n      setOutput(getA(").concat(a,"));\n    }\n    ")}}class ax{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(e.length);for(let c=0;c<n.length;c++)n[c]=e[t[c]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));const r=bm(this.rank),a=sb("rc",this.rank),i=new Array(this.rank);for(let c=0;c<t.length;c++)i[t[c]]=a[c];const o="vec2(".concat(i.slice(-2).join(),")"),s="++".concat(a[this.rank-1]," < ").concat(n[this.rank-1]),u="getChannel(getA(".concat(i.join(),"), ").concat(o,")");this.userCode="\n    void main() {\n      ".concat(r," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(u,";\n      if(").concat(s,") {\n        result[1] = ").concat(u,";\n      }\n      --").concat(a[this.rank-1],";\n      if(++").concat(a[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(u,";\n        if(").concat(s,") {\n          result[3] = ").concat(u,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}}function ix(e,t,n){const r=ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ax(e.shape,t):new rx(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function ox(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r;return function(e,t,n,r){const a=t,i=e.shape.length,o=K(a,e.shape);let s=o;const u=yc(s,i),c=null!=u;let l=e;c&&(l=ix(e,u,r),s=bc(s.length,i)),gc("sum",s,i);const[p,h]=fc(l.shape,s);let d=p;n&&(d=mc(p,o));const f=U(h),m=Qb({inputs:{x:l},attrs:{shape:[U(e.shape)/f,f]},backend:r}),g=nx(m,Oa(e.dtype),"sum",r),y=Qb({inputs:{x:g},attrs:{shape:d},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(g),c&&r.disposeIntermediateTensorInfo(l),y}(a,i,o,n)}const sx={kernelName:tr,backendName:"webgl",kernelFunc:ox};function ux(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{perm:i}=r,o=n,s=a.shape.length,u=new Array(s);for(let l=0;l<u.length;l++)u[l]=a.shape[i[l]];let c;if(o.shouldExecuteOnCPU([a])){const e=o.texData.get(a.dataId).values,t=ib(e,a.shape,a.dtype,i,u);c=o.makeTensorInfo(u,a.dtype);o.texData.get(c.dataId).values=t}else c=ix(a,i,o);return c}const cx={kernelName:Sr,backendName:"webgl",kernelFunc:ux};function lx(e){let{a:t,b:n,transposeA:r,transposeB:a,backend:i,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:u=0,activation:c=null}=e;const l=t.shape.length,p=n.shape.length,h=r?t.shape[l-2]:t.shape[l-1],d=a?n.shape[p-1]:n.shape[p-2],f=r?t.shape[l-1]:t.shape[l-2],m=a?n.shape[p-2]:n.shape[p-1],g=t.shape.slice(0,-2),y=n.shape.slice(0,-2),v=U(g),b=U(y),x=Yo(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([f,m]);B(h===d,(()=>"Error in matMul: inner shapes (".concat(h,") and (")+"".concat(d,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match.")));const w=r?[v,h,f]:[v,f,h],N=a?[b,m,d]:[b,d,m],S=Qb({inputs:{x:t},backend:i,attrs:{shape:w}}),k=Qb({inputs:{x:n},backend:i,attrs:{shape:N}}),E=[S,k],C=Math.max(v,b),T=r?S.shape[1]:S.shape[2],D=null!=o,I=null!=s,A="leakyrelu"===c,F=null!=c?jb(c,!0):null;let _;if((1===f||1===m)&&T>1e3&&!1===(D||I||A||null!=F)){let e=S,t=k;r&&(e=ux({inputs:{x:S},backend:i,attrs:{perm:[0,2,1]}}),E.push(e)),a&&(t=ux({inputs:{x:k},backend:i,attrs:{perm:[0,2,1]}}),E.push(t));const n=1===m;let o=e;1!==m&&(o=Qb({inputs:{x:e},backend:i,attrs:{shape:[C,T,1]}}),E.push(o));const s=1===m?2:1;let u=t;n&&(u=Qb({inputs:{x:t},backend:i,attrs:{shape:[C,1,T]}}),E.push(u));const c=$b({inputs:{a:o,b:u},backend:i});_=ox({inputs:{x:c},backend:i,attrs:{axis:s,keepDims:!0}}),E.push(c)}else{const e=Ma(t.dtype,n.dtype),c=new Gb(w,N,[C,f,m],r,a,D,F,I,A),l=[S,k];if(null!=o&&l.push(o),I&&l.push(s),A){const e=i.makeTensorInfo([],"float32",ia(u,"float32"));l.push(e),E.push(e)}_=i.runWebGLProgram(c,l,e)}const M=Qb({inputs:{x:_},backend:i,attrs:{shape:x}});E.push(_);for(const O of E)i.disposeIntermediateTensorInfo(O);return M}const px={kernelName:Fr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:a,b:i,bias:o,preluActivationWeights:s}=t,{transposeA:u,transposeB:c,activation:l,leakyreluAlpha:p}=r;return lx({a:a,b:i,transposeA:u,transposeB:c,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:p,activation:l})}},hx="return abs(x);";const dx={kernelName:Ne,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const e=n.texData.get(r.dataId),t=Gv(e.values);return n.makeTensorInfo(r.shape,r.dtype,t)}let a;return a=ye().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new wb(r.shape,hx):new mb(r.shape,hx),n.runWebGLProgram(a,[r],r.dtype)}},fx=Vb({opSnippet:gb+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),mx={kernelName:Se,backendName:"webgl",kernelFunc:fx},gx=Vb({opSnippet:gb+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),yx={kernelName:ke,backendName:"webgl",kernelFunc:gx},vx="return a + b;",bx=qb({opSnippet:vx,packedOpSnippet:vx,supportsComplex:!0,cpuKernelImpl:hv}),xx={kernelName:Ee,backendName:"webgl",kernelFunc:bx};class wx{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(((e,t)=>"T".concat(t)));const n=[];this.variableNames.forEach((e=>{n.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));const r=this.variableNames.map((e=>"v".concat(e))).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}class Nx{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(((e,t)=>"T".concat(t)));const n=[];this.variableNames.forEach((e=>{n.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));const r=this.variableNames.map((e=>"v".concat(e))).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}const Sx={kernelName:Ce,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r}=t,a=n;if(1===a.length)return Fb({inputs:{x:a[0]},backend:r});if(a.length>ye().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const t=Math.floor(a.length/2),n=e({inputs:a.slice(0,t),backend:r}),i=e({inputs:a.slice(t),backend:r});return e({inputs:[n,i],backend:r})}const i=a.map((e=>e.dtype)).reduce(((e,t)=>Ma(e,t))),o=a.map((e=>e.shape)),s=ye().getBool("WEBGL_PACK")?new Nx(a[0].shape,o):new wx(a[0].shape,o);return r.runWebGLProgram(s,a,i)}};const kx={kernelName:Te,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r,s=a.shape.length,u=K(i,a.shape);let c=u;const l=yc(c,s);let p=a;null!=l&&(p=ux({inputs:{x:a},backend:n,attrs:{perm:l}}),c=bc(c.length,s)),gc("all",c,s);const[h,d]=fc(p.shape,c),f=Qb({inputs:{x:p},backend:n,attrs:{shape:[-1,U(d)]}}),m=nx(f,f.dtype,"all",n);let g;if(o){g=Qb({inputs:{x:m},backend:n,attrs:{shape:mc(h,u)}})}else g=Qb({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=l&&n.disposeIntermediateTensorInfo(p),g}};const Ex={kernelName:De,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r,s=a.shape.length,u=K(i,a.shape);let c=u;const l=yc(c,s);let p=a;null!=l&&(p=ux({inputs:{x:a},backend:n,attrs:{perm:l}}),c=bc(c.length,s)),gc("any",c,s);const[h,d]=fc(p.shape,c),f=Qb({inputs:{x:p},backend:n,attrs:{shape:[-1,U(d)]}}),m=nx(f,f.dtype,"any",n);let g;if(o){g=Qb({inputs:{x:m},backend:n,attrs:{shape:mc(h,u)}})}else g=Qb({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=l&&n.disposeIntermediateTensorInfo(p),g}};class Cx{constructor(e,t,n){this.variableNames=["A"];const{windowSize:r,batchSize:a,outSize:i}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,i];const o="max"===t?">":"<",s=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(r,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          int inIdx = ").concat(s,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(o," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}}class Tx{constructor(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,B(e.length>2,(()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2.")));const a=e[e.length-1],i=Math.ceil(a/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");const o=this.outputShape,s=o.length,u=bm(s),c=ub("coords",s);let l,p;if(1===i){p=s+1;const e=bm(p);l="\n        ".concat(e," sourceLocR = ").concat(e,"(").concat(c.join(),", 0);\n        ++").concat(c[s-1],";\n        ").concat(e," sourceLocG = ").concat(e,"(").concat(c.join(),", 0);\n        ++").concat(c[s-2],";\n        ").concat(e," sourceLocA = ").concat(e,"(").concat(c.join(),", 0);\n        --").concat(c[s-1],";\n        ").concat(e," sourceLocB = ").concat(e,"(").concat(c.join(),", 0);\n        --").concat(c[s-2],";")}else p=s,l="\n        ".concat(u," sourceLocR = coords;\n        ++").concat(c[s-1],";\n        ").concat(u," sourceLocG = coords;\n        ++").concat(c[s-2],";\n        ").concat(u," sourceLocA = coords;\n        --").concat(c[s-1],";\n        ").concat(u," sourceLocB = coords;\n        --").concat(c[s-2],";");const h=["x","y","z","w","u","v"].slice(0,p),d="."+h[p-1],f=h.map((e=>"int "+e)),m=ub("sourceLocR",p-1).concat("inIdx.r"),g=ub("sourceLocG",p-1).concat("inIdx.g"),y=ub("sourceLocB",p-1).concat("inIdx.b"),v=ub("sourceLocA",p-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",x=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(m.join(),"),\n                             getBestIndicesAChannel(").concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(v.join(),")));"),w="vec4(\n            getAChannel(".concat(m.join(),"),\n            hasNextCol ? getAChannel(").concat(g.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(v.join(),") : 0.)"),N=r?"":"\n      float getBestIndicesAChannel(".concat(f.join(),") {\n        return getChannel(getBestIndicesA(").concat(h.join(),"),\n                                          vec2(").concat(h.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(f.join(),") {\n        return getChannel(getA(").concat(h.join(),"),\n                               vec2(").concat(h.slice(-2).join(),"));\n      }\n      ").concat(N,"\n      void main() {\n        ").concat(u," coords = getOutputCoords();\n        bool hasNextCol = ").concat(c[s-1]," < ").concat(o[s-1]-1,";\n        bool hasNextRow = ").concat(c[s-2]," < ").concat(o[s-2]-1,";\n        ").concat(l,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(d,", sourceLocG").concat(d,",\n          sourceLocB").concat(d,", sourceLocA").concat(d,") * ").concat(t,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(w,";\n\n        for (int i = 0; i < ").concat(t,"; i++) {\n          inIdx = srcIdx;\n          ").concat(x,"\n          vec4 candidate = ").concat(w,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(b,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}}function Dx(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.shape[0],i=t.shape[1];null!=r&&(a=r.shape[0],i=r.shape[1]);const o=Nd(i),s={windowSize:o,inSize:i,batchSize:a,outSize:Math.ceil(i/o)},u=new Cx(s,n,null==r),c=[t];null!=r&&c.push(r);const l=e.runWebGLProgram(u,c,"int32");if(1===l.shape[1])return l;const p=Dx(e,t,n,l);return e.disposeIntermediateTensorInfo(l),p}function Ix(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const a=null!=r?r.shape:t.shape,i=Nd(a[a.length-1]),o=new Tx(a,i,n,null==r),s=null==r?[t]:[t,r],u=e.runWebGLProgram(o,s,"int32");if(u.shape.length===t.shape.length){const r=Ix(e,t,n,u);return e.disposeIntermediateTensorInfo(u),r}return u}function Ax(e,t,n,r){const a=[n];if(gc("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!ye().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const n=[],i=e.texData.get(t.dataId);let o=t;null!==i&&i.isPacked&&(o=e.unpackTensor(t),n.push(o));const[s,u]=fc(o.shape,a),c=U(u),l=Qb({inputs:{x:o},backend:e,attrs:{shape:[-1,c]}});n.push(l);const p=Dx(e,l,r);n.push(p);const h=Qb({inputs:{x:p},backend:e,attrs:{shape:s}});return n.forEach((t=>e.disposeIntermediateTensorInfo(t))),h}return Ix(e,t,r)}const Fx={kernelName:Ie,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;let o=K(i,a.shape);const s=yc(o,a.shape.length);let u=a;const c=[];null!=s&&(u=ux({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=bc(o.length,u.shape.length)),gc("argMax",[o[0]],u.shape.length);const l=Ax(n,u,o[0],"max");return c.forEach((e=>n.disposeIntermediateTensorInfo(e))),l}};const _x={kernelName:Ae,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;let o=K(i,a.shape);const s=yc(o,a.shape.length);let u=a;const c=[];null!=s&&(u=ux({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=bc(o.length,u.shape.length)),gc("argMin",[o[0]],u.shape.length);const l=Ax(n,u,o[0],"min");return c.forEach((e=>n.disposeIntermediateTensorInfo(e))),l}},Mx=Vb({opSnippet:gb+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),Ox={kernelName:Fe,backendName:"webgl",kernelFunc:Mx},Rx=Vb({opSnippet:gb+"return log(x + sqrt(x * x + 1.0));"}),zx={kernelName:_e,backendName:"webgl",kernelFunc:Rx},Bx=Vb({opSnippet:gb+"\n  return atan(x);\n"}),Lx={kernelName:Me,backendName:"webgl",kernelFunc:Bx},Px=qb({opSnippet:Tb+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Ib+"\n  return result;\n"}),Ux={kernelName:Re,backendName:"webgl",kernelFunc:Px},Wx=Vb({opSnippet:gb+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),Vx={kernelName:Oe,backendName:"webgl",kernelFunc:Wx};class qx{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterHeight,p=e.effectiveFilterWidth,h=e.padInfo.top,d=e.padInfo.left;this.outputShape=e.outShape;const f="avg"===t,m="((batch  * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),g="(xR * ".concat(e.inWidth," + xC) * ").concat(e.inChannels," + d");let y="0.0";if(f||(y="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode="\n        const ivec2 strides = ivec2(".concat(o,", ").concat(s,");\n        const ivec2 pads = ivec2(").concat(h,", ").concat(d,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(l,";\n              wR += ").concat(u,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(p,";\n                wC += ").concat(c,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(t," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(r?a?m:g:"wR * ".concat(p," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let v="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(v="avgValue / max(count, 1.0)");const b=4*Math.floor(i/4),x=i%4,w="\n      if (".concat(f,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(o,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(h,", ").concat(d,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(l,";\n            wR += ").concat(u,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(b,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(c,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              getValue(batch, xR, xC + 3 * ").concat(c,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(b,";\n          if (").concat(1===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(v,");\n      }\n    ")}}class jx{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,o=e.strideDepth,s=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,l=e.dilationHeight,p=e.dilationWidth,h=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=e.padInfo.front,g=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const v="avg"===t;let b="0.0";if(v||(b="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(o,", ").concat(s,", ").concat(u,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(h,";\n              wD += ").concat(c,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(d,";\n                wR += ").concat(l,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(f,";\n                  wC += ").concat(p,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(t," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(r?a?"(((batch * ".concat(e.inDepth," + xD) * ").concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"((xD * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"wD * ".concat(d," * ").concat(f," +\n                      wR * ").concat(f," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let x="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(x="avgValue / max(count, 1.0)");const w=4*Math.floor(i/4),N=i%4,S="\n      if (".concat(v,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(o,", ").concat(s,", ").concat(u,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n      const float initializationValue = ").concat(b,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(b,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(h,";\n            wD += ").concat(c,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(d,";\n            wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(p,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(p,", ch)\n              );\n\n              ").concat(S,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===N,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(2===N,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(3===N,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(p,", ch),\n                initializationValue\n              );\n\n              ").concat(S,"\n            }\n          }\n        }\n        setOutput(").concat(x,");\n      }\n    ")}}const Gx={kernelName:ze,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t;tm(a,"avgPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:u}=r;B(fu(o,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")));const c=au(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&W(c.inShape,c.outShape))return Fb({inputs:{x:a},backend:n});const l=new qx(c,"avg",!1);return n.runWebGLProgram(l,[a],"float32")}};const Hx={kernelName:Le,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:o,pad:s,dimRoundingMode:u,dataFormat:c}=r,l=iu(a.shape,i,o,[1,1,1],s,u,c),p=new jx(l,"avg",!1);return n.runWebGLProgram(p,[a],"float32")}};class Kx{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=s-1-e.padInfo.top,l=u-1-e.padInfo.left,p=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(c,", ").concat(l,");\n      const float avgMultiplier = float(").concat(p,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(s,";\n            wR += ").concat(i,") {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(u,";\n            wC+= ").concat(o,") {\n            float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class Xx{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,p=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=l-1-e.padInfo.front,f=p-1-e.padInfo.top,m=h-1-e.padInfo.left,g=1/(t*n*r);this.userCode="\n      const ivec3 pads = ivec3(".concat(d,", ").concat(f,", ").concat(m,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(l,";\n            wD += ").concat(s,") {\n          float dyD = float(dyDCorner + wD) / ").concat(a,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(p,";\n              wR += ").concat(u,") {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(c,") {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const Yx={kernelName:Pe,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,o=i,{filterSize:s,strides:u,pad:c,dimRoundingMode:l}=r,p=iu(o.shape,s,u,[1,1,1],c,l),h=new Xx(p);return n.runWebGLProgram(h,[a],o.dtype)}};const $x={kernelName:Be,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,o=i;tm([a,i],"avgPoolGrad");const{filterSize:s,strides:u,pad:c}=r,l=au(o.shape,s,u,1,c),p=new Kx(l);return n.runWebGLProgram(p,[a],o.dtype)}};const Zx={kernelName:Ue,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:a,b:i}=t,{transposeA:o,transposeB:s}=r;return lx({a:a,b:i,transposeA:o,transposeB:s,backend:n})}};class Qx{constructor(e,t,n,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Yo(e,t),Yo(e,n);let o="0.0";null!=r&&(Yo(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let s="1.0";null!=a&&(Yo(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(o,";\n        float scale = ").concat(s,";\n        float inv = scale * inversesqrt(variance + float(").concat(i,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}}class Jx{constructor(e,t,n,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Yo(e,t),Yo(e,n);let o="vec4(0.0)";null!=r&&(Yo(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let s="vec4(1.0)";null!=a&&(Yo(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = ".concat(o,";\n        vec4 scale = ").concat(s,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(i,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}}const ew={kernelName:_t,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:a,mean:i,variance:o,offset:s,scale:u}=t;B(i.shape.length===o.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),B(null==s||i.shape.length===s.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),B(null==u||i.shape.length===u.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));let{varianceEpsilon:c}=r;null==c&&(c=.001);const l=[a,i,o];let p=null;null!=s&&(p=s.shape,l.push(s));let h=null;null!=u&&(h=u.shape,l.push(u));const d=ye().getBool("WEBGL_PACK_NORMALIZATION")?new Jx(a.shape,i.shape,o.shape,p,h,c):new Qx(a.shape,i.shape,o.shape,p,h,c);return n.runWebGLProgram(d,l,l[0].dtype)}};class tw{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=bm(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=function(e){if(1===e)return"sourceLoc";if(e<=6)return nw.slice(0,e).map((e=>"sourceLoc."+e)).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank);let r;const a=e.map(((e,t)=>"sourceLoc.".concat(nw[t]," = start[").concat(t,"] + coords.").concat(nw[t],";")));r="\n        ".concat(t," sourceLoc;\n        ").concat(t," coords = getOutputCoords();\n        ").concat(a.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(r,"\n        setOutput(getSource(").concat(n,"));\n      }\n    ")}}const nw=["x","y","z","w","u","v"];class rw{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=bm(this.rank),n=ub("coords",this.rank),r=ub("sourceLoc",this.rank),a=1===this.rank?"sourceLoc":"vec2(".concat(r.slice(-2).join(),")"),i="getChannel(getSource(".concat(r.join(),"), ").concat(a,")"),o="\n      result.x = ".concat(i,";\n      if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n        ++").concat(r[this.rank-1],";\n        result.y = ").concat(i,";\n        --").concat(r[this.rank-1],";\n      }\n    "),s=1===this.rank?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(e[this.rank-2],") {\n        ++").concat(r[this.rank-2],";\n        result.z = ").concat(i,";\n        if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n          ++").concat(r[this.rank-1],";\n          result.w = ").concat(i,";\n        }\n      }\n    "),u=this.rank<=4?"sourceLoc = coords +\n            ".concat(t,"(").concat(e.map(((e,t)=>"start[".concat(t,"]"))).join(),");"):e.map(((e,t)=>"".concat(r[t]," = ").concat(n[t]," + start[").concat(t,"];"))).join("\n");this.userCode="\n      void main() {\n        ".concat(t," coords = getOutputCoords();\n        ").concat(t," sourceLoc;\n        ").concat(u,"\n        vec4 result = vec4(0.);\n        ").concat(o,"\n        ").concat(s,"\n        setOutput(result);\n      }\n    ")}}function aw(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,size:o}=r,[s,u]=Vs(a,i,o);if(Ds(a,s,u),0===U(u))return n.makeTensorInfo(u,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){const e=n.texData.get(a.dataId),t=Hv(e.values,s,u,a.shape,a.dtype);return n.makeTensorInfo(u,a.dtype,t)}const{isPacked:c}=n.texData.get(a.dataId),l=Us(a.shape,s,u);if(c||!l){const e=ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rw(u):new tw(u),t=[s];return n.runWebGLProgram(e,[a],a.dtype,t)}return n.uploadToGPU(a.dataId),function(e,t,n,r){const a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),o=r.texData.get(i.dataId);Object.assign(o,a),o.refCount=1,o.shape=n,o.dtype=e.dtype;let s=Ws(t,ae(e.shape));a.slice&&(s+=a.slice.flatOffset),o.slice={flatOffset:s,origDataId:a.slice&&a.slice.origDataId||e.dataId};const u=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,u+1),i}(a,s,u,n)}const iw={kernelName:Xn,backendName:"webgl",kernelFunc:aw},ow={kernelName:We,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,crops:o}=r;B(a.shape.length<=4,(()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"));const s=i.reduce(((e,t)=>e*t)),u=kd(a.shape,i,s),c=Ed(u.length,i.length),l=Cd(a.shape,i,s),p=Td(o,i.length),h=Dd(l,o,i.length),d=[],f=Qb({inputs:{x:a},backend:n,attrs:{shape:u}}),m=ux({inputs:{x:f},backend:n,attrs:{perm:c}}),g=Qb({inputs:{x:m},backend:n,attrs:{shape:l}}),y=aw({inputs:{x:g},backend:n,attrs:{begin:p,size:h}});return d.push(f),d.push(m),d.push(g),d.forEach((e=>n.disposeIntermediateTensorInfo(e))),y}};const sw={kernelName:Ve,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:o}=r,s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=dv(s,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}};const uw={kernelName:qe,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{a:r,b:a}=t,i=ye().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=ye().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,a])||1===o){const e=n.texData.get(r.dataId).values,t=n.texData.get(a.dataId).values,[i,o]=mv(r.shape,a.shape,e,t,r.dtype),s=n.makeTensorInfo(o,r.dtype);return n.texData.get(s.dataId).values=i,s}let s;return s=i?new Ab("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",r.shape,a.shape,!1):new Db("\n  return float(int(a.r) & int(b.r));\n",r.shape,a.shape),n.runWebGLProgram(s,[r,a],r.dtype)}};const cw={kernelName:je,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:r,s1:a}=t,i=n.readSync(r.dataId),o=n.readSync(a.dataId),s=Yo(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},lw=qb({opSnippet:"return float(a != b);",cpuKernelImpl:zv,dtype:"bool"}),pw={kernelName:gn,backendName:"webgl",kernelFunc:lw};function hw(e){const{inputs:t,backend:n}=e,{input:r}=t;return Fb({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}const dw={kernelName:Fn,backendName:"webgl",kernelFunc:hw};const fw={kernelName:Ge,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r,attrs:a}=t,{x:i}=n,{dtype:o}=a;if("complex64"===o){if("complex64"===i.dtype)return Fb({inputs:{x:i},backend:r});const t=ul(i.shape),n=e({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),a=Mb({inputs:{real:n,imag:t},backend:r});return t.dispose(),r.disposeIntermediateTensorInfo(n),a}if("complex64"===i.dtype){const t=hw({inputs:{input:i},backend:r}),n=e({inputs:{x:t},backend:r,attrs:{dtype:o}});return r.disposeIntermediateTensorInfo(t),n}if(!Z(i.dtype,o)){const e=Fb({inputs:{x:i},backend:r});return{dataId:e.dataId,shape:e.shape,dtype:o}}if(r.shouldExecuteOnCPU([i])){const e=r.texData.get(i.dataId).values,[t,n,a]=gv(e,i.shape,i.dtype,o);return r.makeTensorInfo(t,n,a)}if("int32"===o)return function(e,t){const n=new mb(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,r);if("bool"===o){const e=r.makeTensorInfo([],"bool",Y("bool",1)),t=lw({inputs:{a:i,b:e},backend:r});return r.disposeIntermediateTensorInfo(e),t}throw new Error("Error in Cast: failed to cast ".concat(i.dtype," to ").concat(o))}},mw="return ceil(x);",gw=Vb({opSnippet:mw,packedOpSnippet:mw,cpuKernelImpl:yv}),yw={kernelName:He,backendName:"webgl",kernelFunc:gw};class vw{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class bw{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const xw={kernelName:Ke,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{clipValueMin:i,clipValueMax:o}=r;let s;s=ye().getBool("WEBGL_PACK_CLIP")?new bw(a.shape):new vw(a.shape);const u=[[i],[o]];return n.runWebGLProgram(s,[a],a.dtype,u)}};class ww{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function Nw(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}const Sw={kernelName:Ye,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,a=n.texData.get(r.dataId),i=new ww(r.shape),o=[Nw(r,a.complexTensorInfos.real),Nw(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}};class kw{constructor(e){this.outputShape=[],this.outputShape=md(e,1),this.variableNames=e.map(((e,t)=>"T".concat(t)));const t=new Array(e.length-1);t[0]=e[0][1];for(let i=1;i<t.length;i++)t[i]=t[i-1]+e[i][1];const n=["if (yC < ".concat(t[0],") setOutput(getT0(yR, yC));")];for(let i=1;i<t.length;i++){const e=t[i-1];n.push("else if (yC < ".concat(t[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(e,"));"))}const r=t.length,a=t[t.length-1];n.push("else setOutput(getT".concat(r,"(yR, yC-").concat(a,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}}class Ew{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=md(e,t);const n=this.outputShape,r=n.length,a=bm(r),i=ub("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(((e,t)=>"T".concat(t)));const s=new Array(e.length-1);s[0]=e[0][t];for(let f=1;f<s.length;f++)s[f]=s[f-1]+e[f][t];const u=o[t],c=o.slice(-2),l=o.join();let p="if (".concat(u," < ").concat(s[0],") {\n        return getChannel(\n            getT0(").concat(l,"), vec2(").concat(c.join(),"));\n        }");for(let f=1;f<s.length;f++){const e=s[f-1];p+="\n        if (".concat(u," < ").concat(s[f],"  && ").concat(u," >= ").concat(s[f-1],") {\n          return getChannel(\n            getT").concat(f,"(").concat(Cw(o,u,e),"),\n            vec2(").concat(Cw(c,u,e),"));\n        }")}const h=s.length,d=s[s.length-1];p+="\n        return getChannel(\n          getT".concat(h,"(").concat(Cw(o,u,d),"),\n          vec2(").concat(Cw(c,u,d),"));"),this.userCode="\n      float getValue(".concat(o.map((e=>"int "+e)),") {\n        ").concat(p,"\n      }\n\n      void main() {\n        ").concat(a," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(i,"), 0., 0., 0.);\n\n        ").concat(i[r-1]," = ").concat(i[r-1]," + 1;\n        if (").concat(i[r-1]," < ").concat(n[r-1],") {\n          result.g = getValue(").concat(i,");\n        }\n\n        ").concat(i[r-2]," = ").concat(i[r-2]," + 1;\n        if (").concat(i[r-2]," < ").concat(n[r-2],") {\n          result.a = getValue(").concat(i,");\n        }\n\n        ").concat(i[r-1]," = ").concat(i[r-1]," - 1;\n        if (").concat(i[r-2]," < ").concat(n[r-2]," &&\n            ").concat(i[r-1]," < ").concat(n[r-1],") {\n          result.b = getValue(").concat(i,");\n        }\n        setOutput(result);\n      }\n    ")}}function Cw(e,t,n){const r=e.indexOf(t);return e.map(((e,t)=>t===r?"".concat(e," - ").concat(n):e)).join()}function Tw(e){const{inputs:t,backend:n}=e,{input:r}=t;return Fb({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}const Dw={kernelName:Pt,backendName:"webgl",kernelFunc:Tw};function Iw(e,t,n){const r=e[0].dtype;if("complex64"===r){const r=e.map((e=>hw({inputs:{input:e},backend:n}))),a=e.map((e=>Tw({inputs:{input:e},backend:n}))),i=Iw(r,t,n),o=Iw(a,t,n),s=Mb({inputs:{real:i,imag:o},backend:n});return r.forEach((e=>n.disposeIntermediateTensorInfo(e))),a.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),s}let a=n.shouldExecuteOnCPU(e);if("string"===r&&(a=!0),a){const a=e.map((e=>{const r=U(e.shape.slice(t));return Qb({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})})),i=a.map((e=>({vals:n.readSync(e.dataId),shape:e.shape}))),o=md(a.map((e=>e.shape)),1),s=1===a[0].shape[0],u=vv(i,o,r,s),c=md(e.map((e=>e.shape)),t),l=n.makeTensorInfo(c,r,u);return a.forEach((e=>n.disposeIntermediateTensorInfo(e))),l}const i=e.filter((e=>U(e.shape)>0)),o=ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(1===i.length){const t=o?new mb(e[0].shape,xb):new wb(e[0].shape,xb);return n.runWebGLProgram(t,e,r)}const s=ye().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>s){const e=[];for(let a=0;a<i.length;a+=s){const r=i.slice(a,a+s);e.push(Iw(r,t,n))}const r=Iw(e,t,n);for(const t of e)n.disposeIntermediateTensorInfo(t);return r}if(o){const e=new Ew(i.map((e=>e.shape)),t);return n.runWebGLProgram(e,i,r)}const{tensors2D:u,outShape:c}=function(e,t,n){const r=md(e.map((e=>e.shape)),t),a=e.map((e=>Qb({inputs:{x:e},attrs:{shape:[-1,U(e.shape.slice(t))]},backend:n})));return{tensors2D:a,outShape:r}}(i,t,n),l=new kw(u.map((e=>e.shape))),p=n.runWebGLProgram(l,u,r);u.forEach((e=>n.disposeIntermediateTensorInfo(e)));const h=Qb({inputs:{x:p},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(p),h}function Aw(e){const{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,i=K(a,t[0].shape)[0];fd(t.map((e=>e.shape)),i);const o=md(t.map((e=>e.shape)),i);if(0===U(o))return n.makeTensorInfo(o,t[0].dtype,[]);const s=t.filter((e=>U(e.shape)>0));return 1===s.length?Fb({inputs:{x:s[0]},backend:n}):Iw(s,i,n)}const Fw={kernelName:$e,backendName:"webgl",kernelFunc:Aw};class _w{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,o=e.padInfo.left,s=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,l=e.dilationWidth,p=e.filterHeight,h=e.filterWidth,d=4*Math.floor(e.inChannels/4),f=e.inChannels%4,m="channelsLast"===e.dataFormat,g=m?1:2,y=m?2:3,v=m?3:1;let b="",x="";n&&(b=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),x="result = activation(result);");const w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      const ivec2 strides = ivec2(").concat(s,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(i,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(v,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(p,"; wR++) {\n          int xR = xRCorner + wR * ").concat(c,";\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(h,"; wC++) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            if (xC < 0 || xC >= ").concat(e.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(d,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===f,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(d,") *\n                    getW(wR, wC, ").concat(d,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(d,", xR, xC) *\n                    getW(wR, wC, ").concat(d,", d2);\n              }\n\n            } else if (").concat(2===f,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(d,", d2),\n                getW(wR, wC, ").concat(d," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(d,"),\n                  getX(batch, xR, xC, ").concat(d," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(d,", xR, xC),\n                  getX(batch, ").concat(d," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===f,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(d,", d2),\n                getW(wR, wC, ").concat(d," + 1, d2),\n                getW(wR, wC, ").concat(d," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(d,"),\n                  getX(batch, xR, xC, ").concat(d," + 1),\n                  getX(batch, xR, xC, ").concat(d," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(d,", xR, xC),\n                  getX(batch, ").concat(d," + 1, xR, xC),\n                  getX(batch, ").concat(d," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")}}class Mw{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.filterDepth,p=e.filterHeight,h=e.filterWidth,d=4*Math.floor(e.inChannels/4),f=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(a,", ").concat(i,", ").concat(o,");\n      const ivec3 pads = ivec3(").concat(t,", ").concat(n,", ").concat(r,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(l,"; wF++) {\n          int xF = xFCorner + wF * ").concat(s,";\n\n          if (xF < 0 || xF >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,"; wR++) {\n            int xR = xRCorner + wR * ").concat(u,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,"; wC++) {\n              int xC = xCCorner + wC * ").concat(c,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(d,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===f,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(d,") *\n                  getW(wF, wR, wC, ").concat(d,", d2);\n              } else if (").concat(2===f,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(d,"),\n                  getX(batch, xF, xR, xC, ").concat(d," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(d,", d2),\n                  getW(wF, wR, wC, ").concat(d," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===f,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(d,"),\n                  getX(batch, xF, xR, xC, ").concat(d," + 1),\n                  getX(batch, xF, xR, xC, ").concat(d," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(d,", d2),\n                  getW(wF, wR, wC, ").concat(d," + 1, d2),\n                  getW(wF, wR, wC, ").concat(d," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class Ow{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Cm(this.outputShape.length);const i=e.padInfo.left,o=e.strideWidth,s=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,l=c;let p="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let m=0;m<c;m++)p+="\n           vec4 xTexelC".concat(2*m,";\n           int xTexelC").concat(2*m,"Ready;\n           vec4 xTexelC").concat(2*m+1,";\n           int xTexelC").concat(2*m+1,"Ready;\n           vec4 xC").concat(m,";");p+="\n     for (int r = 0; r < ".concat(u,"; r++) {\n      for (int d1 = 0; d1 < ").concat(e.inChannels,"; d1 += 2) {\n       ");for(let m=0;m<c;m++)p+="\n           xTexelC".concat(2*m," = vec4(0.0);\n           xTexelC").concat(2*m,"Ready = 0;\n           xTexelC").concat(2*m+1," = vec4(0.0);\n           xTexelC").concat(2*m+1,"Ready = 0;\n           xC").concat(m," = vec4(0.0);");p+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let m=0;m<(l+1)/2;m++){const t=2*m;if(p+="\n           xC = xCCorner + ".concat(t*s,";\n           "),1===o){if(t<c&&(i%2===1?(p+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n               "),p+=1===s&&t>0?"\n                 xC".concat(t," = vec4(xTexelC").concat(t-2,".zw, xTexelC").concat(t,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(t," = vec4(previous.zw, xTexelC").concat(t,".xy);\n                   } else {\n                     xC").concat(t," = vec4(0.0, 0.0, xTexelC").concat(t,".xy);\n                   }\n                   ")):p+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 xC").concat(t," = xTexelC").concat(t,";\n                 "),t+1<c)){const e=i%2===0?R(s):s;s%2===0&&i%2===1||s%2!==0&&i%2!==1?(p+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(e,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                     xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(t+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(t+1,"Ready = 1;\n                   }\n                   "),p+=s>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(t+1," = vec4(previous.zw, xTexelC").concat(t+1,".xy);\n                     } else {\n                      xC").concat(t+1," = vec4(0.0, 0.0, xTexelC").concat(t+1,".xy);\n                     }\n                     "):"\n                     xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".xy);\n                     ")):p+=1===e?"\n                     xC".concat(t+1," = xTexelC").concat(t,";\n                     "):"\n                     xCOffset = xC + ".concat(e,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                       xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(t+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(t+1,"Ready = 1;\n                     }\n\n                     xC").concat(t+1," = xTexelC").concat(t+1,";\n                     ")}}else t<c&&(i%2===1?(p+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                   xTexelC").concat(t+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(t+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t+1,"Ready = 1;\n                 }\n\n                 xC").concat(t," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n               "),t+1<c&&(p+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(t+1," = vec4(xTexelC").concat(t+1,".xy, final.xy);\n                 "))):(p+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                   xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(t+1,"Ready = 1;\n                 }\n\n                 xC").concat(t," = vec4(\n                   xTexelC").concat(t,".xy, xTexelC").concat(t+1,".xy);\n               "),t+1<c&&(p+="\n                   xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n                 "))));t<c&&(p+="\n             wTexel = getW(r, ".concat(t,", d1, d2);\n             dotProd += xC").concat(t,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(e.inChannels,") {\n               dotProd += xC").concat(t,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),t+1<c&&(p+="\n               wTexel = getW(r, ".concat(t+1,", d1, d2);\n               dotProd += xC").concat(t+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(e.inChannels,") {\n                 dotProd += xC").concat(t+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}p+="\n     }\n   ",p+="\n     }\n   ",p+="\n     }\n   ";let h="",d="";n&&(h=r?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):a?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),d="result = activation(result);");const f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(h,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(p,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(f,"\n         ").concat(d,"\n         setOutput(result);\n       }\n     ")}}class Rw{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Cm(this.outputShape.length);const{dataFormat:n}=t,r=rm(),a="channelsLast"===n,i=a?1:2,o=a?2:3,s=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(e[2]," && pos < ").concat(e[1],") {");let u="";for(let c=0;c<=1;c++)for(let e=0;e<=1;e++)u+="\n          blockIndex = rc.z + ".concat(e,";\n          pos = rc.y + ").concat(c,";\n\n          ").concat(s,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(i,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(o,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(a,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*c+e,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*c+e,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(u,"\n\n        ").concat(r.output," = result;\n      }\n    ")}}function zw(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&1===n&&e[0]>1?[e[0],1]:null}function Bw(e){let{x:t,filter:n,convInfo:r,backend:a,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:u=null}=e;const c=t.shape,l=a.texData.get(t.dataId),p=r.inChannels,h=c[0]*c[1]*c[2],d=r.outChannels,f="channelsLast"===r.dataFormat,m=!1;let g;const y=[];if(null!=o){const e=zw(o.shape,f);null!=e&&(o=Qb({inputs:{x:o},backend:a,attrs:{shape:e}}),y.push(o))}if(null!=i){const e=zw(i.shape,f);null!=e&&(i=Qb({inputs:{x:i},backend:a,attrs:{shape:e}}),y.push(i))}if(!((1===h||1===d)&&p>1e3)&&l.isPacked&&f&&null!=l.texture&&c[2]%2!==0&&W(l.shape.slice(-3),c.slice(-3))){const e=c[0]*c[1]*(c[2]+1),p={dataId:t.dataId,shape:[1,e,r.inChannels],dtype:t.dtype},h=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,B(Xf(l.shape,p.shape),(()=>"packed reshape ".concat(l.shape," to ").concat(p.shape," isn't free")));const d=Qb({inputs:{x:n},backend:a,attrs:{shape:[1,r.inChannels,r.outChannels]}});y.push(d);const f=lx({a:p,b:d,backend:a,transposeA:false,transposeB:m,bias:i,activation:u,preluActivationWeights:o,leakyreluAlpha:s}),v=a.texData.get(f.dataId);B(v.isPacked,(()=>"batchMatMul result is expected to be packed")),l.shape=h,v.shape=r.outShape,g=Fb({inputs:{x:f},backend:a}),g.shape=r.outShape,y.push(f)}else{const e=r.outHeight*r.outWidth,c=Qb({inputs:{x:t},backend:a,attrs:{shape:f?[r.batchSize,e,r.inChannels]:[r.batchSize,r.inChannels,e]}}),l=Qb({inputs:{x:n},backend:a,attrs:{shape:[1,r.inChannels,r.outChannels]}}),p=lx({a:f?c:l,b:f?l:c,transposeA:!f,transposeB:m,backend:a,bias:i,activation:u,preluActivationWeights:o,leakyreluAlpha:s});g=Qb({inputs:{x:p},backend:a,attrs:{shape:r.outShape}}),y.push(c),y.push(l),y.push(p)}for(const v of y)a.disposeIntermediateTensorInfo(v);return g}function Lw(e){let{x:t,filter:n,convInfo:r,backend:a,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:u=null}=e;const{filterWidth:c,filterHeight:l,inChannels:p,outWidth:h,outHeight:d,dataFormat:f}=r,m="channelsLast"===f,g=c*l*p,y=d*h,v=[r.batchSize,g,y],b=[];if(null!=o){const e=zw(o.shape,m);null!=e&&(o=Qb({inputs:{x:o},backend:a,attrs:{shape:e}}),b.push(o))}if(null!=i){const e=zw(i.shape,m);null!=e&&(i=Qb({inputs:{x:i},backend:a,attrs:{shape:e}}),b.push(i))}const x=Qb({inputs:{x:n},backend:a,attrs:{shape:[1,g,U(n.shape)/g]}});b.push(x);const w=new Rw(v,r),N=[t.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],S=a.runWebGLProgram(w,[t],"float32",N),k=Qb({inputs:{x:S},backend:a,attrs:{shape:v}});b.push(S),b.push(k);const E=null!=i,C=null!=o,T="leakyrelu"===u,D=u?jb(u,!0):null,I=new Gb(m?k.shape:x.shape,m?x.shape:k.shape,m?[r.batchSize,y,r.outChannels]:[r.batchSize,r.outChannels,y],!0,!1,E,D,C,T),A=m?[k,x]:[x,k];if(i&&A.push(i),C&&A.push(o),T){const e=a.makeTensorInfo([],"float32",ia(s,"float32"));A.push(e),b.push(e)}const F=a.runWebGLProgram(I,A,"float32"),_=Qb({inputs:{x:F},backend:a,attrs:{shape:r.outShape}});b.push(F);for(const M of b)a.disposeIntermediateTensorInfo(M);return _}const Pw={kernelName:Ze,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:o,pad:s,dataFormat:u,dilations:c,dimRoundingMode:l}=r,p=gu(u),h=ou(a.shape,i.shape,o,c,s,l,!1,p);let d;if(1!==h.filterHeight||1!==h.filterWidth||1!==h.dilationHeight||1!==h.dilationWidth||1!==h.strideHeight||1!==h.strideWidth||"SAME"!==h.padInfo.type&&"VALID"!==h.padInfo.type)if(h.strideWidth<=2&&"channelsLast"===p&&ye().getBool("WEBGL_EXP_CONV")){const e=new Ow(h),t=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];d=n.runWebGLProgram(e,[a,i],"float32",t)}else if(ye().getBool("WEBGL_CONV_IM2COL"))d=Lw({x:a,filter:i,convInfo:h,backend:n});else{const e=new _w(h);d=n.runWebGLProgram(e,[a,i],"float32")}else d=Bw({x:a,filter:i,convInfo:h,backend:n});const f=Qb({inputs:{x:d},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(d),f}};class Uw{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(a,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              ").concat(i?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class Ww{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i="channelsLast"===e.dataFormat,o=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=i?1:2,c=i?2:3,l=i?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(l,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(u,"], coords[").concat(c,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n\n              if (").concat(i,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class Vw{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,i=e.padInfo.top,o=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(e.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(t," - ").concat(a,";\n\n            if (xF < 0 || xF >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(i,";\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(r," - ").concat(o,";\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class qw{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(t,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(a,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(e.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(t," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(r,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(r," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const jw={kernelName:Qe,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:o,pad:s,dataFormat:u,dimRoundingMode:c,filterShape:l}=r,p=gu(u),h=ou(a.shape,l,o,1,s,c,!1,p),d=new Uw(h);return n.runWebGLProgram(d,[a,i],"float32")}};class Gw{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Cm(this.outputShape.length);const t=e.filterHeight,n=e.filterWidth,r=t-1-e.padInfo.top,a=n-1-e.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(r,", ").concat(a,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(e.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(e.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}}const Hw={kernelName:Je,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{inputShape:o,strides:s,pad:u,dataFormat:c,dimRoundingMode:l}=r,p=gu(c),h=ou(o,i.shape,s,1,u,l,!1,p);if(ye().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===p){const e=[[h.strideHeight,h.strideWidth]],t=new Gw(h);return n.runWebGLProgram(t,[a,i],"float32",e)}{const e=new Ww(h);return n.runWebGLProgram(e,[a,i],"float32")}}};const Kw={kernelName:et,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:o,pad:s,dilations:u}=r,c=su(a.shape,i.shape,o,u,s),l=new Mw(c);return n.runWebGLProgram(l,[a,i],"float32")}};const Xw={kernelName:tt,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:o,pad:s,filterShape:u}=r,c=su(a.shape,u,o,1,s),l=new Vw(c);return n.runWebGLProgram(l,[a,i],"float32")}};const Yw={kernelName:nt,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{pad:o,strides:s,inputShape:u}=r,c=su(u,i.shape,s,1,o),l=new qw(c);return n.runWebGLProgram(l,[a,i],"float32")}},$w=Vb({opSnippet:Wb+"\n  return cos(x);\n",packedOpSnippet:"\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(Ib,"\n  return result;\n")}),Zw={kernelName:rt,backendName:"webgl",kernelFunc:$w},Qw=Vb({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),Jw={kernelName:at,backendName:"webgl",kernelFunc:Qw};class eN{constructor(e,t,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,o,s,u]=e,[c]=t,[l,p]=n;this.outputShape=[c,l,p,u];const h="bilinear"===r?1:0,[d,f]=["".concat(o-1,".0"),"".concat(s-1,".0")],[m,g,y]=l>1?["".concat((o-1)/(l-1)),"(y2-y1) * height_ratio","y1*".concat(d," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(d)],[v,b,x]=p>1?["".concat((s-1)/(p-1)),"(x2-x1) * width_ratio","x1*".concat(f," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(f)];this.userCode="\n      const float height_ratio = float(".concat(m,");\n      const float width_ratio = float(").concat(v,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(i,") {\n          return;\n        }\n\n        float height_scale = ").concat(g,";\n        float width_scale = ").concat(b,";\n\n        float in_y = ").concat(y,";\n        if( in_y < 0.0 || in_y > ").concat(d," ) {\n          setOutput(float(").concat(a,"));\n          return;\n        }\n        float in_x = ").concat(x,";\n        if( in_x < 0.0 || in_x > ").concat(f," ) {\n          setOutput(float(").concat(a,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(h," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}}const tN={kernelName:st,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:i,boxInd:o}=t,{cropSize:s,method:u,extrapolationValue:c}=r,l=new eN(a.shape,i.shape,s,u,c);return n.runWebGLProgram(l,[a,i,o],"float32")}};var nN;!function(e){e.Prod="*",e.Sum="+"}(nN||(nN={}));class rN{constructor(e,t,n,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,i=this.op===nN.Prod?"1.0":"0.0",o=n?i:"getX(".concat(aN(a,"coords",this.op),")"),s=this.outputShape[this.outputShape.length-1];let u="",c="";n?(u=r?"end != ".concat(s-1):"end != 0",c=r?"end + 1":"end - 1"):(u=r?"end + pow2 < ".concat(s):"end >= pow2",c=r?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(bm(a)," coords = getOutputCoords();\n        int end = ").concat(iN(a,"coords",this.op),";\n        float val = ").concat(o,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(u,") {\n          int idx = ").concat(c,";\n          ").concat(iN(a,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(aN(a,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}}function aN(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function iN(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function oN(e,t,n,r,a,i){const o=t.shape.length,s=yc([r],o);let u=t;null!=s&&(u=ux({inputs:{x:t},backend:n,attrs:{perm:s}}));const c=bc(1,o)[0];if(c!==o-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(t.shape.length-1," ")+"but got axis=".concat(r));const l=u.shape[c];let p=Fb({inputs:{x:u},backend:n});for(let h=0;h<=Math.ceil(Math.log2(l))-1;h++){const t=new rN(e,u.shape,!1,i),r=[[h]],a=p;p=n.runWebGLProgram(t,[p],p.dtype,r),n.disposeIntermediateTensorInfo(a)}if(a){const t=new rN(e,u.shape,a,i),r=p;p=n.runWebGLProgram(t,[p],p.dtype),n.disposeIntermediateTensorInfo(r)}if(null!=s){const e=ux({inputs:{x:p},backend:n,attrs:{perm:vc(s)}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(u),e}return p}const sN={kernelName:it,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:o,reverse:s}=r;return oN(nN.Prod,a,n,i,o,s)}};const uN={kernelName:ot,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:o,reverse:s}=r;return oN(nN.Sum,a,n,i,o,s)}};const cN={kernelName:ut,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:o,binaryOutput:s}=r;if(1===a.shape.length){const e=n.readSync(a.dataId),t=n.readSync(i.dataId),r=dv(e,t,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,r)}if(2===a.shape.length){const e=n.bufferSync(a),t=n.bufferSync(i),r=fv(e,t,o,s);return n.makeTensorInfo(r.shape,i.dtype,r.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};class lN{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(t,";\n      int offset_h = imod(h, ").concat(t,");\n      int in_w = w / ").concat(t,";\n      int offset_w = imod(w, ").concat(t,");\n      int offset_d = (offset_h * ").concat(t," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const pN={kernelName:ct,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:i,dataFormat:o}=r,s=a.shape[0],u=("NHWC"===o?a.shape[1]:a.shape[2])*i,c=("NHWC"===o?a.shape[2]:a.shape[3])*i,l=("NHWC"===o?a.shape[3]:a.shape[1])/(i*i),p=new lN("NHWC"===o?[s,u,c,l]:[s,l,u,c],i,o);return n.runWebGLProgram(p,[a],a.dtype)}};class hN{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Cm(this.outputShape.length);const i=e.filterHeight,o=e.filterWidth,s=e.outChannels/e.inChannels;let u="",c="";n&&(u=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),c="result = activation(result);");const l=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(u,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(s,";\n        int q = d2 - d1 * ").concat(s,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(i,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(l,"\n        ").concat(c,"\n        setOutput(result);\n      }\n    ")}}class dN{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Cm(this.outputShape.length);const i=e.outChannels/e.inChannels,o=e.padInfo.left,s=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,l=e.filterWidth,p=l;let h="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let g=0;g<l;g++)h+="\n          vec4 xTexelC".concat(2*g,";\n          int xTexelC").concat(2*g,"Ready;\n          vec4 xTexelC").concat(2*g+1,";\n          int xTexelC").concat(2*g+1,"Ready;\n          vec4 xC").concat(g,";");h+="\n    for (int r = 0; r < ".concat(c,"; r++) {\n      ");for(let g=0;g<l;g++)h+="\n          xTexelC".concat(2*g," = vec4(0.0);\n          xTexelC").concat(2*g,"Ready = 0;\n          xTexelC").concat(2*g+1," = vec4(0.0);\n          xTexelC").concat(2*g+1,"Ready = 0;\n          xC").concat(g," = vec4(0.0);");h+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let g=0;g<(p+1)/2;g++){const e=2*g;if(h+="\n          xC = xCCorner + ".concat(e*u,";\n          "),1===s){if(e<l&&(o%2===1?(h+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n              "),h+=1===u&&e>0?"\n                xC".concat(e," = vec4(xTexelC").concat(e-2,".zw, xTexelC").concat(e,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(e," = vec4(previous.zw, xTexelC").concat(e,".xy);\n                  } else {\n                    xC").concat(e," = vec4(0.0, 0.0, xTexelC").concat(e,".xy);\n                  }\n                  ")):h+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                xC").concat(e," = xTexelC").concat(e,";\n                "),e+1<l)){const t=o%2===0?R(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(h+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(t,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                    xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(e+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(e+1,"Ready = 1;\n                  }\n                  "),h+=u>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(e+1," = vec4(previous.zw, xTexelC").concat(e+1,".xy);\n                    } else {\n                     xC").concat(e+1," = vec4(0.0, 0.0, xTexelC").concat(e+1,".xy);\n                    }\n                    "):"\n                    xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".xy);\n                    ")):h+=1===t?"\n                    xC".concat(e+1," = xTexelC").concat(e,";\n                    "):"\n                    xCOffset = xC + ".concat(t,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                      xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(e+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(e+1,"Ready = 1;\n                    }\n\n                    xC").concat(e+1," = xTexelC").concat(e+1,";\n                    ")}}else e<l&&(o%2===1?(h+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                  xTexelC").concat(e+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(e+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e+1,"Ready = 1;\n                }\n\n                xC").concat(e," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n              "),e+1<l&&(h+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(e+1," = vec4(xTexelC").concat(e+1,".xy, final.xy);\n                "))):(h+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                  xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(e+1,"Ready = 1;\n                }\n\n                xC").concat(e," = vec4(\n                  xTexelC").concat(e,".xy, xTexelC").concat(e+1,".xy);\n              "),e+1<l&&(h+="\n                  xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n                "))));e<l&&(h+="\n            wTexel = getW(r, ".concat(e,", d1, q);\n            dotProd += xC").concat(e," * vec4(wTexel.xz, wTexel.xz);\n          "),e+1<l&&(h+="\n              wTexel = getW(r, ".concat(e+1,", d1, q);\n              dotProd += xC").concat(e+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}h+="\n    }\n  ",h+="\n      }\n    ";let d="",f="";n&&(d=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),f="result = activation(result);");const m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(d,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(i,";\n        int q = d2 - d1 * ").concat(i,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(h,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(m,"\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")}}const fN={kernelName:lt,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:o,pad:s,dilations:u,dimRoundingMode:c}=r;let l=u;null==l&&(l=[1,1]),B(fu(o,l),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(l,"'")));const p=ou(a.shape,i.shape,o,l,s,c,!0);let h;h=ye().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels===1?new dN(p):new hN(p);const d=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];return n.runWebGLProgram(h,[a,i],"float32",d)}};class mN{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(i," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(a,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class gN{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=t-1-e.padInfo.top,o=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(s,"; dm++) {\n              int d2 = d1 * ").concat(s," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const yN={kernelName:pt,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:o,dilations:s,pad:u,dimRoundingMode:c,filterShape:l}=r,p=ou(a.shape,l,o,s,u,c,!0),h=new mN(p);return n.runWebGLProgram(h,[a,i],"float32")}};const vN={kernelName:ht,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{strides:o,dilations:s,pad:u,dimRoundingMode:c,inputShape:l}=r,p=ou(l,i.shape,o,s,u,c,!0),h=new gN(p);return n.runWebGLProgram(h,[a,i],"float32")}};class bN{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const xN={kernelName:dt,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,a=[...r.shape,...r.shape],i=U(r.shape),o=Qb({inputs:{x:r},backend:n,attrs:{shape:[i]}}),s=new bN(i),u=n.runWebGLProgram(s,[o],o.dtype),c=Qb({inputs:{x:u},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),c}};class wN{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:n,padInfo:r,strideHeight:a,strideWidth:i,filterHeight:o,filterWidth:s,dilationHeight:u,dilationWidth:c}=e,{top:l,left:p}=r;this.userCode="\n      const ivec2 strides = ivec2(".concat(a,", ").concat(i,");\n      const ivec2 pads = ivec2(").concat(l,", ").concat(p,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(o,"; h++) {\n          int hIn = hBeg + h * ").concat(u,";\n\n          if (hIn >= 0 && hIn < ").concat(t,") {\n            for (int w = 0; w < ").concat(s,"; w++) {\n              int wIn = wBeg + w * ").concat(c,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}}const NN={kernelName:ft,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:o,pad:s,dilations:u}=r,c=ru(a.shape,i.shape,o,s,"NHWC",u);let l;const p=new wN(c);l=n.runWebGLProgram(p,[a,i],"float32");const h=Qb({inputs:{x:l},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(l),h}};const SN={kernelName:bt,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,i=t,{allDims:o,summedDims:s,idDims:u}=$d(a,i.length);Qd(o.length,u,i);const{path:c,steps:l}=Jd(s,u),p=l.length;let h=null,d=o.length;const f=[];for(let m=0;m<p;++m){for(const e of l[m]){const{permutationIndices:t,expandDims:r}=Zd(d,u[e]);let a;ef(t)?a=i[e]:(a=ux({inputs:{x:i[e]},backend:n,attrs:{perm:t}}),f.push(a));const o=a.shape.slice();for(let e=0;e<r.length;++e)o.splice(r[e],0,1);W(a.shape,o)||(a=Qb({inputs:{x:a},backend:n,attrs:{shape:o}}),f.push(a)),null===h?h=a:(h=$b({inputs:{a:a,b:h},backend:n}),f.push(h))}m<p-1&&(c[m]>=0&&(h=ox({inputs:{x:h},backend:n,attrs:{axis:c[m]-(o.length-d),keepDims:!1}}),f.push(h)),d--)}for(const m of f)m!==h&&n.disposeIntermediateTensorInfo(m);return h}},kN=Vb({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),EN={kernelName:xt,backendName:"webgl",kernelFunc:kN},CN={kernelName:wt,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n}=e,{dy:r,y:a}=t,i=ye().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ab("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new Db("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}},TN=qb({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:bv}),DN={kernelName:St,backendName:"webgl",kernelFunc:TN},IN=Vb({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(_d,";\n  float a1 = ").concat(Md,";\n  float a2 = ").concat(Od,";\n  float a3 = ").concat(Rd,";\n  float a4 = ").concat(zd,";\n  float a5 = ").concat(Bd,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),AN={kernelName:Nt,backendName:"webgl",kernelFunc:IN},FN=Vb({opSnippet:Wb+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:xv,dtype:"float32"}),_N={kernelName:kt,backendName:"webgl",kernelFunc:FN};function MN(e){const{inputs:t,attrs:n,backend:r}=e,{dim:a}=n,{input:i}=t,o=i.shape.length,s=i.shape.slice();let u=a;return a<0&&(B(-(o+1)<=a,(()=>"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]"))),u=o+a+1),s.splice(u,0,1),Qb({inputs:{x:i},backend:r,attrs:{shape:s}})}const ON={kernelName:Et,backendName:"webgl",kernelFunc:MN},RN="return exp(x) - 1.0;",zN=Vb({opSnippet:RN,packedOpSnippet:RN,cpuKernelImpl:wv}),BN={kernelName:Ct,backendName:"webgl",kernelFunc:zN};class LN{constructor(e,t,n){this.variableNames=["real","imag"];const r=t[1];this.outputShape=t;const a=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),i=n?"".concat(r,".0"):"1.0";let o;if("real"===e)o="return real * expR - imag * expI;";else{if("imag"!==e)throw new Error('FFT component must be either "real" or "imag", got '.concat(e,"."));o="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(a,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(o,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(r,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(i,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}}function PN(e,t,n){const r=n.texData.get(e.dataId),a=U(e.shape),i=e.shape[e.shape.length-1],o=Qb({inputs:{x:e},backend:n,attrs:{shape:[a/i,i]}}),s=o.shape,u=new LN("real",s,t),c=new LN("imag",s,t),l=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:s},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:s}],p=n.runWebGLProgram(u,l,"float32"),h=n.runWebGLProgram(c,l,"float32"),d=Mb({inputs:{real:p,imag:h},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h);const f=Qb({inputs:{x:d},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(d),f}const UN={kernelName:Tt,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return PN(r,!1,n)}};class WN{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function VN(e){const{backend:t,attrs:n}=e,{shape:r,value:a}=n;let{dtype:i}=n;if(i=i||te(a),"string"===i){const e=$(i,U(r));return e.fill(a),t.makeTensorInfo(r,i,e)}{const e=new WN(r,a),n=[[a]];return t.runWebGLProgram(e,[],i,n)}}const qN={kernelName:Dt,backendName:"webgl",kernelFunc:VN};class jN{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(t," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(t,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const GN={kernelName:It,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n}=e;const{image:r}=t,a=n,i=new jN(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}},HN="return floor(x);",KN=Vb({opSnippet:HN,packedOpSnippet:HN,cpuKernelImpl:Nv}),XN={kernelName:At,backendName:"webgl",kernelFunc:KN},YN=qb({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),$N={kernelName:Ft,backendName:"webgl",kernelFunc:YN};class ZN{constructor(e){this.variableNames=["A"];const t=rm(),[n,r]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(r,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(t.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}}class QN{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=rm(),[n,r]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(r,".0, ").concat(n,".0);\n            vec4 values = ").concat(t.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}const JN={kernelName:Ir,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e;let{pixels:a}=t;const{numChannels:i}=r,o="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,[u,c]=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],l=[c,u],p=[c,u,i];if(s||o){const e=ye().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=eS&&e===tS||(tS=e,eS=document.createElement("canvas").getContext("2d",{willReadFrequently:tS})),eS.canvas.width=u,eS.canvas.height=c,eS.drawImage(a,0,0,u,c),a=eS.canvas}const h=n.makeTensorInfo(l,"int32");n.texData.get(h.dataId).usage=Ef.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),a);const d=ye().getBool("WEBGL_PACK")?new QN(p):new ZN(p),f=n.runWebGLProgram(d,[h],"int32");return n.disposeData(h.dataId),f}};let eS,tS=ye().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");const nS={kernelName:_r,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:o,preluActivationWeights:s}=t,{strides:u,pad:c,dataFormat:l,dilations:p,dimRoundingMode:h,activation:d,leakyreluAlpha:f}=r,m=gu(l),g=ou(a.shape,i.shape,u,p,c,h,!1,m);let y;const v=[],b=null!=o,x=null!=s,w="leakyrelu"===d,N=()=>{const e=[a,i],t=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){const t=Qb({inputs:{x:e},backend:n,attrs:{shape:[e.shape[0],1,1]}});return v.push(t),t}return e};if(b&&e.push(t(o,l)),x&&e.push(t(s,l)),w){const t=n.makeTensorInfo([],"float32",ia(f,"float32"));e.push(t),v.push(t)}return e};if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(g.strideWidth<=2&&"channelsLast"===m&&ye().getBool("WEBGL_EXP_CONV")){const e=d?jb(d,!0):null,t=new Ow(g,b,e,x,w),r=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],a=N();y=n.runWebGLProgram(t,a,"float32",r)}else if(ye().getBool("WEBGL_CONV_IM2COL"))y=Lw({x:a,filter:i,convInfo:g,backend:n,bias:o,activation:d,preluActivationWeights:s,leakyreluAlpha:f});else{const e=d?jb(d,!1):null,t=new _w(g,b,e,x,w),r=N();y=n.runWebGLProgram(t,r,"float32")}else y=Bw({x:a,filter:i,convInfo:g,backend:n,bias:o,activation:d,preluActivationWeights:s,leakyreluAlpha:f});const S=Qb({inputs:{x:y},backend:n,attrs:{shape:g.outShape}});return v.push(y),v.forEach((e=>n.disposeIntermediateTensorInfo(e))),S}};const rS={kernelName:Mr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:o,preluActivationWeights:s}=t,{strides:u,pad:c,dilations:l,dimRoundingMode:p,activation:h,leakyreluAlpha:d}=r,f=[];let m=l;null==m&&(m=[1,1]),B(fu(u,m),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(u," and dilations '").concat(m,"'")));const g=ou(a.shape,i.shape,u,m,c,p,!0),y=ye().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,v=h?jb(h,y):null,b=[a,i],x=null!=o,w=null!=s,N="leakyrelu"===h;if(x&&b.push(o),w&&b.push(s),N){const e=n.makeTensorInfo([],"float32",ia(d,"float32"));b.push(e),f.push(e)}let S;S=y?new dN(g,x,v,w,N):new hN(g,x,v,w,N);const k=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],E=n.runWebGLProgram(S,b,"float32",k);return f.forEach((e=>n.disposeIntermediateTensorInfo(e))),E}};class aS{constructor(e,t,n,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;const a=bm(n.length);let i="\n    int index;";for(let o=0;o<this.sliceDim;o++)i+="\n          index = round(getIndices(coords[0], ".concat(o,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[o],";\n          flattenIndex += index * ").concat(this.strides[o],";");this.userCode="\n         void main() {\n          ".concat(a," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(i,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}}const iS={kernelName:Ot,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:r,indices:a}=t,i=a.shape,o=i[i.length-1],s=U(r.shape),[u,c,l,p]=Id(r,a),h=Qb({inputs:{x:a},backend:n,attrs:{shape:[c,o]}}),d=Qb({inputs:{x:r},backend:n,attrs:{shape:[U(r.shape)/l,l]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){const e=n.readSync(a.dataId),t=n.bufferSync(r),i=Sv(e,t,r.dtype,c,o,l,p,r.shape,s);return n.makeTensorInfo(u,r.dtype,i.values)}const f=new aS(o,p,[c,l],r.shape),m=n.runWebGLProgram(f,[d,h],d.dtype),g=Qb({inputs:{x:m},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),g}};class oS{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const n=bm(this.rank),r=function(e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let r=0;r<e.length;r++)2===r?n.push("index"):n.push("".concat(t[r]));return n.join()}(e);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(e[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(r,"));\n      }\n    ")}}function sS(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,indices:i}=t,{axis:o,batchDims:s}=r,u=K(o,a.shape)[0];if(ye().get("DEBUG")){const e=n.readSync(i.dataId),t=a.shape[u];for(let n=0;n<e.length;++n){const r=e[n];B(r<=t-1&&r>=0,(()=>"GatherV2: the index value ".concat(r," is not in [0, ").concat(t-1,"]")))}}const c=vf(a,i,u,s),l=U(i.shape),p=[],h=Qb({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),d=Qb({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,l/c.batchSize]}});p.push(h),p.push(d);const f=[c.batchSize,c.outerSize,l/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([a,i])||"string"===a.dtype){const e=n.bufferSync(d),t=n.bufferSync(h),r=kv(t,e,f);return p.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(c.outputShape,r.dtype,r.values)}const m=new oS(h.shape,f),g=n.runWebGLProgram(m,[h,d],h.dtype);p.push(g);const y=Qb({inputs:{x:g},backend:n,attrs:{shape:c.outputShape}});return p.forEach((e=>n.disposeIntermediateTensorInfo(e))),y}const uS={kernelName:Mt,backendName:"webgl",kernelFunc:sS},cS=qb({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:Ev,dtype:"bool"}),lS={kernelName:Rt,backendName:"webgl",kernelFunc:cS},pS=qb({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:Cv}),hS={kernelName:zt,backendName:"webgl",kernelFunc:pS};const dS={kernelName:Lt,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return PN(r,!0,n)}},fS=Vb({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),mS={kernelName:Ut,backendName:"webgl",kernelFunc:fS},gS=Vb({opSnippet:"return float(isinf(x));",dtype:"bool"}),yS={kernelName:Wt,backendName:"webgl",kernelFunc:gS},vS=Vb({opSnippet:"return float(isnan(x));",dtype:"bool"}),bS={kernelName:Vt,backendName:"webgl",kernelFunc:vS},xS=qb({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:Tv,dtype:"bool"}),wS={kernelName:jt,backendName:"webgl",kernelFunc:xS},NS=qb({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:Dv,dtype:"bool"}),SS={kernelName:Gt,backendName:"webgl",kernelFunc:NS};const kS={kernelName:Ht,backendName:"webgl",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:a,num:i}=n,o=Iv(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},ES=Vb({opSnippet:Wb+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:Av}),CS={kernelName:Kt,backendName:"webgl",kernelFunc:ES},TS=Vb({opSnippet:Wb+"\n  return log(1.0 + x);\n"}),DS={kernelName:Xt,backendName:"webgl",kernelFunc:TS},IS=qb({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),AS={kernelName:Yt,backendName:"webgl",kernelFunc:IS},FS=Vb({opSnippet:"return float(!(x >= 1.0));"}),_S={kernelName:$t,backendName:"webgl",kernelFunc:FS},MS=qb({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),OS={kernelName:Zt,backendName:"webgl",kernelFunc:MS};class RS{constructor(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[];const i=t,o=e[3]-1;let s;this.outputShape=e;const u="float(".concat(n,") + float(").concat(r,") * sum");s=.5===a?"inversesqrt(".concat(u,")"):1===a?"1.0/(".concat(u,")"):"exp(log(".concat(u,") * float(-").concat(a,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(i,"; j <= ").concat(i,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(o,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(s,";\n        setOutput(val);\n      }\n    ")}}class zS{constructor(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=t,o=e[3]-1;let s;this.outputShape=e;const u="float(".concat(n,") + float(").concat(r,") * sum");s=.5===a?"inversesqrt(".concat(u,")"):1===a?"1.0/(".concat(u,")"):"exp(log(".concat(u,") * float(-").concat(a,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(i,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(i,"; j <= ").concat(i,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(o,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(s,";\n        setOutput(result);\n      }\n    ")}}const BS={kernelName:Qt,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:i,bias:o,alpha:s,beta:u}=r,c=ye().getBool("WEBGL_PACK_NORMALIZATION")?new zS(a.shape,i,o,s,u):new RS(a.shape,i,o,s,u);return n.runWebGLProgram(c,[a],a.dtype)}};class LS{constructor(e,t,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=a,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(t,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(t," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(r,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(r,")\n                * float(").concat(a,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(a,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}}const PS={kernelName:Jt,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a,y:i,dy:o}=t,{depthRadius:s,bias:u,alpha:c,beta:l}=r,p=new LS(a.shape,s,u,c,l);return n.runWebGLProgram(p,[a,i,o],a.dtype)}};function US(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reductionIndices:i,keepDims:o}=r,s=a.shape.length,u=K(i,a.shape);let c=u;const l=yc(c,s),p=null!=l,h=n.shouldExecuteOnCPU([a]);let d=a;if(p){if(h){const e=n.texData.get(d.dataId).values,t=new Array(s);for(let n=0;n<t.length;n++)t[n]=a.shape[l[n]];const r=ib(e,a.shape,a.dtype,l,t);d=n.makeTensorInfo(t,a.dtype);n.texData.get(d.dataId).values=r}else d=ix(a,l,n);c=bc(c.length,s)}gc("max",c,s);const[f,m]=fc(d.shape,c);let g,y=f;if(o&&(y=mc(f,u)),h){const e=n.texData.get(d.dataId).values,t=Fv(e,U(m),y,a.dtype);g=n.makeTensorInfo(y,a.dtype);n.texData.get(g.dataId).values=t}else g=function(e,t,n,r){const a=U(t),i=Qb({inputs:{x:e},attrs:{shape:[U(e.shape)/a,a]},backend:r}),o=nx(i,e.dtype,"max",r),s=Qb({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(d,m,y,n);return p&&n.disposeIntermediateTensorInfo(d),g}const WS={kernelName:en,backendName:"webgl",kernelFunc:US},VS=qb({opSnippet:Tb+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Ib+"\n  return result;\n",cpuKernelImpl:_v}),qS={kernelName:tn,backendName:"webgl",kernelFunc:VS};const jS={kernelName:nn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t;tm(a,"maxPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:u}=r;B(fu(o,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")));const c=au(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&W(c.inShape,c.outShape))return Fb({inputs:{x:a},backend:n});const l=new qx(c,"max",!1);return n.runWebGLProgram(l,[a],a.dtype)}};const GS={kernelName:an,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:o,pad:s,dataFormat:u,dimRoundingMode:c}=r,l=iu(a.shape,i,o,[1,1,1],s,c,u),p=new jx(l,"max",!1);return n.runWebGLProgram(p,[a],a.dtype)}};class HS{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,i=e.effectiveFilterWidth,o=a-1-e.padInfo.top,s=i-1-e.padInfo.left,u=a*i-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(a,";\n          wR += ").concat(r,") {\n          float dyR = float(dyRCorner + wR) / ").concat(t,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(i,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(u," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(i," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class KS{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=s-1-e.padInfo.front,p=u-1-e.padInfo.top,h=c-1-e.padInfo.left,d=s*u*c-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(l,", ").concat(p,", ").concat(h,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(s,";\n           wD += ").concat(a,") {\n          float dyD = float(dyDCorner + wD) / ").concat(t,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(u,";\n              wR += ").concat(i,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(c,";\n                wC += ").concat(o,") {\n              float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(d," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(u," * ").concat(c," +\n                  wR * ").concat(c," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const XS={kernelName:on,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,o=i,{filterSize:s,strides:u,pad:c,dimRoundingMode:l}=r,p=iu(o.shape,s,u,[1,1,1],c,l),h=new jx(p,"max",!0),d=n.runWebGLProgram(h,[o],o.dtype),f=new KS(p),m=n.runWebGLProgram(f,[a,d],o.dtype);return n.disposeIntermediateTensorInfo(d),m}};const YS={kernelName:rn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i,output:o}=t,s=i;tm([i,o],"maxPoolGrad");const{filterSize:u,strides:c,pad:l,dimRoundingMode:p}=r,h=au(s.shape,u,c,1,l,p),d=new qx(h,"max",!0),f=n.runWebGLProgram(d,[s],s.dtype),m=new HS(h),g=n.runWebGLProgram(m,[a,f],s.dtype);return n.disposeIntermediateTensorInfo(f),g}};const $S={kernelName:sn,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:a}=t,{filterSize:i,strides:o,pad:s,includeBatchInIndex:u}=n,c=r;B(4===a.shape.length,(()=>"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")));const l=[1,1];B(fu(o,l),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(l,"'")));const p=au(a.shape,i,o,l,s),[h,d]=function(e,t,n,r){let a=new qx(n,"max",!1);const i=r.runWebGLProgram(a,[e],"float32");return a=new qx(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,u,p,c);return[h,d]}};const ZS={kernelName:un,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:a}=t,{keepDims:i,axis:o}=n,s=r,u=a.shape.length,c=K(o,a.shape);let l=c;const p=yc(l,u),h=null!=p,d=s.shouldExecuteOnCPU([a]),f=[];let m=a;if(h){if(d){const e=s.texData.get(m.dataId).values,t=new Array(u);for(let r=0;r<t.length;r++)t[r]=a.shape[p[r]];const n=ib(e,a.shape,a.dtype,p,t);m=s.makeTensorInfo(t,a.dtype);s.texData.get(m.dataId).values=n}else m=ix(a,p,s);f.push(m),l=bc(l.length,u)}gc("sum",l,u);const[g,y]=fc(m.shape,l);let v=g;i&&(v=mc(g,c));const b=function(e,t,n,r){const a=U(t),i=Qb({inputs:{x:e},attrs:{shape:[U(e.shape)/a,a]},backend:r}),o=nx(i,"float32","mean",r),s=Qb({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(m,y,v,s);for(const x of f)s.disposeIntermediateTensorInfo(x);return b}};const QS={kernelName:cn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r,s=a.shape.length,u=K(i,a.shape);let c=u;const l=yc(c,s);let p=a;null!=l&&(p=ux({inputs:{x:a},backend:n,attrs:{perm:l}}),c=bc(c.length,a.shape.length)),gc("min",c,s);const[h,d]=fc(p.shape,c),f=Qb({inputs:{x:p},backend:n,attrs:{shape:[-1,U(d)]}}),m=nx(f,f.dtype,"min",n);let g;if(o){g=Qb({inputs:{x:m},backend:n,attrs:{shape:mc(h,u)}})}else g=Qb({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=l&&n.disposeIntermediateTensorInfo(p),g}},JS=qb({opSnippet:Tb+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Ib+"\n  return result;\n",cpuKernelImpl:Mv}),ek={kernelName:ln,backendName:"webgl",kernelFunc:JS};class tk{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,a=bm(r),i=t.map((e=>e[0])).join(","),o=t.map(((t,n)=>t[0]+e[n])).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),u="reflect"===n?0:1;this.userCode=1!==r?"\n      ".concat(a," start = ").concat(a,"(").concat(i,");\n      ").concat(a," end = ").concat(a,"(").concat(o,");\n\n      void main() {\n        ").concat(a," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(r,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(u,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(u,";\n          }\n        }\n        ").concat(a," coords = outC - start;\n        setOutput(getX(").concat(s,"));\n      }\n    "):"\n        int start = ".concat(i,";\n        int end = ").concat(o,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(u,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(u,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")}}class nk{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,a=bm(r),i=t.map((e=>e[0])).join(","),o=t.map(((t,n)=>t[0]+e[n])).join(","),s=ub("rc",r),u=ub("source",r),c="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),l=1===r?"source":"vec2(".concat(u.slice(-2).join(),")"),p="reflect"===n?0:1;let h="";if(1===r){const e="\n        ".concat(a," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(p,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(p,";\n        }\n        source -= start;\n      ");h="\n        ".concat(a," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(u.join(),"), ").concat(l,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(c,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(u.join(),"), ").concat(l,");\n        }\n      ")}else{const e="\n        ".concat(a," source = rc;\n        ").concat(a," lt = ").concat(a,"(lessThan(source, start));\n        ").concat(a," gte = ").concat(a,"(greaterThanEqual(source, end));\n        ").concat(a," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(p,") +\n                gte * ((end - 1) * 2 - source + ").concat(p,");\n        source -= start;\n      ");h="\n        ".concat(a," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(u.join(),"), ").concat(l,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(c,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(u.join(),"), ").concat(l,");\n        }\n        rc = outputLoc;\n        ").concat(s[r-2]," += 1;\n        if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {\n          ").concat(e,"\n          result[2] = getChannel(getX(").concat(u.join(),"), ").concat(l,");\n          ").concat(s[r-1]," += 1;\n          if(").concat(c,") {\n            ").concat(e,"\n            result[3] = getChannel(getX(").concat(u.join(),"), ").concat(l,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(a," start = ").concat(a,"(").concat(i,");\n      const ").concat(a," end = ").concat(a,"(").concat(o,");\n\n      void main() {\n        ").concat(a," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(h,"\n        setOutput(result);\n      }\n    ")}}const rk={kernelName:pn,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:a}=t,{paddings:i,mode:o}=r,s=ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new nk(a.shape,i,o):new tk(a.shape,i,o);return n.runWebGLProgram(s,[a],a.dtype)}},ak=qb({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+Ib+"\n  return result;\n"}),ik={kernelName:hn,backendName:"webgl",kernelFunc:ak};class ok{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(t-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(t-1,"));\n      }\n    ")}}const sk=qb({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),uk={kernelName:vt,backendName:"webgl",kernelFunc:sk},ck="return a - b;",lk=qb({opSnippet:ck,packedOpSnippet:ck,supportsComplex:!0,cpuKernelImpl:nb}),pk={kernelName:yr,backendName:"webgl",kernelFunc:lk};function hk(e){const{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:i}=r,o=K([i],a.shape),s=US({inputs:{x:a},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),u=mc(s.shape,o),c=Qb({inputs:{x:s},backend:n,attrs:{shape:u}}),l=lk({inputs:{a:a,b:c},backend:n}),p=FN({inputs:{x:l},backend:n}),h=ox({inputs:{x:p},backend:n,attrs:{axis:o,keepDims:!1}}),d=Qb({inputs:{x:h},backend:n,attrs:{shape:u}}),f=sk({inputs:{a:p,b:d},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),f}const dk={kernelName:ar,backendName:"webgl",kernelFunc:hk};const fk={kernelName:dn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:i,seed:o,normalized:s}=r,u=s?a:hk({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=u.shape[0],l=u.shape[1],p=new ok(c,l,i),h=[[o]],d=n.runWebGLProgram(p,[u],"int32",h);return s||n.disposeIntermediateTensorInfo(u),d}},mk=gb+"\n  return -x;\n";const gk={kernelName:mn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){const e=n.texData.get(r.dataId),[t,a]=Rv(e.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,t)}let a;return a=ye().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new wb(r.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new mb(r.shape,mk),n.runWebGLProgram(a,[r],r.dtype)}},yk=xh;const vk={kernelName:yn,backendName:"webgl",kernelFunc:function(e){Or("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:u}=r,c=n.readSync(a.dataId),l=n.readSync(i.dataId),{selectedIndices:p}=yk(c,l,o,s,u);return n.makeTensorInfo([p.length],"int32",new Int32Array(p))}},bk=wh;const xk={kernelName:vn,backendName:"webgl",kernelFunc:function(e){Or("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:u,padToMaxOutputSize:c}=r,l=n.readSync(a.dataId),p=n.readSync(i.dataId),{selectedIndices:h,validOutputs:d}=bk(l,p,o,s,u,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([d]))]}},wk=Nh;const Nk={kernelName:bn,backendName:"webgl",kernelFunc:function(e){Or("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:u,softNmsSigma:c}=r,l=n.readSync(a.dataId),p=n.readSync(i.dataId),h=o,d=s,f=u,m=c,{selectedIndices:g,selectedScores:y}=wk(l,p,h,d,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}};class Sk{constructor(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(r,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}}const kk={kernelName:wn,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:i,depth:o,onValue:s,offValue:u}=r,c=U(a.shape),l=new Sk(c,o,s,u),p=Qb({inputs:{x:a},backend:n,attrs:{shape:[c]}}),h=n.runWebGLProgram(l,[p],i);n.disposeIntermediateTensorInfo(p);const d=Qb({inputs:{x:h},backend:n,attrs:{shape:[...a.shape,o]}});return n.disposeIntermediateTensorInfo(h),d}};function Ek(e){const{inputs:t,backend:n}=e,{x:r}=t;if("complex64"===r.dtype){const e=hw({inputs:{input:r},backend:n}),t=Ek({inputs:{x:e},backend:n}),a=Tw({inputs:{input:r},backend:n}),i=Ek({inputs:{x:a},backend:n}),o=Mb({inputs:{real:t,imag:i},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),o}return VN({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const Ck={kernelName:Tr,backendName:"webgl",kernelFunc:Ek};const Tk={kernelName:xn,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r}=t,{x:a}=n;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){const t=hw({inputs:{input:a},backend:r}),n=e({inputs:{x:t},backend:r}),i=Tw({inputs:{input:a},backend:r}),o=Ek({inputs:{x:i},backend:r}),s=Mb({inputs:{real:n,imag:o},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}return VN({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};const Dk={kernelName:Nn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(1===t.length)return MN({inputs:{input:t[0]},backend:n,attrs:{dim:a}});const i=t[0].shape,o=t[0].dtype;t.forEach((e=>{L(i,e.shape,"All tensors passed to stack must have matching shapes"),B(o===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const s=[],u=Aw({inputs:t.map((e=>{const t=MN({inputs:{input:e},backend:n,attrs:{dim:a}});return s.push(t),t})),backend:n,attrs:{axis:a}});return s.forEach((e=>n.disposeIntermediateTensorInfo(e))),u}};class Ik{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,a=bm(r),i=t.map((e=>e[0])).join(","),o=t.map(((t,n)=>t[0]+e[n])).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      ".concat(a," start = ").concat(a,"(").concat(i,");\n      ").concat(a," end = ").concat(a,"(").concat(o,");\n\n      void main() {\n        ").concat(a," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(a," coords = outC - start;\n          setOutput(getX(").concat(s,"));\n        }\n      }\n    "):"\n        int start = ".concat(i,";\n        int end = ").concat(o,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}}class Ak{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,a=bm(r),i=t.map((e=>e[0])).join(","),o=t.map(((t,n)=>t[0]+e[n])).join(","),s=ub("rc",r),u=ub("source",r),c="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),l=1===r?"source":"vec2(".concat(u.slice(-2).join(),")"),p=["".concat(a," rc = outputLoc;"),"".concat(s[r-1]," += 1;\n       if(").concat(c,") {\n      "),1===r?"":"}\n       rc = outputLoc;\n       ".concat(s[r-2]," += 1;\n       if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {"),1===r?"":"  ".concat(s[r-1]," += 1;\n         if(").concat(c,") {")],h=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let d="";for(let f=0,m=1===r?2:4;f<m;f++)d+="\n        ".concat(p[f],"\n        if (").concat(h,") {\n          result[").concat(f,"] = float(value);\n        } else {\n          ").concat(a," source = rc - start;\n          result[").concat(f,"] = getChannel(getX(").concat(u.join(),"), ").concat(l,");\n        }\n      ");d+=1===r?"} ":"}}",this.userCode="\n      const ".concat(a," start = ").concat(a,"(").concat(i,");\n      const ").concat(a," end = ").concat(a,"(").concat(o,");\n\n      void main() {\n        ").concat(a," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(d,"\n        setOutput(result);\n      }\n    ")}}const Fk=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,constantValue:o}=r;if(0===U(a.shape)){const e=i.map(((e,t)=>e[0]+a.shape[t]+e[1]));return VN({backend:n,attrs:{shape:e,value:o,dtype:a.dtype}})}const s=ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ak(a.shape,i,o):new Ik(a.shape,i,o),u=[[o]];return n.runWebGLProgram(s,[a],a.dtype,u)},_k={kernelName:Sn,backendName:"webgl",kernelFunc:Fk},Mk=qb({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+Ib+"\n  return result;\n"}),Ok={kernelName:kn,backendName:"webgl",kernelFunc:Mk};const Rk={kernelName:Cn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r,s=a.shape.length,u=[],c=K(i,a.shape);let l=c;const p=yc(l,s);let h,d=a;if(null!=p&&(d=ux({inputs:{x:a},backend:n,attrs:{perm:p}}),l=bc(l.length,s),u.push(d)),gc("prod",l,s),n.shouldExecuteOnCPU([d])){const e=n.texData.get(d.dataId).values,{outVals:t,outShape:r,outDtype:a}=Bv(d.shape,d.dtype,e,l);h=n.makeTensorInfo(r,a,t)}else{const[e,t]=fc(d.shape,l),r=U(t),i=Qb({inputs:{x:d},backend:n,attrs:{shape:[-1,r]}}),o=nx(i,Oa(a.dtype),"prod",n);h=Qb({inputs:{x:o},backend:n,attrs:{shape:e}}),u.push(i),u.push(o)}if(o){u.push(h);const e=mc(h.shape,c);h=Qb({inputs:{x:h},backend:n,attrs:{shape:e}})}return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),h}};const zk={kernelName:Tn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:a,paramsDenseValues:i,indices:o}=t,{outputRaggedRank:s}=r,u=a.map((e=>n.readSync(e.dataId))),c=a.map((e=>e.shape)),l=n.readSync(i.dataId),p=n.readSync(o.dataId),[h,d,f]=Lv(u,c,l,i.shape,i.dtype,p,o.shape,s),m=h.map((e=>n.makeTensorInfo([e.length],"int32",e))),g=n.makeTensorInfo(f,i.dtype,d);return m.concat([g])}};const Bk={kernelName:Dn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{starts:r,limits:a,deltas:i}=t,o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),[c,l]=Pv(o,r.shape,r.dtype,s,a.shape,u,i.shape);return[n.makeTensorInfo([c.length],"int32",c),n.makeTensorInfo([l.length],r.dtype,l)]}};const Lk={kernelName:In,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{shape:a,values:i,defaultValue:o,rowPartitionTensors:s}=t,{rowPartitionTypes:u}=r,c=n.readSync(a.dataId),l=n.readSync(i.dataId),p=n.readSync(o.dataId),h=s.map((e=>n.readSync(e.dataId))),d=s.map((e=>e.shape)),[f,m]=Uv(c,a.shape,l,i.shape,i.dtype,p,o.shape,h,d,u);return n.makeTensorInfo(f,i.dtype,m)}},Pk=e=>{const{backend:t,attrs:n}=e,{start:r,stop:a,step:i,dtype:o}=n,s=Wv(r,a,i,o);return t.makeTensorInfo([s.length],o,s)},Uk={kernelName:An,backendName:"webgl",kernelFunc:Pk},Wk=Vb({opSnippet:"return 1.0 / x;"}),Vk={kernelName:_n,backendName:"webgl",kernelFunc:Wk},qk=Vb({opSnippet:gb+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),jk={kernelName:Mn,backendName:"webgl",kernelFunc:qk},Gk=Vb({opSnippet:gb+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),Hk={kernelName:Pn,backendName:"webgl",kernelFunc:Gk};class Kk{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];const[i,o,s,u]=e;this.outputShape=[i,t,n,u];const c=[r&&t>1?o-1:o,r&&n>1?s-1:s],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];let p;p=a?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/l[0],",\n          ").concat(c[1]/l[1],");\n      const vec2 inputShapeRC = vec2(").concat(o,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(p,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}}class Xk{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,s,u]=e;this.outputShape=[i,t,n,u];const c=[r&&t>1?o-1:o,r&&n>1?s-1:s],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];let p;p=a?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/l[0],",\n          ").concat(c[1]/l[1],",\n          ").concat(c[1]/l[1],");\n      const vec3 inputShapeRC = vec3(").concat(o,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(p,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(u-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}}const Yk={kernelName:Bn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:o,size:s}=r,[u,c]=s,l=ye().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Xk(a.shape,u,c,i,o):new Kk(a.shape,u,c,i,o);return n.runWebGLProgram(l,[a],"float32")}};class $k{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,a]=t,[,i,o]=e,s=[n&&i>1?r-1:r,n&&o>1?a-1:a],u=[n&&i>1?i-1:i,n&&o>1?o-1:o],c=s[0]/u[0],l=s[1]/u[1],p=1/c,h=1/l,d=2*Math.ceil(p)+2,f=2*Math.ceil(h)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(c,");\n        const float widthScale = float(").concat(l,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(h,");\n\n        const int winHeight = int(").concat(d,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(o,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(r-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(a-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const Zk={kernelName:Ln,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:o}=r,s=new $k(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}};class Qk{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];const[i,o,s,u]=e;this.outputShape=[i,t,n,u];const c=[r&&t>1?o-1:o,r&&n>1?s-1:s],l=[r&&t>1?t-1:t,r&&n>1?n-1:n],p=r?"0.5":"0.0";let h;h=a?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/l[0],",\n          ").concat(c[1]/l[1],");\n      const vec2 inputShapeRC = vec2(").concat(o,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(p,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}}class Jk{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,s,u]=e;this.outputShape=[i,t,n,u];const c=[r&&t>1?o-1:o,r&&n>1?s-1:s],l=[r&&t>1?t-1:t,r&&n>1?n-1:n],p=r?"0.5":"0.0";let h;h=a?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/l[0],",\n          ").concat(c[1]/l[1],",\n          ").concat(c[1]/l[1],");\n      const vec3 inputShapeRC = vec3(").concat(o,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(p,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(u-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}}const eE={kernelName:Rn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:o,size:s}=r,[u,c]=s,l=ye().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Jk(a.shape,u,c,i,o):new Qk(a.shape,u,c,i,o);return n.runWebGLProgram(l,[a],a.dtype)}};class tE{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,a]=t,[,i,o]=e,s=[n&&i>1?r-1:r,n&&o>1?a-1:a],u=[n&&i>1?i-1:i,n&&o>1?o-1:o],c=s[0]/u[0],l=s[1]/u[1],p=1/c,h=1/l,d=2*Math.ceil(p)+2,f=2*Math.ceil(h)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(c,");\n        const float widthScale = float(").concat(l,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(h,");\n\n        const int winHeight = int(").concat(d,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(o,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(s[0],") *\n                (float(dyR) / float(").concat(u[0],"));\n\n            float sourceFracCol =\n                float(").concat(s[1],") *\n                  (float(dyC) / float(").concat(u[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(r,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(a,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const nE={kernelName:zn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:o}=r,s=new tE(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}};class rE{constructor(e,t){this.variableNames=["x"];const n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=e,1===n)return void(this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(e[0]," - coord - 1));\n        }\n      "));const r=e.map(((n,r)=>(n=>-1!==t.indexOf(n)&&1!==e[n]?"".concat(e[n]," - coords[").concat(n,"] - 1"):"coords[".concat(n,"]"))(r))).join(","),a=bm(n);this.userCode="\n      void main() {\n        ".concat(a," coords = getOutputCoords();\n        setOutput(getX(").concat(r,"));\n      }\n    ")}}class aE{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=e;const r=ub("rc",n),a="".concat(r[n-1]," + 1 < ").concat(this.outputShape[n-1]),i="".concat(r[n-2]," + 1 < ").concat(this.outputShape[n-2]),o=bm(n);function s(n){const r=e.map(((r,a)=>function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?"".concat(e[n]," - ").concat(r[n]," - 1"):"".concat(r[n])}(a,n))),a=r.join(","),i=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(i,"))")}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(e[0]," - rc - 1),\n            ").concat(e[0]," - rc - 1);\n          if(").concat(a,"){\n              result.g = getChannel(getX(").concat(e[0]," - (rc  + 1) - 1),\n                ").concat(e[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(o," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return s(e)}(r.slice()),";\n          if(").concat(a,"){\n            result.g = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",s(e)}(r.slice()),";\n          }\n          if(").concat(i,") {\n            result.b = ").concat(function(e){return e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice()),";\n            if(").concat(a,") {\n              result.a = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}}const iE={kernelName:Un,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:i}=r,o=a.shape.length,s=K(i,a.shape);if(0===o)return Fb({inputs:{x:a},backend:n});const u=ye().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new aE(a.shape,s):new rE(a.shape,s);return n.runWebGLProgram(u,[a],a.dtype)}};class oE{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=e[1],r=e[2];this.outputShape=e;let a="";a="number"===typeof t?"float outputValue = ".concat(t.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(t.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(a,"\n          if(coordX >= 0 && coordX < ").concat(r," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const sE={kernelName:Ar,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:a}=t,{radians:i,fillValue:o,center:s}=n,u=r,c=new oE(a.shape,o),[l,p]=Sd(s,a.shape[1],a.shape[2]),h=[[l,p,Math.sin(i),Math.cos(i)]];return u.runWebGLProgram(c,[a],a.dtype,h)}},uE=Vb({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),cE={kernelName:Wn,backendName:"webgl",kernelFunc:uE},lE=Vb({opSnippet:"return inversesqrt(x);",cpuKernelImpl:Vv}),pE={kernelName:Vn,backendName:"webgl",kernelFunc:lE};class hE{constructor(e,t,n,r,a,i){let o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const s=bm(a.length),u=bm(i.length);let c="";1===n?c="i":2===n&&(c="i, j");const l="getIndices(".concat(c,")");let p="";1===r?p="i":2===r&&(p="i, coords[1]");const h="getUpdates(".concat(p,")");let d="";o&&(d="coords[0], coords[1]");const f="getDefaultValue(".concat(d,")"),m=t>1?"strides[j]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(a,");\n\n        void main() {\n          ").concat(u," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(e,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(t,"; j++) {\n              int index = round(").concat(l,");\n              flattenedIndex += index * ").concat(m,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(h,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(f,", sum, float(found)));\n        }\n      ")}}class dE{constructor(e,t,n,r,a,i){let o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const s=bm(a.length),u=bm(i.length);let c="";1===n?c="i":2===n&&(c="i, j");const l="getIndices(".concat(c,")");let p="";1===r?p="i":2===r&&(p="i, coords[1]");const h="getUpdates(".concat(p,")");let d="";o&&(d="coords[0], coords[1]");const f="getDefaultValue(".concat(d,")"),m=t>1?"strides[j]":"strides",g=t>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(a,");\n\n        void main() {\n          ").concat(u," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(e,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(t,"; j+=2) {\n              ivec4 index = round(").concat(l,");\n              flattenedIndex += index.xz * ").concat(m,";\n              if (j + 1 < ").concat(t,") {\n                flattenedIndex += index.yw * ").concat(g,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(h,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(f,", sum, found));\n        }\n      ")}}const fE={kernelName:qn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:i}=t,{shape:o}=r,{sliceRank:s,numUpdates:u,sliceSize:c,strides:l,outputSize:p}=Ap(0,a,o),h=[p/c,c];if(0===p)return n.makeTensorInfo(o,a.dtype);const d=Qb({inputs:{x:a},backend:n,attrs:{shape:[u,s]}}),f=Qb({inputs:{x:i},backend:n,attrs:{shape:[u,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let g;g=ye().getBool("WEBGL_PACK")?new dE(u,s,d.shape.length,f.shape.length,l,h):new hE(u,s,d.shape.length,f.shape.length,l,h);const y=n.runWebGLProgram(g,[f,d,m],f.dtype),v=Qb({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(m),v}};class mE{constructor(e,t,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];const a="for (int i = 0; i < ".concat(Math.ceil(Math.log2(t+1)),"; ++i) { if (left >= right) break;"),i=2===ye().getNumber("WEBGL_VERSION")?"while (left < right) {":a,o="left"===r?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(i,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(o," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}}const gE={kernelName:Gn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:i}=t,{side:o}=r,s=new mE(a.shape[0],a.shape[1],i.shape[1],o),u=[[a.shape[1]]];return n.runWebGLProgram(s,[a,i],"int32",u)}};class yE{constructor(e,t,n){let r,a;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(1===n)a="resRC",r="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],o=[];for(let r=0;r<t.length;r++)o.push("".concat(n[r])),r<e&&i.push("".concat(n[r]));r=i.join(),a=o.join()}const i=bm(n);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        float cVal = getC(").concat(r,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(a,"));\n        } else {\n          setOutput(getB(").concat(a,"));\n        }\n      }\n    ")}}const vE={kernelName:Hn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:r,t:a,e:i}=t,o=new yE(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(o,[r,a,i],Ma(a.dtype,i.dtype))}},bE=Vb({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(Ad,";\n  float scale = ").concat(Fd,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),xE={kernelName:Kn,backendName:"webgl",kernelFunc:bE},wE=Vb({opSnippet:Wb+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:jv}),NE={kernelName:Qn,backendName:"webgl",kernelFunc:wE},SE=Vb({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),kE={kernelName:Zn,backendName:"webgl",kernelFunc:SE},EE=Vb({opSnippet:Wb+"\n  return sin(x);\n",packedOpSnippet:"\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(Ib,"\n  return result;\n")}),CE={kernelName:Yn,backendName:"webgl",kernelFunc:EE},TE=Vb({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),DE={kernelName:$n,backendName:"webgl",kernelFunc:TE},IE=Vb({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),AE={kernelName:Jn,backendName:"webgl",kernelFunc:IE},FE={kernelName:nr,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,paddings:o}=r;B(a.shape.length<=4,(()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"));const s=i.reduce(((e,t)=>e*t)),u=[[0,0]];u.push(...o);for(let y=1+i.length;y<a.shape.length;++y)u.push([0,0]);const c=[],l=Fk({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),p=kd(l.shape,i,s,!1),h=Ed(p.length,i.length,!1),d=Cd(l.shape,i,s,!1),f=Qb({inputs:{x:l},backend:n,attrs:{shape:p}}),m=ux({inputs:{x:f},backend:n,attrs:{perm:h}}),g=Qb({inputs:{x:m},backend:n,attrs:{shape:d}});return c.push(l),c.push(f),c.push(m),c.forEach((e=>n.disposeIntermediateTensorInfo(e))),g}};const _E={kernelName:ir,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{indices:r,values:a,denseShape:i,defaultValue:o}=t;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));const s=n.readSync(r.dataId),u=n.readSync(a.dataId),c=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[p,h,d,f,m]=Kv(s,r.shape,r.dtype,u,a.dtype,c,l);return[n.makeTensorInfo(h,r.dtype,p),n.makeTensorInfo([h[0]],a.dtype,d),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((e=>Number(e))))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};const ME={kernelName:or,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:a,newShape:i}=t;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));const o=Array.from(n.readSync(a.dataId)),s=n.readSync(r.dataId),u=Array.from(n.readSync(i.dataId)),[c,l,p]=Xv(s,r.shape,r.dtype,o,u);return[n.makeTensorInfo(l,r.dtype,c),n.makeTensorInfo([p.length],i.dtype,new Int32Array(p))]}};const OE={kernelName:sr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(i.shape));const o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),[c,l]=Yv(o,r.shape,r.dtype,s,u,!0);return n.makeTensorInfo(l,r.dtype,c)}};const RE={kernelName:ur,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(i.shape));const o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),[c,l]=Yv(o,r.shape,r.dtype,s,u);return n.makeTensorInfo(l,r.dtype,c)}};const zE={kernelName:cr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:a,sparseValues:i,defaultValue:o}=t,{outputShape:s}=r,{sliceRank:u,numUpdates:c,sliceSize:l,strides:p,outputSize:h}=Ap(0,a,s),d=!1;if("string"===i.dtype){const e=n.bufferSync(a),t=n.bufferSync(i),r=ca(n.readSync(o.dataId)[0]),f=qv(e,t,s,h,l,c,u,p,r,d);return n.makeTensorInfo(s,f.dtype,f.values)}const f=new hE(c,u,a.shape.length,i.shape.length,p,[h,1],d),m=n.runWebGLProgram(f,[i,a,o],i.dtype),g=Qb({inputs:{x:m},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(m),g}};const BE={kernelName:rr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:i,axis:o}=r,s=K(o,a.shape)[0],u=nf(a,i,s),c=a.shape.length,l=new Array(c).fill(0),p=a.shape.slice();return u.map((e=>{const t=[...p];t[s]=e;const r=aw({inputs:{x:a},backend:n,attrs:{begin:l,size:t}});return l[s]+=e,r}))}},LE="return sqrt(x);",PE=Vb({opSnippet:LE,packedOpSnippet:LE,cpuKernelImpl:$v}),UE={kernelName:er,backendName:"webgl",kernelFunc:PE},WE={kernelName:pr,backendName:"webgl",kernelFunc:Vb({opSnippet:"return x * x;"})},VE="return (a - b) * (a - b);",qE=qb({opSnippet:VE,packedOpSnippet:VE}),jE={kernelName:lr,backendName:"webgl",kernelFunc:qE};const GE={kernelName:hr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t;if("string"!==a.dtype)throw new Error("Input must be of datatype string");const i=bf(n.readSync(a.dataId)),o=Zv(i,"string",r);return n.makeTensorInfo(a.shape,"string",o)}};const HE={kernelName:Dr,backendName:"webgl",kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e;const{x:a}=t,i=gb+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new mb(a.shape,i);return r.runWebGLProgram(o,[a],a.dtype)}};class KE{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,a=bm(n.length),i=bm(n.length);let o="";if(1===r)o="coords * strides + begin";else{let e=0;o=n.map(((t,r)=>(e++,1===n.length?"coords * strides[".concat(r,"] + begin[").concat(r,"]"):"coords[".concat(e-1,"] * strides[").concat(r,"] + begin[").concat(r,"]")))).join(",")}this.userCode="\n      ".concat(a," begin = ").concat(a,"(").concat(e,");\n      ").concat(a," strides = ").concat(a,"(").concat(t,");\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(o,"));\n      }\n    ")}}const XE={kernelName:dr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,end:o,strides:s,beginMask:u,endMask:c,ellipsisMask:l,newAxisMask:p,shrinkAxisMask:h}=r,{finalShapeSparse:d,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:v,end:b,strides:x}=qs(a.shape,i,o,s,u,c,l,p,h);let w;if(m)w=Qb({inputs:{x:a},backend:n,attrs:{shape:f}});else if(g||y){B(a.shape.length>=1,(()=>"Input must have rank at least 1, got: ".concat(a.shape.length)));const e=As(v,b,x),t=aw({inputs:{x:a},backend:n,attrs:{begin:v,size:e}});w=Qb({inputs:{x:t},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(t)}else{if(n.shouldExecuteOnCPU([a])){const e=n.readSync(a.dataId),t=wo(a.shape,a.dtype,e),r=Qv(d,t,x,v);w=n.makeTensorInfo(f,a.dtype,r.values)}else{const e=new KE(v,x,d);w=n.runWebGLProgram(e,[a],a.dtype)}}const N=Qb({inputs:{x:w},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(w),N}};const YE={kernelName:fr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:i,leftPad:o,rightPad:s,padWidth:u,preserveShortSequences:c}=r,{data:l,dataSplits:p}=t,h=n.readSync(l.dataId),d=n.readSync(p.dataId),[f,m]=Jv(h,d,a,i,o,s,u,c);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(p.shape,"int32",m)]}};const $E={kernelName:mr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:a}=r,{input:i,delimiter:o}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(1!==i.shape.length)throw new Error("Input must be a vector, got shape: ".concat(i.shape));if(0!==o.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(o.shape));const s=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[c,l,p]=eb(s,u,a),h=l.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",l),n.makeTensorInfo([2],"int32",new Int32Array(p))]}};const ZE={kernelName:gr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:a}=r,{input:i}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),s=tb(o,a);return n.makeTensorInfo(i.shape,"int32",s)}},QE=Vb({opSnippet:"return tan(x);"}),JE={kernelName:vr,backendName:"webgl",kernelFunc:QE},eC=Vb({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),tC={kernelName:br,backendName:"webgl",kernelFunc:eC};const nC={kernelName:jn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{tensor:a,indices:i,updates:o}=t,{}=r,{sliceRank:s,numUpdates:u,sliceSize:c,strides:l,outputSize:p}=Ap(0,i,a.shape),h=[p/c,c];if(0===p)return n.makeTensorInfo(a.shape,i.dtype);const d=Qb({inputs:{x:i},backend:n,attrs:{shape:[u,s]}}),f=Qb({inputs:{x:o},backend:n,attrs:{shape:[u,c]}}),m=Qb({inputs:{x:a},backend:n,attrs:{shape:h}}),g=new hE(u,s,d.shape.length,f.shape.length,l,h,!1,!0),y=n.runWebGLProgram(g,[f,d,m],m.dtype),v=Qb({inputs:{x:y},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),v}};class rC{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[i]*t[i];this.outputShape=n,this.rank=n.length;const r=bm(this.rank),a=function(e){const t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(e);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(a,"));\n      }\n    ")}}function aC(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:i}=r;if("string"===a.dtype||a.shape.length>5){const e=n.readSync(a.dataId),t="string"===a.dtype?e.map((e=>ca(e))):e,r=wo(a.shape,a.dtype,t),o=rb(r,i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const o=new rC(a.shape,i);return n.runWebGLProgram(o,[a],a.dtype)}const iC={kernelName:xr,backendName:"webgl",kernelFunc:aC};class oC{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class sC{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function uC(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function cC(e){let t=1;for(;t<e;)t*=2;return t}const lC={kernelName:wr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:i,sorted:o}=r,s=ye().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=ye().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=a.shape,l=c[c.length-1];if(n.shouldExecuteOnCPU([a])||l<s||i>u){const e=n.readSync(a.dataId),[t,r]=ab(e,c,a.dtype,i,o);return[n.makeTensorInfo(t.shape,t.dtype,t.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===i)return c[c.length-1]=0,[n.makeTensorInfo(c,a.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(1===l)return[a,VN({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const p=n.texData.get(a.dataId),h=null!==p&&p.isPacked,d=h?n.unpackTensor(a):a,f=U(c)/l,m=Qb({inputs:{x:d},attrs:{shape:[f,l]},backend:n});h&&uC(n,d);const g=cC(i),y=cC(l);let v=null;const b=()=>null===v?[m,m]:[m,v],x=(e,t,r)=>{const a=b(),i=new oC(r),o=[[l],[null===v?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],s=v;v=n.runWebGLProgram(i,a,"int32",o),uC(n,s)};for(let E=1;E<g;E*=2){const e=2*E;for(let t=E;t>=1;t/=2)x(e,t,[f,y])}for(let E=y;E>g;E/=2){const e=b(),t=new sC([f,E/2]),r=[[l],[null===v?1:0],[g]],a=v;v=n.runWebGLProgram(t,e,"int32",r),uC(n,a);const i=g/2,o=2*i;for(let n=i;n>=1;n/=2)x(o,n,v.shape)}let w=v;v=aw({inputs:{x:v},backend:n,attrs:{begin:0,size:[f,i]}}),uC(n,w);let N=sS({inputs:{x:m,indices:v},backend:n,attrs:{axis:1,batchDims:1}});uC(n,m);const S=c.slice(0,-1);S.push(i),w=v,v=Qb({inputs:{x:v},attrs:{shape:S},backend:n}),uC(n,w);const k=N;return N=Qb({inputs:{x:N},attrs:{shape:S},backend:n}),uC(n,k),[N,v]}};class pC{constructor(e,t,n,r,a,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const o="nearest"===n?1:2;let s;switch(r){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(e," && 0 <= coordX && coordX < ").concat(t,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(a,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(a,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(t,"));\n                float mapY = mapCoord(inY, float(").concat(e,"));\n\n                if (").concat(o," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}}const hC={kernelName:Nr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:a,transforms:i}=t,{interpolation:o,fillMode:s,fillValue:u,outputShape:c}=r,[l,p,h,d]=a.shape,[f,m]=null!=c?c:[p,h],g=new pC(p,h,o,s,u,[l,f,m,d]);return n.runWebGLProgram(g,[a,i],"float32")}};const dC={kernelName:kr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:i}=t;tm(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(i.dataId),{outputValues:s,outputShape:u,indices:c}=ob(o,a,i.shape,i.dtype);return[r.makeTensorInfo(u,i.dtype,s),r.makeTensorInfo([c.length],"int32",c)]}};const fC={kernelName:Er,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:a}=t;let{axis:i}=r;i<0&&(i+=a.shape.length);const o=a,s=o.shape.length,u=a.shape[i],c=new Array(s-1);let l=0;for(let m=0;m<s;m++)m!==i&&(c[l++]=o.shape[m]);const p=[],h=new Array(s).fill(0),d=o.shape.slice();d[i]=1;const f=new Array(u);for(let m=0;m<f.length;m++){h[i]=m;const e=aw({inputs:{x:o},backend:n,attrs:{begin:h,size:d}}),t=Qb({inputs:{x:e},backend:n,attrs:{shape:c}});f[m]=t,p.push(e)}return p.forEach((e=>n.disposeIntermediateTensorInfo(e))),f}};class mC{constructor(e,t){this.variableNames=["x","segmentIds"];const n=e.windowSize,r=e.batchSize,a=e.inSize,i=e.numSegments,o=i*Math.ceil(a/n);this.outputShape=[r,o];const s=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ";let l="";a%n>0&&(l="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return initializationValue;\n        }\n      "));let p="";a%n>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(l,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(p,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(i,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(i,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(c,"\n        } else if (").concat(2===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(c,"\n        } else if (").concat(3===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(c,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}}const gC={kernelName:Cr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:i}=t,{numSegments:o}=r,s=a.shape.length,u=[];let c=0;const l=yc([c],s);let p=a;null!=l&&(p=ux({inputs:{x:a},backend:n,attrs:{perm:l}}),u.push(p),c=bc(1,s)[0]);const h=yf(p.shape,c,o),d=U([p.shape[c]]),f=Qb({inputs:{x:p},backend:n,attrs:{shape:[-1,d]}});u.push(f);const m=Oa(a.dtype),g=(e,t,r,a,i)=>{const o=e.shape[0],s=e.shape[1],c=gf(s,i),l=new mC({windowSize:c,inSize:s,batchSize:o,numSegments:i},t),p=n.compileAndRun(l,[e,r],a);if(u.push(p),p.shape[1]===i)return p;const h=Pk({backend:n,attrs:{start:0,stop:i,step:1,dtype:"float32"}}),d=aC({inputs:{x:h},backend:n,attrs:{reps:[s/c]}});u.push(h),u.push(d);return g(p,t,d,a,i)},y=Qb({inputs:{x:g(f,"unsortedSegmentSum",i,m,o)},backend:n,attrs:{shape:h}});let v=y;if(null!=l){u.push(y);const e=vc(l);v=ux({inputs:{x:v},backend:n,attrs:{perm:e}})}return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),v}},yC=[px,dx,mx,yx,xx,Sx,kx,Ex,Fx,_x,Ox,zx,Lx,Ux,Vx,Gx,Hx,Yx,$x,Zx,ew,ow,sw,uw,cw,fw,yw,xw,Ob,Sw,Fw,Pw,jw,Hw,Kw,Xw,Yw,Zw,Jw,tN,sN,uN,cN,pN,fN,yN,vN,xN,NN,SN,EN,CN,DN,AN,_N,ON,BN,UN,qN,GN,XN,$N,JN,nS,rS,iS,uS,lS,hS,_b,dS,Dw,mS,yS,bS,Bb,wS,SS,kS,CS,DS,AS,_S,OS,BS,PS,WS,qS,jS,GS,XS,YS,$S,ZS,QS,ek,rk,ik,fk,Zb,gk,vk,xk,Nk,pw,kk,Tk,Dk,_k,Ok,Ub,Rk,zk,Bk,Lk,Uk,dw,uk,Vk,jk,Hk,Jb,Yk,Zk,eE,nE,iE,sE,cE,pE,fE,gE,vE,xE,NE,kE,CE,DE,iw,dk,AE,FE,_E,ME,OE,RE,zE,BE,UE,WE,jE,GE,HE,XE,YE,$E,ZE,pk,sx,JE,tC,nC,iC,lC,hC,cx,dC,fC,gC,Ck];for(const n of yC)Wr(n);const vC={kernelName:Ne,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Do(e,xp(No(n,"float32"),-1))}}},bC={kernelName:Se,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=Ao(No(n,"float32")),r=Io(jo(Mo(1),t));return Hc(To(e,r))}}}},xC={kernelName:ke,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=Io(jo(Ao(No(n,"float32")),1));return To(e,t)}}}},wC={kernelName:Ee,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=Yo(n.shape,r.shape);return{a:()=>{let t=e;const r=Xo(n.shape,a);return r.length>0&&(t=Nc(t,r)),vu(t,n.shape)},b:()=>{let t=e;const n=Xo(r.shape,a);return n.length>0&&(t=Nc(t,n)),vu(t,r.shape)}}}},NC={kernelName:Ce,saveAllInputs:!0,gradFunc:(e,t)=>{const n={};return t.forEach(((t,r)=>{n[r]=()=>e.clone()})),n}},SC={kernelName:Ie,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Fo(n)}}},kC={kernelName:Ae,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Fo(n)}}},EC={kernelName:Fe,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>To(e,Io(jo(Mo(1),Ao(No(n,"float32")))))}}},CC={kernelName:_e,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=Io(Eo(Mo(1),Ao(No(n,"float32"))));return To(e,t)}}}},TC={kernelName:Re,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=Yo(n.shape,r.shape);return{a:()=>{const t=Eo(Ao(n),Ao(r));let i=Do(e,To(r,t));const o=Xo(n.shape,a);return o.length>0&&(i=Nc(i,o)),vu(i,n.shape)},b:()=>{const t=Eo(Ao(n),Ao(r));let i=Hc(Do(e,To(n,t)));const o=Xo(r.shape,a);return o.length>0&&(i=Nc(i,o)),vu(i,r.shape)}}}},DC={kernelName:Me,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>To(e,Eo(Ao(No(n,"float32")),1))}}},IC={kernelName:Oe,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>To(e,jo(Mo(1),Ao(No(n,"float32"))))}}};const AC=ri({avgPool3dGrad_:function(e,t,n,r,a,i){const o=ei(e,"dy","avgPool3dGrad"),s=ei(t,"input","avgPool3dGrad");let u=o,c=s,l=!1;4===s.rank&&(l=!0,u=vu(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=vu(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),B(5===u.rank,(()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(u.rank,"."))),B(5===c.rank,(()=>"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(c.rank,"."))),yu("avgPool3dGrad",a,i);const p={dy:u,input:c},h={filterSize:n,strides:r,pad:a,dimRoundingMode:i},d=Ga.runKernel(Pe,p,h);return l?vu(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),FC={kernelName:Le,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:a,strides:i,pad:o,dimRoundingMode:s}=n;return{x:()=>AC(e,r,a,i,o,s)}}};const _C=ri({avgPoolGrad_:function(e,t,n,r,a){const i=ei(e,"dy","avgPoolGrad"),o=ei(t,"input","avgPoolGrad");B(o.rank===i.rank,(()=>"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(i.rank,")")));let s=o,u=i,c=!1;3===o.rank&&(c=!0,s=vu(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=vu(i,[1,i.shape[0],i.shape[1],i.shape[2]])),B(4===u.rank,(()=>"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(u.rank,"."))),B(4===s.rank,(()=>"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(s.rank,".")));const l={dy:u,input:s},p={filterSize:n,strides:r,pad:a},h=Ga.runKernel(Be,l,p);return c?vu(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),MC={kernelName:ze,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:a,strides:i,pad:o}=n;return{x:()=>_C(e,r,a,i,o)}}},OC={kernelName:Ue,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{const[r,a]=t,{transposeA:i,transposeB:o}=n;return i||o?!i&&o?{a:()=>Nu(e,a,!1,!1),b:()=>Nu(e,r,!0,!1)}:i&&!o?{a:()=>Nu(a,e,!1,!0),b:()=>Nu(r,e,!1,!1)}:{a:()=>Nu(a,e,!0,!0),b:()=>Nu(e,r,!0,!0)}:{a:()=>Nu(e,a,!1,!0),b:()=>Nu(r,e,!0,!1)}}},RC={kernelName:We,gradFunc:(e,t,n)=>{const{blockShape:r,crops:a}=n;return{x:()=>Cl(e,r,a)}}},zC={kernelName:"BroadcastTo",gradFunc:(e,t,n)=>{const r=n,a=r.inputShape,i=r.shape,o=Array.from(i);for(let u=a.length-1;u>=0;u--)if(a[u]===i[u])o[u]=1;else if(1!==a[u])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(i,"]."));const s=[];for(let u=0;u<o.length;u++)o[u]>1&&s.push(u);return{x:()=>Nc(e,s,!0)}}},BC={kernelName:Ge,gradFunc:e=>({x:()=>e.clone()})},LC={kernelName:He,gradFunc:e=>({x:()=>Fo(e)})},PC={kernelName:Ke,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{clipValueMin:a,clipValueMax:i}=n;return{x:()=>ic(Zc(Oc(r,a),Wc(r,i)),e,Fo(e))}}},UC={kernelName:Ye,inputsToSave:["x"],gradFunc:vC.gradFunc},WC={kernelName:$e,saveAllInputs:!0,gradFunc:(e,t,n)=>{const r=t.map((e=>e.shape)),{axis:a}=n,i=K(a,t[0].shape)[0],o=r.map((e=>e[i]));return mp(e,o,i).map((e=>()=>e))}},VC={kernelName:Ze,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,a]=t,{dilations:i,strides:o,pad:s,dataFormat:u}=n;return B(du(i),(()=>"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(i,"'"))),{x:()=>ju(r.shape,e,a,o,s,u),filter:()=>Zp(r,e,a.shape,o,s,u)}}},qC={kernelName:Je,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{const[r,a]=t,{strides:i,pad:o,dataFormat:s,dimRoundingMode:u}=n;return{dy:()=>Vu(e,a,i,o,s,1,u),filter:()=>Zp(e,r,a.shape,i,o,s,u)}}};const jC=ri({conv3DBackpropFilter_:function(e,t,n,r,a){let i=e;4===e.rank&&(i=vu(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let o=t;4===o.rank&&(o=vu(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),B(5===i.rank,(()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(i.shape,"."))),B(5===o.rank,(()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,"."))),B(5===n.length,(()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,"."))),B(i.shape[4]===n[3],(()=>"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must ")+"match input depth in filter (".concat(n[3],"."))),B(o.shape[4]===n[4],(()=>"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")));const s={x:i,dy:o},u={strides:r,pad:a,filterShape:n};return Ga.runKernel(tt,s,u)}}),GC={kernelName:et,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:a,pad:i}=n;B(du(r),(()=>"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")));const[o,s]=t;return{x:()=>Ku(o.shape,e,s,a,i),filter:()=>jC(o,e,s.shape,a,i)}}},HC={kernelName:rt,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Do(Hc(ip(No(n,"float32"))),e)}}},KC={kernelName:at,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Do(op(No(n,"float32")),e)}}},XC={kernelName:ot,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:a,exclusive:i,reverse:o}=n;return{x:()=>{const t=yc([a],r.rank);let n=Qu(e,a,i,!o);return null!=t&&(n=Vp(n,t)),n}}}},YC={kernelName:lt,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:a,pad:i,dimRoundingMode:o}=n,s=null==r?[1,1]:r;B(du(s),(()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")));const[u,c]=t;return B(4===u.rank,(()=>"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(u.rank,"."))),B(4===c.rank,(()=>"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(c.rank,"."))),B(u.shape[3]===c.shape[2],(()=>"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(u.shape[3],") must match the inChannels dimension ")+"in filter ".concat(c.shape[2],"."))),B(fu(a,s),(()=>"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(s,"'."))),yu("depthwiseConv2d",i,o),{x:()=>ah(u.shape,e,c,a,i,s,o),filter:()=>rh(u,e,c.shape,a,i,s,o)}}},$C={kernelName:ft,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,a]=t,i={x:r,filter:a,dy:e},o={x:r,filter:a,dy:e};return{x:()=>Ga.runKernel(mt,i,n),filter:()=>Ga.runKernel(gt,o,n)}}},ZC={kernelName:xt,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t,r={dy:e,y:n};return{x:()=>Ga.runKernel(wt,r)}}},QC={kernelName:Nt,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=Do(Cc(Hc(Ao(n))),2/Math.sqrt(Math.PI));return{x:()=>Do(e,r)}}},JC={kernelName:kt,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Do(e,n)}}},eT={kernelName:Et,inputsToSave:["input"],gradFunc:(e,t)=>{const[n]=t;return{input:()=>vu(e,n.shape)}}},tT={kernelName:Ct,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Do(e,Cc(n))}}},nT={kernelName:At,gradFunc:e=>({x:()=>Fo(e)})},rT={kernelName:Ft,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=Yo(n.shape,r.shape);return{a:()=>{const t=To(e,No(r,"float32")),i=Xo(n.shape,a);return i.length>0?vu(Nc(t,i),n.shape):t},b:()=>{let t=Do(e,No(n,"float32"));const i=Xo(r.shape,a);i.length>0&&(t=vu(Nc(t,i),r.shape));const o=Ao(r);return Hc(To(t,No(o,"float32")))}}}},aT={kernelName:_t,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{const{varianceEpsilon:r}=n,[a,i,o,s]=t,u=null==s?Mo(1):s,c=Xo(i.shape,a.shape),l=[];if(1===i.rank){for(let e=0;e<a.shape.length-1;++e)l.push(a.shape[e]);l.push(1)}const p=jo(a,i),h=Do(e,u),d=ep(Eo(o,Mo(r))),f=Do(Do(Do(d,d),d),Mo(-.5));return{x:()=>1===i.rank?vu(Do(Do(e,Ic(vu(d,[1,1,1,i.shape[0]]),l)),u),a.shape):vu(Do(Do(e,d),u),a.shape),mean:()=>{let e=Do(Do(d,Mo(-1)),h);return 1===i.rank&&(e=Nc(e,c)),vu(e,i.shape)},variance:()=>{let e=Do(Do(f,p),h);return 1===i.rank&&(e=Nc(e,c)),vu(e,i.shape)},scale:()=>{const t=Do(p,d);let n=Do(e,t);return 1===i.rank&&(n=Nc(n,c)),vu(n,i.shape)},offset:()=>{let t=e;return 1===i.rank&&(t=Nc(t,c)),vu(t,i.shape)}}}},iT={kernelName:Mt,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{const[r,a]=t,{axis:i,batchDims:o}=n,s=K(i,r.shape)[0],u=(e,t,n)=>()=>{const r=e.shape,a=t.size,o=r.slice(0,s),u=o.length,c=r.slice(i,r.length).slice(1),l=c.length,p=oT(0,u),h=oT(u+1,u+1+l),d=sT([o,[a],c]),f=vu(n,d),m=vu(t,[a]),g=sT([[u],p,h]),y=Vp(f,g);let v=Rp(y,m,e.shape[s]);const b=vc(g);return v=Vp(v,b),v};if(1===o){const t=r.shape[0],n=r.split(t,0);return{x:()=>{const t=bp(n.map(((t,n)=>u(t,a.slice(n,1),e.slice(n,1))())));return t.reshape(r.shape)},indices:()=>a}}return{x:u(r,a,e),indices:()=>a}}};function oT(e,t){const n=[];for(let r=e;r<t;++r)n.push(r);return n}function sT(e){const t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}const uT={kernelName:zt,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>Fo(n),b:()=>Fo(r)}}},cT={kernelName:Bt,gradFunc:e=>({x:()=>No(e,"float32")})},lT={kernelName:Ut,gradFunc:e=>({x:()=>Fo(e)})},pT={kernelName:Wt,gradFunc:e=>({x:()=>Fo(e)})},hT={kernelName:Vt,gradFunc:e=>({x:()=>Fo(e)})},dT={kernelName:qt,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{alpha:a}=n,i=Mc(r,0);return{x:()=>ic(i,e,Do(e,a))}}},fT={kernelName:Xt,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>To(e,Eo(n,1))}}},mT={kernelName:Kt,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>To(e,No(n,"float32"))}}},gT={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{axis:a}=n;return{logits:()=>{const t=Cc(r);return jo(e,Do(Nc(e,a,!0),t))}}}};const yT=ri({localResponseNormalizationBackprop_:function(e,t,n){const r={x:e,y:t,dy:n},a={depthRadius:arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,bias:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,alpha:arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,beta:arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5};return Ga.runKernel(Jt,r,a)}}),vT={kernelName:Qt,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,a]=t,{depthRadius:i,bias:o,alpha:s,beta:u}=n;return{x:()=>yT(r,a,e,i,o,s,u)}}};function bT(e,t,n,r){return t.rank<n.rank&&(t=vu(t,mc(t.shape,r))),e.rank<n.rank&&(e=vu(e,mc(e.shape,r))),{x:()=>Do(e,No(ac(n,t),e.dtype))}}const xT={kernelName:en,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{reductionIndices:a}=r,i=t[0],o=bT(e,t[1],i,K(a,i.shape));return{x:()=>o.x()}}},wT={kernelName:tn,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>Do(e,No(Oc(n,r),"float32")),b:()=>Do(e,No(Uc(n,r),"float32"))}}};const NT=ri({maxPool3dGrad_:function(e,t,n,r,a,i,o){const s=ei(e,"dy","maxPool3dGrad"),u=ei(t,"input","maxPool3dGrad"),c=ei(n,"output","maxPool3dGrad");let l=s,p=u,h=c,d=!1;4===u.rank&&(d=!0,l=vu(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),p=vu(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),h=vu(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),B(5===l.rank,(()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(l.rank,"."))),B(5===p.rank,(()=>"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(p.rank,"."))),B(5===h.rank,(()=>"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(h.rank,"."))),yu("maxPool3dGrad",i,o);const f={dy:l,input:p,output:h},m={filterSize:r,strides:a,pad:i,dimRoundingMode:o},g=Ga.runKernel(on,f,m);return d?vu(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),ST={kernelName:an,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,a]=t,{filterSize:i,strides:o,pad:s,dimRoundingMode:u}=n;return{x:()=>NT(e,r,a,i,o,s,u)}}};const kT=ri({maxPoolGrad_:function(e,t,n,r,a,i,o){const s=ei(e,"dy","maxPoolGrad"),u=ei(t,"input","maxPoolGrad"),c=ei(n,"output","maxPoolGrad");B(u.rank===s.rank,(()=>"Rank of input (".concat(u.rank,") does not match rank of dy ")+"(".concat(s.rank,")"))),B(4===s.rank,(()=>"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(s.rank,"."))),B(4===u.rank,(()=>"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(u.rank,"."))),yu("maxPoolGrad",i,o);const l={dy:s,input:u,output:c},p={filterSize:r,strides:a,pad:i,dimRoundingMode:o};return Ga.runKernel(rn,l,p)}}),ET={kernelName:nn,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,a]=t,{filterSize:i,strides:o,pad:s}=n;return{x:()=>kT(e,r,a,i,o,s)}}},CT={kernelName:pn,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:a}=n,i=a.map((e=>e[0]));return{x:()=>ku(e,i,r.shape)}}},TT={kernelName:Sn,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:a}=n,i=a.map((e=>e[0]));return{x:()=>ku(e,i,r.shape)}}},DT={kernelName:kn,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{const[n,r,a]=t,i=n,o=r,s=Yo(i.shape,o.shape);return{a:()=>{const t=No(o,"float32");let n=Do(e,Do(t,qo(i,jo(t,Mo(1)))));const r=Xo(i.shape,s);return r.length>0&&(n=Nc(n,r)),vu(n,i.shape)},b:()=>{const t=Mc(i,0),n=ic(t,jc(i),Fo(i));let r=Do(e,Do(a,n));const u=Xo(o.shape,s);return u.length>0&&(r=Nc(r,u)),vu(r,o.shape)}}}};function IT(e,t,n){const r=e.shape.length,a=r-n.length,i=yc(n,r);let o=e;null!=i&&(o=Vp(e,i));const s=o.shape.slice(),u=s.splice(r-n.length,n.length).reduce(((e,t)=>e*t),1);s.push(u);let c=function(e,t,n){const r=e.shape.slice();r[n]=1;const a=vu(t,r),i=Zu(e,n,!0,!1),o=Zu(e,n,!0,!0),s=Do(i,o);return Do(a,s)}(o.reshape(s),t,a);if(c=c.reshape(o.shape),null!=i){const e=vc(i);c=Vp(c,e)}return c}const AT={kernelName:Kn,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=Mc(n,Mo(0)),r=Mo(Ad),a=Mo(Fd),i=Do(e,a),o=Do(Do(e,r),Cc(No(n,"float32")));return ic(t,i,o)}}}},FT={kernelName:nr,gradFunc:(e,t,n)=>{const{blockShape:r,paddings:a}=n;return{x:()=>Tu(e,r,a)}}},_T={kernelName:rr,gradFunc:(e,t,n)=>{const{axis:r}=n;return{x:()=>wu(e,r)}}};const MT=[vC,bC,xC,wC,NC,SC,kC,EC,CC,TC,DC,IC,FC,MC,OC,RC,zC,BC,LC,PC,UC,WC,qC,VC,GC,HC,KC,XC,YC,$C,{kernelName:vt,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=Yo(n.shape,r.shape);return{a:()=>{const t=To(e,No(r,"float32")),i=Xo(n.shape,a);return i.length>0?vu(Nc(t,i),n.shape):t},b:()=>{let t=Do(e,No(n,"float32"));const i=Xo(r.shape,a);i.length>0&&(t=vu(Nc(t,i),r.shape));const o=Ao(r);return Hc(To(t,No(o,"float32")))}}}},ZC,QC,JC,eT,tT,rT,nT,aT,iT,uT,cT,lT,pT,hT,dT,fT,mT,gT,vT,xT,xT,wT,ST,ET,{kernelName:un,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:a}=n,i=K(a,r.shape),o=U(fc(r.shape,i)[1]);return{x:()=>{const t=r.shape.slice();i.forEach((e=>{t[e]=1}));const n=vu(e,t);return To(Do(n,cl(r.shape,"float32")),o)}}}},{kernelName:cn,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{axis:a}=r,[i,o]=t,s=bT(e,o,i,K(a,i.shape));return{x:()=>s.x()}}},{kernelName:ln,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>Do(e,No(Wc(n,r),"float32")),b:()=>Do(e,No(Mc(n,r),"float32"))}}},CT,{kernelName:hn,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=Yo(n.shape,r.shape);return{a:()=>{const t=Xo(n.shape,a);return t.length>0?vu(Nc(e,t),n.shape):e},b:()=>{const t=Do(e,Hc(Fc(To(n,r)))),i=Xo(r.shape,a);return i.length>0?vu(Nc(t,i),r.shape):t}}}},{kernelName:fn,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=Yo(n.shape,r.shape);return{a:()=>{const t=Do(e,No(r,"float32")),i=Xo(n.shape,a);return i.length>0?vu(Nc(t,i),n.shape):t},b:()=>{const t=Do(e,No(n,"float32")),i=Xo(r.shape,a);return i.length>0?vu(Nc(t,i),r.shape):t}}}},{kernelName:mn,gradFunc:e=>({x:()=>Hc(e)})},{kernelName:wn,inputsToSave:["indices"],gradFunc:(e,t)=>{const n=t[0];return{indices:()=>ul(n.shape,"float32")}}},{kernelName:xn,gradFunc:e=>({x:()=>Fo(e)})},{kernelName:Nn,saveAllInputs:!0,gradFunc:(e,t,n)=>{const{axis:r}=n;return zp(e,r).map((e=>()=>e))}},TT,TT,DT,{kernelName:En,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{const[n,r]=t,a=Mc(n,0);return{x:()=>ic(a,e,Do(e,r)),alpha:()=>{let t=ic(a,Fo(e),Do(e,n));const i=Xo(r.shape,e.shape);return i.length>0&&(t=Nc(t,i)),vu(t,r.shape)}}}},{kernelName:Cn,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:a}=n;let i=[];return i=void 0===a||null===a?r.shape.map(((e,t)=>t)):"number"===typeof a?[a]:a,{x:()=>IT(r,e,i)}}},{kernelName:_n,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>To(e,Hc(Ao(n)))}}},{kernelName:Pn,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=Do(Wc(n,6),xp(n));return{x:()=>Do(e,No(r,"float32"))}}},{kernelName:Mn,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Do(e,No(xp(n),"float32"))}}},{kernelName:On,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>vu(e,n.shape)}}},{kernelName:Bn,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,a={dy:e,images:r};return{images:()=>Ga.runKernel(Ln,a,n)}}},{kernelName:Rn,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,a={dy:e,images:r};return{images:()=>Ga.runKernel(zn,a,n)}}},{kernelName:Un,gradFunc:(e,t,n)=>{const{dims:r}=n,a=K(r,e.shape);return{x:()=>Xl(e,a)}}},{kernelName:Wn,gradFunc:e=>({x:()=>Fo(e)})},{kernelName:Vn,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Hc(To(e,Do(qo(n,1.5),2)))}}},{kernelName:Hn,inputsToSave:["condition"],gradFunc:(e,t)=>{const[n]=t;return{condition:()=>No(Fo(n),"float32"),t:()=>Do(e,No(n,e.dtype)),e:()=>Do(e,No(Qc(n),e.dtype))}}},AT,{kernelName:Qn,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Do(e,Do(n,jo(Mo(1),n)))}}},{kernelName:Zn,gradFunc:e=>({x:()=>Fo(e)})},{kernelName:Yn,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Do(Yu(No(n,"float32")),e)}}},{kernelName:$n,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Do($u(No(n,"float32")),e)}}},{kernelName:Xn,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{begin:a,size:i}=n,o=r.shape,[s,u]=Vs(r,a,i),c=[];for(let l=0;l<e.rank;l++)c.push([s[l],o[l]-s[l]-u[l]]);return{x:()=>wl(e,c)}}},{kernelName:ar,outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{dim:a}=n,i=Do(e,r);return{logits:()=>jo(i,Do(Nc(i,[a],true),r))}}},{kernelName:Jn,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Do(e,Su(n))}}},FT,FT,_T,_T,{kernelName:er,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>To(e,Do(Io(No(n,"float32")),2))}}},{kernelName:lr,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=Mo(2);return{a:()=>Do(e,Do(a,jo(n,r))),b:()=>Do(e,Do(a,jo(r,n)))}}},{kernelName:pr,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Do(e,Do(No(n,"float32"),2))}}},{kernelName:Dr,gradFunc:e=>({x:()=>Fo(e)})},{kernelName:yr,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=Yo(n.shape,r.shape);return{a:()=>{let t=e;const r=Xo(n.shape,a);return r.length>0&&(t=Nc(t,r)),vu(t,n.shape)},b:()=>{let t=e;const n=Xo(r.shape,a);return n.length>0&&(t=Nc(t,n)),vu(Hc(t),r.shape)}}}},{kernelName:tr,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,a=r.shape.slice(),{axis:i}=n;K(i,r.shape).forEach((e=>{a[e]=1}));const o=vu(e,a),s=Do(o,cl(r.shape,"float32"));return{x:()=>s}}},{kernelName:vr,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>To(e,Ao(Yu(n)))}}},{kernelName:br,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>Do(jo(Mo(1),Ao(n)),e)}}},{kernelName:xr,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{reps:a}=n;return{x:()=>{let t=Fo(r);if(1===r.rank)for(let n=0;n<a[0];++n)t=Eo(t,ku(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)t=Eo(t,ku(e,[n*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)for(let o=0;o<a[2];++o)t=Eo(t,ku(e,[n*r.shape[0],i*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)for(let o=0;o<a[2];++o)for(let s=0;s<a[3];++s)t=Eo(t,ku(e,[n*r.shape[0],i*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},{kernelName:Sr,gradFunc:(e,t,n)=>{const r=n,{perm:a}=r,i=vc(a);return{x:()=>Vp(e,i)}}},{kernelName:Er,gradFunc:(e,t,n)=>{const r=n,{axis:a}=r;return{value:()=>bp(e,a)}}},{kernelName:Cr,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>function(e,t){const n=$o(t,Fo(t)),r=_c(e,n);let a=Oc(t,Mo(0,"int32"));const i=r.rank-a.rank;for(let s=0;s<i;++s)a=Tc(a,s+1);a=Zc(a,cl(r.shape,"bool"));const o=Fo(r);return ic(a,r,o)}(e,n)}}},{kernelName:Tr,gradFunc:e=>({x:()=>Fo(e)})}];for(const n of MT)Vr(n);Ea().prototype.abs=function(){return this.throwIfDisposed(),Ho(this)},Ea().prototype.acos=function(){return this.throwIfDisposed(),Gs(this)},Ea().prototype.acosh=function(){return this.throwIfDisposed(),Hs(this)},Ea().prototype.add=function(e){return this.throwIfDisposed(),Eo(this,e)},Ea().prototype.all=function(e,t){return this.throwIfDisposed(),Xs(this,e,t)},Ea().prototype.any=function(e,t){return this.throwIfDisposed(),Ys(this,e,t)},Ea().prototype.argMax=function(e){return this.throwIfDisposed(),$s(this,e)},Ea().prototype.argMin=function(e){return this.throwIfDisposed(),Zs(this,e)},Ea().prototype.asScalar=function(){return this.throwIfDisposed(),B(1===this.size,(()=>"The array must have only 1 element.")),vu(this,[])},Ea().prototype.asType=function(e){return this.throwIfDisposed(),No(this,e)},Ea().prototype.as1D=function(){return this.throwIfDisposed(),vu(this,[this.size])},Ea().prototype.as2D=function(e,t){return this.throwIfDisposed(),vu(this,[e,t])},Ea().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),vu(this,[e,t,n])},Ea().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),vu(this,[e,t,n,r])},Ea().prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),vu(this,[e,t,n,r,a])},Ea().prototype.asin=function(){return this.throwIfDisposed(),Qs(this)},Ea().prototype.asinh=function(){return this.throwIfDisposed(),Js(this)},Ea().prototype.atan=function(){return this.throwIfDisposed(),eu(this)},Ea().prototype.atan2=function(e){return this.throwIfDisposed(),tu(this,e)},Ea().prototype.atanh=function(){return this.throwIfDisposed(),nu(this)},Ea().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),bu(this,e,t,n,r)},Ea().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Tu(this,e,t)},Ea().prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),Du(this,e,t,n,r,a)},Ea().prototype.broadcastTo=function(e){return this.throwIfDisposed(),Ru(this,e)},Ea().prototype.cast=function(e){return this.throwIfDisposed(),No(this,e)},Ea().prototype.ceil=function(){return this.throwIfDisposed(),zu(this)},Ea().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),Bu(this,e,t)},Ea().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof ka&&(e=[e]),wu([this,...e],t)},Ea().prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),qu(this,e,t,n,r,a,i)},Ea().prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),Gu(this,e,t,n,r,a)},Ea().prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Vu(this,e,t,n,r,a,i)},Ea().prototype.cos=function(){return this.throwIfDisposed(),Yu(this)},Ea().prototype.cosh=function(){return this.throwIfDisposed(),$u(this)},Ea().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),Zu(this,e,t,n)},Ea().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),Qu(this,e,t,n)},Ea().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),ec(this,e,t)},Ea().prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),tc(this,e,t,n,r,a,i)},Ea().prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),rc(this,e,t,n,r,a)},Ea().prototype.divNoNan=function(e){return this.throwIfDisposed(),oc(this,e)},Ea().prototype.div=function(e){return this.throwIfDisposed(),To(this,e)},Ea().prototype.dot=function(e){return this.throwIfDisposed(),sc(this,e)},Ea().prototype.elu=function(){return this.throwIfDisposed(),cc(this)},Ea().prototype.equal=function(e){return this.throwIfDisposed(),ac(this,e)},Ea().prototype.erf=function(){return this.throwIfDisposed(),pc(this)},Ea().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),Ec(this,e,t)},Ea().prototype.exp=function(){return this.throwIfDisposed(),Cc(this)},Ea().prototype.expandDims=function(e){return this.throwIfDisposed(),Tc(this,e)},Ea().prototype.expm1=function(){return this.throwIfDisposed(),Dc(this)},Ea().prototype.fft=function(){return this.throwIfDisposed(),hp(this)},Ea().prototype.flatten=function(){return this.throwIfDisposed(),vu(this,[this.size])},Ea().prototype.floor=function(){return this.throwIfDisposed(),Fc(this)},Ea().prototype.floorDiv=function(e){return this.throwIfDisposed(),Co(this,e)},Ea().prototype.gather=function(e,t,n){return this.throwIfDisposed(),_c(this,e,t,n)},Ea().prototype.greaterEqual=function(e){return this.throwIfDisposed(),Oc(this,e)},Ea().prototype.greater=function(e){return this.throwIfDisposed(),Mc(this,e)},Ea().prototype.ifft=function(){return this.throwIfDisposed(),dp(this)},Ea().prototype.irfft=function(){return this.throwIfDisposed(),fp(this)},Ea().prototype.isFinite=function(){return this.throwIfDisposed(),zc(this)},Ea().prototype.isInf=function(){return this.throwIfDisposed(),Bc(this)},Ea().prototype.isNaN=function(){return this.throwIfDisposed(),Lc(this)},Ea().prototype.leakyRelu=function(e){return this.throwIfDisposed(),Pc(this,e)},Ea().prototype.lessEqual=function(e){return this.throwIfDisposed(),Wc(this,e)},Ea().prototype.less=function(e){return this.throwIfDisposed(),Uc(this,e)},Ea().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),qc(this,e,t,n,r)},Ea().prototype.logSigmoid=function(){return this.throwIfDisposed(),Xc(this)},Ea().prototype.logSoftmax=function(e){return this.throwIfDisposed(),Yc(this,e)},Ea().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),$c(this,e,t)},Ea().prototype.log=function(){return this.throwIfDisposed(),jc(this)},Ea().prototype.log1p=function(){return this.throwIfDisposed(),Gc(this)},Ea().prototype.logicalAnd=function(e){return this.throwIfDisposed(),Zc(this,e)},Ea().prototype.logicalNot=function(){return this.throwIfDisposed(),Qc(this)},Ea().prototype.logicalOr=function(e){return this.throwIfDisposed(),Jc(this,e)},Ea().prototype.logicalXor=function(e){return this.throwIfDisposed(),el(this,e)},Ea().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Nu(this,e,t,n)},Ea().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),al(this,e,t,n,r)},Ea().prototype.max=function(e,t){return this.throwIfDisposed(),xc(this,e,t)},Ea().prototype.maximum=function(e){return this.throwIfDisposed(),$o(this,e)},Ea().prototype.mean=function(e,t){return this.throwIfDisposed(),sl(this,e,t)},Ea().prototype.min=function(e,t){return this.throwIfDisposed(),wc(this,e,t)},Ea().prototype.minimum=function(e){return this.throwIfDisposed(),pl(this,e)},Ea().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),hl(this,e,t)},Ea().prototype.mod=function(e){return this.throwIfDisposed(),dl(this,e)},Ea().prototype.mul=function(e){return this.throwIfDisposed(),Do(this,e)},Ea().prototype.neg=function(){return this.throwIfDisposed(),Hc(this)},Ea().prototype.norm=function(e,t,n){return this.throwIfDisposed(),kc(this,e,t,n)},Ea().prototype.notEqual=function(e){return this.throwIfDisposed(),yl(this,e)},Ea().prototype.oneHot=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),vl(this,e,t,n)},Ea().prototype.onesLike=function(){return this.throwIfDisposed(),bl(this)},Ea().prototype.pad=function(e,t){return this.throwIfDisposed(),wl(this,e,t)},Ea().prototype.pool=function(e,t,n,r,a,i){return this.throwIfDisposed(),Tl(this,e,t,n,r,a,i)},Ea().prototype.pow=function(e){return this.throwIfDisposed(),qo(this,e)},Ea().prototype.prelu=function(e){return this.throwIfDisposed(),Dl(this,e)},Ea().prototype.prod=function(e,t){return this.throwIfDisposed(),Il(this,e,t)},Ea().prototype.reciprocal=function(){return this.throwIfDisposed(),Gl(this)},Ea().prototype.relu=function(){return this.throwIfDisposed(),Hl(this)},Ea().prototype.relu6=function(){return this.throwIfDisposed(),Kl(this)},Ea().prototype.reshapeAs=function(e){return this.throwIfDisposed(),vu(this,e.shape)},Ea().prototype.reshape=function(e){return this.throwIfDisposed(),vu(this,e)},Ea().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),_h(this,e,t,n)},Ea().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),Mh(this,e,t,n)},Ea().prototype.reverse=function(e){return this.throwIfDisposed(),Xl(this,e)},Ea().prototype.rfft=function(){return this.throwIfDisposed(),gp(this)},Ea().prototype.round=function(){return this.throwIfDisposed(),Jl(this)},Ea().prototype.rsqrt=function(){return this.throwIfDisposed(),ep(this)},Ea().prototype.selu=function(){return this.throwIfDisposed(),tp(this)},Ea().prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),np(this,e,t,n,r,a,i)},Ea().prototype.sigmoid=function(){return this.throwIfDisposed(),Su(this)},Ea().prototype.sign=function(){return this.throwIfDisposed(),ap(this)},Ea().prototype.sin=function(){return this.throwIfDisposed(),ip(this)},Ea().prototype.sinh=function(){return this.throwIfDisposed(),op(this)},Ea().prototype.slice=function(e,t){return this.throwIfDisposed(),ku(this,e,t)},Ea().prototype.softmax=function(e){return this.throwIfDisposed(),pp(this,e)},Ea().prototype.softplus=function(){return this.throwIfDisposed(),Kc(this)},Ea().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Cl(this,e,t)},Ea().prototype.split=function(e,t){return this.throwIfDisposed(),mp(this,e,t)},Ea().prototype.sqrt=function(){return this.throwIfDisposed(),Io(this)},Ea().prototype.square=function(){return this.throwIfDisposed(),Ao(this)},Ea().prototype.squaredDifference=function(e){return this.throwIfDisposed(),yp(this,e)},Ea().prototype.squeeze=function(e){return this.throwIfDisposed(),vp(this,e)},Ea().prototype.stack=function(e,t){this.throwIfDisposed();const n=e instanceof ka?[this,e]:[this,...e];return bp(n,t)},Ea().prototype.step=function(e){return this.throwIfDisposed(),xp(this,e)},Ea().prototype.stridedSlice=function(e,t,n,r,a,i,o,s){return this.throwIfDisposed(),wp(this,e,t,n,r,a,i,o,s)},Ea().prototype.sub=function(e){return this.throwIfDisposed(),jo(this,e)},Ea().prototype.sum=function(e,t){return this.throwIfDisposed(),Nc(this,e,t)},Ea().prototype.tan=function(){return this.throwIfDisposed(),Np(this)},Ea().prototype.tanh=function(){return this.throwIfDisposed(),Eu(this)},Ea().prototype.tile=function(e){return this.throwIfDisposed(),Ic(this,e)},Ea().prototype.toBool=function(){return this.throwIfDisposed(),No(this,"bool")},Ea().prototype.toFloat=function(){return this.throwIfDisposed(),No(this,"float32")},Ea().prototype.toInt=function(){return this.throwIfDisposed(),No(this,"int32")},Ea().prototype.topk=function(e,t){return this.throwIfDisposed(),_p(this,e,t)},Ea().prototype.transpose=function(e){return this.throwIfDisposed(),Vp(this,e)},Ea().prototype.unique=function(e){return this.throwIfDisposed(),Op(this,e)},Ea().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),Rp(this,e,t)},Ea().prototype.unstack=function(e){return this.throwIfDisposed(),zp(this,e)},Ea().prototype.where=function(e,t){return this.throwIfDisposed(),ic(e,this,t)},Ea().prototype.zerosLike=function(){return this.throwIfDisposed(),Fo(this)};class OT extends Error{constructor(e){super(e),Object.setPrototypeOf(this,OT.prototype)}}class RT extends Error{constructor(e){super(e),Object.setPrototypeOf(this,RT.prototype)}}class zT extends Error{constructor(e){super(e),Object.setPrototypeOf(this,zT.prototype)}}class BT extends Error{constructor(e){super(e),Object.setPrototypeOf(this,BT.prototype)}}class LT extends Error{constructor(e){super(e),Object.setPrototypeOf(this,LT.prototype)}}Error;class PT{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(e,"."));if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const e=this.cache.keys().next().value;this.cache.delete(e)}this.maxEntries=e}}function UT(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}{const n=new Array(t);return n.fill(e),n}}function WT(e,t){if(!e)throw new LT(t)}function VT(e,t){let n=0;for(const r of e)r===t&&n++;return n}function qT(e){return 1===e.length?e[0]:e}function jT(e){return Array.isArray(e)?e:[e]}function GT(e){const t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function HT(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,((e,t)=>t.toUpperCase()))}let KT={};function XT(e){if(null===e||void 0===e)return null;const t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function YT(e){if(null!=e&&"object"===typeof e)if(Array.isArray(e))e.forEach((e=>YT(e)));else{const t=Object.keys(e);for(const n of t){const t=e[n];null!=t&&"object"===typeof t&&(Array.isArray(t)||"ndarray"!==t.type||"number"!==typeof t.value?YT(t):e[n]=t.value)}}}function $T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof e){const a=e;let i;if(a in n)i=n[a];else if(a in KT)i=KT[a];else if(i=t[a],null==i)throw new zT("Unknown ".concat(r,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return i}{const i=e;if(null==i.className||null==i.config)throw new zT("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(i),".\n")+"'className' and 'config' must set.");const o=i.className;let s,u;if(o in n?[s,u]=n[o]:o in KT?[s,u]=KT.className:o in t&&([s,u]=t[o]),null==s)throw new zT("Unknown ".concat(r,": ").concat(o,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=u){const e={};for(const n of Object.keys(KT))e[n]=KT[n];for(const a of Object.keys(n))e[a]=n[a];i.config.customObjects=e;const t=Object.assign({},KT);for(const a of Object.keys(n))KT[a]=n[a];YT(i.config);const r=u(s,i.config,n,a);return KT=Object.assign({},t),r}{const e=Object.assign({},KT);for(const r of Object.keys(n))KT[r]=n[r];const t=new s(i.config);return KT=Object.assign({},e),t}}}function ZT(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function QT(e){if(null==e)return e;const t=[];for(const n of e)-1===t.indexOf(n)&&t.push(n);return t}function JT(e){if(null==e)throw new zT("Invalid value in obj: ".concat(JSON.stringify(e)));for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}function eD(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new zT("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function tD(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return WT(n>=0),WT(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((e=>typeof e===t))}function nD(e,t){Array.isArray(e)?(B(e.length>0,(()=>"".concat(t," is unexpectedly an empty array."))),e.forEach(((e,n)=>nD(e,"element ".concat(n+1," of ").concat(t))))):B(Number.isInteger(e)&&e>0,(()=>"Expected ".concat(t," to be a positive integer, but got ")+"".concat(rD(e),".")))}function rD(e){return null===e?"null":Array.isArray(e)?"["+e.map((e=>rD(e))).join(",")+"]":"string"===typeof e?'"'.concat(e,'"'):"".concat(e)}function aD(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}let iD=0;function oD(){return iD++}const sD={};function uD(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in sD||(sD[e]=0),sD[e]+=1,e+sD[e].toString()}const cD=["channelsFirst","channelsLast"],lD=["nearest","bilinear"],pD=["valid","same","causal"],hD=["max","avg"],dD=["sum","mul","concat","ave"],fD=new Map;function mD(e){eD(cD,"DataFormat",e)}function gD(e){eD(pD,"PaddingMode",e)}function yD(e){eD(hD,"PoolMode",e)}const vD=[];function bD(e,t){vD.push(e);try{const e=t();return vD.pop(),e}catch(Z2){throw vD.pop(),Z2}}function xD(e){if(!SD(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===vD.length?"":vD.join("/")+"/")+e}function wD(e){if(!SD(e))throw new Error("Not a valid tensor name: '"+e+"'");fD.has(e)||fD.set(e,0);const t=fD.get(e);if(fD.set(e,fD.get(e)+1),t>0){const n="".concat(e,"_").concat(t);return fD.set(n,1),n}return e}const ND=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function SD(e){return!!e.match(ND)}function kD(e,t,n){null==t&&(t=0),null==n&&(n=e.length);let r=1;for(let a=t;a<n;++a)r*=e[a];return r}function ED(e){if(0===e.length)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r<t&&(t=r)}return t}function CD(e){if(0===e.length)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r>t&&(t=r)}return t}function TD(e,t){if(t<e)throw new zT("end (".concat(t,") < begin (").concat(e,") is forbidden."));const n=[];for(let r=e;r<t;++r)n.push(r);return n}let DD;function ID(){return null==DD&&(DD=yi().epsilon()),DD}function AD(e,t){return No(e,t)}function FD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),vu(e,n)}function _D(e,t,n){return pi((()=>{switch(e.rank){case 1:return sp(e,t,n);case 2:return up(e,[t,0],[n,e.shape[1]]);case 3:return cp(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return lp(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return ku(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return ku(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new zT("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function MD(e,t,n){return pi((()=>{switch(e.rank){case 1:return sp(e,t,n);case 2:return up(e,[0,t],[e.shape[0],n]);case 3:return cp(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return lp(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new zT("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function OD(e,t,n,r){return pi((()=>{switch(e.rank){case 1:return sp(e,t,n);case 2:switch(r){case 1:return _D(e,t,n);case 2:return MD(e,t,n);default:throw new zT("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return _D(e,t,n);case 2:return cp(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return MD(e,t,n);default:throw new zT("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return _D(e,t,n);case 2:return lp(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return lp(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return MD(e,t,n);default:throw new zT("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new zT("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function RD(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(t=e[0].rank,n=0!==t?t:0),n===e[0].rank&&(n=-1),wu(e,n)}function zD(e,t){switch(e.rank){case 1:return Lu([e,t]);case 2:return Pu([e,t],0);case 3:return Uu([e,t],0);case 4:return Wu([e,t],0);default:throw new zT("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function BD(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new zT("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return Ic(e,t)}function LD(e){return Pl(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)}function PD(e,t,n,r){if(e.rank<2||t.rank<2)throw new BT("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3){if(e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new BT("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape))}if(2===e.rank&&2===t.rank){return oh({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?VD(e.rank,r,"channelsLast"):null,activation:n})}{const a=e.shape.slice(),i=a.pop();e=vu(e,[-1,i]);const o=t.shape.slice(),s=o.pop(),u=o.pop(),c=[...o,s],l=Array.from({length:t.rank},((e,n)=>0===n?t.rank-2:n<=t.rank-2?n-1:n));t=vu(Vp(t,l),[u,-1]);const p=[...a,...c];return vu(oh({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?VD(e.rank,r,"channelsLast"):null,activation:n}),p)}}function UD(e,t,n){return pi((()=>(t=Array.isArray(t)?Sp(t,"int32"):No(t,"int32"),_c(e,t,n))))}function WD(e){return Do(e,e)}function VD(e,t,n){const r=t.shape;if(1!==t.rank&&t.rank!==e)throw new zT("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)return 1===r.length?vu(t,[1,r[0],1,1,1]):vu(t,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?vu(t,[1,1,1,1,r[0]]):vu(t,[1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?vu(t,[1,r[0],1,1]):vu(t,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?vu(t,[1,1,1,r[0]]):vu(t,[1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?vu(t,[1,r[0],1]):vu(t,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?vu(t,[1,1,r[0]]):vu(t,[1].concat(r))}else if(e<3)return t;throw new zT("Unsupported input rank by biasAdd: ".concat(t.rank))}function qD(e,t,n){return pi((()=>(null==n&&(n="channelsLast"),mD(n),Eo(e,VD(e.rank,t,n)))))}function jD(e,t,n,r){return pi((()=>Kp(e,t,n,r)))}function GD(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e():t()}const HD=["fanIn","fanOut","fanAvg"],KD=["normal","uniform","truncatedNormal"];class XD extends zo{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class YD extends XD{apply(e,t){return ul(e,t)}}YD.className="Zeros",Lo(YD);class $D extends XD{apply(e,t){return cl(e,t)}}$D.className="Ones",Lo($D);class ZD extends XD{constructor(e){if(super(),"object"!==typeof e)throw new zT("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new zT("config must have value set but got ".concat(e));this.value=e.value}apply(e,t){return pi((()=>Do(Mo(this.value),cl(e,t))))}getConfig(){return{value:this.value}}}ZD.className="Constant",Lo(ZD);class QD extends XD{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return Wl(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}QD.className="RandomUniform",Lo(QD);class JD extends XD{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new BT("randomNormal does not support dType ".concat(t,"."));return LD(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}JD.className="RandomNormal",Lo(JD);class eI extends XD{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new BT("truncatedNormal does not support dType ".concat(t,"."));return Mp(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}eI.className="TruncatedNormal",Lo(eI);class tI extends XD{constructor(e){super(),this.gain=null!=e.gain?e.gain:1}apply(e,t){return pi((()=>{if(2!==e.length||e[0]!==e[1])throw new zT("Identity matrix initializer can only be used for 2D square matrices.");return Do(this.gain,Ac(e[0]))}))}getConfig(){return{gain:this.gain}}}tI.className="Identity",Lo(tI);class nI extends XD{constructor(e){if(super(),e.scale<0)throw new zT("scale must be a positive float. Got: ".concat(e.scale));var t;this.scale=null==e.scale?1:e.scale,this.mode=null==e.mode?"fanIn":e.mode,t=this.mode,eD(HD,"FanMode",t),this.distribution=null==e.distribution?"normal":e.distribution,function(e){eD(KD,"Distribution",e)}(this.distribution),this.seed=e.seed}apply(e,t){const n=function(e){let t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(mD(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){const r=kD(e,2);t=e[1]*r,n=e[0]*r}else if("channelsLast"===r){const r=kD(e,0,e.length-2);t=e[e.length-2]*r,n=e[e.length-1]*r}}else{const r=kD(e);t=Math.sqrt(r),n=Math.sqrt(r)}return[t,n]}(e),r=n[0],a=n[1];let i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,r):"fanOut"===this.mode?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),"normal"===this.distribution){const n=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new BT("".concat(this.getClassName()," does not support dType ").concat(t,"."));return Mp(e,0,n,t,this.seed)}{const n=Math.sqrt(3*i);return Wl(e,-n,n,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}nI.className="VarianceScaling",Lo(nI);class rI extends nI{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return nI.className}}rI.className="GlorotUniform",Lo(rI);class aI extends nI{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return nI.className}}aI.className="GlorotNormal",Lo(aI);class iI extends nI{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return nI.className}}iI.className="HeNormal",Lo(iI);class oI extends nI{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return nI.className}}oI.className="HeUniform",Lo(oI);class sI extends nI{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return nI.className}}sI.className="LeCunNormal",Lo(sI);class uI extends nI{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return nI.className}}uI.className="LeCunUniform",Lo(uI);class cI extends XD{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==e.gain?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return pi((()=>{if(e.length<2)throw new BT("Shape must be at least 2D.");if("int32"!==t&&"float32"!==t&&void 0!==t)throw new TypeError("Unsupported data type ".concat(t,"."));const n=U(e.slice(0,-1)),r=e[e.length-1],a=n*r;a>this.ELEMENTS_WARN_SLOW&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than ".concat(this.ELEMENTS_WARN_SLOW," (").concat(a,") elements: ")+"Slowness may result.");const i=LD([Math.max(r,n),Math.min(r,n)],0,1,t,this.seed),o=sd.qr(i,!1);let s=o[0];const u=o[1].flatten().stridedSlice([0],[Math.min(r,n)*Math.min(r,n)],[Math.min(r,n)+1]);return s=Do(s,u.sign()),n<r&&(s=s.transpose()),Do(Mo(this.gain),s.reshape(e))}))}getConfig(){return{gain:this.gain,seed:this.seed}}}cI.className="Orthogonal",Lo(cI);const lI={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function pI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return $T(e,Bo.getMap().classNameMap,t,"initializer")}function hI(e){return XT(e)}function dI(e){if("string"===typeof e){const t=e in lI?lI[e]:e;if("GlorotNormal"===t)return new aI;if("GlorotUniform"===t)return new rI;if("HeNormal"===t)return new iI;if("HeUniform"===t)return new oI;if("LeCunNormal"===t)return new sI;if("LeCunUniform"===t)return new uI;{const e={};return e.className=t,e.config={},pI(e)}}return e instanceof XD?e:pI(e)}function fI(e){return Array.isArray(e)&&Array.isArray(e[0])}function mI(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function gI(e){let t;if(Array.isArray(e)){if(1!==e.length)throw new zT("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function yI(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new zT("Expected exactly 1 Shape; got ".concat(e.length))}return e}function vI(e){let t=0;for(const n of e)0===n.shape.length?t+=1:t+=n.shape.reduce(((e,t)=>e*t));return t}const bI="Variable";class xI{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bI,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.dtype=null==t?"float32":t,this.shape=e.shape,this.id=oD(),n=null==n?bI:n,this.originalName=xD(n),this.name=wD(this.originalName),this.trainable_=r,this.constraint=a,this.val=Lp(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function wI(e){return e.map((e=>e.read()))}function NI(e){e.forEach((e=>{e[0].write(e[1])}))}class SI{constructor(e){this.dtype=e.dtype,this.shape=e.shape,null!=e.shape?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class kI{constructor(e,t,n,r,a,i,o){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=a,this.outputTensorIndex=o,this.id=oD(),null!=i&&(this.originalName=xD(i),this.name=wD(this.originalName)),this.rank=t.length}}let EI=0;class CI{constructor(e,t){this.callArgs=t,this.id=EI++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const n of e.inboundLayers)null!=n&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)null!=t?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let TI=0;class DI extends zo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=TI++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const e=this.getClassName();t=GT(e)+"_"+uD(e)}if(this.name=t,this.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){let t;if(null!=e.batchInputShape)t=e.batchInputShape;else if(null!=e.inputShape){let n=null;null!=e.batchSize&&(n=e.batchSize),t=[n].concat(e.inputShape)}this.batchInputShape=t;let n=e.dtype;null==n&&(n=e.inputDType),null==n&&(n="float32"),this.dtype=n}null!=e.weights?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(0===this.inboundNodes.length)throw new RT("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new zT("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}getInputAt(e){return qT(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return qT(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new OT("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new OT("Layer ".concat(this.name)+" is not connected, no input to return.");return qT(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new OT("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new OT("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return qT(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map((e=>e()))}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach((t=>t.trainable=e)),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter((e=>e.trainable)):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter((e=>!e.trainable)).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=jT(e);if(null==this.inputSpec||0===this.inputSpec.length)return;const n=jT(this.inputSpec);if(t.length!==n.length)throw new zT("Layer ".concat(this.name," expects ").concat(n.length," inputs, ")+"but it received ".concat(t.length," input tensors. ")+"Input received: ".concat(e));for(let r=0;r<t.length;r++){const e=t[r],a=n[r];if(null==a)continue;const i=e.rank;if(null!=a.ndim&&i!==a.ndim)throw new zT("Input ".concat(r," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(a.ndim,", found ndim=").concat(i));if(null!=a.maxNDim&&i>a.maxNDim)throw new zT("Input ".concat(r," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(a.maxNDim,", found ndim=").concat(i));if(null!=a.minNDim&&i<a.minNDim)throw new zT("Input ".concat(r," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(a.minNDim,", found ndim=").concat(i,"."));if(null!=a.dtype&&e.dtype!==a.dtype)throw new zT("Input ".concat(r," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(a.dtype,", found dtype=").concat(e.dtype,"."));if(a.axes){const t=e.shape;for(const e in a.axes){const n=Number(e),i=a.axes[e],o=n>=0?t[n]:t[t.length+n];if(null!=i&&-1===[i,null].indexOf(o))throw new zT("Input ".concat(r," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(n," of input shape to ")+"have value ".concat(i," but got shape ").concat(t,"."))}}if(null!=a.shape)for(let t=0;t<a.shape.length;++t){const n=a.shape[t],i=e.shape[t];if(null!=n&&null!=i&&n!==i)throw new zT("Input ".concat(r," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(a.shape,", ")+"found shape=".concat(e.shape,"."))}}}call(e,t){return e}invokeCallHook(e,t){null!=this._callHook&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const n=jT(e),r=function(e){let t=!0;for(const n of jT(e))if(!(n instanceof kI)){t=!1;break}return t}(e),a=function(e){let t=!0;for(const n of jT(e))if(n instanceof kI){t=!1;break}return t}(e);if(r===a)throw new zT("Arguments to apply() must be all SymbolicTensors or all Tensors");return bD(this.name,(()=>{if(!this.built){this.assertInputCompatibility(e);const t=[];for(const n of jT(e))t.push(n.shape);this.build(qT(t)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&a&&(this._refCount=1)}if(this.assertInputCompatibility(e),a){let r=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,r);const a=jT(r),i=[];for(let e of a)-1!==n.indexOf(e)&&(e=e.clone()),i.push(e);if(r=qT(i),null!=this.activityRegularizer)throw new BT("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{const n=function(e){e=jT(e);const t=[];for(const n of e)t.push(n.shape);return qT(t)}(e),r=this.computeOutputShape(n);let a;const i="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(e)?n[0]:n),a=null!=r&&r.length>0&&Array.isArray(r[0])?r.map(((n,r)=>new kI(i,n,this,jT(e),t,this.name,r))):new kI(i,r,this,jT(e),t,this.name),this.addInboundNode(e,a,null,null,n,r,t),this._refCount++,null!=this.activityRegularizer)throw new BT("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}}))}warnOnIncompatibleInputShape(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{let t=!1;this.batchInputShape.forEach(((n,r)=>{null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new OT("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");const e=[];for(const t of this.inboundNodes){const n=JSON.stringify(t.outputShapes);-1===e.indexOf(n)&&e.push(n)}if(1===e.length){const e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&1===e.length?e[0]:e}throw new OT("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}countParams(){if(!this.built)throw new RT("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return vI(this.weights)}build(e){this.built=!0}getWeights(){return wI(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.trainableWeights:this.weights)}setWeights(e){pi((()=>{const t=this.weights;if(t.length!==e.length)throw new zT('You called setWeights(weights) on layer "'.concat(this.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(t.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0===t.length)return;const n=[],r=wI(t);for(let a=0;a<r.length;++a){const i=r[a],o=t[a],s=e[a];if(!W(i.shape,s.shape))throw new zT("Layer weight shape ".concat(i.shape," ")+"not compatible with provided weight shape ".concat(s.shape));n.push([o,s])}NI(n)}))}addWeight(e,t,n,r,a,i,o,s){if(-1!==this._addedWeightNames.indexOf(e))throw new zT("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=s?s():dI("zeros"));const u=r.apply(t,n),c=new xI(u,n,e,i,o);return u.dispose(),null!=a&&this.addLoss((()=>a.apply(c.read()))),null==i&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){null==e||Array.isArray(e)&&0===e.length||(e=jT(e),void 0!==this._losses&&null!==this._losses&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");t.forEach((e=>{if(null!=e)throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return t}setMaskMetadata(e,t,n){if(!this.supportsMasking)return;const r=this.computeMask(e,n),a=jT(t),i=jT(r);if(a.length!==i.length)throw new Error("".concat(this.name," outputs ").concat(a.length," tensors ")+"but ".concat(a.length," masks for those tensors"));for(let o=0;o<a.length;o++)a[o].kerasMask=i[o]}addInboundNode(e,t,n,r,a,i){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const s=jT(e);t=jT(t),n=jT(n),r=jT(r),a=mI(a),i=mI(i);const u=[],c=[],l=[];for(const p of s)u.push(p.sourceLayer),c.push(p.nodeIndex),l.push(p.tensorIndex);new CI({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:l,inputTensors:s,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(let p=0;p<t.length;p++)t[p].sourceLayer=this,t[p].nodeIndex=this.inboundNodes.length-1,t[p].tensorIndex=p}getConfig(){const e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach((e=>e.dispose())),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}dispose(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();let e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function II(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];{const e=t.inboundNodes[n];if(0===e.inboundLayers.length)return e.inputTensors;{const t=[];for(let n=0;n<e.inboundLayers.length;n++){const r=II(e.inputTensors[n],e.inboundLayers[n],e.nodeIndices[n]);for(const e of r)-1===t.indexOf(e)&&t.push(e)}return t}}}class AI extends DI{constructor(e){if(super({dtype:e.dtype,name:null!=e.name?e.name:uD("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new zT("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(null==t){if(null==e.inputShape)throw new zT("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new zT("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];const r=new kI(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new CI({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new zT("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}AI.className="InputLayer",Lo(AI);class FI{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof FI)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(null==e)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,n){if(null!=this.id2Value[e.id])throw new zT("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return No(t,e.dtype)}catch(r5){throw new zT("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return null!=this.id2Value[e.id]}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof kI){if(null==this.id2Value[e.id])throw new zT("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}{const t=this.name2Id[e];if(null==t)throw new zT("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}}getMask(e){if(e instanceof kI){if(null==this.id2Value[e.id])throw new zT("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}{const t=this.name2Id[e];if(null==t)throw new zT("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}}disposeMasks(){null!=this.id2Mask&&hi(this.id2Mask)}}const _I=new PT,MI=new PT;function OI(e,t,n,r){const a=null!=n&&n.training,i=Array.isArray(e),o=i?e:[e],s=o.map((e=>e.name)),u=[],c=t.names();for(const f of s)-1!==c.indexOf(f)?u.push(t.getValue(f)):u.push(null);null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const l=s.join(",")+"|"+t.names().sort().join(",");let p,h=_I.get(l);if(null==h){const e=function(e,t){B(null!=e&&e.length>0,(()=>"Expected at least one fetch, got none"));let n=[],r={};if(1===e.length){const a=zI(e[0],t);n=a.sorted,r=a.recipientMap}else{const a=new Set;for(const i of e){const{sorted:e,recipientMap:o}=zI(i,t);for(const t of e)a.has(t.name)||(n.push(t),a.add(t.name));for(const t in o)null==r[t]&&(r[t]=new Set),o[t].forEach((e=>r[t].add(e)))}}return{sorted:n,recipientCounts:RI(r)}}(o,t);h=e.sorted,p=e.recipientCounts,_I.put(l,h),MI.put(l,p)}p={},a||Object.assign(p,MI.get(l));const d=new FI(t);for(let f=0;f<h.length;++f){if(null!=r){const e=li().numTensors;e>r.maxNumTensors&&(r.maxNumTensors=e),e<r.minNumTensors&&(r.minNumTensors=e)}const e=h[f],i=e.sourceLayer;if(i instanceof AI)continue;const o=[],c=[],l=[];let m=!1;for(const n of e.inputs){const e=d.getValue(n),r=d.getMask(n);o.push(e),c.push(r),null!=r&&(m=!0),a||(p[n.name]--,0!==p[n.name]||t.hasKey(n)||-1!==s.indexOf(n.name)||e.isDisposed||!0===n.sourceLayer.stateful||l.push(e))}m&&((n=n||{}).mask=c[0]);const g=jT(i.apply(o,n));let y=null;i.supportsMasking&&(y=i.computeMask(o,c));const v=BI(e),b=Array.isArray(v)?v:[v];for(let t=0;t<b.length;++t){d.hasKey(b[t])||d.add(b[t],g[t],Array.isArray(y)?y[0]:y);const e=s.indexOf(b[t].name);-1!==e&&(u[e]=g[t])}a||hi(l)}return d.disposeMasks(),i?u:u[0]}function RI(e){const t={};for(const n in e)t[n]=e[n].size;return t}function zI(e,t){const n=new Set,r=[],a={};for(const s of t.names())n.add(s);const i=[],o=[];for(i.push(e);i.length>0;){const e=i[i.length-1];if(n.has(e.name)){i.pop();continue}const t=o[o.length-1]===i.length-1;if(0===e.inputs.length||t)i.pop(),r.push(e),n.add(e.name),t&&o.pop();else{o.push(i.length-1);for(const t of e.inputs)null==a[t.name]&&(a[t.name]=new Set),a[t.name].add(e.name),n.has(t.name)||i.push(t)}}return{sorted:r,recipientMap:a}}function BI(e){let t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{let n=null;for(let t=0;t<e.sourceLayer.inboundNodes.length;++t)for(const r of e.sourceLayer.inboundNodes[t].outputTensors)if(r.id===e.id){n=t;break}t=e.sourceLayer.getOutputAt(n)}return t}function LI(e,t){return pi((()=>Io(Nc(Do(e,e),t,!0))))}ye().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",(()=>100),(function(e){null!=_I&&_I.setMaxEntries(e),null!=MI&&MI.setMaxEntries(e)}));class PI extends zo{getConfig(){return{}}}class UI extends PI{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return pi((()=>{const t=LI(e,this.axis),n=Bu(t,0,this.maxValue);return Do(e,To(n,Eo(ID(),t)))}))}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}UI.className="MaxNorm",Lo(UI);class WI extends PI{constructor(e){super(),this.defaultAxis=0,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return pi((()=>To(e,Eo(ID(),LI(e,this.axis)))))}getConfig(){return{axis:this.axis}}}WI.className="UnitNorm",Lo(WI);class VI extends PI{apply(e){return Hl(e)}}VI.className="NonNeg",Lo(VI);class qI extends PI{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=e.minValue?e.minValue:this.defaultMinValue,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.rate=null!=e.rate?e.rate:this.defaultRate,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return pi((()=>{const t=LI(e,this.axis),n=Eo(Do(this.rate,Bu(t,this.minValue,this.maxValue)),Do(1-this.rate,t));return Do(e,To(n,Eo(ID(),t)))}))}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}qI.className="MinMaxNorm",Lo(qI);const jI={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function GI(e){return XT(e)}function HI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return $T(e,Bo.getMap().classNameMap,t,"constraint")}function KI(e){if(null==e)return null;if("string"===typeof e){return HI({className:e in jI?jI[e]:e,config:{}})}return e instanceof PI?e:HI(e)}async function XI(e){if(null==e)return;const t=[],n=[],r=[];for(const a in e){const i=e[a];if("number"!==typeof i){const e=i;t.push(e.data()),n.push(a),r.push(e)}}if(t.length>0){const a=await Promise.all(t);for(let t=0;t<a.length;++t)e[n[t]]=a[t][0];hi(r)}}function YI(e){if(null!=e)for(const t in e){const n=e[t];"number"!==typeof n&&n.dispose()}}var $I;!function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}($I||($I={}));class ZI{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class QI{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;null==e&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){null==e&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){null==e&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class JI extends ZI{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){null==t&&(t={});const n=null==t.size?0:t.size;this.seen+=n;for(const r in t){const e=t[r];if("number"===typeof e)this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+e*n;else{let t;r in this.totals?t=this.totals[r]:this.totals[r]=0;const a=pi((()=>Eo(this.totals[r],Do(e,n))));this.totals[r]=a,null!=t&&t.dispose()}}}async onEpochEnd(e,t){if(null!=t)for(const n of this.params.metrics)null!=this.totals[n]&&("number"===typeof this.totals[n]?t[n]=this.totals[n]/this.seen:pi((()=>{const e=Do(To(1,this.seen),this.totals[n]);t[n]=e,this.totals[n].dispose(),di(t[n])})))}}class eA extends ZI{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){null==t&&(t={}),this.epoch.push(e);for(const n in t)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){const e=[],t=[],n=[];for(const a in this.history){const r=this.history[a];for(let i=0;i<r.length;++i)if("number"!==typeof r[i]){const o=r[i];e.push(o.data()),t.push(a),n.push(i)}}const r=await Promise.all(e);for(let a=0;a<r.length;++a){this.history[t[a]][n[a]].dispose(),this.history[t[a]][n[a]]=r[a][0]}}}class tA extends ZI{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||dd,this.yieldEvery=t||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");ee(this.yieldEvery)&&(this.maybeWait=function(e,t,n){let r,a=null!=n?n():sa();return function(){const i=null!=n?n():sa();return i-a<t||(a=i,r=e(...arguments)),r}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){const r=[];null!=this.yield&&(await XI(n),r.push(this.yield(e,t,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,null!=this.epochBegin&&(await XI(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const n=[];null!=this.epochEnd&&(await XI(t),n.push(this.epochEnd(e,t))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){null!=this.batchBegin&&(await XI(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const n=[];null!=this.batchEnd&&(await XI(t),n.push(this.batchEnd(e,t))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):ee(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){null!=this.trainBegin&&(await XI(e),await this.trainBegin(e))}async onTrainEnd(e){null!=this.trainEnd&&(await XI(e),await this.trainEnd(e))}}function nA(e,t){if(null==e&&(e={}),e instanceof ZI)return[e];if(Array.isArray(e)&&e[0]instanceof ZI)return e;return jT(e).map((e=>new tA(e,t)))}class rA{constructor(){}static registerCallbackConstructor(e,t){B(e>=0&&Number.isInteger(e),(()=>"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(e))),rA.checkForDuplicate(t),null==rA.constructors[e]&&(rA.constructors[e]=[]),rA.constructors[e].push(t)}static checkForDuplicate(e){for(const t in rA.constructors){rA.constructors[+t].forEach((t=>{if(t===e)throw new zT("Duplicate callback constructor.")}))}}static clear(){rA.constructors={}}static createCallbacks(e){const t=[];for(const n in rA.constructors){const r=+n;e>=r&&t.push(...rA.constructors[r])}return t.map((e=>new e))}}function aA(e,t,n,r,a,i,o,s,u){const c=new eA,l=[new JI,...rA.createCallbacks(t)];null!=e&&l.push(...e),l.push(c);const p=new QI(l);return p.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:t,doValidation:s,metrics:u}),{callbackList:p,history:c}}function iA(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return $T(e,Bo.getMap().classNameMap,t,"layer",n)}function oA(e,t){return pi((()=>{"float32"!==e.dtype&&(e=No(e,"float32"));const n=Nc(WD(e),t,!0),r=Wo(n.shape,ID()),a=Io($o(n,r));return To(e,a)}))}function sA(e,t){return pi((()=>sl(WD(jo(t,e)),-1)))}function uA(e,t){return pi((()=>sl(Ho(jo(t,e)),-1)))}function cA(e,t){return pi((()=>{const n=jo(e,t),r=Bu(Ho(e),ID(),Number.MAX_VALUE),a=Ho(To(n,r));return Do(100,sl(a,-1))}))}function lA(e,t){return pi((()=>{const n=Bu(t,ID(),Number.MAX_VALUE),r=jc(Eo(1,n)),a=Bu(e,ID(),Number.MAX_VALUE),i=jc(Eo(1,a));return sl(WD(jo(r,i)),-1)}))}function pA(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return pi((()=>{if(n)t=pp(t);else{const e=Nc(t,t.shape.length-1,!0);t=To(t,e)}return t=Bu(t,ID(),1-ID()),Hc(Nc(Do(No(e,"float32"),jc(t)),t.shape.length-1))}))}function hA(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return pi((()=>{const r=No(Fc(function(e){const t=[kD(e.shape)];return vu(e,t)}(e)),"int32"),a=(t=Bu(t,ID(),1-ID())).shape;return pA(vu(vl(r,a[a.length-1]),a),t,n)}))}function dA(e,t){return pi((()=>{let n;return n=Bu(t,ID(),1-ID()),n=jc(To(n,jo(1,n))),sl(function(e,t){if(!W(e.shape,t.shape))throw new zT("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return pi((()=>{const n=Hl(t),r=Hc(Ho(t));return Eo(jo(n,Do(t,e)),Gc(Cc(r)))}))}(e,n),-1)}))}function fA(e,t){return pi((()=>{const n=Bu(e,ID(),1),r=Bu(t,ID(),1);return Nc(Do(e,jc(To(n,r))),-1)}))}function mA(e,t){return pi((()=>{const n=oA(e,-1),r=oA(t,-1),a=Do(n,r);return Hc(Nc(a,-1))}))}rA.constructors={};const gA={meanSquaredError:sA,meanAbsoluteError:uA,meanAbsolutePercentageError:cA,meanSquaredLogarithmicError:lA,squaredHinge:function(e,t){return pi((()=>{const n=$o(0,jo(1,Do(e,t)));return sl(WD(n),-1)}))},hinge:function(e,t){return pi((()=>{const n=$o(0,jo(1,Do(e,t)));return sl(n,-1)}))},categoricalHinge:function(e,t){return pi((()=>{const n=Nc(Do(e,t),-1),r=xc(Do(jo(1,e),t),-1);return $o(0,Eo(1,jo(r,n)))}))},logcosh:function(e,t){return pi((()=>{const n=Math.log(2),r=jo(t,e),a=jo(Eo(r,Kc(Do(-2,r))),n);return sl(a,-1)}))},categoricalCrossentropy:pA,sparseCategoricalCrossentropy:hA,binaryCrossentropy:dA,kullbackLeiblerDivergence:fA,poisson:function(e,t){return pi((()=>{const n=jc(Eo(ID(),t));return sl(jo(t,Do(e,n)),-1)}))},cosineProximity:mA};function yA(e){if("string"===typeof e){if(e in gA)return gA[e];let t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new zT(t)}return e}function vA(e,t){return pi((()=>{const n=Do(.5,bl(t)),r=AD(Mc(t,n),e.dtype);return sl(ac(e,r),-1)}))}function bA(e,t){return pi((()=>AD(ac($s(e,-1),$s(t,-1)),"float32")))}function xA(e,t){return pi((()=>No(Nc(Zc(ac(e,1),ac(t,1))),"float32")))}function wA(e,t){return dA(e,t)}function NA(e,t){return e.rank===t.rank&&(e=vp(e,[e.rank-1])),(t=$s(t,-1)).dtype!==e.dtype&&(t=No(t,e.dtype)),No(ac(e,t),"float32")}const SA=pA,kA=hA,EA={binaryAccuracy:vA,categoricalAccuracy:bA,precision:function(e,t){return pi((()=>{const n=xA(e,t),r=function(e,t){return pi((()=>No(Nc(Zc(ac(e,0),ac(t,1))),"float32")))}(e,t),a=Eo(n,r);return No(ic(Mc(a,0),To(n,a),0),"float32")}))},categoricalCrossentropy:SA,sparseCategoricalCrossentropy:kA,mse:sA,MSE:sA,mae:uA,MAE:uA,mape:cA,MAPE:cA,cosine:mA};function CA(e){if("string"===typeof e&&e in EA)return EA[e];if("string"!==typeof e&&null!=e)return e;throw new zT("Unknown metric ".concat(e))}function TA(e){if(WT(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"===typeof e)return e;{let t;for(const n of Object.keys(gA))if(gA[n]===e){t=n;break}if(void 0!==t)return t;for(const n of Object.keys(EA))if(EA[n]===e){t=n;break}return void 0!==t?t:e.name}}const DA=1048576;function IA(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!==typeof e||Object.getPrototypeOf(e)!==Object.prototype||!AA(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(e);n.length>DA&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(n.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(DA,"."))}}function AA(e){if(null===e)return!0;if("object"===typeof e){if(Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);for(const n of t){if("string"!==typeof n)return!1;if(!AA(e[n]))return!1}return!0}if(Array.isArray(e)){for(const t of e)if(!AA(t))return!1;return!0}return!1}{const t=typeof e;return"string"===t||"number"===t||"boolean"===t}}function FA(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log;const a=function(e){let t=!0;const n=[],r=[];for(const a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(const a of n){if(a.length>1||1===a.length&&a[0].inboundLayers.length>1){t=!1;break}r.push(...a)}if(t)for(const a of e.layers){let e=!1;for(const n of a.inboundNodes)if(-1!==r.indexOf(n)){if(e){t=!1;break}e=!0}if(!t)break}return t}(e),i=["Layer (type)","Input Shape","Output shape","Param #"];let o;if(a?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map((e=>Math.floor(t*e)))),!a){i.push("Receives inputs"),o=[];for(const t in e.nodesByDepth)o.push(...e.nodesByDepth[t])}r("_".repeat(t)),_A(i,n,r),r("=".repeat(t));const s=e.layers;for(let l=0;l<s.length;++l)a?MA(s[l],n,r):OA(s[l],n,o,r),r((l===s.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();const u=function(e){let t;t=null!=e.collectedTrainableWeights?vI(e.collectedTrainableWeights):vI(e.trainableWeights);return t}(e),c=vI(e.nonTrainableWeights);r("Total params: ".concat(u+c)),r("Trainable params: ".concat(u)),r("Non-trainable params: ".concat(c)),r("_".repeat(t))}function _A(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="";for(let a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r+=e[a],r=r.slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function MA(e,t,n){let r,a;try{a=e.inboundNodes.map((e=>JSON.stringify(e.inputShapes))).join(",")}catch(r5){a="multiple"}try{r=JSON.stringify(e.outputShape)}catch(r5){r="multiple"}const i=e.name,o=e.getClassName();_A(["".concat(i," (").concat(o,")"),a,r,e.countParams().toString()],t,n)}function OA(e,t,n,r){let a,i;try{i=e.inboundNodes.map((e=>JSON.stringify(e.inputShapes))).join(",")}catch(r5){i="multiple"}try{a=JSON.stringify(e.outputShape)}catch(r5){a="multiple"}const o=[];for(const l of e.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(l)))for(let e=0;e<l.inboundLayers.length;++e){const t=l.inboundLayers[e].name,n=l.nodeIndices[e],r=l.tensorIndices[e];o.push("".concat(t,"[").concat(n,"][").concat(r,"]"))}const s=e.name,u=e.getClassName(),c=0===o.length?"":o[0];_A(["".concat(s," (").concat(u,")"),i,a,e.countParams().toString(),c],t,r);for(let l=1;l<o.length;++l)_A(["","","","",o[l]],t,r)}function RA(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"===typeof n}function zA(e,t){if(null===e)return null;if("string"===typeof e)return HT(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){const n=[],r=e.length;for(let a=0;a<r;++a){const r=e[a];RA(t,a,r)?n.push(r):n.push(zA(r,t))}return n}{const t={};for(const n of Object.keys(e)){const r=e[n];if("name"===n&&"string"===typeof r)t[n]=r;else{const e=HT(n);t[e]=zA(r,e)}}return t}}function BA(e,t){if(null===e||void 0===e)return null;if("string"===typeof e)return GT(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){const n=[],r=e.length;for(let a=0;a<r;++a){const r=e[a];RA(t,a,r)?n.push(r):n.push(BA(r,t))}return n}{const t={};for(const n of Object.keys(e)){const r=e[n],a=GT(n);t[a]="name"!==n&&"className"!==n||"string"!==typeof r?BA(r,n):r}return t}}const LA="4.22.0";class PA extends DI{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,null==this.name){const e=this.getClassName().toLowerCase();this.name=uD(e)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],QT(this.inputs).length!==this.inputs.length)throw new zT("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(this.inputs.map((e=>e.name))));QT(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(this.outputs.map((e=>e.name)))),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const e=y.sourceLayer,t=y.nodeIndex,n=y.tensorIndex;this.outputLayers.push(e),this.outputLayersNodeIndices.push(t),this.outputLayersTensorIndices.push(n)}for(const y of this.inputs){const e=y.sourceLayer,t=y.nodeIndex,n=y.tensorIndex;WT(0===t,"input layer has >1 nodes"),WT(0===n,"input layer has >1 tensors"),this.inputLayers.push(e),this.inputLayersNodeIndices.push(t),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const t=this.inputLayers[y];if(!(t instanceof AI))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(y," (0-based) originates ")+"from layer type ".concat(t.getClassName(),"."));this.inputNames.push(t.name),this.feedInputShapes.push(t.batchInputShape),this.feedInputNames.push(t.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map((e=>e.shape)),this.internalOutputShapes=this.outputs.map((e=>e.shape));const t={},n={},r={},a={},i={},o=[],s=(e,t,n,r,a,u)=>{null!=r&&null!=a&&null!=u||(r=e.sourceLayer,a=e.nodeIndex,u=e.tensorIndex);const c=r.inboundNodes[a];if(-1!==n.indexOf(c))throw new RT("The tensor ".concat(e.name,' at layer "').concat(r.name,'" ')+"is part of a cycle.");if(-1!==t.indexOf(c))return;this.containerNodes.add(PA.nodeKey(r,a)),r.id in i||(i[r.id]=Object.keys(i).length),-1===n.indexOf(c)&&n.push(c);const l=c.inboundLayers.length;for(let i=0;i<l;i++){const e=c.inputTensors[i],r=c.inboundLayers[i],a=c.nodeIndices[i],o=c.tensorIndices[i];s(e,t,n,r,a,o)}for(t.push(c);n.indexOf(c)>=0;)n.splice(n.indexOf(c),1);o.push(c)},u=[],c=[];for(const y of this.outputs)s(y,u,c);const l=o.slice().reverse();for(const y of l){n[y.id]=y,y.id in t||(t[y.id]=0);let e=t[y.id];const i=null==r[y.outboundLayer.id]?0:r[y.outboundLayer.id];e=Math.max(e,i),r[y.outboundLayer.id]=e,a[y.outboundLayer.id]=y.outboundLayer,t[y.id]=e;for(let r=0;r<y.inboundLayers.length;r++){const a=y.inboundLayers[r],i=y.nodeIndices[r],o=a.inboundNodes[i],s=null==t[o.id]?0:t[o.id];t[o.id]=Math.max(e+1,s),n[o.id]=o}}const p={};for(const y in t){const e=t[y];e in p||(p[e]=[]),p[e].push(n[y])}const h={};for(const y in r){const e=r[y];e in h||(h[e]=[]),h[e].push(a[y])}let d=Object.keys(h).map((e=>parseInt(e,10))).sort(ZT);this.layers=[];for(const y of d){const e=h[y];e.sort(((e,t)=>{const n=i[e.id],r=i[t.id];return n<r?-1:n>r?1:0}));for(const t of e)t instanceof PA&&this.internalContainerRefs.push(t),this.layers.push(t)}this.layersByDepth=h,d=Object.keys(p).map((e=>parseInt(e,10))).sort(ZT);const f=this.inputs.slice(),m=[];for(const y of d)for(const e of p[y]){const t=e.outboundLayer;if(null!=t){for(const n of e.inputTensors)if(-1===f.indexOf(n))throw new RT("Graph disconnected: cannot obtain value for tensor ".concat(n)+' at layer "'.concat(t.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(m));for(const t of e.outputTensors)f.push(t);m.push(t.name)}}this.nodesByDepth=p;const g=this.layers.map((e=>e.name));for(const y of g){const e=g.filter((e=>e===y)).length;if(1!==e)throw new RT('The name "'.concat(y,'" is used ').concat(e," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new CI({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map((e=>null)),outputMasks:this.outputs.map((e=>null)),inputShapes:this.inputs.map((e=>e.shape)),outputShapes:this.outputs.map((e=>e.shape))}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach((t=>{t._trainableWeights.forEach((t=>t.trainable=e))})),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new zT("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const e of this.layers)t.push(...e.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n={};let r=0;const a=(e=>{const t=Object.keys(e);if(0===t.length)return!1;const n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))})(e);a&&this.parseWeights(e);for(const o of this.layers)for(const[e,t]of o.weights.entries()){const i=a?"".concat(t.name.split("/").slice(0,-1).join("/")+"/").concat(e):t.originalName;if(null!=n[i])throw new zT("Duplicate weight name: ".concat(i));n[i]=t,r++}const i=[];for(const o in e){let r=o;if(null==n[o]){const e=o.split("/");r=e.slice(0,-2).concat([e[e.length-1]]).join("/")}if(null!=n[r])i.push([n[r],e[o]]);else if(t)throw new zT("Provided weight data has no target variable: ".concat(o));delete n[r]}if(t){const e=[];for(const t in n)e.push(t);if(e.length>0)throw new zT("".concat(e.length," of ").concat(r," weights are not set: ")+"".concat(e))}NI(i)}parseWeights(e){for(const t in Object.keys(e)){const n=t.split("/"),r=["vars","layer_checkpoint_dependencies"],a=n.map((e=>e.startsWith("_")?e.slice(1):e)).filter((e=>!r.includes(e))).join("/");a!==t&&(e[a]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(LA),t.backend="TensorFlow.js",t}toJSON(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=BA(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return pi((()=>{e=jT(e);const n=new FI;for(let t=0;t<this.inputs.length;++t)n.add(this.inputs[t],e[t]);return OI(this.outputs,n,t)}))}computeMask(e,t){return pi((()=>{let n;return e=jT(e),n=null==t?UT(null,e.length):jT(t),this.runInternalGraph(e,n)[1]}))}computeOutputShape(e){const t=mI(e);if(t.length!==this.inputLayers.length)throw new zT("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));const n={};for(let o=0;o<t.length;o++){const e=this.inputLayers[o],r=t[o];n[e.name+"_0_0"]=r}const r=Object.keys(this.nodesByDepth).map((e=>parseInt(e,10))).sort(ZT);if(r.length>1)for(const o of r){const e=this.nodesByDepth[o];for(const t of e){const e=t.outboundLayer;if(-1!==this.inputLayers.map((e=>e.id)).indexOf(e.id))continue;const r=[];for(let o=0;o<t.inboundLayers.length;o++){const e=t.inboundLayers[o],a=t.nodeIndices[o],i=t.tensorIndices[o],s=n["".concat(e.name,"_").concat(a,"_").concat(i)];r.push(s)}const a=mI(e.computeOutputShape(qT(r))),i=e.inboundNodes.indexOf(t);for(let t=0;t<a.length;t++){n["".concat(e.name,"_").concat(i,"_").concat(t)]=a[t]}}}const a=[],i=[];for(let o=0;o<this.outputLayers.length;o++){const e=this.outputLayers[o],t=this.outputLayersNodeIndices[o],n=this.outputLayersTensorIndices[o],r="".concat(e.name,"_").concat(t,"_").concat(n);i.push(r)}for(let o=0;o<i.length;o++){const e=i[o];WT(e in n),a.push(n[e])}return qT(a)}runInternalGraph(e,t){null==t&&(t=UT(null,e.length));const n={};for(let s=0;s<this.inputs.length;++s){const r=this.inputs[s],a=e[s],i=t[s];n[r.id]=[a,i]}const r=Object.keys(this.nodesByDepth).map((e=>parseInt(e,10))).sort(ZT);for(const s of r){const e=this.nodesByDepth[s];for(const t of e){const e=t.outboundLayer,r=t.inputTensors,a=t.outputTensors,i=new Array;for(const t of r)t.id in n&&i.push(n[t.id]);if(i.length===r.length){let r,o,s,u,c={};if(null!=t.callArgs&&(c=t.callArgs),1===i.length){const[t,n]=i[0];null==c.mask&&(c.mask=n),s=jT(e.call(t,c)),u=jT(e.computeMask(t,n)),r=[t],o=[n]}else r=i.map((e=>e[0])),o=i.map((e=>e[1])),null==c.mask&&(c.mask=o),s=jT(e.call(r,c)),u=jT(e.computeMask(r,o));if(e.activityRegularizer)throw new BT("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let e=0;e<a.length;++e){const t=a[e],r=s[e],i=u[e];n[t.id]=[r,i]}}}}const a=[],i=[],o=[];for(const s of this.outputs){WT(s.id in n,"Could not compute output ".concat(s.name," : ").concat(s.id));const[e,t]=n[s.id];o.push(e.shape),a.push(e),i.push(t)}return[a,i,o]}buildNodeConversionMap(e){const t={};let n;for(const r of this.layers){n=r instanceof PA?1:0;for(let e=0;e<r.inboundNodes.length;e++){const a=PA.nodeKey(r,e);this.containerNodes.has(a)&&(t[a]=n,n+=1)}}return t}getLayer(e,t){if(null!=t)return this.findLayer(t);if(null==e)throw new zT("Provide either a layer name or layer index");if("number"===typeof e)return this.findLayer(e);for(const n of this.layers)if(n.name===e)return n;throw new zT("No such layer: ".concat(e))}findLayer(e){if(this.layers.length<=e)throw new zT("Was asked to retrieve layer at index ".concat(e,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[e]}calculateLosses(){return pi((()=>{const e=[];for(const t of this.layers)for(let n=0;n<t.inboundNodes.length;++n){const r=PA.nodeKey(t,n);this.containerNodes.has(r)&&e.push(...t.calculateLosses())}return e}))}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),n=[];for(const i of this.layers){const e=i.getClassName(),r=i.getConfig(),a=[];for(let n=0;n<i.inboundNodes.length;n++){const e=i.inboundNodes[n],r=PA.nodeKey(i,n);let o={};if(this.containerNodes.has(r)){if(e.callArgs)try{JSON.stringify(e.callArgs),o=e.callArgs}catch(r5){console.warn("Layer ".concat(i.name," was passed ")+"non-serializable keyword arguments: "+"".concat(e.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),o={}}if(e.inboundLayers.length>0){const n=[];for(let r=0;r<e.inboundLayers.length;r++){const a=e.inboundLayers[r],i=e.nodeIndices[r],s=e.tensorIndices[r];let u=t[PA.nodeKey(a,i)];null==u&&(u=0),n.push([a.name,u,s,o])}a.push(n)}}}const o={};o.name=i.name,o.className=e,o.config=r,o.inboundNodes=a,n.push(o)}e.layers=n;const r=[];for(let i=0;i<this.inputLayers.length;i++){const e=this.inputLayers[i],n=this.inputLayersNodeIndices[i],a=PA.nodeKey(e,n);if(!this.containerNodes.has(a))continue;let o=t[a];null!==o&&void 0!==o||(o=0);const s=this.inputLayersTensorIndices[i];r.push([e.name,o,s])}e.inputLayers=r;const a=[];for(let i=0;i<this.outputLayers.length;i++){const e=this.outputLayers[i],n=this.outputLayersNodeIndices[i],r=PA.nodeKey(e,n);if(!this.containerNodes.has(r))continue;let o=t[r];null!==o&&void 0!==o||(o=0);const s=this.outputLayersTensorIndices[i];a.push([e.name,o,s])}return e.outputLayers=a,e}static fromConfig(e,t){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r={},a={};function i(e,t){e.name in a?a[e.name].push(t):a[e.name]=[t]}function o(e,t){const n=[];let a;for(const o of t){const s=o[0],u=o[1],c=o[2];if(a=null==o[3]?{}:o[3],!(s in r))return void i(e,t);const l=r[s];if(l.inboundNodes.length<=u)return void i(e,t);const p=l.inboundNodes[u];n.push(p.outputTensors[c])}n.length>0&&e.apply(qT(n),a)}function s(e){const a=e.name,o=iA(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(n),r[a]=o;e.inboundNodes.forEach((e=>{if(!(e instanceof Array))throw new zT("Corrupted configuration, expected array for nodeData: ".concat(e));i(o,e)}))}const u=t.name,c=t.layers;for(const f of c)s(f);for(;!JT(a);)for(const e of c){const t=r[e.name];if(t.name in a){const e=a[t.name];delete a[t.name];for(const n of e)o(t,n)}}const l=[],p=[],h=t.inputLayers;for(const f of h){const e=f[0],t=f[1],n=f[2];WT(e in r);const a=r[e].inboundNodes[t].outputTensors;l.push(a[n])}const d=t.outputLayers;for(const f of d){const e=f[0],t=f[1],n=f[2];WT(e in r);const a=r[e].inboundNodes[t].outputTensors;p.push(a[n])}return new e({inputs:l,outputs:p,name:u})}get stateful(){if(this._stateful)throw new zT("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){pi((()=>{this.layers.forEach((e=>{e.stateful&&e.resetStates()}))}))}}function UA(e,t,n){const r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((e=>null));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"===typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"===typeof e&&Object.keys(e).length>0&&"object"===typeof e[Object.keys(e)[0]]){const n=[];return t.forEach((t=>{t in e?n.push(e[t]):n.push(null)})),n}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(t," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(e)))}function WA(e,t){return UA(e,t,"classWeight")}async function VA(e,t,n,r){if(null!=t||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const t=pi((()=>{if(1===e.shape.length)return So(e);if(2===e.shape.length){if(e.shape[1]>1){return $s(e,1)}if(1===e.shape[1])return vu(e,[e.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(e.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(e.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),r=Array.from(await t.data());hi(t);const a=[];return r.forEach((e=>{if(null==n[e])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");a.push(n[e])})),Sp(a,"float32")}return null}function qA(e,t){return Do(e,t)}function jA(e,t){let n,r;const a=t;n=a.xs,r=a.ys,B(null!=n&&null!=r,(()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t)));const i=GA("input",e.inputNames,n),o=GA("output",e.outputNames,r),s=i[0].shape[0];B(i.length===e.inputs.length,(()=>"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(i.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")"))),B(o.length===e.outputs.length,(()=>"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(o.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")")));for(let u=0;u<i.length;u++)B(i[u].shape[0]===s,(()=>"Batch size mismatch: input "+"".concat(e.inputNames[u]," has ").concat(i[u].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")));for(let u=0;u<o.length;u++)B(o[u].shape[0]===s,(()=>"Batch size mismatch: output "+"".concat(e.outputNames[u]," has ").concat(o[u].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")));return{xs:i,ys:o}}function GA(e,t,n){if(n instanceof ka)return[n];if(Array.isArray(n))return B(n.length===t.length,(()=>"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,"."))),n;{const r=[];for(const a of t){if(null==n[a])throw new zT("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(a,"'."));r.push(n[a])}return r}}async function HA(e,t,n){const r=null!=n.batchesPerEpoch;if(B(null!=e.optimizer,(()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig).")),B(null!=n,(()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call.")),B(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),(()=>"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(n.epochs))),B(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),(()=>"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(n.batchesPerEpoch))),B(null==n.validationSplit,(()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead.")),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{const a=null!=n.validationData;let i,o;if(a)if(KA(n.validationData))B(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),(()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(n.validationBatches)));else{const e=function(e){if(3===e.length)throw new BT("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}(n.validationData);i=e.xs,o=e.ys}const s=e.makeTrainFunction(),u=e.getDedupedMetricsNames();let c;c=a?u.slice().concat(u.map((e=>"val_"+e))):u.slice();const l=nA(n.callbacks,n.yieldEvery),p=null==n.verbose?1:n.verbose,{callbackList:h,history:d}=aA(l,p,n.epochs,null,null,function(e,t){let n=null;null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size);return n}(t,n),null,a,c);h.setModel(e),e.history=d,await h.onTrainBegin(),e.stopTraining_=!1;let f=null==n.initialEpoch?0:n.initialEpoch,m=await t.iterator();for(;f<n.epochs;){const c={};await h.onEpochBegin(f);let l=0,p=0;for(r||(m=await t.iterator());!r||l<n.batchesPerEpoch;){const t=await m.next();if(r&&t.done){console.warn("You provided `batchesPerEpoch` as "+"".concat(n.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(l," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(n.batchesPerEpoch*n.epochs," batches). ")+"You may need to use the repeat() function when building your dataset.");break}if(null!=t.value){const{xs:r,ys:a}=jA(e,t.value),i={};i.batch=p,i.size=r[0].shape[0],await h.onBatchBegin(p,i);const o=[];if(null!=n.classWeight){const t=WA(n.classWeight,e.outputNames);for(let e=0;e<t.length;++e)o.push(await VA(a[e],null,t[e]))}const c=r.concat(a).concat(o),d=s(c);hi(c);for(let e=0;e<u.length;++e){const t=u[e],n=d[e];i[t]=n,di(n)}await h.onBatchEnd(p,i),YI(i),p++,l++}if(r?l>=n.batchesPerEpoch:t.done){if(a){let t;t=KA(n.validationData)?jT(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):jT(e.evaluate(i,o,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<e.metricsNames.length;++n)c["val_".concat(e.metricsNames[n])]=t[n]}break}if(e.stopTraining_)break}if(await h.onEpochEnd(f,c),f++,e.stopTraining_)break}return await h.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function KA(e){return"function"===typeof e.iterator}function XA(e){B(e>0&&Number.isInteger(e),(()=>"batchSize is required to be a positive integer, but got ".concat(e)))}function YA(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((e=>_D(e,t,n-t))):_D(e,t,n-t)}function $A(e,t){return pi((()=>null==e?null:Array.isArray(e)?e.map((e=>$A(e,t))):UD(e,"int32"===t.dtype?t:No(t,"int32"))))}function ZA(e,t){const n=[];let r=0,a=null;for(;r<e;)a=r+t,a>=e&&(a=e),n.push([r,a]),r=a;return n}function QA(e){const t=[];e instanceof ka&&(e=[e]);for(let n=0;n<e.length;++n){const r=e[n];if(1===r.rank)t.push(FD(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function JA(e,t){if(null==e)return;const n=[];if(t instanceof ka)n.push(t.id);else if(Array.isArray(t))t.forEach((e=>n.push(e.id)));else if(null!=t)for(const a in t){const e=t[a];n.push(e.id)}const r=[];if(e instanceof ka)-1===n.indexOf(e.id)&&r.push(e);else if(Array.isArray(e))e.forEach((e=>{-1===n.indexOf(e.id)&&r.push(e)}));else if(null!=e)for(const a in e){const t=e[a];-1===n.indexOf(t.id)&&r.push(t)}r.forEach((e=>{e.isDisposed||e.dispose()}))}function eF(e){return Array.isArray(e)}function tF(e){return!function(e){return e instanceof ka}(e)&&!eF(e)}function nF(e,t,n){let r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){let t=!1;if(eF(e)&&e.length>0)t=!0;else if(tF(e)){for(const n in e)if(e.hasOwnProperty(n)){t=!0;break}}else t=!0;if(t)throw new zT("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map((e=>null));if(tF(e)){r=[];for(const n of t){if(null==e[n])throw new zT('No data provided for "'.concat(n,'". Need data for each key in: ')+"".concat(t));r.push(e[n])}}else if(eF(e)){if(e.length!==t.length)throw new zT("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));r=e}else{if(t.length>1)throw new zT("The model ".concat(i," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));r=[e]}if(r=QA(r),null!=n)for(let o=0;o<t.length;++o){if(null==n[o])continue;const e=r[o];if(e.shape.length!==n[o].length)throw new zT("Error when checking ".concat(i,": expected ").concat(t[o]," ")+"to have ".concat(n[o].length," dimension(s). but got array with ")+"shape ".concat(e.shape));for(let t=0;t<n[o].length;++t){if(0===t&&!a)continue;const r=e.shape[t],s=n[o][t];if(null!=s&&s>=0&&r!==s)throw new zT("".concat(i," expected a batch of elements where each ")+"example has shape [".concat(n[o].slice(1,n[o].length),"] ")+"(i.e.,tensor shape [*,".concat(n[o].slice(1,n[o].length),"])")+" but the ".concat(i," received an input with ").concat(e.shape[0])+" examples, each with shape [".concat(e.shape.slice(1,e.shape.length),"]")+" (tensor shape [".concat(e.shape,"])"))}}return r}function rF(e,t,n){let r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new zT("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));r=e}else{if(t.length>1)throw new zT("The model expects ".concat(t.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));r=[e]}if(null!=n)for(let o=0;o<t.length;++o){if(null==n[o])continue;const e=r[o];if(e.shape.length!==n[o].length)throw new zT("Error when checking ".concat(i,": expected ").concat(t[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(e.shape)));for(let r=0;r<n[o].length;++r){if(0===r&&!a)continue;const s=e.shape[r],u=n[o][r];if(null!=u&&u!==s)throw new zT("Error when checking ".concat(i,": expected ")+"".concat(t[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(e.shape),"."))}}}class aF extends PA{constructor(e){super(e),this.isTraining=!1}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new zT("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");FA(this,e,t,n)}compile(e){if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"===typeof e.optimizer)this.optimizer_=function(e){const t={Adagrad:()=>pd.adagrad(.01),Adadelta:()=>pd.adadelta(1,.95,ID()),Adam:()=>pd.adam(.001,.9,.999,ID()),Adamax:()=>pd.adamax(.002,.9,.999,ID(),0),RMSProp:()=>pd.rmsprop(.001,.9,0,ID()),SGD:()=>pd.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new zT("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Po))throw new zT("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(Array.isArray(e.loss)||"string"===typeof e.loss||"function"===typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new zT("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));const n=e.loss;t=n.map((e=>yA(e)))}else{const n=yA(e.loss);this.outputs.forEach((e=>{t.push(n)}))}else{e.loss=e.loss;for(const t in e.loss)if(-1===this.outputNames.indexOf(t))throw new zT('Unknown entry in loss dictionary: "'.concat(t,'". ')+"Only expected the following keys: ".concat(this.outputNames));for(const n of this.outputNames)null==e.loss[n]&&console.warn('Output "'.concat(n,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(n," during training")),t.push(yA(e.loss[n]))}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const e=this.internalOutputShapes[i],t=this.outputNames[i];this.feedOutputNames.push(t),this.feedOutputShapes.push(e),this.feedLossFns.push(this.lossFunctions[i])}const n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],bD("loss",(()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;const t=this.lossFunctions[e];this.outputs.length>1&&(this.metricsTensors.push([t,e]),this.metricsNames.push(this.outputNames[e]+"_loss"))}}));const r=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((e=>[]));let n;if("string"===typeof e||"function"===typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!==typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map((e=>n));{const e=[];for(const r of t){let t=n.hasOwnProperty(r)?n[r]:[];Array.isArray(t)||(t=[t]),e.push(t)}return e}}(e.metrics,this.outputNames),a=(e,t,n)=>{this.outputNames.length>1&&(t=this.outputNames[e]+"_"+t),this.metricsNames.push(t),this.metricsTensors.push([n,e])};bD("metric",(()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;(t=>{let n,r,i;for(const o of t){if("string"===typeof o&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(o)){const t=this.internalOutputShapes[e];let a;1===t[t.length-1]||this.lossFunctions[e]===dA?-1!==["accuracy","acc"].indexOf(o)?r=vA:-1!==["crossentropy","ce"].indexOf(o)&&(r=wA):this.lossFunctions[e]===hA?-1!==["accuracy","acc"].indexOf(o)?r=NA:-1!==["crossentropy","ce"].indexOf(o)&&(r=kA):-1!==["accuracy","acc"].indexOf(o)?r=bA:-1!==["crossentropy","ce"].indexOf(o)&&(r=SA),-1!==["accuracy","acc"].indexOf(o)?a="acc":-1!==["crossentropy","ce"].indexOf(o)&&(a="ce"),i=r,n=""+a}else{const e=CA(o);i=e,n=""+TA(o)}let t;bD(n,(()=>{t=i})),a(e,n,t)}})(r[e])}})),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=null==n.batchSize?32:n.batchSize;XA(r);const a=this.standardizeUserDataXY(e,t,!0,r);try{const e=a[0].concat(a[1]);this.makeTestFunction();const t=this.testFunction;return qT(this.testLoop(t,e,r,n.verbose,n.steps))}finally{JA(a[0],e),JA(a[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),async function(e,t,n){const r=null!=(n=n||{}).batches,a=e.testFunction;let i=[];if(n.verbose>0)throw new BT("Verbose mode is not implemented yet.");B(!r||n.batches>0&&Number.isInteger(n.batches),(()=>"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(n.batches))));const o="function"===typeof t.next?t:await t.iterator();let s=0,u=0;for(;!r||u<n.batches;){const t=await o.next();if(i=pi((()=>{if(t.value){const{xs:n,ys:r}=jA(e,t.value),o=n.concat(r),c=pi((()=>a(o)));if(hi(o),0===u)for(let e=0;e<c.length;++e)i.push(Mo(0));const l=o[0].shape[0];for(let e=0;e<c.length;++e){const t=c[e],n=i[e];i[e]=pi((()=>Eo(i[e],Do(l,t)))),u>0&&hi(n)}hi(c),s+=l,++u}return i})),t.done){r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(n.batches," batches). ")+"You may need to use the repeat() function when building your dataset.");break}}for(let c=0;c<i.length;++c){const e=i[c];i[c]=To(i[c],s),hi(e)}return qT(i)}(this,e,t)}checkNumSamples(e,t,n){let r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new zT("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else{if(null==e)throw new zT("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}execute(e,t){if(Array.isArray(t)&&0===t.length)throw new zT("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(t),r=n?t:[t],a=this.retrieveSymbolicTensors(r),i=new FI;if(e instanceof ka&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new zT("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(let t=0;t<this.inputs.length;++t)i.add(this.inputs[t],e[t])}else for(const s of this.inputs){const t=e[s.name];if(null==t)throw new zT("No value is provided for the model's input ".concat(s.name));i.add(s,t)}const o=OI(a,i);return n?o:o[0]}retrieveSymbolicTensors(e){const t=UT(null,e.length);let n=e.length;for(const r of this.layers){const a=Array.isArray(r.output)?r.output:[r.output],i=a.map((e=>e.name));for(let r=0;r<e.length;++r){const o=i.indexOf(e[r]);if(-1!==o&&(t[r]=a[o],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw t.forEach(((t,r)=>{null==t&&n.push(e[r])})),new zT("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(n)))}return t}predictLoop(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return pi((()=>{const r=this.checkNumSamples(e);if(n)throw new BT("Verbose predictLoop() is not implemented yet.");const a=ZA(r,t),i=this.outputs.map((e=>[]));for(let t=0;t<a.length;++t){pi((()=>{const n=a[t][0],r=a[t][1],i=YA(e,n,r),o=[];if(Array.isArray(i))for(let e=0;e<i.length;++e)o.push({key:this.inputs[e],value:i[e]});else o.push({key:this.inputs[0],value:i});const s=new FI(o);return OI(this.outputs,s)})).forEach(((e,t)=>i[t].push(e)))}return qT(i.map((e=>wu(e,0))))}))}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=QA(e);rF(n,this.inputNames,this.feedInputShapes,!1);try{const e=null==t.batchSize?32:t.batchSize;return XA(e),this.predictLoop(n,e)}finally{JA(n,e)}}predictOnBatch(e){rF(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t){let n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new RT("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const r=[];for(let a=0;a<this.feedOutputShapes.length;++a){const e=this.feedOutputShapes[a];this.feedLossFns[a]===hA?r.push(e.slice(0,e.length-1).concat([1])):r.push(e)}if(function(e,t){const n=QT(e.map((e=>e.shape[0])));n.sort();const r=QT(t.map((e=>e.shape[0])));if(r.sort(),n.length>1)throw new zT("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((e=>e.shape)))));if(r.length>1)throw new zT("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((e=>e.shape)))));if(n.length>0&&r.length>0&&!W(n,r))throw new zT("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(n[0]," input sample(s) and ").concat(r[0]," target ")+"sample(s).")}(e=nF(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=nF(t,this.feedOutputNames,r,!1,"target")),function(e,t,n){const r=[sA,dA,pA];for(let a=0;a<e.length;++a){const i=e[a],o=t[a],s=n[a];if(null!=o){if(o===pA&&1===i.shape[i.shape.length-1])throw new zT("You are passing a target array of shape ".concat(i.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o)){const e=i.shape.slice(1),t=s.slice(1);for(let n=0;n<e.length;++n){const r=e[n],a=t[n];if(null!=a&&r!==a)throw new zT("A target Tensor with shape ".concat(i.shape," was passed for an ")+"output of shape ".concat(s,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new zT("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}async standardizeUserData(e,t,n,r){let a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5?arguments[5]:void 0;const[o,s]=this.standardizeUserDataXY(e,t,a,i);if(null!=n)throw new Error("sample weight is not supported yet.");let u=null;if(null!=r){const e=WA(r,this.outputNames);u=[];for(let t=0;t<e.length;++t)u.push(await VA(s[t],null,e[t]))}return[o,s,u]}testLoop(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4?arguments[4]:void 0;return pi((()=>{const i=this.checkNumSamples(t,n,a,"steps"),o=[];if(r>0)throw new BT("Verbose mode is not implemented yet.");if(null!=a)throw new BT("steps mode in testLoop() is not implemented yet");{const r=ZA(i,n),a=Sp(TD(0,i));for(let n=0;n<r.length;++n){const i=r[n][0],s=r[n][1],u=_D(a,i,s-i),c=$A(t,u),l=e(c);if(0===n)for(let e=0;e<l.length;++e)o.push(Mo(0));for(let e=0;e<l.length;++e){const t=l[e];o[e]=Eo(o[e],Do(s-i,t))}}for(let e=0;e<o.length;++e)o[e]=To(o[e],i)}return o}))}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){const r=e[n];let a=r;if(VT(e,r)>1){const t=VT(e.slice(0,n),r);a+="_".concat(t)}t.push(a)}return t}makeTrainFunction(){return e=>{const t=[],n=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),i=[],o=this.collectedTrainableWeights.map((e=>e.read()));return[this.optimizer_.minimize((()=>{const e=[];for(let t=0;t<this.inputs.length;++t)e.push({key:this.inputs[t],value:n[t]});const o=new FI(e),s=OI(this.outputs,o,{training:!0});let u;for(let n=0;n<this.lossFunctions.length;++n){let e=(0,this.lossFunctions[n])(r[n],s[n]);null!=a[n]&&(e=qA(e,a[n]));const i=sl(e);t.push(i),u=0===n?e:Eo(u,e)}for(let n=0;n<this.metricsTensors.length;++n){let e;if(this.outputs.length>1&&n<this.outputs.length)e=t[n];else{const t=this.metricsTensors[n][0],a=this.metricsTensors[n][1];e=sl(t(r[a],s[a]))}di(e),i.push(e)}return u=sl(u),this.calculateLosses().forEach((e=>{u=Eo(u,e)})),u}),!0,o)].concat(i)}}makeTestFunction(){this.testFunction=e=>pi((()=>{const t=[];let n;const r=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let e=0;e<this.inputs.length;++e)i.push({key:this.inputs[e],value:r[e]});const o=new FI(i),s=OI(this.outputs,o);for(let e=0;e<this.lossFunctions.length;++e){const r=this.lossFunctions[e],i=sl(r(a[e],s[e]));n=0===e?i:Eo(n,i),t.push(n)}for(let e=0;e<this.metricsTensors.length;++e){const n=this.metricsTensors[e][0],r=this.metricsTensors[e][1],i=sl(n(a[r],s[r]));t.push(i)}return t}))}async fit(e,t){let n,r,a,i,o,s,u,c,l,p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;try{const h=null==p.batchSize?32:p.batchSize;XA(h);const d=!1,f=await this.standardizeUserData(e,t,p.sampleWeight,p.classWeight,d,h);n=f[0],r=f[1],l=f[2];let m,g=!1;if(null!=p.validationData&&p.validationData.length>0){if(g=!0,2!==p.validationData.length)throw 3===p.validationData.length?new BT("validationData including sample weights is not supported yet."):new zT("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(p.validationData," is invalid."));o=p.validationData[0],s=p.validationData[1];const e=!0,t=await this.standardizeUserData(o,s,null,null,e,h);u=t[0],c=t[1],m=u.concat(c)}else if(null!=p.validationSplit&&p.validationSplit>0&&p.validationSplit<1){g=!0;const e=Math.floor(n[0].shape[0]*(1-p.validationSplit)),t=n[0].shape[0];u=YA(n,e,t),a=n,n=YA(n,0,e),c=YA(r,e,t),i=r,r=YA(r,0,e),m=u.concat(c)}else null!=p.validationSteps&&(g=!0);const y=n.concat(r).concat(l);this.checkTrainableWeightsConsistency();const v=this.makeTrainFunction(),b=this.getDedupedMetricsNames();let x,w;g?(this.makeTestFunction(),x=this.testFunction,w=b.slice().concat(b.map((e=>"val_"+e)))):(x=null,m=[],w=b.slice());const N=nA(p.callbacks,p.yieldEvery);return await this.fitLoop(v,y,b,h,p.epochs,p.verbose,N,x,m,p.shuffle,w,p.initialEpoch,null,null)}finally{this.isTraining=!1,JA(n,e),JA(r,t),JA(a,e),JA(i,t),JA(u,o),JA(c,s),null!=l&&hi(l)}}async fitLoop(e,t,n,r,a,i,o,s,u,c,l,p,h,d){null==r&&(r=32),null==a&&(a=1),null==c&&(c=!0),null==p&&(p=0);let f=!1;if(null!=s&&null!=u&&(f=!0),null!=d&&(f=!0,null==h))throw new zT("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const m=this.checkNumSamples(t,r,h,"steps_per_epoch");let g;null!=m&&(g=TD(0,m)),null==i&&(i=1);const{callbackList:y,history:v}=aA(o,i,a,p,m,h,r,f,l);y.setModel(this),this.history=v,await y.onTrainBegin(),this.stopTraining_=!1;for(let b=p;b<a;++b){await y.onEpochBegin(b);const a={};if(null!=h)throw new BT("stepsPerEpoch mode is not implemented yet.");{if("batch"===c)throw new BT("batch shuffling is not implemneted yet");c&&M(g);const i=Sp(g),o=ZA(m,r);for(let c=0;c<o.length;++c){const l={};if(await y.onBatchBegin(c,l),pi((()=>{const p=o[c][0],h=o[c][1],d=_D(i,p,h-p);l.batch=c,l.size=h-p;const m=$A(t,d),g=e(m);for(let e=0;e<n.length;++e){const t=n[e],r=g[e];l[t]=r,di(r)}if(c===o.length-1&&f){const e=this.testLoop(s,u,r);for(let t=0;t<n.length;++t){const r=n[t],i=e[t];di(i),a["val_"+r]=i}}})),await y.onBatchEnd(c,l),YI(l),this.stopTraining_)break}i.dispose()}if(await y.onEpochEnd(b,a),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return HA(this,e,t)}async trainOnBatch(e,t){const n=await this.standardizeUserData(e,t),r=n[0],a=n[1],i=this.makeTrainFunction()(r.concat(a)),o=[];for(const s of i){const e=await s.data();o.push(e[0])}return hi(i),JA(n[0],e),JA(n[1],t),qT(o)}getNamedWeights(e){const t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n);for(let i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const t=li().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-li().numTensors}return e}getLossIdentifiers(){let e;if("string"===typeof this.loss)e=GT(this.loss);else if(Array.isArray(this.loss)){for(const e of this.loss)if("string"!==typeof e)throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map((e=>GT(e)))}else{const t=Object.keys(this.loss);e={};const n=this.loss;for(const r of t){if("string"!==typeof n[r])throw new Error("Serialization of non-string loss is not supported.");e[r]=GT(n[r])}}return e}getMetricIdentifiers(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[GT(TA(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((e=>GT(TA(e))));{const e={};for(const t in this.metrics)e[t]=GT(TA(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const t=iA(zA(e.optimizer_config));let n,r;if("string"===typeof e.loss)n=HT(e.loss);else if(Array.isArray(e.loss))n=e.loss.map((e=>HT(e)));else if(null!=e.loss){n={};for(const t in e.loss)n[t]=HT(e.loss[t])}if(Array.isArray(e.metrics))r=e.metrics.map((e=>HT(e)));else if(null!=e.metrics){r={};for(const t in e.metrics)r[t]=HT(e.metrics[t])}this.compile({loss:n,metrics:r,optimizer:t})}async save(e,t){if("string"===typeof e){const t=Pi(e);if(0===t.length)throw new zT("Cannot find any save handlers for URL '".concat(e,"'"));if(t.length>1)throw new zT("Found more than one (".concat(t.length,") save handlers for ")+"URL '".concat(e,"'"));e=t[0]}if(null==e.save)throw new zT("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await bi(this.getNamedWeights(t)),r={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(LA),convertedBy:null};if(null!=t&&t.includeOptimizer&&null!=this.optimizer){r.trainingConfig=this.getTrainingConfig();const e="optimizer",{data:t,specs:a}=await bi(await this.optimizer.getWeights(),e);n.specs.push(...a),n.data=Ii([n.data,t])}if(null!=this.userDefinedMetadata){const e=!0;IA(this.userDefinedMetadata,this.name,e),r.userDefinedMetadata=this.userDefinedMetadata}return r.weightData=n.data,r.weightSpecs=n.specs,e.save(r)}setUserDefinedMetadata(e){IA(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}aF.className="Model",Lo(aF);class iF extends aF{}iF.className="Functional",Lo(iF);class oF extends aF{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=null!=e.name?e.name:uD("sequential_"),null!=e.layers)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some((e=>e<0)))throw new zT("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}add(e){const t=e instanceof oF||e instanceof aF;let n;if(t){if(n=e,1!==n.outputs.length)throw new zT("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new zT("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new zT("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const t=function(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new zT("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));let n=e.dtype;return null==n&&(n="float32"),new AI({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(t)}if(t)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==e.inboundNodes.length)throw new zT("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new zT("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=II(this.outputs[0])}this.inboundNodes=[],new CI({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:UT(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((e=>e.shape)),outputShapes:this.outputs[0].shape})}else{const t=e.apply(this.outputs[0]);if(Array.isArray(t))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[t],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return null==this.model&&this.build(),this.model.call(e,t)}build(e){if(yI(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new aF({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),super.summary(e,t,n)}setWeights(e){null==this.model&&this.build(),this.model.setWeights(e)}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new RT("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new RT("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new RT("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new RT("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t){let n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new zT("Legacy serialization format not supported yet.");n=t}else B(null!=t.layers,(()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field.")),n=t.layers,delete t.layers,a=t;const i=new e(a);if(!(i instanceof oF))throw new BT("Sequential.fromConfig called on non-Sequential input: ".concat(i));for(const o of n){const e=iA(o,void 0,r);r&&e.setFastWeightInitDuringBuild(!0),i.add(e)}return i}set stopTraining(e){if(null==this.model)throw new zT("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(null==this.model)throw new zT("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}}oF.className="Sequential",Lo(oF);class sF extends zo{getConfig(){return{}}}class uF extends sF{apply(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new BT("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return cc(e)}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}}uF.className="elu",Lo(uF);class cF extends sF{apply(e){return tp(e)}}cF.className="selu",Lo(cF);class lF extends sF{apply(e){return Hl(e)}}lF.className="relu",Lo(lF);class pF extends sF{apply(e){return pi((()=>pl(6,Hl(e))))}}pF.className="relu6",Lo(pF);class hF extends sF{apply(e){return e}}hF.className="linear",Lo(hF);class dF extends sF{apply(e){return Su(e)}}dF.className="sigmoid",Lo(dF);class fF extends sF{apply(e){return function(e){return pi((()=>{const t=Eo(.5,Do(.2,e));return Bu(t,0,1)}))}(e)}}fF.className="hardSigmoid",Lo(fF);class mF extends sF{apply(e){return Kc(e)}}mF.className="softplus",Lo(mF);class gF extends sF{apply(e){return function(e){return pi((()=>To(e,Eo(Ho(e),1))))}(e)}}gF.className="softsign",Lo(gF);class yF extends sF{apply(e){return Eu(e)}}yF.className="tanh",Lo(yF);class vF extends sF{apply(e){return pp(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}vF.className="softmax",Lo(vF);class bF extends sF{apply(e){return Yc(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}bF.className="logSoftmax",Lo(bF);class xF extends sF{apply(e){return pi((()=>pi((()=>{const t=Math.sqrt(2),n=Do(.5,Eo(1,pc(To(e,t))));return Do(e,n)}))))}}xF.className="gelu",Lo(xF);class wF extends sF{apply(e){return pi((()=>Do(.5,Do(e,Eo(1,Eu(Do(Io(To(2,Math.PI)),Eo(e,Do(.044715,qo(e,3))))))))))}}wF.className="gelu_new",Lo(wF);class NF extends sF{apply(e){return pi((()=>Do(e,Eu(Kc(e)))))}}NF.className="mish",Lo(NF);class SF extends sF{apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return pi((()=>Do(Su(Do(e,t)),e)))}}function kF(e){return e.getClassName()}function EF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return $T(e,Bo.getMap().classNameMap,t,"activation")}function CF(e){if(null==e){const e={className:"linear",config:{}};return EF(e)}if("string"===typeof e){const t={};return t.className=e,t.config={},EF(t)}return e instanceof sF?e:EF(e)}function TF(e){if(null!=e&&"object"!==typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}SF.className="swish",Lo(SF);class DF extends zo{}class IF extends DF{constructor(e){super(),TF(e),this.l1=null==e||null==e.l1?.01:e.l1,this.l2=null==e||null==e.l2?.01:e.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(e){return pi((()=>{let t=ul([1]);return this.hasL1&&(t=Eo(t,Nc(Do(this.l1,Ho(e))))),this.hasL2&&(t=Eo(t,Nc(Do(this.l2,WD(e))))),vu(t,[])}))}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}IF.className="L1L2",Lo(IF);const AF={l1l2:"L1L2"};function FF(e){return XT(e)}function _F(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return $T(e,Bo.getMap().classNameMap,t,"regularizer")}function MF(e){if(null==e)return null;if("string"===typeof e){return _F({className:e in AF?AF[e]:e,config:{}})}return e instanceof DF?e:_F(e)}class OF extends DI{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,null!=e&&(this.maxValue=e.maxValue)}call(e,t){e=gI(e);let n=Hl(e);return null!=this.maxValue&&(n=Bu(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}OF.className="ReLU",Lo(OF);class RF extends DI{constructor(e){super(null==e?{}:e),this.DEFAULT_ALPHA=.3,null==e&&(e={}),this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=gI(e);return Pc(n,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}RF.className="LeakyReLU",Lo(RF);class zF extends DI{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),this.supportsMasking=!0,this.alphaInitializer=dI(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=MF(e.alphaRegularizer),this.alphaConstraint=KI(e.alphaConstraint),null==e.sharedAxes)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else{if("number"!==typeof e.sharedAxes)throw new zT("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));this.sharedAxes=[e.sharedAxes]}}build(e){const t=(e=yI(e)).slice(1);if(null!=this.sharedAxes)for(const r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let r=1;r<e.length;++r)n[r]=e[r];this.inputSpec=[new SI({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=gI(e),Dl(e,this.alpha.read())}getConfig(){const e={alphaInitializer:hI(this.alphaInitializer),alphaRegularizer:FF(this.alphaRegularizer),alphaConstraint:GI(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}zF.className="PReLU",Lo(zF);class BF extends DI{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==this.DEFAULT_ALPHA)throw new BT("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=gI(e);return cc(n)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}BF.className="ELU",Lo(BF);class LF extends DI{constructor(e){super(null==e?{}:e),this.DEFAULT_THETA=1,null==e&&(e={}),this.theta=null==e.theta?this.DEFAULT_THETA:e.theta}call(e,t){const n=gI(e);return Do(n,No(Mc(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}LF.className="ThresholdedReLU",Lo(LF);class PF extends DI{constructor(e){super(null==e?{}:e),this.DEFAULT_AXIS=1,null==e&&(e={}),this.softmax=(new vF).apply,this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis}call(e,t){return pi((()=>{let n=gI(e);const r=t.mask;if(null!=r){const e=Do(jo(cl(n.shape),No(r,n.dtype)),Mo(-1e9));n=Eo(n,e)}return this.axis instanceof Array?this.axis.length>1?Cc(jo(n,$c(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)}))}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}function UF(e,t,n){if("number"===typeof e)return UT(e,t);if(e.length!==t)throw new zT("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(let a=0;a<t;++a){const i=e[a];if((r=i)!==parseInt(r.toString(),10))throw new zT("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(i))}return e;var r}function WF(e,t,n,r){if(null==e)return e;let a;return a="same"===n?e:e-(t+(t-1)*((arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)-1))+1,Math.floor((a+r-1)/r)}function VF(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+CD([n-t,0]);else{if("same"!==r)throw new zT("Unsupport padding mode: ".concat(r,"."));e*=t}return e}function qF(e,t){return pi((()=>(mD(t),"channelsFirst"===t?Vp(e,[0,2,3,1]):e)))}function jF(e,t){return pi((()=>(mD(t),"channelsFirst"===t?Vp(e,[0,2,3,4,1]):e)))}function GF(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return pi((()=>{if(null==i&&(i="channelsLast"),mD(i),3!==e.shape.length)throw new zT("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new zT("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new zT("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(n.shape.length," instead"));if("channelsFirst"===i&&(e=Vp(e,[0,2,1])),"causal"===a)throw new BT("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let s=qu(e,t,r,"same"===a?"same":"valid","NWC",o);return null!=n&&(s=qD(s,n)),s}))}function HF(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return pi((()=>{if(null==i&&(i="channelsLast"),mD(i),3!==e.rank&&4!==e.rank)throw new zT("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new zT("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));let u=qF(e,i);if("causal"===a)throw new BT("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=nh({x:u,filter:t,strides:r,pad:"same"===a?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===i&&(u=Vp(u,[0,3,1,2])),u}))}function KF(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return pi((()=>{if(null==i&&(i="channelsLast"),mD(i),4!==e.rank&&5!==e.rank)throw new zT("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new zT("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));let s=jF(e,i);if("causal"===a)throw new BT("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=Hu(s,t,r,"same"===a?"same":"valid","NDHWC",o),null!=n&&(s=qD(s,n)),"channelsFirst"===i&&(s=Vp(s,[0,4,1,2,3])),s}))}PF.className="Softmax",Lo(PF);class XF extends DI{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",XF.verifyArgs(t),this.rank=e,nD(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new BT("Convolution layer for rank other than 1, 2, or 3 (".concat(this.rank,") is ")+"not implemented yet.");if(this.kernelSize=UF(t.kernelSize,e,"kernelSize"),this.strides=UF(null==t.strides?1:t.strides,e,"strides"),this.padding=null==t.padding?"valid":t.padding,gD(this.padding),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,mD(this.dataFormat),this.activation=CF(t.activation),this.useBias=null==t.useBias||t.useBias,this.biasInitializer=dI(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=KI(t.biasConstraint),this.biasRegularizer=MF(t.biasRegularizer),this.activityRegularizer=MF(t.activityRegularizer),this.dilationRate=UF(null==t.dilationRate?1:t.dilationRate,e,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new zT("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(this.dilationRate)));if(2===this.rank){if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new zT("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}else if(3===this.rank)if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new zT("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}static verifyArgs(e){if(WT("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!==typeof e.kernelSize&&!tD(e.kernelSize,"number",1,3))throw new zT("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:kF(this.activation),useBias:this.useBias,biasInitializer:hI(this.biasInitializer),biasRegularizer:FF(this.biasRegularizer),activityRegularizer:FF(this.activityRegularizer),biasConstraint:GI(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class YF extends XF{constructor(e,t){super(e,t),this.kernel=null,YF.verifyArgs(t),this.filters=t.filters,nD(this.filters,"filters"),this.kernelInitializer=dI(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=KI(t.kernelConstraint),this.kernelRegularizer=MF(t.kernelRegularizer)}build(e){e=yI(e);const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new zT("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));const n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return pi((()=>{let t;e=gI(e);const n=null==this.bias?null:this.bias.read(),r=aD(this.activation.getClassName());if(null!=r&&2===this.rank)t=HF(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)t=GF(e,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)t=HF(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new BT("convolutions greater than 3D are not implemented yet.");t=KF(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(t=this.activation.apply(t))}return t}))}computeOutputShape(e){e=yI(e);const t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2);for(let a=0;a<n.length;++a){const e=WF(n[a],this.kernelSize[a],this.padding,this.strides[a],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[a]);t.push(e)}let r=[e[0]];return"channelsLast"===this.dataFormat?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){const e={filters:this.filters,kernelInitializer:hI(this.kernelInitializer),kernelRegularizer:FF(this.kernelRegularizer),kernelConstraint:GI(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||"number"!==typeof e.filters||e.filters<1)throw new zT("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}class $F extends YF{constructor(e){super(2,e),$F.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&!tD(e.kernelSize,"number",1,2))throw new zT("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}$F.className="Conv2D",Lo($F);class ZF extends YF{constructor(e){super(3,e),ZF.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new zT("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}ZF.className="Conv3D",Lo(ZF);class QF extends $F{constructor(e){if(super(e),this.inputSpec=[new SI({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new zT("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(e){if(4!==(e=yI(e)).length)throw new zT("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new zT("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new SI({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return pi((()=>{let t=gI(e);if(4!==t.shape.length)throw new zT("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));const n=t.shape,r=n[0];let a,i;"channelsFirst"===this.dataFormat?(a=2,i=3):(a=1,i=2);const o=n[a],s=n[i],u=this.kernelSize[0],c=this.kernelSize[1],l=this.strides[0],p=this.strides[1],h=[r,VF(o,l,u,this.padding),VF(s,p,c,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=Vp(t,[0,2,3,1]));let d=Gu(t,this.kernel.read(),h,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(d=Vp(d,[0,3,1,2])),null!=this.bias&&(d=qD(d,this.bias.read(),this.dataFormat)),null!=this.activation&&(d=this.activation.apply(d)),d}))}computeOutputShape(e){const t=(e=yI(e)).slice();let n,r,a;"channelsFirst"===this.dataFormat?(n=1,r=2,a=3):(n=3,r=1,a=2);const i=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return t[n]=this.filters,t[r]=VF(t[r],s,i,this.padding),t[a]=VF(t[a],u,o,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}QF.className="Conv2DTranspose",Lo(QF);class JF extends ZF{constructor(e){if(super(e),this.inputSpec=[new SI({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new zT("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(e){if(5!==(e=yI(e)).length)throw new zT("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new zT("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new SI({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return pi((()=>{let t=gI(e);if(5!==t.shape.length)throw new zT("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));const n=t.shape,r=n[0];let a,i,o;"channelsFirst"===this.dataFormat?(o=2,a=3,i=4):(o=1,a=2,i=3);const s=n[o],u=n[a],c=n[i],l=this.kernelSize[0],p=this.kernelSize[1],h=this.kernelSize[2],d=this.strides[0],f=this.strides[1],m=this.strides[2],g=[r,VF(s,d,l,this.padding),VF(u,f,p,this.padding),VF(c,m,h,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=Vp(t,[0,2,3,4,1]));let y=Xu(t,this.kernel.read(),g,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(y=Vp(y,[0,4,1,2,3])),null!==this.bias&&(y=qD(y,this.bias.read(),this.dataFormat)),null!==this.activation&&(y=this.activation.apply(y)),y}))}computeOutputShape(e){const t=(e=yI(e)).slice();let n,r,a,i;"channelsFirst"===this.dataFormat?(n=1,r=2,a=3,i=4):(n=4,r=1,a=2,i=3);const o=this.kernelSize[0],s=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],l=this.strides[1],p=this.strides[2];return t[n]=this.filters,t[r]=VF(t[r],c,o,this.padding),t[a]=VF(t[a],l,s,this.padding),t[i]=VF(t[i],p,u,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}JF.className="Conv3DTranspose",Lo(JF);class e_ extends YF{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==t.filters)throw new zT("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=t.kernelInitializer||null!=t.kernelRegularizer||null!=t.kernelConstraint)throw new zT("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=t.padding&&"same"!==t.padding&&"valid"!==t.padding)throw new zT("SeparableConv".concat(this.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(t.padding)));this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=dI(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=MF(t.depthwiseRegularizer),this.depthwiseConstraint=KI(t.depthwiseConstraint),this.pointwiseInitializer=dI(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=MF(t.pointwiseRegularizer),this.pointwiseConstraint=KI(t.pointwiseConstraint)}build(e){if((e=yI(e)).length<this.rank+2)throw new zT("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new zT("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));const n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[];for(let o=0;o<this.rank;++o)a.push(1);a.push(n*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new SI({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return pi((()=>{let t;if(e=gI(e),1===this.rank)throw new BT("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(e=Vp(e,[0,2,3,1])),t=np(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(t=qD(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),"channelsFirst"===this.dataFormat&&(t=Vp(t,[0,3,1,2])),t}))}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=hI(this.depthwiseInitializer),e.pointwiseInitializer=hI(this.pointwiseInitializer),e.depthwiseRegularizer=FF(this.depthwiseRegularizer),e.pointwiseRegularizer=FF(this.pointwiseRegularizer),e.depthwiseConstraint=GI(this.depthwiseConstraint),e.pointwiseConstraint=GI(this.pointwiseConstraint),e}}e_.className="SeparableConv";class t_ extends e_{constructor(e){super(2,e)}}t_.className="SeparableConv2D",Lo(t_);class n_ extends YF{constructor(e){super(1,e),n_.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&!tD(e.kernelSize,"number",1,1))throw new zT("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}n_.className="Conv1D",Lo(n_);class r_ extends DI{constructor(e){super(e),"number"===typeof e.cropping?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"===typeof e.cropping[0]?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return pi((()=>{if(e=gI(e),"channelsLast"===this.dataFormat){const t=OD(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return OD(t,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const t=OD(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return OD(t,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}}))}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}r_.className="Cropping2D",Lo(r_);class a_ extends DI{constructor(e){var t;super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==e.size?this.DEFAULT_SIZE:e.size,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,mD(this.dataFormat),this.interpolation=null==e.interpolation?"nearest":e.interpolation,t=this.interpolation,eD(lD,"InterpolationFormat",t)}computeOutputShape(e){if("channelsFirst"===this.dataFormat){const t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}{const t=null==e[1]?null:this.size[0]*e[1],n=null==e[2]?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return pi((()=>{let t=gI(e);const n=t.shape;if("channelsFirst"===this.dataFormat){t=Vp(t,[0,2,3,1]);const e=this.size[0]*n[2],r=this.size[1]*n[3],a="nearest"===this.interpolation?od.resizeNearestNeighbor(t,[e,r]):od.resizeBilinear(t,[e,r]);return Vp(a,[0,3,1,2])}{const e=this.size[0]*n[1],r=this.size[1]*n[2];return"nearest"===this.interpolation?od.resizeNearestNeighbor(t,[e,r]):od.resizeBilinear(t,[e,r])}}))}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}a_.className="UpSampling2D",Lo(a_);class i_ extends XF{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=dI(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=KI(e.depthwiseConstraint),this.depthwiseRegularizer=MF(e.depthwiseRegularizer)}build(e){if((e=yI(e)).length<4)throw new zT("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));const t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new zT("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));const n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return pi((()=>{let t=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return pi((()=>{null==a&&(a="channelsLast"),mD(a);let o=qF(e,a);if(4!==e.rank)throw new zT("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new zT("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return o=tc(o,t,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(o=Vp(o,[0,3,1,2])),o}))}(e=gI(e),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(t=qD(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),t}))}computeOutputShape(e){e=yI(e);const t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=WF(t,this.kernelSize[0],this.padding,this.strides[0]),i=WF(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,a,i]:[e[0],a,i,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=hI(this.depthwiseInitializer),e.depthwiseRegularizer=FF(this.depthwiseRegularizer),e.depthwiseConstraint=GI(this.depthwiseRegularizer),e}}function o_(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new zT("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=a(t),constants:n=a(n)}}function s_(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return pi((()=>{const u=t.shape.length;if(u<3)throw new zT("Input should be at least 3D, but is ".concat(u,"D."));const c=[1,0].concat(TD(2,u));if(t=Vp(t,c),null!=i)throw new BT("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&(a=No(No(a,"bool"),"float32"),a.rank===u-1&&(a=Tc(a,-1)),a=Vp(a,c)),r&&(t=Xl(t,0),null!=a&&(a=Xl(a,0)));const l=[];let p,h=n;const d=t.shape[0],f=zp(t);let m,g;null!=a&&(m=zp(a));for(let t=0;t<d;++t){const n=f[t],r=pi((()=>e(n,h)));if(null==a)p=r[0],h=r[1];else{const e=pi((()=>{const e=m[t],n=jo(bl(e),e);return{output:Eo(Do(r[0],e),Do(h[0],n)),newStates:h.map(((t,a)=>Eo(Do(r[1][a],e),Do(t,n))))}}));p=e.output,h=e.newStates}s&&l.push(p)}if(s){g=bp(l,1)}return[p,g,h]}))}i_.className="DepthwiseConv2D",Lo(i_);class u_ extends DI{constructor(e){let t;if(super(e),null==e.cell)throw new zT("cell property is missing for the constructor of RNN.");if(t=Array.isArray(e.cell)?new g_({cells:e.cell}):e.cell,null==t.stateSize)throw new zT("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=null!=e.returnSequences&&e.returnSequences,this.returnState=null!=e.returnState&&e.returnState,this.goBackwards=null!=e.goBackwards&&e.goBackwards,this._stateful=null!=e.stateful&&e.stateful,this.unroll=null!=e.unroll&&e.unroll,this.supportsMasking=!0,this.inputSpec=[new SI({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){return TD(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((e=>null))}return this.states_}setStates(e){this.states_=e}computeOutputShape(e){fI(e)&&(e=e[0]);let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const n=t[0];let r;if(r=this.returnSequences?[e[0],e[1],n]:[e[0],n],this.returnState){const n=[];for(const r of t)n.push([e[0],r]);return[r].concat(n)}return r}computeMask(e,t){return pi((()=>{Array.isArray(t)&&(t=t[0]);const e=this.returnSequences?t:null;if(this.returnState){const t=this.states.map((e=>null));return[e].concat(t)}return e}))}get states(){if(null==this.states_){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}return this.states_}set states(e){this.states_=e}build(e){if(null!=this.numConstants)throw new BT("Constants support is not implemented in RNN yet.");fI(e)&&(e=e[0]);const t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new SI({shape:[t,null,...n]});const r=[e[0]].concat(e.slice(2));let a;if(this.cell.build(r),a=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!W(this.stateSpec.map((e=>e.shape[e.shape.length-1])),a))throw new zT("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=a.map((e=>new SI({shape:[null,e]})));this.stateful&&this.resetStates()}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];pi((()=>{if(!this.stateful)throw new OT("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new zT("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((e=>ul([n,e]))):this.states_=[ul([n,this.cell.stateSize])];else if(null==e)hi(this.states_),null!=this.keptStates&&(hi(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((e=>ul([n,e]))):this.states_[0]=ul([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new zT("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===t?this.keptStates.push(this.states_.slice()):hi(this.states_);for(let t=0;t<this.states_.length;++t){const r=e[t],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[t]:this.cell.stateSize,i=[n,a];if(!W(r.shape,i))throw new zT("State ".concat(t," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(i,", received shape=").concat(r.shape));this.states_[t]=r}}this.states_=this.states_.map((e=>di(e.clone())))}))}apply(e,t){let n=null==t?null:t.initialState,r=null==t?null:t.constants;null==t&&(t={});const a=o_(e,n,r,this.numConstants);e=a.inputs,n=a.initialState,r=a.constants;let i=[],o=[];if(null!=n){t.initialState=n,i=i.concat(n),this.stateSpec=[];for(const e of n)this.stateSpec.push(new SI({shape:e.shape}));o=o.concat(this.stateSpec)}null!=r&&(t.constants=r,i=i.concat(r),this.numConstants=r.length);if(i[0]instanceof kI){const n=[e].concat(i),r=this.inputSpec.concat(o),a=this.inputSpec;this.inputSpec=r;const s=super.apply(n,t);return this.inputSpec=a,s}return super.apply(e,t)}call(e,t){return pi((()=>{const n=null==t?null:t.mask,r=null==t?null:t.training;let a=null==t?null:t.initialState;e=gI(e),null==a&&(a=this.stateful?this.states_:this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==i)throw new zT("RNN Layer has ".concat(i," state(s) but was passed ")+"".concat(a.length," initial state(s)."));this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:r},s=s_(((e,t)=>{const n=this.cell.call([e].concat(t),o);return[n[0],n.slice(1)]}),e,a,this.goBackwards,n,null,this.unroll,this.returnSequences),u=s[0],c=s[1],l=s[2];this.stateful&&this.resetStates(l,r);const p=this.returnSequences?c:u;return this.returnState?[p].concat(l):p}))}getInitialState(e){return pi((()=>{let t=ul(e.shape);return t=Nc(t,[1,2]),t=FD(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map((e=>e>1?BD(t,[1,e]):t)):this.cell.stateSize>1?[BD(t,[1,this.cell.stateSize])]:[t]}))}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===u_.className&&(t.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),e),t)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=iA(t.cell,n);return new e(Object.assign(t,{cell:r}))}}u_.className="RNN",Lo(u_);class c_ extends DI{}class l_ extends c_{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,nD(this.units,"units"),this.activation=CF(null==e.activation?this.DEFAULT_ACTIVATION:e.activation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=dI(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=dI(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=dI(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=MF(e.kernelRegularizer),this.recurrentRegularizer=MF(e.recurrentRegularizer),this.biasRegularizer=MF(e.biasRegularizer),this.kernelConstraint=KI(e.kernelConstraint),this.recurrentConstraint=KI(e.recurrentConstraint),this.biasConstraint=KI(e.biasConstraint),this.dropout=ED([1,CD([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=ED([1,CD([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=yI(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return pi((()=>{if(2!==e.length)throw new zT("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));let n=e[1];e=e[0];const r=null!=t.training&&t.training;let a;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=y_({ones:()=>bl(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=y_({ones:()=>bl(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;a=PD(null!=i?Do(e,i):e,this.kernel.read()),null!=this.bias&&(a=qD(a,this.bias.read())),null!=o&&(n=Do(n,o));let s=Eo(a,PD(n,this.recurrentKernel.read()));return null!=this.activation&&(s=this.activation.apply(s)),[s,s]}))}getConfig(){const e=super.getConfig(),t={units:this.units,activation:kF(this.activation),useBias:this.useBias,kernelInitializer:hI(this.kernelInitializer),recurrentInitializer:hI(this.recurrentInitializer),biasInitializer:hI(this.biasInitializer),kernelRegularizer:FF(this.kernelRegularizer),recurrentRegularizer:FF(this.recurrentRegularizer),biasRegularizer:FF(this.biasRegularizer),activityRegularizer:FF(this.activityRegularizer),kernelConstraint:GI(this.kernelConstraint),recurrentConstraint:GI(this.recurrentConstraint),biasConstraint:GI(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}l_.className="SimpleRNNCell",Lo(l_);class p_ extends u_{constructor(e){e.cell=new l_(e),super(e)}call(e,t){return pi((()=>{null!=this.cell.dropoutMask&&(hi(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(hi(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,a=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})}))}static fromConfig(e,t){return new e(t)}}p_.className="SimpleRNN",Lo(p_);class h_ extends c_{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new zT("GRUCell does not support reset_after parameter set to true.");this.units=e.units,nD(this.units,"units"),this.activation=CF(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=CF(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=dI(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=dI(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=dI(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=MF(e.kernelRegularizer),this.recurrentRegularizer=MF(e.recurrentRegularizer),this.biasRegularizer=MF(e.biasRegularizer),this.kernelConstraint=KI(e.kernelConstraint),this.recurrentConstraint=KI(e.recurrentConstraint),this.biasConstraint=KI(e.biasConstraint),this.dropout=ED([1,CD([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=ED([1,CD([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){const t=(e=yI(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return pi((()=>{if(2!==e.length)throw new zT("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));const n=null!=t.training&&t.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=y_({ones:()=>bl(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=y_({ones:()=>bl(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,i=this.recurrentDropoutMask;let o,s,u;0<this.dropout&&this.dropout<1&&(e=Do(e,a[0]));let c=PD(e,this.kernel.read());this.useBias&&(c=qD(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=Do(r,i[0]));const l=this.recurrentKernel.read(),[p,h]=mp(l,[2*this.units,this.units],l.rank-1),d=PD(r,p),[f,m,g]=mp(c,3,c.rank-1),[y,v]=mp(d,2,d.rank-1);o=this.recurrentActivation.apply(Eo(f,y)),s=this.recurrentActivation.apply(Eo(m,v));const b=PD(Do(s,r),h);u=this.activation.apply(Eo(g,b));const x=Eo(Do(o,r),Do(Eo(1,Hc(o)),u));return[x,x]}))}getConfig(){const e=super.getConfig(),t={units:this.units,activation:kF(this.activation),recurrentActivation:kF(this.recurrentActivation),useBias:this.useBias,kernelInitializer:hI(this.kernelInitializer),recurrentInitializer:hI(this.recurrentInitializer),biasInitializer:hI(this.biasInitializer),kernelRegularizer:FF(this.kernelRegularizer),recurrentRegularizer:FF(this.recurrentRegularizer),biasRegularizer:FF(this.biasRegularizer),activityRegularizer:FF(this.activityRegularizer),kernelConstraint:GI(this.kernelConstraint),recurrentConstraint:GI(this.recurrentConstraint),biasConstraint:GI(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}h_.className="GRUCell",Lo(h_);class d_ extends u_{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new h_(e),super(e)}call(e,t){return pi((()=>{null!=this.cell.dropoutMask&&(hi(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(hi(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,a=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})}))}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}d_.className="GRU",Lo(d_);class f_ extends c_{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,nD(this.units,"units"),this.activation=CF(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=CF(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=dI(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=dI(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=dI(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=MF(e.kernelRegularizer),this.recurrentRegularizer=MF(e.recurrentRegularizer),this.biasRegularizer=MF(e.biasRegularizer),this.kernelConstraint=KI(e.kernelConstraint),this.recurrentConstraint=KI(e.recurrentConstraint),this.biasConstraint=KI(e.biasConstraint),this.dropout=ED([1,CD([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=ED([1,CD([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;const n=(e=yI(e))[e.length-1];let r;if(this.kernel=this.addWeight("kernel",[n,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const e=this.biasInitializer,n=this.units;r=new((t=class extends XD{apply(t,r){const a=e.apply([n]),i=(new $D).apply([n]),o=e.apply([2*n]);return zD(zD(a,i),o)}}).className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return pi((()=>{const n=null!=t.training&&t.training;if(3!==e.length)throw new zT("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));let r=e[1];const a=e[2];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=y_({ones:()=>bl(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=y_({ones:()=>bl(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let s,u,c,l;0<this.dropout&&this.dropout<1&&(e=Do(e,i[0]));let p=PD(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=Do(r,o[0])),p=Eo(p,PD(r,this.recurrentKernel.read())),this.useBias&&(p=qD(p,this.bias.read()));const[h,d,f,m]=mp(p,4,p.rank-1);s=this.recurrentActivation.apply(h),u=this.recurrentActivation.apply(d),c=Eo(Do(u,a),Do(s,this.activation.apply(f))),l=this.recurrentActivation.apply(m);const g=Do(l,this.activation.apply(c));return[g,g,c]}))}getConfig(){const e=super.getConfig(),t={units:this.units,activation:kF(this.activation),recurrentActivation:kF(this.recurrentActivation),useBias:this.useBias,kernelInitializer:hI(this.kernelInitializer),recurrentInitializer:hI(this.recurrentInitializer),biasInitializer:hI(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:FF(this.kernelRegularizer),recurrentRegularizer:FF(this.recurrentRegularizer),biasRegularizer:FF(this.biasRegularizer),activityRegularizer:FF(this.activityRegularizer),kernelConstraint:GI(this.kernelConstraint),recurrentConstraint:GI(this.recurrentConstraint),biasConstraint:GI(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}f_.className="LSTMCell",Lo(f_);class m_ extends u_{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new f_(e),super(e)}call(e,t){return pi((()=>{null!=this.cell.dropoutMask&&(hi(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(hi(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,a=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})}))}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}m_.className="LSTM",Lo(m_);class g_ extends c_{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return pi((()=>{let n=e.slice(1);const r=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?r.push(n.splice(0,e.stateSize.length)):r.push(n.splice(0,1));r.reverse();const a=[];let i;for(let o=0;o<this.cells.length;++o){const s=this.cells[o];n=r[o],i=0===o?[e[0]].concat(n):[i[0]].concat(n),i=s.call(i,t),a.push(i.slice(1))}n=[];for(const e of a.slice().reverse())n.push(...e);return[i[0]].concat(n)}))}build(e){let t;fI(e)&&(e=e[0]),this.cells.forEach(((n,r)=>{bD("RNNCell_".concat(r),(()=>{n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}getConfig(){const e=super.getConfig(),t={cells:this.cells.map((e=>({className:e.getClassName(),config:e.getConfig()})))};return Object.assign(Object.assign({},e),t)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[];for(const a of t.cells)r.push(iA(a,n));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return wI(e)}setWeights(e){const t=[];for(const n of this.cells){const r=n.weights.length,a=e.splice(r);for(let e=0;e<n.weights.length;++e)t.push([n.weights[e],a[e]])}NI(t)}}function y_(e){const{ones:t,rate:n,training:r=!1,count:a=1,dropoutFunc:i}=e,o=()=>null!=i?i(t(),n):jD(t(),n),s=()=>GD(o,t,r);if(!a||a<=1)return di(s().clone());return Array(a).fill(void 0).map(s).map((e=>di(e.clone())))}g_.className="StackedRNNCells",Lo(g_);var v_=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};class b_ extends u_{constructor(e){if(e.unroll)throw new BT("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new BT("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new SI({ndim:5})]}call(e,t){return pi((()=>{if(null!=this.cell.dropoutMask&&(hi(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(hi(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new zT("ConvRNN2D cell does not support constants");const n=null==t?null:t.mask,r=null==t?null:t.training,a=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})}))}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return pi((()=>{const{stateSize:t}=this.cell,n=e.shape,r=this.computeSingleOutputShape(n),a=ul([r[0],...r.slice(2)]);return Array.isArray(t)?Array(t.length).fill(a):[a]}))}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];pi((()=>{if(!this.stateful)throw new OT("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),a=[r[0],...r.slice(2)];if(null==n[0])throw new zT("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>ul(a))):this.states_=[ul(a)];else if(null==e)hi(this.states_),null!=this.keptStates&&(hi(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>ul(a))):this.states_[0]=ul(a);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new zT("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));t?this.keptStates.push(this.states_.slice()):hi(this.states_);for(let t=0;t<this.states_.length;++t){const n=e[t],r=a;if(!W(n.shape,r))throw new zT("State ".concat(t," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(r,", received shape=").concat(n.shape));this.states_[t]=n}}this.states_=this.states_.map((e=>di(e.clone())))}))}computeSingleOutputShape(e){const{dataFormat:t,filters:n,kernelSize:r,padding:a,strides:i,dilationRate:o}=this.cell,s="channelsFirst"===t,u=e[s?3:2],c=e[s?4:3],l=WF(u,r[0],a,i[0],o[0]),p=WF(c,r[1],a,i[1],o[1]);return[...e.slice(0,2),...s?[n,l,p]:[l,p,n]]}}b_.className="ConvRNN2D";class x_ extends f_{constructor(e){const{filters:t,kernelSize:n,strides:r,padding:a,dataFormat:i,dilationRate:o}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,nD(this.filters,"filters"),this.kernelSize=UF(n,2,"kernelSize"),this.kernelSize.forEach((e=>nD(e,"kernelSize"))),this.strides=UF(r||1,2,"strides"),this.strides.forEach((e=>nD(e,"strides"))),this.padding=a||"valid",gD(this.padding),this.dataFormat=i||"channelsLast",mD(this.dataFormat),this.dilationRate=UF(o||1,2,"dilationRate"),this.dilationRate.forEach((e=>nD(e,"dilationRate")))}build(e){var t;e=yI(e);const n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new zT("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));const r=e[n],a=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const i=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let e;if(this.unitForgetBias){const n=this.biasInitializer,r=this.filters;e=new((t=class extends XD{apply(e,t){return RD([n.apply([r]),cl([r]),n.apply([2*r])])}}).className="CustomInit",t)}else e=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,e,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return pi((()=>{if(3!==e.length)throw new zT("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));const n=t.training||!1,r=e[0],a=e[1],i=e[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=y_({ones:()=>bl(r),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,s=(e,t,n)=>t&&t[n]?Do(t[n],e):e;let u=s(r,o,0),c=s(r,o,1),l=s(r,o,2),p=s(r,o,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=y_({ones:()=>bl(a),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const h=this.recurrentDropoutMask;let d=s(a,h,0),f=s(a,h,1),m=s(a,h,2),g=s(a,h,3);const[y,v,b,x]=mp(this.kernel.read(),4,3),[w,N,S,k]=this.useBias?mp(this.bias.read(),4):[null,null,null,null];u=this.inputConv(u,y,w,this.padding),c=this.inputConv(c,v,N,this.padding),l=this.inputConv(l,b,S,this.padding),p=this.inputConv(p,x,k,this.padding);const[E,C,T,D]=mp(this.recurrentKernel.read(),4,3);d=this.recurrentConv(d,E),f=this.recurrentConv(f,C),m=this.recurrentConv(m,T),g=this.recurrentConv(g,D);const I=this.recurrentActivation.apply(Eo(u,d)),A=this.recurrentActivation.apply(Eo(c,f)),F=Eo(Do(A,i),Do(I,this.activation.apply(Eo(l,m)))),_=Do(this.recurrentActivation.apply(Eo(p,g)),this.activation.apply(F));return[_,_,F]}))}getConfig(){const e=super.getConfig(),{units:t}=e,n=v_(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(e,t,n,r){const a=Vu(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?qD(a,n,this.dataFormat):a}recurrentConv(e,t){return Vu(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}x_.className="ConvLSTM2DCell",Lo(x_);class w_ extends b_{constructor(e){const t=new x_(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}w_.className="ConvLSTM2D",Lo(w_);class N_ extends DI{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(null==this.noiseShape)return this.noiseShape;const t=e.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}call(e,t){return pi((()=>{this.invokeCallHook(e,t);const n=gI(e);if(0<this.rate&&this.rate<1){const e=null!=t.training&&t.training,r=this.getNoiseShape(n);return GD((()=>jD(n,this.rate,r,this.seed)),(()=>n),e)}return e}))}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}N_.className="Dropout",Lo(N_);class S_ extends N_{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}S_.className="SpatialDropout1D",Lo(S_);class k_ extends DI{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){let t=null;null!=e.batchSize&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,nD(this.units,"units"),this.activation=CF(e.activation),null!=e.useBias&&(this.useBias=e.useBias),this.kernelInitializer=dI(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=dI(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=KI(e.kernelConstraint),this.biasConstraint=KI(e.biasConstraint),this.kernelRegularizer=MF(e.kernelRegularizer),this.biasRegularizer=MF(e.biasRegularizer),this.activityRegularizer=MF(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){const t=(e=yI(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){const t=(e=yI(e)).slice();return t[t.length-1]=this.units,t}call(e,t){return pi((()=>{this.invokeCallHook(e,t);const n=gI(e),r=aD(this.activation.getClassName());let a;return null!=r?a=PD(n,this.kernel.read(),r,this.bias?this.bias.read():null):(a=PD(n,this.kernel.read()),null!=this.bias&&(a=qD(a,this.bias.read())),null!=this.activation&&(a=this.activation.apply(a))),a}))}getConfig(){const e={units:this.units,activation:kF(this.activation),useBias:this.useBias,kernelInitializer:hI(this.kernelInitializer),biasInitializer:hI(this.biasInitializer),kernelRegularizer:FF(this.kernelRegularizer),biasRegularizer:FF(this.biasRegularizer),activityRegularizer:FF(this.activityRegularizer),kernelConstraint:GI(this.kernelConstraint),biasConstraint:GI(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}k_.className="Dense",Lo(k_);class E_ extends DI{constructor(e){super(e=e||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=yI(e);for(const t of e.slice(1))if(null==t)throw new zT('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.');return[e[0],kD(e,1)]}call(e,t){return pi((()=>{this.invokeCallHook(e,t);let n=gI(e);if("channelsFirst"===this.dataFormat&&n.rank>1){const e=[0];for(let t=2;t<n.rank;++t)e.push(t);e.push(1),n=Vp(n,e)}return function(e){if(e.rank<=1)throw new zT("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));const t=[e.shape[0],kD(e.shape,1)];return vu(e,t)}(n)}))}getConfig(){const e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}E_.className="Flatten",Lo(E_);class C_ extends DI{constructor(e){super(e),this.supportsMasking=!0,this.activation=CF(e.activation)}call(e,t){return pi((()=>{this.invokeCallHook(e,t);const n=gI(e);return this.activation.apply(n)}))}getConfig(){const e={activation:kF(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}C_.className="Activation",Lo(C_);class T_ extends DI{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return pi((()=>{return e=gI(e),t=e,n=this.n,pi((()=>{if(2!==t.shape.length)throw new zT("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(t.shape.length," tensor."));return BD(FD(t,1),[1,n,1])}));var t,n}))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}T_.className="RepeatVector",Lo(T_);class D_ extends DI{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||null==e}fixUnknownDimension(e,t){const n="Total size of new array must be unchanged.",r=t.slice();let a=1,i=null;for(let s=0;s<r.length;++s){const e=r[s];if(this.isUnknown(e)){if(null!==i)throw new zT("Can only specifiy one unknown dimension.");i=s}else a*=e}const o=kD(e);if(null!==i){if(0===a||o%a!==0)throw new zT(n);r[i]=o/a}else if(o!==a)throw new zT(n);return r}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return pi((()=>{this.invokeCallHook(e,t);const n=gI(e),r=n.shape,a=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return vu(n,a)}))}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}D_.className="Reshape",Lo(D_);class I_ extends DI{constructor(e){if(super(e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));const t=TD(1,e.dims.length+1);if(!W(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new SI({ndim:this.dims.length+1})]}computeOutputShape(e){const t=(e=yI(e)).slice();return this.dims.forEach(((n,r)=>{t[r+1]=e[n]})),t}call(e,t){return Vp(gI(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}I_.className="Permute",Lo(I_);class A_ extends DI{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,this.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const n=gI(e);return Ys(yl(n,this.maskValue),-1)}call(e,t){return pi((()=>{this.invokeCallHook(e,t);const n=gI(e),r=Ys(yl(n,this.maskValue),-1,!0);return Do(n,No(r,n.dtype))}))}}A_.className="Masking",Lo(A_);class F_ extends DI{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){let t=null;null!=e.batchSize&&(t=e.batchSize),null==e.inputLength?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(jT(e.inputLength))}this.inputDim=e.inputDim,nD(this.inputDim,"inputDim"),this.outputDim=e.outputDim,nD(this.outputDim,"outputDim"),this.embeddingsInitializer=dI(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=MF(e.embeddingsRegularizer),this.activityRegularizer=MF(e.activityRegularizer),this.embeddingsConstraint=KI(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return pi((()=>this.maskZero?(e=gI(e),yl(e,Fo(e))):null))}computeOutputShape(e){if(e=yI(e),null==this.inputLength)return[...e,this.outputDim];const t=jT(this.inputLength);if(t.length!==e.length-1)throw new zT('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));{let n=0;for(let r=0;r<t.length;++r){const a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new zT('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==a&&(t[n]=i),n++}}return[e[0],...t,this.outputDim]}call(e,t){return pi((()=>{this.invokeCallHook(e,t);let n=gI(e);"int32"!==n.dtype&&(n=AD(n,"int32"));const r=UD(this.embeddings.read(),vu(n,[n.size]));return vu(r,yI(this.computeOutputShape(n.shape)))}))}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:hI(this.embeddingsInitializer),embeddingsRegularizer:FF(this.embeddingsRegularizer),activityRegularizer:FF(this.activityRegularizer),embeddingsConstraint:GI(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}F_.className="Embedding",Lo(F_);class __ extends DI{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new BT}computeElementwiseOpOutputShape(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;const n=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){const a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new zT("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[yI(e)]),e.length<2)throw new zT("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));let t=[];for(const a of e)null!=a&&null!==a[0]&&t.push(a[0]);if(t=QT(t),t.length>1)throw new zT("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));let n=null==e[0]?null:e[0].slice(1);for(let a=1;a<e.length;++a){const t=null==e[a]?null:e[a].slice(1);n=this.computeElementwiseOpOutputShape(n,t)}const r=e.map((e=>e.length));-1===e.indexOf(null)&&1===QT(r).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return pi((()=>{if(this.reshapeRequired){const t=[],n=e.map((e=>e.rank));if(-1===n.indexOf(null)){const r=CD(n);for(let n of e){const e=n.rank;for(let t=0;t<r-e;++t)n=FD(n,1);t.push(n)}return this.mergeFunction(t)}{let n=!1;for(const i of e){const e=i.rank;if(null==e){const e=i.shape,r=e[0],a=e.slice(1).concat([r]);let o=vu(i,[r].concat(kD(e.slice(1))));o=Vp(o,[1,0]),o=vu(o,a),t.push(o),n=!0}else if(e>1){const r=TD(1,e).concat([0]);t.push(Vp(i,r)),n=!0}else t.push(i)}let r=this.mergeFunction(t);const a=r.rank;if(n)if(null==a){const e=r.shape,t=e[e.length-1],n=[t].concat(e.slice(0,e.length-1));r=vu(Vp(vu(r,[-1,t]),[1,0]),n)}else if(a>1){const e=[a-1].concat(TD(0,a-1));r=Vp(r,e)}return r}}return this.mergeFunction(e)}))}computeOutputShape(e){let t;t=null==e[0]?null:e[0].slice(1);for(let r=1;r<e.length;++r){const n=null==e[r]?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,n)}let n=[];for(const r of e)null!=r&&null!==r[0]&&n.push(r[0]);return n=QT(n),t=1===n.length?n.concat(t):[null].concat(t),t}computeMask(e,t){return pi((()=>{if(null==t)return null;if(!Array.isArray(t))throw new zT("`mask` should be an Array");if(!Array.isArray(e))throw new zT("`inputs` should be an Array");if(t.length!==e.length)throw new zT("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every((e=>null==e)))return null;let n=(t=t.map((e=>null==e?e:Tc(e,0))))[0];for(let e=1;e<t.length-1;++e)n=Zc(n,t[e]);return n}))}}class M_ extends __{constructor(e){super(e)}mergeFunction(e){return pi((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=Eo(t,e[n]);return t}))}}M_.className="Add",Lo(M_);class O_ extends __{constructor(e){super(e)}mergeFunction(e){return pi((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=Do(t,e[n]);return t}))}}O_.className="Multiply",Lo(O_);class R_ extends __{constructor(e){super(e)}mergeFunction(e){return pi((()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=Eo(t,e[n]);return Do(1/e.length,t)}))}}R_.className="Average",Lo(R_);class z_ extends __{constructor(e){super(e)}mergeFunction(e){return pi((()=>{let t=e[0];for(let n=1;n<e.length;++n)t=$o(t,e[n]);return t}))}}z_.className="Maximum",Lo(z_);class B_ extends __{constructor(e){super(e)}mergeFunction(e){return pi((()=>{let t=e[0];for(let n=1;n<e.length;++n)t=pl(t,e[n]);return t}))}}B_.className="Minimum",Lo(B_);class L_ extends __{constructor(e){super(e),this.DEFAULT_AXIS=-1,null==e&&(e={}),this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new zT("A `Concatenate` layer should be called on a list of at least 2 inputs");let t=!0;for(const r of e)if(null!=r){t=!1;break}if(t)return;const n=[];for(let r=0;r<e.length;++r){const t=e[r].slice();t.splice(this.axis,1);let a=!1;for(const e of n)if(W(e,t)){a=!0;break}a||n.push(t)}if(n.length>1)throw new zT("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return pi((()=>RD(e,this.axis)))}computeOutputShape(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new zT("A `Concatenate` layer should be called on a list of inputs.");const t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(const a of t.slice(1)){if(null==n[r]||null==a[r]){n[r]=null;break}n[r]+=a[r]}return n}computeMask(e,t){if(null==t)return null;if(!Array.isArray(t))throw new zT("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new zT("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new zT("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return pi((()=>{let n=!0;if(t.forEach((e=>{null==e||(n=!1)})),n)return null;const r=[];for(let i=0;i<e.length;++i)null==t[i]?r.push(No(bl(e[i]),"bool")):t[i].rank<e[i].rank?r.push(Tc(t[i],-1)):r.push(t[i]);const a=wu(r,this.axis);return Xs(a,-1,!1)}))}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}function P_(e,t){for(;e<0;)e+=t;return e}L_.className="Concatenate",Lo(L_);class U_ extends __{constructor(e){super(e),this.axes=e.axes,this.normalize=null!=e.normalize&&e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){B(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const t=e[0],n=e[1];if(t.length>3||n.length>3)throw new BT("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new zT("Dimension incompatibility: "+"".concat(t[r[0]]," !== ").concat(n[r[1]]))}mergeFunction(e){if(2!==e.length)throw new zT("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));let t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map(((t,n)=>P_(t,e[n].shape.length))):[P_(this.axes,n.shape.length),P_(this.axes,r.shape.length)],this.normalize&&(n=oA(n,t[0]),r=oA(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new BT("batchDot is not implemented for tensors of 4D or higher rank yet");if(B(e.shape.length>=2,(()=>"batchDot requires the rank of x to be >= 2, "+"but got ".concat(e.shape.length))),B(e.shape.length>=2,(()=>"batchDot requires the rank of y to be >= 2, "+"but got ".concat(t.shape.length))),"number"===typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new BT("batchDot is not implemented for complex64-type Tensors yet.");const r=e.shape.length,a=t.shape.length;null==n&&(n=[r-1,a-2]);const i=n;return pi((()=>{let n,o;if(r>a){n=r-a;const e=[];for(let t=0;t<n;++t)e.push(1);t=vu(t,t.shape.concat(e))}else if(a>r){n=a-r;const t=[];for(let e=0;e<n;++e)t.push(1);e=vu(e,e.shape.concat(t))}else n=0;if(2===e.shape.length&&2===t.shape.length)o=i[0]===i[1]?Nc(Do(e,t),i[0]):Nc(Do(Vp(e,[1,0]),t),i[1]);else{const n=i[0]!==e.shape.length-1,r=i[1]===t.shape.length-1;o=Nu(e,t,n,r)}if(n>0){let e;e=r>a?r+a-3:r-1;const t=[];for(let r=e;r<e+n;++r)t.push(r);o=vp(o,t)}return 1===o.shape.length&&(o=Tc(o,1)),o}))}(n,r,t)}interpretAxes(e,t){let n;return n=Array.isArray(this.axes)?this.axes:[P_(this.axes,e.length),P_(this.axes,t.length)],n}computeOutputShape(e){B(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new BT("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);const a=t.concat(n);return 1===a.length&&a.push(1),a}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}U_.className="Dot",Lo(U_);class W_ extends DI{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return pi((()=>{this.invokeCallHook(e,t);const n=gI(e);return GD((()=>Eo(LD(n.shape,0,this.stddev),n)),(()=>n),t.training||!1)}))}}W_.className="GaussianNoise",Lo(W_);class V_ extends DI{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return pi((()=>{this.invokeCallHook(e,t);const n=gI(e);if(this.rate>0&&this.rate<1){return GD((()=>{const e=Math.sqrt(this.rate/(1-this.rate));return Do(n,LD(n.shape,1,e))}),(()=>n),t.training||!1)}return n}))}}V_.className="GaussianDropout",Lo(V_);class q_ extends DI{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||gI(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return pi((()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(e),r=()=>{const t=gI(e),r=-1.7580993408473766;let a=Oc(Wl(n),this.rate);a=AD(a,"float32");const i=((1-this.rate)*(1+this.rate*r**2))**-.5,o=-i*r*this.rate,s=Eo(Do(t,a),Do(Eo(a,-1),r));return Eo(Do(s,i),o)};return GD(r,(()=>gI(e)),t.training||!1)}return e}))}}function j_(e,t,n,r,a){let i,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)i=Iu(e,t,n,r,a,o);else if(3===e.rank)i=Au(e,t,n,r,a,o);else{if(4!==e.rank)throw new BT("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");i=Fu(e,t,n,r,a,o)}return i}function G_(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return W(r.slice().sort(),TD(0,e.rank-1))?function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return pi((()=>{const i=fl(e,r),o=i.mean,s=i.variance;return[j_(e,o,s,n,t,a),o,s]}))}(e,t,n,r,a):function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return pi((()=>{const i=fl(e,r),o=i.mean,s=i.variance,u=[];for(const t of TD(0,e.rank))-1!==r.indexOf(t)?u.push(1):u.push(e.shape[t]);const c=vu(o,u),l=vu(s,u),p=null==t?null:vu(t,u),h=null==n?null:vu(n,u);return[j_(e,c,l,h,p,a),o,s]}))}(e,t,n,r,a)}q_.className="AlphaDropout",Lo(q_);class H_ extends DI{constructor(e){null==e&&(e={}),super(e),this.supportsMasking=!0,this.axis=null==e.axis?-1:e.axis,this.momentum=null==e.momentum?.99:e.momentum,this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=dI(e.betaInitializer||"zeros"),this.gammaInitializer=dI(e.gammaInitializer||"ones"),this.movingMeanInitializer=dI(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=dI(e.movingVarianceInitializer||"ones"),this.betaConstraint=KI(e.betaConstraint),this.gammaConstraint=KI(e.gammaConstraint),this.betaRegularizer=MF(e.betaRegularizer),this.gammaRegularizer=MF(e.gammaRegularizer)}build(e){e=yI(e);const t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new zT("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new SI({ndim:e.length,axes:{[t]:n}})];const r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return pi((()=>{const n=null!=t.training&&t.training,r=gI(e),a=r.shape,i=a.length,o=TD(0,i),s=this.axis>=0?this.axis:this.axis+i;o.splice(s,1);const u=UT(1,i);u[s]=a[s];const c=o.slice();c.sort();const l=!W(c,TD(0,i).slice(0,i-1));if(!n)return(()=>{if(l){const e=vu(this.movingMean.read(),u),t=vu(this.movingVariance.read(),u),n=this.center?vu(this.beta.read(),u):null,a=this.scale?vu(this.gamma.read(),u):null;return j_(r,e,t,n,a,this.epsilon)}return j_(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[p,h,d]=G_(r,this.gamma.read(),this.beta.read(),o,this.epsilon),f=(e,t,n)=>{pi((()=>{const r=1-n,a=e.read(),i=Do(jo(a,t),r);e.write(jo(a,i))}))};return(()=>{f(this.movingMean,h,this.momentum),f(this.movingVariance,d,this.momentum)})(),p}))}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:hI(this.betaInitializer),gammaInitializer:hI(this.gammaInitializer),movingMeanInitializer:hI(this.movingMeanInitializer),movingVarianceInitializer:hI(this.movingVarianceInitializer),betaRegularizer:FF(this.betaRegularizer),gammaRegularizer:FF(this.gammaRegularizer),betaConstraint:GI(this.betaConstraint),gammaConstraint:GI(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}H_.className="BatchNormalization",Lo(H_);class K_ extends DI{constructor(e){if(null==e&&(e={}),super(e),this.axis=null==e.axis?-1:e.axis,"number"===typeof this.axis){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received ".concat(this.axis))}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(this.axis)));for(const e of this.axis)if(!Number.isInteger(e))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(this.axis)))}this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=dI(e.betaInitializer||"zeros"),this.gammaInitializer=dI(e.gammaInitializer||"ones"),this.betaRegularizer=MF(e.betaRegularizer),this.gammaRegularizer=MF(e.gammaRegularizer),this.supportsMasking=!0}build(e){const t=(e=yI(e)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=t);for(const a of this.axis)if(a<0||a>=t)throw new Error("Invalid axis: ".concat(a));if(this.axis.length!==QT(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));const n=this.axis.map((t=>e[t])),r=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,t){const n=gI(e),r=n.shape,a=r.length;return pi((()=>{let{mean:e,variance:t}=fl(n,this.axis,!0);const i=UT(1,a);for(const n of this.axis)i[n]=r[n];const o=e=>null!=e&&e.shape.length!==a?vu(e,i):e;let s=this.scale?o(this.gamma.read()):null,u=this.center?o(this.beta.read()):null;const c=[],l=[];for(let n=0;n<a;++n)-1!==this.axis.indexOf(n)?(c.push(r[n]),l.push(1)):(c.push(1),l.push(r[n]));return e=Ic(e,c),t=Ic(t,c),null!=s&&(s=Ic(s,l)),null!=u&&(u=Ic(u,l)),j_(n,e,t,u,s,this.epsilon)}))}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:hI(this.betaInitializer),gammaInitializer:hI(this.gammaInitializer),betaRegularizer:FF(this.betaRegularizer),gammaRegularizer:FF(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}K_.className="LayerNormalization",Lo(K_);class X_ extends DI{constructor(e){if(null==e&&(e={}),super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)this.padding=[[1,1],[1,1]];else if("number"===typeof e.padding)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new zT("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));let t,n;if("number"===typeof e.padding[0])t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new zT("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(t=e.padding[0],2!==e.padding[1].length)throw new zT("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new SI({ndim:4})]}computeOutputShape(e){let t,n;return e=yI(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}call(e,t){return pi((()=>{return t=gI(e),n=this.padding,r=this.dataFormat,pi((()=>{if(4!==t.rank)throw new zT("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(t.rank,"-D tensor."));if(null==n&&(n=[[1,1],[1,1]]),2!==n.length||2!==n[0].length||2!==n[1].length)throw new zT("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==r&&(r="channelsLast"),"channelsLast"!==r&&"channelsFirst"!==r)throw new zT("Unknown data format: ".concat(r,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");let e;return e="channelsFirst"===r?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]],wl(t,e)}));var t,n,r}))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}function Y_(e,t,n,r,a,i){return pi((()=>{let o;mD(a),yD(i),gD(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=qF(e,a);const s="same"===r?"same":"valid";return o="max"===i?al(e,t,n,s):bu(e,t,n,s),"channelsFirst"===a&&(o=Vp(o,[0,3,1,2])),o}))}function $_(e,t,n,r,a,i){return pi((()=>{let o;mD(a),yD(i),gD(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=jF(e,a);const s="same"===r?"same":"valid";return o="max"===i?il(e,t,n,s):xu(e,t,n,s),"channelsFirst"===a&&(o=Vp(o,[0,4,1,2,3])),o}))}X_.className="ZeroPadding2D",Lo(X_);class Z_ extends DI{constructor(e){if(null==e.poolSize&&(e.poolSize=2),super(e),"number"===typeof e.poolSize)this.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!==typeof e.poolSize[0])throw new zT("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));this.poolSize=e.poolSize}if(nD(this.poolSize,"poolSize"),null==e.strides)this.strides=this.poolSize;else if("number"===typeof e.strides)this.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!==typeof e.strides[0])throw new zT("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));this.strides=e.strides}nD(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,gD(this.padding),this.inputSpec=[new SI({ndim:3})]}computeOutputShape(e){const t=WF((e=yI(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return pi((()=>{this.invokeCallHook(e,t),e=FD(gI(e),2);const n=this.poolingFunction(gI(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return vp(n,[2])}))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class Q_ extends Z_{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return mD(a),gD(r),Y_(e,t,n,r,a,"max")}}Q_.className="MaxPooling1D",Lo(Q_);class J_ extends Z_{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return mD(a),gD(r),Y_(e,t,n,r,a,"avg")}}J_.className="AveragePooling1D",Lo(J_);class eM extends DI{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new zT("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides];nD(this.poolSize,"poolSize"),nD(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,mD(this.dataFormat),gD(this.padding),this.inputSpec=[new SI({ndim:4})]}computeOutputShape(e){e=yI(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=WF(t,this.poolSize[0],this.padding,this.strides[0]),n=WF(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return pi((()=>(this.invokeCallHook(e,t),this.poolingFunction(gI(e),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class tM extends eM{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return mD(a),gD(r),Y_(e,t,n,r,a,"max")}}tM.className="MaxPooling2D",Lo(tM);class nM extends eM{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return mD(a),gD(r),Y_(e,t,n,r,a,"avg")}}nM.className="AveragePooling2D",Lo(nM);class rM extends DI{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new zT("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];nD(this.poolSize,"poolSize"),nD(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,mD(this.dataFormat),gD(this.padding),this.inputSpec=[new SI({ndim:5})]}computeOutputShape(e){e=yI(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=WF(t,this.poolSize[0],this.padding,this.strides[0]),n=WF(n,this.poolSize[1],this.padding,this.strides[1]),r=WF(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}call(e,t){return pi((()=>(this.invokeCallHook(e,t),this.poolingFunction(gI(e),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class aM extends rM{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return mD(a),gD(r),$_(e,t,n,r,a,"max")}}aM.className="MaxPooling3D",Lo(aM);class iM extends rM{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return mD(a),gD(r),$_(e,t,n,r,a,"avg")}}iM.className="AveragePooling3D",Lo(iM);class oM extends DI{constructor(e){super(e),this.inputSpec=[new SI({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new BT}}class sM extends oM{constructor(e){super(e||{})}call(e,t){return pi((()=>{const t=gI(e);return sl(t,1)}))}}sM.className="GlobalAveragePooling1D",Lo(sM);class uM extends oM{constructor(e){super(e||{})}call(e,t){return pi((()=>{const t=gI(e);return xc(t,1)}))}}uM.className="GlobalMaxPooling1D",Lo(uM);class cM extends DI{constructor(e){super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,mD(this.dataFormat),this.inputSpec=[new SI({ndim:4})]}computeOutputShape(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new BT}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class lM extends cM{call(e,t){return pi((()=>{const t=gI(e);return"channelsLast"===this.dataFormat?sl(t,[1,2]):sl(t,[2,3])}))}}lM.className="GlobalAveragePooling2D",Lo(lM);class pM extends cM{call(e,t){return pi((()=>{const t=gI(e);return"channelsLast"===this.dataFormat?xc(t,[1,2]):xc(t,[2,3])}))}}pM.className="GlobalMaxPooling2D",Lo(pM);class hM extends DI{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(e){null!=this.layer&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=iA(t.layer,n);delete t.layer;const a={layer:r};return Object.assign(a,t),new e(a)}}class dM extends hM{constructor(e){super(e),this.supportsMasking=!0}build(e){if((e=yI(e)).length<3)throw new zT("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){const t=[(e=yI(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}call(e,t){return pi((()=>s_(((e,n)=>[gI(this.layer.call(e,t)),[]]),e=gI(e),[],!1,null,null,!1,!0)[1]))}}dM.className="TimeDistributed",Lo(dM);class fM extends hM{constructor(e){super(e);const t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=iA(n),t.goBackwards=!0!==t.goBackwards;const r={};var a;if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=iA(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,a=this.mergeMode,eD(dD,"BidirectionalMergeMode",a),e.weights)throw new BT("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t,n,r,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),this.returnState?(r=a.slice(1),t=a[0]):t=a[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):qT(n)}apply(e,t){let n=null==t?null:t.initialState,r=null==t?null:t.constants;null==t&&(t={});const a=o_(e,n,r,this.numConstants);if(e=a.inputs,n=a.initialState,r=a.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(null==n||0===n.length)&&null==r)return super.apply(e,t);const i=[],o=[];if(null!=n){const e=n.length;if(e%2>0)throw new zT("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,i.push(...n);const r=n.map((e=>new SI({shape:e.shape})));this.forwardLayer.stateSpec=r.slice(0,e/2),this.backwardLayer.stateSpec=r.slice(e/2),o.push(...r)}if(null!=r)throw new BT("Support for constants in Bidirectional layers is not implemented yet.");const s=i[0]instanceof kI;for(const u of i)if(u instanceof kI!==s)throw new zT("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(s){const n=[e].concat(i),r=this.inputSpec.concat(o),a=this.inputSpec;this.inputSpec=r;const s=super.apply(n,t);return this.inputSpec=a,s}return super.apply(e,t)}call(e,t){return pi((()=>{const n=t.initialState;let r,a,i,o;if(null==n)r=this.forwardLayer.call(e,t),a=this.backwardLayer.call(e,t);else{const i=n.slice(0,n.length/2),o=n.slice(n.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:i})),a=this.backwardLayer.call(e,Object.assign(t,{initialState:o}))}return this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),this.returnSequences&&(a=Xl(a,1)),"concat"===this.mergeMode?o=RD([r,a]):"sum"===this.mergeMode?o=Eo(r,a):"ave"===this.mergeMode?o=Do(.5,Eo(r,a)):"mul"===this.mergeMode?o=Do(r,a):null==this.mergeMode&&(o=[r,a]),this.returnState?null==this.mergeMode?o.concat(i):[o].concat(i):o}))}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){bD(this.forwardLayer.name,(()=>{this.forwardLayer.build(e)})),bD(this.backwardLayer.name,(()=>{this.backwardLayer.build(e)})),this.built=!0}computeMask(e,t){let n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){const e=this.forwardLayer.states.map((e=>null));return Array.isArray(n)?n.concat(e).concat(e):[n].concat(e).concat(e)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const n=iA(t.layer);if(delete t.layer,null!=t.numConstants)throw new BT("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=t;return r.layer=n,new e(r)}}fM.className="Bidirectional",Lo(fM);class mM extends DI{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return pi((()=>("float32"!==(e=gI(e)).dtype&&(e=AD(e,"float32")),Eo(Do(e,this.scale),this.offset))))}}mM.className="Rescaling",Lo(mM);const{resizeBilinear:gM,cropAndResize:yM}=od;class vM extends DI{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,r,a,i,o,s){return pi((()=>{let u,c=!1;const l=[t/i,n/o,(r+t)/i,(a+n)/o],p=[];3===e.rank?(c=!0,u=bp([e])):u=e;for(let e=0;e<u.shape[0];e++)p.push(l);const h=oi(p,[p.length,4]),d=ql(0,p.length,1,"int32"),f=yM(u,h,d,[r,a],"nearest");return AD(c?gI(zp(f)):f,s)}))}upsize(e,t,n,r){return pi((()=>AD(gM(e,[t,n]),r)))}call(e,t){return pi((()=>{const t=gI(e),n=t.dtype,r=t.shape,a=r[r.length-3],i=r[r.length-2];let o=0;a!==this.height&&(o=Math.floor((a-this.height)/2));let s=0;return i!==this.width&&(s=Math.floor((i-this.width)/2),0===s&&(s=1)),o>=0&&s>=0?this.centerCrop(t,o,s,this.height,this.width,a,i,n):this.upsize(e,this.height,this.width,n)}))}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){const t=(e=yI(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}}vM.className="CenterCrop",Lo(vM);class bM extends DI{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return null==(e=yI(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return pi((()=>{let n;if("int32"!==(e=gI(e)).dtype&&(e=AD(e,"int32")),"undefined"!==typeof t.countWeights){if("count"!==this.outputMode)throw new zT("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(t.countWeights));n=gI(t.countWeights)}const r=xc(e),a=wc(e),i=Mc(this.numTokens,r).bufferSync().get(0),o=Oc(a,0).bufferSync().get(0);if(!i||!o)throw new zT("Input values must be between 0 < values <="+" numTokens with numTokens=".concat(this.numTokens));return function(e,t,n,r){let a=gI(e);if("int32"!==a.dtype&&(a=AD(a,"int32")),"int"===t)return a;const i=a.shape;if(0===a.rank&&(a=Tc(a,-1)),"oneHot"===t&&1!==a.shape[a.shape.length-1]&&(a=Tc(a,-1)),a.rank>2)throw new zT("When outputMode is not int, maximum output rank is 2"+" Received outputMode ".concat(t," and input shape ").concat(i)+" which would result in output rank ".concat(a.rank,"."));const o=["multiHot","oneHot"].includes(t),s=a;let u;if(u=Ju(s,"undefined"!==typeof r&&"count"===t?r:[],n,o),"tfIdf"!==t)return u;if(r)return Do(u,r);throw new zT("When outputMode is 'tfIdf', weights must be provided.")}(e,this.outputMode,this.numTokens,n)}))}}bM.className="CategoryEncoding",Lo(bM);const xM=new Set(["bilinear","nearest"]);class wM extends DI{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation){if(!xM.has(e.interpolation))throw new zT("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));this.interpolation=e.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(e.cropToAspectRatio)}computeOutputShape(e){const t=(e=yI(e))[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return pi((()=>{const t=[this.height,this.width];if("bilinear"===this.interpolation)return od.resizeBilinear(e,t,!this.cropToAspectRatio);if("nearest"===this.interpolation)return od.resizeNearestNeighbor(e,t,!this.cropToAspectRatio);throw new Error("Interpolation is ".concat(this.interpolation," but only ").concat([...xM]," are supported"))}))}}wM.className="Resizing",Lo(wM);class NM{constructor(e){this.seed=e}next(){if(void 0!==this.seed)return this.seed++}}NM.className="RandomSeed";class SM extends DI{constructor(e){super(e),this.randomGenerator=new NM(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}SM.className="BaseRandomLayer";const kM=new Set(["bilinear","nearest"]);class EM extends SM{constructor(e){super(e);const{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new zT("Invalid factor: ".concat(this.factor,". Must be positive number or tuple of 2 numbers"));this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new zT("factor must have values larger than -1. Got: ".concat(this.factor));if(this.widthUpper<this.widthLower)throw new zT("factor cannot have upper bound less than lower bound.\n        Got upper bound: ".concat(this.widthUpper,".\n        Got lower bound: ").concat(this.widthLower,"\n      "));if(n){if(!kM.has(n))throw new zT("Invalid interpolation parameter: ".concat(n," is not implemented"));this.interpolation=n}}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){const t=(e=yI(e))[2];return[this.imgHeight,-1,t]}call(e,t){return pi((()=>{const t=gI(e);this.imgHeight=t.shape[t.shape.length-3];const n=t.shape[t.shape.length-2];this.widthFactor=Wl([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let r=this.widthFactor.dataSync()[0]*n;r=Math.round(r);const a=[this.imgHeight,r];switch(this.interpolation){case"bilinear":return od.resizeBilinear(e,a);case"nearest":return od.resizeNearestNeighbor(e,a);default:throw new Error("Interpolation is ".concat(this.interpolation,"\n          but only ").concat([...kM]," are supported"))}}))}}EM.className="RandomWidth",Lo(EM);var CM,TM;ye().registerFlag("KEEP_INTERMEDIATE_TENSORS",(()=>!1),(e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(CM||(CM={})),function(e){let t;!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(TM||(TM={}));const DM={};function IM(e){return DM[e]}function AM(e,t,n,r,a){const i=t.inputParams[e];if(i&&void 0!==i.inputIndexStart){const e=i.inputIndexStart,o=0===i.inputIndexEnd?void 0:void 0===i.inputIndexEnd?e+1:i.inputIndexEnd,s=e<0?t.inputNames.length+e:e;if("tensor"===i.type)return FM(t.inputNames[s],n,r,a);if("tensors"===i.type){const i=t.inputs.slice(e,o);return t.inputNames.slice(e,o).filter(((e,t)=>{var n;return"NoOp"!==(null===(n=i[t])||void 0===n?void 0:n.op)})).map((e=>FM(e,n,r,a)))}const u=FM(t.inputNames[s],n,r,a),c=u.dataSync();return"number"===i.type?c[0]:oe(u.shape,c)}const o=t.attrParams[e];return o&&o.value}function FM(e,t,n,r){const[a,i]=RM(e,n);if(null!=r){const e=r.getHashTableHandleByName(a);if(null!=e)return e}const o=n.currentContextIds.find((e=>!!t[OM(a,e)]));return void 0!==o?t[OM(a,o)][i]:void 0}function _M(e,t,n){return t[OM(e,n.currentContextId)]}function MM(e,t){const[n,r,a]=RM(e,t);return[OM(n,t&&t.currentContextId),r,a]}function OM(e,t){return t?"".concat(e,"-").concat(t):e}function RM(e,t){if(""===e)return["",0,void 0];const n=null!=t&&null!=t.parseNodeNameCache;if(n){const n=t.parseNodeNameCache.get(e);if(null!=n)return n}const r=e.split(":");let a;if(1===r.length)a=[e,0,void 0];else{const e=r[0],t=3===r.length?r[1]:void 0;a=[e,Number(r[r.length-1]),t]}return n&&t.parseNodeNameCache.set(e,a),a}function zM(e,t,n){let r=AM("pad",e,t,n);if("explicit"===r){r=AM("explicitPaddings",e,t,n);const a=[[0,0],[0,0],[0,0],[0,0]];for(let e=0;e<4;e++)a[e][0]=r[2*e],a[e][1]=r[2*e+1];return a}return r}function BM(e){return e.kept?e:So(e)}const LM=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],PM=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],UM=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],WM=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],VM=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],qM=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],jM=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],GM=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],HM=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],KM=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],XM=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],YM=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],$M=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],ZM=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],QM=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],JM=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],eO=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],tO=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],nO=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];class rO{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[].concat(...[s,u,c,l,p,h,d,f,m,g,y,v,b,x,w,N,S,k,E].map((e=>e.json)));this.opMappers=e.reduce(((e,t)=>(e[t.tfOpName]=t,e)),{})}transformGraph(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.node,r=[],a=[],i=[],o=n.reduce(((e,t)=>(e[t.name]=this.mapNode(t),t.op.startsWith("Placeholder")?r.push(e[t.name]):"Const"===t.op?a.push(e[t.name]):null!=t.input&&0!==t.input.length||i.push(e[t.name]),e)),{});let s=[];const u=[];let c={},l={};null!=t&&(c=this.mapSignatureEntries(t.inputs),l=this.mapSignatureEntries(t.outputs));const p=Object.keys(o);p.forEach((e=>{const t=o[e];t.inputNames.forEach(((e,n)=>{const[r,,a]=MM(e),i=o[r];if(null!=i.outputs){const e=i.outputs.indexOf(a);if(-1!==e){const a="".concat(r,":").concat(e);t.inputNames[n]=a}}t.inputs.push(i),i.children.push(t)}))})),0===Object.keys(l).length?p.forEach((e=>{const t=o[e];0===t.children.length&&u.push(t)})):Object.keys(l).forEach((e=>{const[t]=MM(e),n=o[t];null!=n&&(n.signatureKey=l[e],u.push(n))})),Object.keys(c).length>0?Object.keys(c).forEach((e=>{const[t]=MM(e),n=o[t];n&&(n.signatureKey=c[e],s.push(n))})):s=r;let h={};null!=e.library&&null!=e.library.function&&(h=e.library.function.reduce(((e,t)=>(e[t.signature.name]=this.mapFunction(t),e)),{}));const d={nodes:o,inputs:s,outputs:u,weights:a,placeholders:r,signature:t,functions:h};return i.length>0&&(d.initNodes=i),d}mapSignatureEntries(e){return Object.keys(e||{}).reduce(((t,n)=>(t[e[n].name]=n,t)),{})}mapNode(e){const t=IM(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});const n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((e=>e.startsWith("^")?e.slice(1):e)),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return null!=t.inputs&&(n.inputParams=t.inputs.reduce(((e,t)=>(e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e)),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce(((t,n)=>{const r=n.type;let a;switch(n.type){case"string":a=iO(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=iO(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":a=mO(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=mO(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":a=sO(e.attr,n.tfName,n.defaultValue||0),void 0===a&&n.tfDeprecatedName&&(a=sO(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":a=fO(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=fO(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":a=oO(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=oO(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":a=yO(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=yO(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":a=dO(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=dO(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":a=gO(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=gO(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":a=lO(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=lO(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":a=pO(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=pO(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":a=cO(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=cO(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(e.op))}return t[n.name]={value:a,type:r},t}),{})),n}mapFunction(e){const t=e.nodeDef,n=[];let r={};null!=t&&(r=t.reduce(((e,t)=>(e[t.name]=this.mapNode(t),"Const"===t.op&&n.push(e[t.name]),e)),{}));const a=[],i=[];e.signature.inputArg.forEach((e=>{const[t]=MM(e.name),n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:uO(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,a.push(n),r[t]=n}));Object.keys(r).forEach((e=>{const t=r[e];t.inputNames.forEach(((e,n)=>{const[a,,i]=MM(e),o=r[a];if(null!=o.outputs){const e=o.outputs.indexOf(i);if(-1!==e){const r="".concat(a,":").concat(e);t.inputNames[n]=r}}t.inputs.push(o),o.children.push(t)}))}));const o=e.ret;e.signature.outputArg.forEach((e=>{const[t,n]=MM(o[e.name]),a=r[t];null!=a&&(a.defaultOutput=n,i.push(a))}));const s=this.mapArgsToSignature(e);return{nodes:r,inputs:a,outputs:i,weights:n,placeholders:[],signature:s}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce(((e,t)=>(e[t.name]=this.mapArgToTensorInfo(t),e)),{}),outputs:e.signature.outputArg.reduce(((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t)),{})}}mapArgToTensorInfo(e,t){let n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}function aO(e,t){const n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){const t=ye().global;if("undefined"!==typeof t.atob)return t.atob(e);if("undefined"!==typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function iO(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=e[t];return null!=a?aO(a.s,r):n}function oO(e,t,n){const r=e[t];return r?r.b:n}function sO(e,t,n){const r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"===typeof a?a:parseInt(a,10)}function uO(e){switch("string"===typeof e&&(e=CM[e]),e){case CM.DT_FLOAT:case CM.DT_HALF:return"float32";case CM.DT_INT32:case CM.DT_INT64:case CM.DT_INT8:case CM.DT_UINT8:return"int32";case CM.DT_BOOL:return"bool";case CM.DT_DOUBLE:return"float32";case CM.DT_STRING:return"string";case CM.DT_COMPLEX64:case CM.DT_COMPLEX128:return"complex64";default:return null}}function cO(e,t,n){const r=e[t];return r&&r.func?r.func.name:n}function lO(e,t,n){const r=e[t];return r&&r.type?uO(r.type):n}function pO(e,t,n){const r=e[t];return r&&r.list&&r.list.type?r.list.type.map((e=>uO(e))):n}function hO(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((e=>"number"===typeof e.size?e.size:parseInt(e.size,10))):[]}function dO(e,t,n){const r=e[t];return r&&r.shape?hO(r.shape):n}function fO(e,t,n){const r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((e=>"number"===typeof e?e:parseInt(e,10))):n}function mO(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=e[t];return a&&a.list&&a.list.s?a.list.s.map((e=>aO(e,r))):n}function gO(e,t,n){const r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((e=>hO(e))):n}function yO(e,t,n){const r=e[t];return r&&r.list&&r.list.b?r.list.b:n}class vO{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map((e=>this.getInput(e))),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce(((e,t)=>(e[t]=this.getAttr(t),e)),{}))}getInput(e){return FM(e,this.tensorMap,this.context)}getAttr(e,t){const n=this.node.rawAttrs[e];if(null!=n.tensor)return FM(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return sO(this.node.rawAttrs,e,t);if(null!=n.s)return iO(this.node.rawAttrs,e,t);if(null!=n.b)return oO(this.node.rawAttrs,e,t);if(null!=n.shape)return dO(this.node.rawAttrs,e,t);if(null!=n.type)return lO(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return fO(this.node.rawAttrs,e,t);if(null!=n.list.s)return mO(this.node.rawAttrs,e,t);if(null!=n.list.shape)return gO(this.node.rawAttrs,e,t);if(null!=n.list.b)return yO(this.node.rawAttrs,e,t);if(null!=n.list.type)return pO(this.node.rawAttrs,e,t)}return t}}function bO(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!==typeof e&&"number"!==typeof t){B(e.length===t.length,(()=>n+" Shapes ".concat(e," and ").concat(t," must match")));for(let r=0;r<e.length;r++){const a=e[r],i=t[r];B(a<0||i<0||a===i,(()=>n+" Shapes ".concat(e," and ").concat(t," must match")))}}}function xO(e){return"number"!==typeof e&&!e.some((e=>e<0))}function wO(e,t,n){let r=NO(e,n);const a=!xO(r);if(a&&0===t.length)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(r));if(a&&t.forEach((e=>{r=NO(e.shape,r)})),!xO(r))throw new Error("Non-fully-defined elementShape: ".concat(r));return r}function NO(e,t){if("number"===typeof e)return t;if("number"===typeof t)return e;if(e.length!==t.length)throw new Error("Incompatible ranks during merge: ".concat(e," vs. ").concat(t));const n=[];for(let r=0;r<e.length;++r){const a=e[r],i=t[r];if(a>=0&&i>=0&&a!==i)throw new Error("Incompatible shape during merge: ".concat(e," vs. ").concat(t));n[r]=a>=0?a:i}return n}class SO{constructor(e,t,n,r,a,i,o){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=a,this.dynamicSize=i,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.idTensor=Mo(0),di(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach((t=>{null!=e&&e.has(t.tensor.id)||t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));const t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map((e=>this.read(e)))}write(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));const n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),bO(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,di(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach(((e,n)=>this.write(e,t[n])))}gather(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(let t=0;t<this.size();t++)e.push(t)}if(0===e.length)return oi([],[0].concat(this.elementShape));const n=this.readMany(e);return bO(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),bp(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(0===this.size())return oi([],[0].concat(this.elementShape));const t=[];for(let r=0;r<this.size();r++)t.push(r);const n=this.readMany(t);return bO(this.elementShape,n[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(n[0].shape,")")),wu(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));const n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,zp(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));let n=0;const r=e.map((e=>(n+=e,n)));if(n!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(n,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");const a=0===n?0:t.size/n,i=[];pi((()=>{t=vu(t,[1,n,a]);for(let n=0;n<e.length;++n){const o=[0,0===n?0:r[n-1],0],s=[1,e[n],a];i[n]=vu(ku(t,o,s),this.elementShape)}return i}));const o=[];for(let s=0;s<e.length;s++)o[s]=s;this.writeMany(o,i)}}class kO{get id(){return this.idTensor.id}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;this.tensors=e,this.elementShape=t,this.elementDtype=n,null!=e&&e.forEach((e=>{if(n!==e.dtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(e.dtype));bO(t,e.shape,"TensorList shape mismatch: "),di(e)})),this.idTensor=Mo(0),this.maxNumElements=r,di(this.idTensor)}copy(){return new kO([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach((t=>{null!=e&&e.has(t.id)||t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(-1!==n&&this.tensors.length!==n)throw new Error("Operation expected a list with ".concat(n," elements but got a list with ").concat(this.tensors.length," elements."));bO(e,this.elementShape,"TensorList shape mismatch: ");const r=wO(this.elementShape,this.tensors,e);return pi((()=>{const e=this.tensors.map((e=>vu(e,r)));return bp(e,0)}))}popBack(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");const n=wO(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,bO(r.shape,e,"TensorList shape mismatch: "),vu(r,n)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(bO(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");di(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(e));if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error("TensorListResize input size ".concat(e," is greater maxNumElement ").concat(this.maxNumElements,"."));const t=new kO([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let n=0;n<Math.min(this.tensors.length,e);++n)t.tensors[n]=this.tensors[n];return t}getItem(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[e])throw new Error("element at index ".concat(e," is null."));bO(this.tensors[e].shape,t,"TensorList shape mismatch: ");const r=wO(this.elementShape,this.tensors,t);return vu(this.tensors[e],r)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));bO(this.elementShape,t.shape,"TensorList shape mismatch: "),di(t),null!=this.tensors[e]&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,n){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));bO(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=wO(this.elementShape,this.tensors,n);return 0===e.length?oi([],[0].concat(r)):pi((()=>{const t=e.map((e=>vu(this.tensors[e],r)));return bp(t,0)}))}concat(e,t){if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));bO(this.elementShape,t,"TensorList shape mismatch: ");const n=wO(this.elementShape,this.tensors,t);return 0===this.size()?oi([],[0].concat(n)):pi((()=>{const e=this.tensors.map((e=>vu(e,n)));return wu(e,0)}))}}const EO=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{const r=AM("thenBranch",e,t,n),a=AM("elseBranch",e,t,n),i=AM("cond",e,t,n),o=AM("args",e,t,n);return(await i.data())[0]?n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[a].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=AM("body",e,t,n),a=AM("cond",e,t,n),i=AM("args",e,t,n),o=await n.functionMap[a].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),s=i.map((e=>e.id));let u=await o[0].data();o.forEach((e=>{e.kept||-1!==s.indexOf(e.id)||e.dispose()}));let c=i;for(;u[0];){const e=c;c=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const t=c.map((e=>e.id));e.forEach((e=>{e.kept||-1!==s.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()}));const i=await n.functionMap[a].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);u=await i[0].data(),i.forEach((e=>{e.kept||-1!==s.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()}))}return c}case"LoopCond":return[BM(AM("pred",e,t,n))];case"Switch":{const r=AM("pred",e,t,n);let a=AM("data",e,t,n);return a.kept||(a=BM(a)),(await r.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{const r=e.inputNames.find((e=>void 0!==FM(e,t,n)));if(r){return[BM(FM(r,t,n))]}return}case"Enter":{const r=AM("frameName",e,t,n),a=AM("tensor",e,t,n);return n.enterFrame(r),[BM(a)]}case"Exit":{const r=AM("tensor",e,t,n);return n.exitFrame(),[BM(r)]}case"NextIteration":{const r=AM("tensor",e,t,n);return n.nextIteration(),[BM(r)]}case"TensorArrayV3":{const r=AM("size",e,t,n),a=AM("dtype",e,t,n),i=AM("elementShape",e,t,n),o=AM("dynamicSize",e,t,n),s=AM("clearAfterRead",e,t,n),u=AM("identicalElementShapes",e,t,n),c=AM("name",e,t,n),l=new SO(c,a,r,i,u,o,s);return n.addTensorArray(l),[l.idTensor,Mo(1)]}case"TensorArrayWriteV3":{const r=AM("tensorArrayId",e,t,n),a=AM("index",e,t,n),i=AM("tensor",e,t,n),o=n.getTensorArray(r.id);return o.write(a,i),[o.idTensor]}case"TensorArrayReadV3":{const r=AM("tensorArrayId",e,t,n),a=AM("index",e,t,n);return[n.getTensorArray(r.id).read(a)]}case"TensorArrayGatherV3":{const r=AM("tensorArrayId",e,t,n),a=AM("indices",e,t,n),i=AM("dtype",e,t,n);return[n.getTensorArray(r.id).gather(a,i)]}case"TensorArrayScatterV3":{const r=AM("tensorArrayId",e,t,n),a=AM("indices",e,t,n),i=AM("tensor",e,t,n),o=n.getTensorArray(r.id);return o.scatter(a,i),[o.idTensor]}case"TensorArrayConcatV3":{const r=AM("tensorArrayId",e,t,n),a=n.getTensorArray(r.id),i=AM("dtype",e,t,n);return[a.concat(i)]}case"TensorArraySplitV3":{const r=AM("tensorArrayId",e,t,n),a=AM("tensor",e,t,n),i=AM("lengths",e,t,n),o=n.getTensorArray(r.id);return o.split(i,a),[o.idTensor]}case"TensorArraySizeV3":{const r=AM("tensorArrayId",e,t,n);return[Mo(n.getTensorArray(r.id).size(),"int32")]}case"TensorArrayCloseV3":{const r=AM("tensorArrayId",e,t,n),a=n.getTensorArray(r.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{const r=AM("tensorListId",e,t,n),a=AM("index",e,t,n),i=AM("tensor",e,t,n),o=n.getTensorList(r.id);return o.setItem(a,i),[o.idTensor]}case"TensorListGetItem":{const r=AM("tensorListId",e,t,n),a=AM("index",e,t,n),i=AM("elementShape",e,t,n),o=AM("elementDType",e,t,n);return[n.getTensorList(r.id).getItem(a,i,o)]}case"TensorListScatterV2":case"TensorListScatter":{const r=AM("indices",e,t,n),a=function(e,t,n,r){if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));const a=Math.max(...t);if(null!=r&&-1!==r&&a>=r)throw new Error("Max index must be < array size (".concat(a,"  vs. ").concat(r,")"));const i=new kO([],n,e.dtype,r),o=zp(e,0);return t.forEach(((e,t)=>{i.setItem(e,o[t])})),i}(AM("tensor",e,t,n),r,AM("elementShape",e,t,n),AM("numElements",e,t,n));return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=AM("elementShape",e,t,n),a=AM("elementDType",e,t,n);let i;i="TensorListReserve"===e.op?"numElements":"maxNumElements";const o=AM(i,e,t,n),s=function(e,t,n,r){return new kO([],e,t,r)}(r,a,0,"TensorListReserve"===e.op?-1:o);return n.addTensorList(s),[s.idTensor]}case"TensorListGather":{const r=AM("tensorListId",e,t,n),a=AM("indices",e,t,n),i=AM("elementShape",e,t,n),o=AM("elementDType",e,t,n);return[n.getTensorList(r.id).gather(a,o,i)]}case"TensorListStack":{const r=AM("tensorListId",e,t,n),a=AM("elementShape",e,t,n),i=AM("elementDType",e,t,n),o=AM("numElements",e,t,n);return[n.getTensorList(r.id).stack(a,i,o)]}case"TensorListFromTensor":{const r=function(e,t,n){const r=e.dtype;if(e.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(e.shape));if(e.dtype!==n)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(n));bO(e.shape.slice(1),t,"TensorList shape mismatch: ");const a=zp(e);return new kO(a,t,r)}(AM("tensor",e,t,n),AM("elementShape",e,t,n),AM("elementDType",e,t,n));return n.addTensorList(r),[r.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=AM("tensorListId",e,t,n),a=n.getTensorList(r.id),i=AM("dtype",e,t,n),o=AM("elementShape",e,t,n);return[a.concat(i,o)]}case"TensorListPushBack":{const r=AM("tensorListId",e,t,n),a=AM("tensor",e,t,n),i=n.getTensorList(r.id);return i.pushBack(a),[i.idTensor]}case"TensorListPopBack":{const r=AM("tensorListId",e,t,n),a=AM("elementShape",e,t,n),i=AM("elementDType",e,t,n);return[n.getTensorList(r.id).popBack(a,i)]}case"TensorListSplit":{const r=AM("tensor",e,t,n),a=AM("elementShape",e,t,n),i=function(e,t,n){let r=0;const a=t.map((e=>(r+=e,r)));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(e.shape));const i=NO(e.shape.slice(1),n),o=0===r?0:e.size/r,s=pi((()=>{const n=[];e=vu(e,[1,r,o]);for(let r=0;r<t.length;++r){const s=[0,0===r?0:a[r-1],0],u=[1,t[r],o];n[r]=vu(ku(e,s,u),i)}return e.dispose(),n})),u=new kO([],n,e.dtype,t.length);for(let c=0;c<s.length;c++)u.setItem(c,s[c]);return u}(r,AM("lengths",e,t,n),a);return n.addTensorList(i),[i.idTensor]}case"TensorListLength":{const r=AM("tensorListId",e,t,n);return[Mo(n.getTensorList(r.id).size(),"int32")]}case"TensorListResize":{const r=AM("tensorListId",e,t,n),a=AM("size",e,t,n),i=n.getTensorList(r.id).resize(a);return n.addTensorList(i),[i.idTensor]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}};function CO(e,t,n){const[r,a]=AM("fusedOps",e,t,n),i="biasadd"===r,o=!i,s="prelu"===a,u="fusedbatchnorm"===r,c=AM("numArgs",e,t,n);if(i){if(s&&2!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&i&&1!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const l=AM("strides",e,t,n),p=zM(e,t,n),h=AM("dataFormat",e,t,n).toUpperCase(),d=AM("dilations",e,t,n);let[f,m]=AM("args",e,t,n);o&&(m=f,f=void 0);return{stride:l,pad:p,dataFormat:h,dilations:d,biasArg:f,preluArg:m,activationFunc:a,leakyreluAlpha:AM("leakyreluAlpha",e,t,n)}}function TO(e,t,n){return{boxes:AM("boxes",e,t,n),scores:AM("scores",e,t,n),maxOutputSize:AM("maxOutputSize",e,t,n),iouThreshold:AM("iouThreshold",e,t,n),scoreThreshold:AM("scoreThreshold",e,t,n),softNmsSigma:AM("softNmsSigma",e,t,n)}}class DO{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=Mo(0),this.tensorMap=new Map,di(this.handle)}clearAndClose(){this.tensorMap.forEach((e=>e.dispose())),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Mo(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return this.tensorMap.forEach((e=>e.dispose())),this.tensorMap.clear(),pi((()=>{const e=zp(t),r=n.length,a=e.length;B(r===a,(()=>"The number of elements doesn't match, keys has "+"".concat(r," elements, the values has ").concat(a," ")+"elements."));for(let t=0;t<r;t++){const r=n[t],a=e[t];di(a),this.tensorMap.set(r,a)}return this.handle}))}async find(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return pi((()=>{const e=[];for(let r=0;r<n.length;r++){const a=n[r],i=this.findWithDefault(a,t);e.push(i)}return bp(e)}))}findWithDefault(e,t){const n=this.tensorMap.get(e);return null!=n?n:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(e.dtype));if(t.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(t.dtype))}}function IO(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:pi;const i=((e,t,n)=>{switch(e.category){case"arithmetic":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(AM("a",e,t,n),AM("b",e,t,n))];case"AddN":return[r.addN(AM("tensors",e,t,n))];case"FloorMod":case"Mod":return[r.mod(AM("a",e,t,n),AM("b",e,t,n))];case"Mul":return[r.mul(AM("a",e,t,n),AM("b",e,t,n))];case"RealDiv":case"Div":return[r.div(AM("a",e,t,n),AM("b",e,t,n))];case"DivNoNan":return[r.divNoNan(AM("a",e,t,n),AM("b",e,t,n))];case"FloorDiv":return[r.floorDiv(AM("a",e,t,n),AM("b",e,t,n))];case"Sub":return[r.sub(AM("a",e,t,n),AM("b",e,t,n))];case"Minimum":return[r.minimum(AM("a",e,t,n),AM("b",e,t,n))];case"Maximum":return[r.maximum(AM("a",e,t,n),AM("b",e,t,n))];case"Pow":return[r.pow(AM("a",e,t,n),AM("b",e,t,n))];case"SquaredDifference":return[r.squaredDifference(AM("a",e,t,n),AM("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"basic_math":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"Abs":case"ComplexAbs":return[r.abs(AM("x",e,t,n))];case"Acos":return[r.acos(AM("x",e,t,n))];case"Acosh":return[r.acosh(AM("x",e,t,n))];case"Asin":return[r.asin(AM("x",e,t,n))];case"Asinh":return[r.asinh(AM("x",e,t,n))];case"Atan":return[r.atan(AM("x",e,t,n))];case"Atan2":return[r.atan2(AM("x",e,t,n),AM("y",e,t,n))];case"Atanh":return[r.atanh(AM("x",e,t,n))];case"Ceil":return[r.ceil(AM("x",e,t,n))];case"Complex":return[r.complex(AM("real",e,t,n),AM("imag",e,t,n))];case"Cos":return[r.cos(AM("x",e,t,n))];case"Cosh":return[r.cosh(AM("x",e,t,n))];case"Elu":return[r.elu(AM("x",e,t,n))];case"Erf":return[r.erf(AM("x",e,t,n))];case"Exp":return[r.exp(AM("x",e,t,n))];case"Expm1":return[r.expm1(AM("x",e,t,n))];case"Floor":return[r.floor(AM("x",e,t,n))];case"Log":return[r.log(AM("x",e,t,n))];case"Log1p":return[r.log1p(AM("x",e,t,n))];case"Imag":return[r.imag(AM("x",e,t,n))];case"Neg":return[r.neg(AM("x",e,t,n))];case"Reciprocal":return[r.reciprocal(AM("x",e,t,n))];case"Real":return[r.real(AM("x",e,t,n))];case"Relu":return[r.relu(AM("x",e,t,n))];case"Round":return[r.round(AM("x",e,t,n))];case"Selu":return[r.selu(AM("x",e,t,n))];case"Sigmoid":return[r.sigmoid(AM("x",e,t,n))];case"Sin":return[r.sin(AM("x",e,t,n))];case"Sign":return[r.sign(AM("x",e,t,n))];case"Sinh":return[r.sinh(AM("x",e,t,n))];case"Softplus":return[r.softplus(AM("x",e,t,n))];case"Sqrt":return[r.sqrt(AM("x",e,t,n))];case"Square":return[r.square(AM("x",e,t,n))];case"Tanh":return[r.tanh(AM("x",e,t,n))];case"Tan":return[r.tan(AM("x",e,t,n))];case"ClipByValue":return[r.clipByValue(AM("x",e,t,n),AM("clipValueMin",e,t,n),AM("clipValueMax",e,t,n))];case"Relu6":return[r.relu6(AM("x",e,t,n))];case"Rsqrt":return[r.rsqrt(FM(e.inputNames[0],t,n))];case"LeakyRelu":return[r.leakyRelu(AM("x",e,t,n),AM("alpha",e,t,n))];case"Prelu":return[r.prelu(AM("x",e,t,n),AM("alpha",e,t,n))];case"IsNan":return[r.isNaN(FM(e.inputNames[0],t,n))];case"IsInf":return[r.isInf(FM(e.inputNames[0],t,n))];case"IsFinite":return[r.isFinite(FM(e.inputNames[0],t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"control":return EO(e,t,n);case"convolution":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"Conv1D":{const a=AM("stride",e,t,n),i=AM("pad",e,t,n),o=AM("dataFormat",e,t,n).toUpperCase(),s=AM("dilation",e,t,n);return[r.conv1d(AM("x",e,t,n),AM("filter",e,t,n),a,i,o,s)]}case"Conv2D":{const a=AM("strides",e,t,n),i=zM(e,t,n),o=AM("dataFormat",e,t,n).toUpperCase(),s=AM("dilations",e,t,n);return[r.conv2d(AM("x",e,t,n),AM("filter",e,t,n),[a[1],a[2]],i,o,[s[1],s[2]])]}case"_FusedConv2D":{const{stride:a,pad:i,dataFormat:o,dilations:s,biasArg:u,preluArg:c,activationFunc:l,leakyreluAlpha:p}=CO(e,t,n);return[r.fused.conv2d({x:AM("x",e,t,n),filter:AM("filter",e,t,n),strides:[a[1],a[2]],pad:i,dataFormat:o,dilations:[s[1],s[2]],bias:u,activation:l,preluActivationWeights:c,leakyreluAlpha:p})]}case"FusedDepthwiseConv2dNative":{const{stride:a,pad:i,dataFormat:o,dilations:s,biasArg:u,preluArg:c,activationFunc:l,leakyreluAlpha:p}=CO(e,t,n);return[r.fused.depthwiseConv2d({x:AM("x",e,t,n),filter:AM("filter",e,t,n),strides:[a[1],a[2]],pad:i,dataFormat:o,dilations:[s[1],s[2]],bias:u,activation:l,preluActivationWeights:c,leakyreluAlpha:p})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const a=AM("outputShape",e,t,n),i=AM("strides",e,t,n),o=zM(e,t,n);return[r.conv2dTranspose(AM("x",e,t,n),AM("filter",e,t,n),a,[i[1],i[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const a=AM("strides",e,t,n),i=zM(e,t,n),o=AM("dilations",e,t,n),s=AM("dataFormat",e,t,n).toUpperCase();return[r.depthwiseConv2d(AM("input",e,t,n),AM("filter",e,t,n),[a[1],a[2]],i,s,[o[1],o[2]])]}case"Conv3D":{const a=AM("strides",e,t,n),i=AM("pad",e,t,n),o=AM("dataFormat",e,t,n).toUpperCase(),s=AM("dilations",e,t,n);return[r.conv3d(AM("x",e,t,n),AM("filter",e,t,n),[a[1],a[2],a[3]],i,o,[s[1],s[2],s[3]])]}case"AvgPool":{const a=AM("strides",e,t,n),i=AM("pad",e,t,n),o=AM("kernelSize",e,t,n);return[r.avgPool(AM("x",e,t,n),[o[1],o[2]],[a[1],a[2]],i)]}case"MaxPool":{const a=AM("strides",e,t,n),i=AM("pad",e,t,n),o=AM("kernelSize",e,t,n);return[r.maxPool(AM("x",e,t,n),[o[1],o[2]],[a[1],a[2]],i)]}case"MaxPoolWithArgmax":{const a=AM("strides",e,t,n),i=AM("pad",e,t,n),o=AM("kernelSize",e,t,n),s=AM("includeBatchInIndex",e,t,n),{result:u,indexes:c}=r.maxPoolWithArgmax(AM("x",e,t,n),[o[1],o[2]],[a[1],a[2]],i,s);return[u,c]}case"AvgPool3D":{const a=AM("strides",e,t,n),i=AM("pad",e,t,n),o=AM("kernelSize",e,t,n);return[r.avgPool3d(AM("x",e,t,n),[o[1],o[2],o[3]],[a[1],a[2],a[3]],i)]}case"MaxPool3D":{const a=AM("strides",e,t,n),i=AM("pad",e,t,n),o=AM("kernelSize",e,t,n);return[r.maxPool3d(AM("x",e,t,n),[o[1],o[2],o[3]],[a[1],a[2],a[3]],i)]}case"Dilation2D":{const a=AM("strides",e,t,n),i=AM("pad",e,t,n),o=AM("dilations",e,t,n),s=a[1],u=a[2],c=o[1],l=o[2];return[r.dilation2d(AM("x",e,t,n),AM("filter",e,t,n),[s,u],i,[c,l],"NHWC")]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"creation":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"Fill":{const a=AM("shape",e,t,n),i=AM("dtype",e,t,n),o=AM("value",e,t,n);return[r.fill(a,o,i)]}case"LinSpace":{const a=AM("start",e,t,n),i=AM("stop",e,t,n),o=AM("num",e,t,n);return[r.linspace(a,i,o)]}case"Multinomial":{const a=AM("logits",e,t,n),i=AM("numSamples",e,t,n),o=AM("seed",e,t,n);return[r.multinomial(a,i,o)]}case"OneHot":{const a=AM("indices",e,t,n),i=AM("depth",e,t,n),o=AM("onValue",e,t,n),s=AM("offValue",e,t,n),u=AM("dtype",e,t,n);return[r.oneHot(a,i,o,s,u)]}case"Ones":return[r.ones(AM("shape",e,t,n),AM("dtype",e,t,n))];case"OnesLike":return[r.onesLike(AM("x",e,t,n))];case"RandomStandardNormal":return[r.randomStandardNormal(AM("shape",e,t,n),AM("dtype",e,t,n),AM("seed",e,t,n))];case"RandomUniform":return[r.randomUniform(AM("shape",e,t,n),AM("minval",e,t,n),AM("maxval",e,t,n),AM("dtype",e,t,n))];case"RandomUniformInt":return[r.randomUniformInt(AM("shape",e,t,n),AM("minval",e,t,n),AM("maxval",e,t,n),AM("seed",e,t,n))];case"Range":{const a=AM("start",e,t,n),i=AM("stop",e,t,n),o=AM("step",e,t,n);return[r.range(a,i,o,AM("dtype",e,t,n))]}case"TruncatedNormal":{const a=AM("shape",e,t,n),i=AM("mean",e,t,n),o=AM("stdDev",e,t,n),s=AM("seed",e,t,n);return[r.truncatedNormal(a,i,o,AM("dtype",e,t,n),s)]}case"Zeros":return[r.zeros(AM("shape",e,t,n),AM("dtype",e,t,n))];case"ZerosLike":return[r.zerosLike(AM("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"dynamic":return async function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:C;switch(e.op){case"NonMaxSuppressionV5":{const{boxes:r,scores:i,maxOutputSize:o,iouThreshold:s,scoreThreshold:u,softNmsSigma:c}=TO(e,t,n),l=await a.image.nonMaxSuppressionWithScoreAsync(r,i,o,s,u,c);return[l.selectedIndices,l.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:r,scores:i,maxOutputSize:o,iouThreshold:s,scoreThreshold:u}=TO(e,t,n),c=AM("padToMaxOutputSize",e,t,n),l=await a.image.nonMaxSuppressionPaddedAsync(r,i,o,s,u,c);return[l.selectedIndices,l.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:r,scores:i,maxOutputSize:o,iouThreshold:s,scoreThreshold:u}=TO(e,t,n);return[await a.image.nonMaxSuppressionAsync(r,i,o,s,u)]}case"Where":{const r=a.cast(AM("condition",e,t,n),"bool"),i=[await a.whereAsync(r)];return r.dispose(),i}case"ListDiff":return a.setdiff1dAsync(AM("x",e,t,n),AM("y",e,t,n));default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n);case"evaluation":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"LowerBound":{const a=AM("sortedSequence",e,t,n),i=AM("values",e,t,n);return[r.lowerBound(a,i)]}case"TopKV2":{const a=AM("x",e,t,n),i=AM("k",e,t,n),o=AM("sorted",e,t,n),s=r.topk(a,i,o);return[s.values,s.indices]}case"UpperBound":{const a=AM("sortedSequence",e,t,n),i=AM("values",e,t,n);return[r.upperBound(a,i)]}case"Unique":{const a=AM("x",e,t,n),i=r.unique(a);return[i.values,i.indices]}case"UniqueV2":{const a=AM("x",e,t,n),i=AM("axis",e,t,n),o=r.unique(a,i);return[o.values,o.indices]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"image":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"ResizeBilinear":{const a=AM("images",e,t,n),i=AM("size",e,t,n),o=AM("alignCorners",e,t,n),s=AM("halfPixelCenters",e,t,n);return[r.image.resizeBilinear(a,[i[0],i[1]],o,s)]}case"ResizeNearestNeighbor":{const a=AM("images",e,t,n),i=AM("size",e,t,n),o=AM("alignCorners",e,t,n),s=AM("halfPixelCenters",e,t,n);return[r.image.resizeNearestNeighbor(a,[i[0],i[1]],o,s)]}case"CropAndResize":{const a=AM("image",e,t,n),i=AM("boxes",e,t,n),o=AM("boxInd",e,t,n),s=AM("cropSize",e,t,n),u=AM("method",e,t,n),c=AM("extrapolationValue",e,t,n);return[r.image.cropAndResize(a,i,o,s,u,c)]}case"ImageProjectiveTransformV3":{const a=AM("images",e,t,n),i=AM("transforms",e,t,n),o=AM("outputShape",e,t,n),s=AM("fillValue",e,t,n),u=AM("interpolation",e,t,n),c=AM("fillMode",e,t,n);return[r.image.transform(a,i,u.toLowerCase(),c.toLowerCase(),s,o)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"graph":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":const a=AM("default",e,t,n);return[FM(e.name,t,n)||a];case"Placeholder":return[FM(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[BM(AM("x",e,t,n))];case"IdentityN":return AM("x",e,t,n).map((e=>BM(e)));case"Shape":return[r.tensor1d(AM("x",e,t,n).shape,"int32")];case"ShapeN":return AM("x",e,t,n).map((e=>r.tensor1d(e.shape)));case"Size":return[r.scalar(AM("x",e,t,n).size,"int32")];case"Rank":return[r.scalar(AM("x",e,t,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const i=AM("x",e,t,n),o=AM("data",e,t,n),s=AM("message",e,t,n),u=AM("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(let e=0;e<o.length;e++)console.log(Array.prototype.slice.call(o[e].dataSync()).slice(0,u));return[i];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"logical":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"Equal":return[r.equal(AM("a",e,t,n),AM("b",e,t,n))];case"NotEqual":return[r.notEqual(AM("a",e,t,n),AM("b",e,t,n))];case"Greater":return[r.greater(AM("a",e,t,n),AM("b",e,t,n))];case"GreaterEqual":return[r.greaterEqual(AM("a",e,t,n),AM("b",e,t,n))];case"Less":return[r.less(AM("a",e,t,n),AM("b",e,t,n))];case"LessEqual":return[r.lessEqual(AM("a",e,t,n),AM("b",e,t,n))];case"LogicalAnd":return[r.logicalAnd(AM("a",e,t,n),AM("b",e,t,n))];case"LogicalNot":return[r.logicalNot(AM("a",e,t,n))];case"LogicalOr":return[r.logicalOr(AM("a",e,t,n),AM("b",e,t,n))];case"Select":case"SelectV2":return[r.where(AM("condition",e,t,n),AM("a",e,t,n),AM("b",e,t,n))];case"BitwiseAnd":return[r.bitwiseAnd(AM("a",e,t,n),AM("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"matrices":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(AM("a",e,t,n),AM("b",e,t,n),AM("transposeA",e,t,n),AM("transposeB",e,t,n))];case"Einsum":return[r.einsum(AM("equation",e,t,n),...AM("tensors",e,t,n))];case"Transpose":return[r.transpose(AM("x",e,t,n),AM("perm",e,t,n))];case"_FusedMatMul":const[a,i]=AM("fusedOps",e,t,n),o="biasadd"===a,s="prelu"===i,u=AM("numArgs",e,t,n),c=AM("leakyreluAlpha",e,t,n);if(o){if(s&&2!==u)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&1!==u)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[l,p]=AM("args",e,t,n);return[r.fused.matMul({a:AM("a",e,t,n),b:AM("b",e,t,n),transposeA:AM("transposeA",e,t,n),transposeB:AM("transposeB",e,t,n),bias:l,activation:i,preluActivationWeights:p,leakyreluAlpha:c})];case"MatrixBandPart":return[r.linalg.bandPart(AM("a",e,t,n),AM("numLower",e,t,n),AM("numUpper",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"normalization":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"EuclideanNorm":return[r.euclideanNorm(AM("x",e,t,n),AM("axis",e,t,n),AM("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[r.batchNorm(AM("x",e,t,n),AM("mean",e,t,n),AM("variance",e,t,n),AM("offset",e,t,n),AM("scale",e,t,n),AM("epsilon",e,t,n))];case"LRN":return[r.localResponseNormalization(AM("x",e,t,n),AM("radius",e,t,n),AM("bias",e,t,n),AM("alpha",e,t,n),AM("beta",e,t,n))];case"Softmax":return[r.softmax(AM("x",e,t,n))];case"LogSoftmax":return[r.logSoftmax(AM("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"ragged":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"RaggedGather":{const{outputNestedSplits:a,outputDenseValues:i}=r.raggedGather(AM("paramsNestedSplits",e,t,n),AM("paramsDenseValues",e,t,n),AM("indices",e,t,n),AM("outputRaggedRank",e,t,n));return a.concat(i)}case"RaggedRange":{const{rtNestedSplits:a,rtDenseValues:i}=r.raggedRange(AM("starts",e,t,n),AM("limits",e,t,n),AM("splits",e,t,n));return[a,i]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(AM("shape",e,t,n),AM("values",e,t,n),AM("defaultValue",e,t,n),AM("rowPartitionTensors",e,t,n),AM("rowPartitionTypes",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"reduction":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"Max":{const a=AM("axis",e,t,n),i=AM("keepDims",e,t,n);return[r.max(AM("x",e,t,n),a,i)]}case"Mean":{const a=AM("axis",e,t,n),i=AM("keepDims",e,t,n);return[r.mean(AM("x",e,t,n),a,i)]}case"Min":{const a=AM("axis",e,t,n),i=AM("keepDims",e,t,n);return[r.min(AM("x",e,t,n),a,i)]}case"Sum":{const a=AM("axis",e,t,n),i=AM("keepDims",e,t,n);return[r.sum(AM("x",e,t,n),a,i)]}case"All":{const a=AM("axis",e,t,n),i=AM("keepDims",e,t,n);return[r.all(AM("x",e,t,n),a,i)]}case"Any":{const a=AM("axis",e,t,n),i=AM("keepDims",e,t,n);return[r.any(AM("x",e,t,n),a,i)]}case"ArgMax":{const a=AM("axis",e,t,n);return[r.argMax(AM("x",e,t,n),a)]}case"ArgMin":{const a=AM("axis",e,t,n);return[r.argMin(AM("x",e,t,n),a)]}case"Prod":{const a=AM("axis",e,t,n),i=AM("keepDims",e,t,n);return[r.prod(AM("x",e,t,n),a,i)]}case"Cumprod":{const a=AM("axis",e,t,n),i=AM("exclusive",e,t,n),o=AM("reverse",e,t,n);return[r.cumprod(AM("x",e,t,n),a,i,o)]}case"Cumsum":{const a=AM("axis",e,t,n),i=AM("exclusive",e,t,n),o=AM("reverse",e,t,n);return[r.cumsum(AM("x",e,t,n),a,i,o)]}case"Bincount":const a=AM("x",e,t,n),i=AM("weights",e,t,n),o=AM("size",e,t,n);return[r.bincount(a,i,o)];case"DenseBincount":{const a=AM("x",e,t,n),i=AM("weights",e,t,n),o=AM("size",e,t,n),s=AM("binaryOutput",e,t,n);return[r.denseBincount(a,i,o,s)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"slice_join":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"ConcatV2":case"Concat":{const a=AM("n",e,t,n),i=AM("axis",e,t,n);let o=AM("tensors",e,t,n);return o=o.slice(0,a),[r.concat(o,i)]}case"Gather":{const a=AM("x",e,t,n),i=AM("indices",e,t,n);return[r.gather(a,r.cast(i,"int32"),0)]}case"GatherV2":{const a=AM("axis",e,t,n),i=AM("batchDims",e,t,n),o=AM("x",e,t,n),s=AM("indices",e,t,n);return[r.gather(o,r.cast(s,"int32"),a,i)]}case"Reverse":{const a=AM("dims",e,t,n),i=[];for(let e=0;e<a.length;e++)a[e]&&i.push(e);const o=AM("x",e,t,n);return[r.reverse(o,i)]}case"ReverseV2":{const a=AM("axis",e,t,n),i=AM("x",e,t,n);return[r.reverse(i,a)]}case"Slice":{const a=AM("begin",e,t,n),i=AM("size",e,t,n);return[r.slice(AM("x",e,t,n),a,i)]}case"StridedSlice":{const a=AM("begin",e,t,n),i=AM("end",e,t,n),o=AM("strides",e,t,n),s=AM("beginMask",e,t,n),u=AM("endMask",e,t,n),c=AM("ellipsisMask",e,t,n),l=AM("newAxisMask",e,t,n),p=AM("shrinkAxisMask",e,t,n),h=AM("x",e,t,n);return[r.stridedSlice(h,a,i,o,s,u,c,l,p)]}case"Pack":return pi((()=>{const a=AM("axis",e,t,n),i=AM("tensors",e,t,n),o=i[0].shape,s=r.squeeze(i[0]).shape,u=i.map((e=>{const t=W(e.shape,o);if(!t&&!W(r.squeeze(e).shape,s))throw new Error("the input tensors shape does not match");return t?e:r.reshape(e,o)}));return[r.stack(u,a)]}));case"Unpack":{const a=AM("axis",e,t,n),i=AM("tensor",e,t,n);return r.unstack(i,a)}case"Tile":{const a=AM("reps",e,t,n);return[r.tile(AM("x",e,t,n),a)]}case"Split":case"SplitV":{const a=AM("axis",e,t,n),i=AM("numOrSizeSplits",e,t,n),o=AM("x",e,t,n);return r.split(o,i,a)}case"ScatterNd":{const a=AM("indices",e,t,n),i=AM("values",e,t,n),o=AM("shape",e,t,n);return[r.scatterND(a,i,o)]}case"GatherNd":{const a=AM("x",e,t,n),i=AM("indices",e,t,n);return[r.gatherND(a,i)]}case"SparseToDense":{const a=AM("sparseIndices",e,t,n),i=AM("outputShape",e,t,n),o=AM("sparseValues",e,t,n),s=AM("defaultValue",e,t,n);return[r.sparseToDense(a,o,i,o.dtype===s.dtype?s:r.cast(s,o.dtype))]}case"TensorScatterUpdate":{const a=AM("indices",e,t,n),i=AM("values",e,t,n),o=AM("tensor",e,t,n);return[r.tensorScatterUpdate(o,a,i)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"sparse":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"SparseFillEmptyRows":{const{outputIndices:a,outputValues:i,emptyRowIndicator:o,reverseIndexMap:s}=r.sparse.sparseFillEmptyRows(AM("indices",e,t,n),AM("values",e,t,n),AM("denseShape",e,t,n),AM("defaultValue",e,t,n));return[a,i,o,s]}case"SparseReshape":{const{outputIndices:a,outputShape:i}=r.sparse.sparseReshape(AM("inputIndices",e,t,n),AM("inputShape",e,t,n),AM("newShape",e,t,n));return[a,i]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(AM("data",e,t,n),AM("indices",e,t,n),AM("segmentIds",e,t,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(AM("data",e,t,n),AM("indices",e,t,n),AM("segmentIds",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"spectral":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"FFT":return[r.fft(AM("x",e,t,n))];case"IFFT":return[r.ifft(AM("x",e,t,n))];case"RFFT":return[r.rfft(AM("x",e,t,n))];case"IRFFT":return[r.irfft(AM("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"string":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(AM("input",e,t,n),AM("pattern",e,t,n),AM("rewrite",e,t,n),AM("replaceGlobal",e,t,n))];case"StringNGrams":{const{nGrams:a,nGramsSplits:i}=r.string.stringNGrams(AM("data",e,t,n),AM("dataSplits",e,t,n),AM("separator",e,t,n),AM("nGramWidths",e,t,n),AM("leftPad",e,t,n),AM("rightPad",e,t,n),AM("padWidth",e,t,n),AM("preserveShortSequences",e,t,n));return[a,i]}case"StringSplit":{const{indices:a,values:i,shape:o}=r.string.stringSplit(AM("input",e,t,n),AM("delimiter",e,t,n),AM("skipEmpty",e,t,n));return[a,i,o]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(AM("input",e,t,n),AM("numBuckets",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"transformation":return a((()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;switch(e.op){case"Cast":return[r.cast(AM("x",e,t,n),AM("dtype",e,t,n))];case"ExpandDims":{const a=AM("axis",e,t,n);return[r.expandDims(AM("x",e,t,n),a)]}case"Squeeze":{const a=AM("axis",e,t,n);return[r.squeeze(AM("x",e,t,n),a)]}case"Reshape":return[r.reshape(AM("x",e,t,n),AM("shape",e,t,n))];case"EnsureShape":return[r.ensureShape(AM("x",e,t,n),AM("shape",e,t,n))];case"MirrorPad":return[r.mirrorPad(AM("x",e,t,n),AM("padding",e,t,n),AM("mode",e,t,n))];case"PadV2":case"Pad":return[r.pad(AM("x",e,t,n),AM("padding",e,t,n),AM("constantValue",e,t,n))];case"SpaceToBatchND":{const a=AM("blockShape",e,t,n),i=AM("paddings",e,t,n);return[r.spaceToBatchND(AM("x",e,t,n),a,i)]}case"BatchToSpaceND":{const a=AM("blockShape",e,t,n),i=AM("crops",e,t,n);return[r.batchToSpaceND(AM("x",e,t,n),a,i)]}case"DepthToSpace":{const a=AM("blockSize",e,t,n),i=AM("dataFormat",e,t,n).toUpperCase();return[r.depthToSpace(AM("x",e,t,n),a,i)]}case"BroadcastTo":return[r.broadcastTo(AM("x",e,t,n),AM("shape",e,t,n))];case"BroadcastArgs":return[r.broadcastArgs(AM("s0",e,t,n),AM("s1",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)));case"hash_table":return(async(e,t,n,r)=>{switch(e.op){case"HashTable":case"HashTableV2":{const a=r.getHashTableHandleByName(e.name);if(null!=a)return[a];{const a=AM("keyDType",e,t,n),i=AM("valueDType",e,t,n),o=new DO(a,i);return r.addHashTable(e.name,o),[o.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const a=AM("tableHandle",e,t,n,r),i=AM("keys",e,t,n),o=AM("values",e,t,n),s=r.getHashTableById(a.id);return[await s.import(i,o)]}case"LookupTableFind":case"LookupTableFindV2":{const a=AM("tableHandle",e,t,n,r),i=AM("keys",e,t,n),o=AM("defaultValue",e,t,n),s=r.getHashTableById(a.id);return[await s.find(i,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const a=AM("tableHandle",e,t,n,r);return[r.getHashTableById(a.id).tensorSize()]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}})(e,t,n,r);case"custom":const i=IM(e.op);if(i&&i.customExecutor)return i.customExecutor(new vO(e,t,n));throw TypeError("Custom op ".concat(e.op," is not registered."));default:throw TypeError("Unknown op '".concat(e.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}})(e,t,n);return de(i)?i.then((e=>[].concat(e))):[].concat(i)}class AO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0;this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=r,this.parseNodeNameCache=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map((e=>0===e.id&&0===e.iterationId?"":"".concat(e.frameName,"-").concat(e.iterationId))).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}function FO(e,t,n,r){const a=new Set,i=[];let o=null,s=null;const u=new Set,c=new Set(Object.keys(e).map((e=>RM(e)[0])));r=r||[];const l=new Set(r.map((e=>RM(e.name)[0]))),p=[...t];for(;p.length>0;){const e=p.pop();(BO(e)||LO(e)||PO(e))&&null==o&&(o=e,s=o.children.map((e=>e.name)).filter((e=>a.has(e)))),a.add(e.name),null==n[e.name]&&(c.has(e.name)||l.has(e.name)||(0!==e.inputs.length?e.inputs.forEach((e=>{u.has(e.name)||(u.add(e.name),p.push(e))})):i.push(e.name)))}return{inputs:e,outputs:t,usedNodes:a,missingInputs:i,dynamicNode:o,syncInputs:s}}function _O(e,t){const{usedNodes:n,inputs:r}=t,a=Object.keys(r).map((e=>RM(e)[0])).map((t=>e.nodes[t])),i=e.initNodes||[],o=e=>n.has("string"===typeof e?e:e.name);function s(e){return[...new Map(e.map((e=>[e.name,e]))).values()]}const u=s([...a,...e.weights,...i]).filter(o),c=s([...u,...Object.values(e.nodes)]).filter(o),l=new Map(c.map((e=>[e.name,e]))),p={};for(const m of c){p[m.name]=p[m.name]||0;for(const e of m.children)o(e)||(p[e.name]=Number.POSITIVE_INFINITY),p[e.name]=(p[e.name]||0)+1}const h=Object.entries(p).filter((e=>{let[,t]=e;return 0===t})).map((e=>{let[t]=e;return t})),d=[...h];for(;h.length>0;){const e=h.pop(),t=l.get(e);for(const n of t.children.filter(o))0===--p[n.name]&&(d.push(n.name),h.push(n.name))}const f=function(e,t){const n=new Map(e.map((e=>[e.name,e]))),r=t.map((e=>e.name)),a=new Set(r);for(;r.length>0;){const e=r.pop(),t=n.get(e);for(const i of t.children)n.has(i.name)&&!a.has(i.name)&&(a.add(i.name),r.push(i.name))}const i=e.filter((e=>a.has(e.name)));return i}(d.map((e=>l.get(e))),u);return function(e,t){const n=new Map(e.map(((e,t)=>[e.name,t]))),r=new Set(t.map((e=>e.name))),a=e=>r.has("string"===typeof e?e:e.name),i=new Set(e.map((e=>e.name))),o=e=>i.has("string"===typeof e?e:e.name);for(const s of e){for(const e of s.children.filter(o)){if(!n.has(e.name))throw new MO("Child ".concat(e.name," of node ").concat(s.name," is unreachable."));if(n.get(s.name)>n.get(e.name))throw new MO("Node ".concat(s.name," is scheduled to run after its child ").concat(e.name,"."))}if(!a(s))for(const e of s.inputs){if(!n.has(e.name))throw new MO("Input ".concat(e.name," of node ").concat(s.name," is unreachable."));if(n.get(e.name)>n.get(s.name))throw new MO("Node ".concat(s.name," is scheduled to run before its input ").concat(e.name,"."))}}}(f,u),f}class MO extends Error{constructor(e){super("NodesExecutionOrderError: ".concat(e))}}const OO=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),RO=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),zO=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function BO(e){return OO.has(e.op)}function LO(e){return RO.has(e.op)}function PO(e){return zO.has(e.op)}class UO{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map((t=>e[t].map((e=>e.id))));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map((e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0})))}get outputs(){return this._outputs.map((e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0})))}get inputNodes(){return this._inputs.map((e=>e.signatureKey||e.name))}get outputNodes(){return this._outputs.map((e=>{const t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t}))}get functions(){return Object.keys(this._functions).reduce(((e,t)=>(e[t]=this._functions[t].signature,e)),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,null!=e.functions&&Object.keys(e.functions).forEach((t=>{this._functionExecutorMap[t]=new UO(e.functions[t],this)}))}getCompilationKey(e,t){const n=e.map((e=>e.name)).sort(),r=t.map((e=>e.name)).sort();return n.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,t){const n=FO(e,t,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:a,syncInputs:i}=n;if(null!=a)throw new Error("This execution contains the node '".concat(a.name,"', which has ")+"the dynamic op '".concat(a.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(i,"]"));if(r.length>0){const n=t.map((e=>e.name)),a=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(n,"] from the provided inputs ")+"[".concat(a,"]. Missing the following inputs: [").concat(r,"]"))}const o=_O(this.graph,n),s=function(e){const t=new Map(e.map(((e,t)=>[e.name,t]))),n=Number.MAX_SAFE_INTEGER,r=e.map(((e,t)=>BO(e)?n:t)),a=e=>{const n=r[t.get(e.name)];return null==n?-1:n},i=e.map(((e,t)=>e.children.map(a).reduce(((e,t)=>Math.max(e,t)),r[t]))),o=new Map;for(let s=0;s<e.length;++s){const t=i[s];if(t===n)continue;const r=e[s],a=e[t];o.has(a.name)||o.set(a.name,[]),o.get(a.name).push(r)}return o}(o);return{orderedNodes:o,nodeLiveUntilMap:s}}cloneAndKeepTensor(e){if(null==e)return null;const t=e.clone();return di(t),t}cloneTensorList(e){if(!e)return null;const t=e.map((e=>this.cloneAndKeepTensor(e)));return t}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map((e=>{let[t,n]=e;return[t,this.cloneTensorList(n)]})))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);const n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const r=n.map((e=>this.graph.nodes[RM(e)[0]])),a=t.map((e=>RM(e)[0])),i=new Set(a);let o=a.map((e=>this.graph.nodes[e]));0===o.length&&(o=this._outputs);const s=this.getCompilationKey(r,o);let u=this.compiledMap.get(s);null==u&&(u=this.compile(e,o),this.compiledMap.set(s,u));try{this.keepIntermediateTensors=ye().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(Z2){this.keepIntermediateTensors=!1,console.warn(Z2.message)}const c={},l={};return pi((()=>{const n=new AO(this.weightMap,c,l,this.functionExecutorMap,this.parseNodeNameCache),r=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach((t=>{const[a,i]=RM(t,n),o=[];o[i]=e[t],r[a]=o,this.keepIntermediateTensors&&(this.clonedTensorsMap[a]=this.cloneTensorList(o))}));const a=this.getFrozenTensorIds(r),{orderedNodes:o,nodeLiveUntilMap:s}=u;for(const e of o){if(r[e.name])continue;const t=IO(e,r,n,this._resourceManager);if(de(t))throw new Error("The execution of the op '".concat(e.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");r[e.name]=t,this.keepIntermediateTensors&&(this.clonedTensorsMap[e.name]=this.cloneTensorList(t)),this.checkTensorForDisposalWithNodeLiveUntilInfo(e,r,n,a,i,s.get(e.name))}return null==this.parent&&n.dispose(a),t.map((e=>FM(e,r,n)))}))}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map((t=>e[t])).map((e=>e.map((e=>e.id)))));return new Set(t)}checkTensorForDisposal(e,t,n,r,a,i,o){if(!BO(t)&&!i.has(e)){for(const r of n[e])null!=r&&(o[r.id]=(o[r.id]||0)+t.children.length);for(const e of t.inputs){if(BO(e))continue;const t=_M(e.name,n,r);if(null!=t)for(const e of t){if(!e||e.kept||a.has(e.id))continue;const t=o[e.id];1===t?(e.dispose(),delete o[e.id]):null!=t&&o[e.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,n,r,a,i){function o(e){return BO(e)||a.has(e.name)}if(!BO(e)&&null!=i)for(const s of i){if(o(s))continue;const e=_M(s.name,t,n);for(const t of e)!t||t.kept||r.has(t.id)||t.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach((e=>{for(const t of e)t&&!t.isDisposed&&t.dispose()})),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.disposeIntermediateTensors(),n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=ye().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(Z2){this.keepIntermediateTensors=!1,console.warn(Z2.message)}const i=new AO(this.weightMap,r,a,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const o=await this.executeWithControlFlow(e,i,t,n),s=t.map((e=>FM(e,o,i))),u=s.map((e=>e.id)),c=Object.keys(e).map((t=>e[t].id)),l=new Set([...u,...c,...this.weightIds]);return Object.values(o).forEach((e=>{e.forEach((e=>{!e||e.isDisposed||l.has(e.id)||e.dispose()}))})),null==this.parent&&i.dispose(l),s}async executeFunctionAsync(e,t,n){const r=e.reduce(((e,t,n)=>(e[this.inputs[n].name]=t,e)),{});return this._executeAsync(r,this.outputNodes,!0,t,n)}async executeWithControlFlow(e,t,n,r){const a=Object.keys(e),i=a.map((e=>this.graph.nodes[RM(e)[0]])),o=n.map((e=>RM(e)[0])),s=new Set(o);let u=o.map((e=>this.graph.nodes[e]));0===u.length&&(u=this._outputs);const{usedNodes:c,missingInputs:l,dynamicNode:p,syncInputs:h}=FO(e,u,this.weightMap,this._initNodes),d=[...i,...this.graph.weights,...this._initNodes||[]].map((e=>({node:e,contexts:t.currentContext}))),f=Object.assign({},this.weightMap);Object.keys(e).forEach((t=>{const[n,r]=RM(t),a=[];a[r]=e[t],f[n]=a}));const m={},g=this.getFrozenTensorIds(f),y={};for(;d.length>0;){const e=this.processStack(i,d,t,f,y,g,s,m,c);await Promise.all(e)}null!=p||r||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const v=u.filter((e=>!BO(e)&&!FM(e.name,f,t))).map((e=>e.name));if(v.length>0){let e="";throw null!=p&&(e="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(h,"]")),new Error("Cannot compute the outputs [".concat(v,"] from the provided ")+"inputs [".concat(a,"]. Consider providing the following inputs: ")+"[".concat(l,"]. ").concat(e))}return f}processStack(e,t,n,r,a,i,o,s,u){const c=[];for(;t.length>0;){const e=t.pop();n.currentContext=e.contexts;let l="";if("Enter"===e.node.op&&AM("isConstant",e.node,r,n)&&([l]=MM(e.node.name,n)),null==r[e.node.name]){const p=IO(e.node,r,n,this._resourceManager);l||([l]=MM(e.node.name,n));const h=n.currentContext;de(p)?c.push(p.then((c=>(r[l]=c,this.keepIntermediateTensors&&(this.clonedTensorsMap[l]=this.cloneTensorList(c)),n.currentContext=h,this.checkTensorForDisposal(l,e.node,r,n,i,o,s),this.processChildNodes(e.node,t,n,r,a,u),c)))):(r[l]=p,this.keepIntermediateTensors&&(this.clonedTensorsMap[l]=this.cloneTensorList(p)),this.checkTensorForDisposal(l,e.node,r,n,i,o,s),this.processChildNodes(e.node,t,n,r,a,u))}else this.processChildNodes(e.node,t,n,r,a,u)}return c}processChildNodes(e,t,n,r,a,i){e.children.forEach((e=>{const[o]=MM(e.name,n);!a[o]&&i.has(e.name)&&("Merge"===e.op?e.inputNames.some((e=>!!FM(e,r,n)))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((e=>!!FM(e,r,n)))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})))}))}dispose(){Object.keys(this.weightMap).forEach((e=>this.weightMap[e].forEach((e=>e.dispose()))))}checkInputShapeAndType(e){Object.keys(e).forEach((t=>{const n=e[t],[r]=RM(t),a=this.graph.nodes[r];if(a.attrParams.shape&&a.attrParams.shape.value){const e=a.attrParams.shape.value;B(e.length===n.shape.length&&n.shape.every(((t,n)=>-1===e[n]||e[n]===t)),(()=>"The shape of dict['".concat(a.name,"'] provided in ")+"model.execute(dict) must be [".concat(e,"], but was ")+"[".concat(n.shape,"]")))}a.attrParams.dtype&&a.attrParams.dtype.value&&B(n.dtype===a.attrParams.dtype.value,(()=>"The dtype of dict['".concat(a.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(a.attrParams.dtype.value,", but was ").concat(n.dtype)))}))}mapInputs(e){var t,n;const r={};for(const a in e){const i=null===(n=null===(t=this._signature)||void 0===t?void 0:t.inputs)||void 0===n?void 0:n[a];null!=i?r[i.name]=e[a]:r[a]=e[a]}return r}checkInputs(e){const t=Object.keys(e).filter((e=>{const[t]=RM(e);return null==this.graph.nodes[t]}));if(t.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(t,"] that are not part of graph"))}mapOutputs(e){return e.map((e=>{var t,n;const r=null===(n=null===(t=this._signature)||void 0===t?void 0:t.outputs)||void 0===n?void 0:n[e];return null!=r?r.name:e}),{})}checkOutputs(e){e.forEach((e=>{const[t]=RM(e);if(!this.graph.nodes[t])throw new Error("The output '".concat(e,"' is not found in the graph"))}))}}class WO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}const VO="?tfjs-format=file",qO="model.json";class jO{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.modelUrl=t,this.loadOptions=n,this.version="n/a",this.io=r,null==n&&(this.loadOptions={}),this.resourceManager=new WO}findIOHandler(){const e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for ")+"URL '".concat([e],"'"));this.handler=t[0]}}load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return de(e)?e.then((e=>null==e.getWeightStream?this.loadSync(e):this.loadStreaming(e))):this.loadSync(e)}loadSync(e){const t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(null==e.getWeightStream)throw new Error("Model artifacts missing streamWeights function");const t=await Ei(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;const n=this.artifacts.modelTopology;let r=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){const e=this.artifacts.userDefinedMetadata;null!=e.signature&&(r=e.signature),null!=e.structuredOutputKeys&&(this.structuredOutputKeys=e.structuredOutputKeys)}if(this.signature=r,this.version="".concat(n.versions.producer,".").concat(n.versions.minConsumer),this.executor=new UO(rO.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){const t=rO.Instance.transformGraph(e.modelInitializer);this.initializer=new UO(t),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if("string"===typeof e){const t=this.io.getSaveHandlers(e);if(0===t.length)throw new Error("Cannot find any save handlers for URL '".concat(e,"'"));if(t.length>1)throw new Error("Found more than one (".concat(t.length,") save handlers for ")+"URL '".concat(e,"'"));e=t[0]}if(null==e.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const t={};return(e instanceof ka?[e]:e).forEach(((e,n)=>t[this.structuredOutputKeys[n]]=e)),t}return e}predict(e,t){const n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}async predictAsync(e,t){const n=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(n)}normalizeInputs(e){var t;if(!(e instanceof ka)&&!Array.isArray(e)){const n=null===(t=this.signature)||void 0===t?void 0:t.inputs;if(null!=n)for(const t in n){const r=n[t];null!=r.resourceId&&(e[t]=this.resourceIdToCapturedInput[r.resourceId])}return e}e=Array.isArray(e)?e:[e];const n=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+n!==this.inputNodes.length)throw new Error("Input tensor count mismatch, the graph model has ".concat(this.inputNodes.length-n," non-resource placeholders, while there are ").concat(e.length," input tensors provided."));let r=0;return this.inputNodes.reduce(((t,n)=>{var a,i,o;const s=null===(o=null===(i=null===(a=this.signature)||void 0===a?void 0:a.inputs)||void 0===i?void 0:i[n])||void 0===o?void 0:o.resourceId;return t[n]=null!=s?this.resourceIdToCapturedInput[s]:e[r++],t}),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const t=this.initializerSignature.outputs,n=Object.keys(t);for(let r=0;r<n.length;r++){const a=t[n[r]];this.resourceIdToCapturedInput[a.resourceId]=e[r]}}}execute(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce(((t,n)=>(t[n]=[e[n]],t)),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&hi(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function GO(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==n&&(n={}),n.fromTFHub&&"string"===typeof t&&(t=function(e){e.endsWith("/")||(e+="/");return"".concat(e).concat(qO).concat(VO)}(t));const a=new jO(t,n,r);return await a.load(),a}function HO(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if("function"===typeof Blob&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);const a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if($O(e)){const a=Array.isArray(e)?[]:{};r.add(e);for(const i in e){const o=HO(e[i],t,n,r);a[i]=o}return r.delete(e),e.__proto__&&(a.__proto__=e.__proto__),a}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,a.value),a.value}function KO(e){return XO(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:YO)}function XO(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;const r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");const a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if($O(r)){const a=Array.isArray(r)?[]:{};n.add(r);for(const i in r){const r=XO(e.map((e=>e[i])),t,n);a[i]=r}return n.delete(r),a}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return a.value}function YO(e){return null===e?null:$O(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function $O(e){let t=!1;if(ye().get("IS_BROWSER"))t=e instanceof TextDecoder;else{const{StringDecoder:r}=n(551);t=e instanceof r}return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"===typeof e&&!(e instanceof ka)&&!(e instanceof Promise)&&!t)}function ZO(e){return function(e,t){return HO(e,t)}(e,QO)}function QO(e){return e instanceof ka?{value:e.clone(),recurse:!1}:$O(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}class JO{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,null==e)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(const t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}class eR extends JO{constructor(){super(eR.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){const e=2*this.capacity,t=new Array(e),n=this.length();for(let r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}function tR(e){return new iR(e)}function nR(e,t){return new gR(e,t)}eR.INITIAL_CAPACITY=32;class rR{async toArray(){const e=[];let t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){const e=this.prefetch(100),t=[];let n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)t=await this.next(),n=e(t.value)}handleErrors(e){return new hR(this,e)}filter(e){return new lR(this,e)}map(e){return new pR(this,e)}mapAsync(e){return new dR(this,e)}serialMapAsync(e){return new dR(this,e).serial()}flatmap(e){return new mR(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile((e=>!0===e))}rowMajorBatch(e){return new cR(this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}columnMajorBatch(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:YO;return this.rowMajorBatch(e,t).map((e=>KO(e,n)))}concatenate(e,t){return new gR(new aR([this,e]),t)}take(e){return e<0||null==e?this:new uR(this,e)}skip(e){return e<0||null==e?this:new sR(this,e)}prefetch(e){return new vR(this,e)}shuffle(e,t){return new bR(this,e,t)}serial(){return new oR(this)}}class aR extends rR{constructor(e){super(),this.items=e,this.trav=0}summary(){return"Array of ".concat(this.items.length," items")}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const e=this.items[this.trav];return this.trav++,{value:ZO(e),done:!1}}}class iR extends rR{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(Z2){throw Z2.message="Error thrown while iterating through a dataset: ".concat(Z2.message),Z2}}}class oR extends rR{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Serial")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){return this.upstream.next()}}class sR extends rR{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Skip")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const e=await this.upstream.next();if(e.done)return e;hi(e.value)}return this.upstream.next()}}class uR extends rR{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return"".concat(this.upstream.summary()," -> Take")}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class cR extends rR{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){const e=[];for(;e.length<this.batchSize;){const t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}}class lR extends rR{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Filter")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;){const e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;hi(e.value)}}}class pR extends rR{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> Map")}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=Pa(e.value),n=this.transform(e.value),r=Pa(n);for(const a of t)La(a,r)||a.dispose();return{value:n,done:!1}}}class hR extends rR{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> handleErrors")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(Z2){if(!this.handler(Z2))return{value:null,done:!0}}}}class dR extends rR{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> AsyncMap")}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=Pa(e.value),n=await this.transform(e.value),r=Pa(n);for(const a of t)La(a,r)||a.dispose();return{value:n,done:!1}}}class fR extends rR{constructor(){super(),this.outputQueue=new eR,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class mR extends fR{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> Flatmap")}async pump(){const e=await this.upstream.next();if(e.done)return!1;const t=Pa(e.value),n=this.transform(e.value),r=Pa(n);this.outputQueue.pushAll(n);for(const a of t)La(a,r)||a.dispose();return!0}}class gR extends rR{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,null==this.iterator){const e=await this.moreIterators.next();if(e.done)return{value:null,done:!0};this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}}var yR;!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(yR||(yR={}));class vR extends rR{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new JO(t)}summary(){return"".concat(this.upstream.summary()," -> Prefetch")}refill(){for(;!this.buffer.isFull();){const e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}}class bR extends vR{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=Ol.alea(n||sa().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(!t.done)return this.refill(),t;this.upstreamExhausted=!0}return{value:null,done:!0}}}class xR{constructor(){this.size=null}batch(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this;let r;return B(e>0,(()=>"batchSize needs to be positive, but it is\n      ".concat(e))),r=this.size===1/0||null==this.size?this.size:t?Math.ceil(this.size/e):Math.floor(this.size/e),wR((async()=>(await n.iterator()).columnMajorBatch(e,t,NR)),r)}concatenate(e){const t=this;let n;return n=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,wR((async()=>(await t.iterator()).concatenate(await e.iterator())),n)}filter(e){const t=this;let n;return n=this.size===1/0?1/0:null,wR((async()=>(await t.iterator()).filter((t=>pi((()=>e(t)))))),n)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){const t=this;return wR((async()=>(await t.iterator()).map((t=>pi((()=>e(t)))))),this.size)}mapAsync(e){const t=this;return wR((async()=>(await t.iterator()).mapAsync(e)),this.size)}prefetch(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const t=this;return wR((async()=>(await t.iterator()).prefetch(e)),this.size)}repeat(e){const t=this;let n;return n=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,wR((async()=>nR(tR((async()=>({value:await t.iterator(),done:!1}))).take(e))),n)}skip(e){const t=this;let n;return n=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,wR((async()=>(await t.iterator()).skip(e)),n)}shuffle(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));const r=this,a=Ol.alea(t||sa().toString());return wR((async()=>{let t=a.int32();return n&&(t+=a.int32()),(await r.iterator()).shuffle(e,t.toString())}),this.size)}take(e){const t=this;let n;return n=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,wR((async()=>(await t.iterator()).take(e)),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function wR(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new class extends xR{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function NR(e){if(null===e)return null;if(function(e){return null==e||null===(t=e)||"object"!==typeof t&&"function"!==typeof t||Array.isArray(e)||"object"===typeof e&&e instanceof ka||la(e);var t}(e[0])){return{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof ka?bp(e):oi(e)}(e),recurse:!1}}return{value:null,recurse:!0}}xR.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");const SR=Pp;class kR extends F{nextDataId(){return kR.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new A(this,ci())}write(e,t,n){this.firstUse&&(this.firstUse=!1,ye().get("IS_NODE")&&Or("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&J(n[0])){const a=n.map((e=>ua(e)));r=this.write(a,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){if(this.data.has(e)){return this.data.get(e).refCount}return 0}incRef(e){this.data.get(e).refCount++}decRef(e){if(this.data.has(e)){this.data.get(e).refCount--}}move(e,t,n,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:n}=this.data.get(e);if("complex64"===t){return Ld(this.readSync(n.real.dataId),this.readSync(n.imag.dataId))}return function(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error("Unknown dtype ".concat(t))}(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map((e=>ca(e)));return wo(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return wo(e.shape,e.dtype,t)}makeOutput(e,t,n){return ci().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(e);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=sa();e();return{kernelMs:sa()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Gm([e],"where");const t=this.readSync(e.dataId);return SR(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}kR.nextDataId=0;gi("cpu",(()=>new kR),1);const ER=yg(xt,(e=>e>=0?e:Math.exp(e)-1)),CR={kernelName:xt,backendName:"cpu",kernelFunc:ER};function TR(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:i}=r;Gm([a],"leakyRelu");const o=U(a.shape),s=n.data.get(a.dataId).values,u=Y("float32",o);for(let c=0;c<s.length;c++)u[c]=s[c]<0?i*s[c]:s[c];return n.makeTensorInfo(a.shape,"float32",u)}const DR={kernelName:qt,backendName:"cpu",kernelFunc:TR},IR=Xm(((e,t)=>e<0?t*e:e));function AR(e){const{inputs:t,backend:n}=e,{x:r,alpha:a}=t;Gm([r,a],"prelu");const i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,[s,u]=IR(r.shape,a.shape,i,o,"float32");return n.makeTensorInfo(u,"float32",s)}const FR={kernelName:En,backendName:"cpu",kernelFunc:AR},_R=yg(Mn,(e=>Math.max(0,e))),MR={kernelName:Mn,backendName:"cpu",kernelFunc:_R},OR=yg(Pn,(e=>Math.min(Math.max(0,e),6))),RR={kernelName:Pn,backendName:"cpu",kernelFunc:OR};function zR(e,t,n,r,a){if("linear"===n)return Qm({inputs:{x:t},backend:e});if("relu"===n)return _R({inputs:{x:t},backend:e});if("elu"===n)return ER({inputs:{x:t},backend:e});if("relu6"===n)return OR({inputs:{x:t},backend:e});if("prelu"===n)return AR({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return TR({inputs:{x:t},backend:e,attrs:{alpha:a}});if("sigmoid"===n)return By({inputs:{x:t},backend:e});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function BR(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{shape:i}=r,o=U(a.shape),s=H(i,o),u=U(s);B(o===u,(()=>"The new shape (".concat(s,") has ").concat(u," elements and the old ")+"shape (".concat(a.shape,") has ").concat(o," elements. The new shape and old ")+"shape must have the same number of elements.")),n.incRef(a.dataId);const c=n.data.get(a.dataId);if(null!=c.complexTensorInfos){const e=c.complexTensorInfos.real,t=c.complexTensorInfos.imag;e.shape=s,t.shape=s}return{dataId:a.dataId,shape:s,dtype:a.dtype}}const LR={kernelName:On,backendName:"cpu",kernelFunc:BR};function PR(e){const{inputs:t,backend:n,attrs:r}=e,{a:a,b:i}=t,{transposeA:o,transposeB:s}=r;Gm([a,i],"matMul");const u=a.shape.length,c=i.shape.length,l=o?a.shape[u-2]:a.shape[u-1],p=s?i.shape[c-1]:i.shape[c-2],h=o?a.shape[u-1]:a.shape[u-2],d=s?i.shape[c-2]:i.shape[c-1],f=a.shape.slice(0,-2),m=i.shape.slice(0,-2),g=U(f),y=U(m),v=Yo(a.shape.slice(0,-2),i.shape.slice(0,-2)).concat([h,d]);B(l===p,(()=>"Error in matMul: inner shapes (".concat(l,") and (")+"".concat(p,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(i.shape," and transposeA=").concat(o)+" and transposeB=".concat(s," must match.")));const b=s?[y,d,p]:[y,p,d],x=BR({inputs:{x:a},backend:n,attrs:{shape:o?[g,l,h]:[g,h,l]}}),w=BR({inputs:{x:i},backend:n,attrs:{shape:b}}),N=o?x.shape[1]:x.shape[2],S=o?x.shape[2]:x.shape[1],k=s?w.shape[1]:w.shape[2],E=Math.max(g,y),C=n.data.get(x.dataId).values,T=n.data.get(w.dataId).values,D=ae(x.shape),I=ae(w.shape),[A,F,_]=o?[D[0],1,D[1]]:[D[0],D[1],1],[M,O,R]=s?[1,I[1],I[0]]:[I[1],1,I[0]],z=S*k,L=wo([E,S,k],x.dtype),P=L.values,W=n.blockSize;for(let B=0;B<E;B++){const e=B%g,t=B%y;for(let n=0;n<S;n+=W){const r=Math.min(n+W,S);for(let a=0;a<k;a+=W){const i=Math.min(a+W,k);for(let o=0;o<N;o+=W){const s=Math.min(o+W,N);for(let u=n;u<r;u++)for(let n=a;n<i;n++){let r=0;for(let a=o;a<s;a++){r+=C[e*A+u*F+a*_]*T[a*M+n*O+t*R]}P[B*z+(u*k+n)]+=r}}}}}return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),n.makeTensorInfo(v,L.dtype,L.values)}const UR={kernelName:Ue,backendName:"cpu",kernelFunc:PR};const WR={kernelName:Fr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:a,b:i,bias:o,preluActivationWeights:s}=t,{transposeA:u,transposeB:c,activation:l,leakyreluAlpha:p}=r;let h,d,f;const m=[];h=PR({inputs:{a:a,b:i},attrs:{transposeA:u,transposeB:c},backend:n}),o&&(d=cg({inputs:{a:h,b:o},backend:n}),m.push(h),h=d),l&&(f=zR(n,h,l,s,p),m.push(h),h=f);for(const g of m)n.disposeIntermediateTensorInfo(g);return h}},VR=yg(Se,(e=>Math.acos(e))),qR={kernelName:Se,backendName:"cpu",kernelFunc:VR},jR=yg(ke,(e=>Math.acosh(e))),GR={kernelName:ke,backendName:"cpu",kernelFunc:jR};const HR={kernelName:Ce,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,r=t;Gm(t,"addN");const a=r.map((e=>n.data.get(e.dataId).values)),i=wo(r[0].shape,r[0].dtype),o=i.values;for(let s=0;s<r.length;s++){const e=a[s];for(let t=0;t<o.length;t++)o[t]+=e[t]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}};const KR={kernelName:Te,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r;Gm(a,"all");const s=K(i,a.shape);let u=s;const c=yc(u,a.shape.length);let l=a;null!=c&&(l=gy({inputs:{x:a},backend:n,attrs:{perm:c}}),u=bc(u.length,a.shape.length)),gc("all",u,l.shape.length);const[p,h]=fc(l.shape,u),d=U(h),f=ue(U(p),l.dtype),m=n.data.get(l.dataId).values;for(let y=0;y<f.length;++y){const e=y*d;let t=m[e];for(let n=0;n<d;++n){const r=m[e+n];t=t&&r}f[y]=t}null!=c&&n.disposeIntermediateTensorInfo(l);const g=n.makeTensorInfo(p,l.dtype,f);if(o){const e=BR({inputs:{x:g},backend:n,attrs:{shape:mc(p,s)}});return n.disposeIntermediateTensorInfo(g),e}return g}};const XR={kernelName:De,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r;Gm(a,"any");const s=K(i,a.shape);let u=s;const c=yc(u,a.shape.length);let l=a;null!=c&&(l=gy({inputs:{x:a},backend:n,attrs:{perm:c}}),u=bc(u.length,a.shape.length)),gc("any",u,l.shape.length);const[p,h]=fc(l.shape,u),d=U(h),f=ue(U(p),l.dtype),m=n.data.get(l.dataId).values;for(let y=0;y<f.length;++y){const e=y*d;let t=m[e];for(let n=0;n<d;++n){const r=m[e+n];t=t||r}f[y]=t}null!=c&&n.disposeIntermediateTensorInfo(l);const g=n.makeTensorInfo(p,l.dtype,f);if(o){const e=BR({inputs:{x:g},backend:n,attrs:{shape:mc(p,s)}});return n.disposeIntermediateTensorInfo(g),e}return g}};const YR={kernelName:Ie,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;Gm(a,"argMax");let o=K(i,a.shape);const s=yc(o,a.shape.length);let u=a;const c=[];null!=s&&(u=gy({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=bc(o.length,u.shape.length)),o=[o[0]],gc("argMax",o,u.shape.length);const[l,p]=fc(u.shape,o),h=ue(U(l),"int32"),d=U(p),f=n.data.get(u.dataId).values;for(let m=0;m<h.length;++m){const e=m*d;let t=f[e],n=0;for(let r=0;r<d;++r){const a=f[e+r];a>t&&(t=a,n=r)}h[m]=n}return c.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(l,"int32",h)}};const $R={kernelName:Ae,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;Gm(a,"argMin");let o=K(i,a.shape);const s=yc(o,a.shape.length);let u=a;const c=[];null!=s&&(u=gy({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=bc(o.length,u.shape.length)),o=[o[0]],gc("argMin",o,u.shape.length);const[l,p]=fc(u.shape,o),h=ue(U(l),"int32"),d=U(p),f=n.data.get(u.dataId).values;for(let m=0;m<h.length;++m){const e=m*d;let t=f[e],n=0;for(let r=0;r<d;++r){const a=f[e+r];a<t&&(t=a,n=r)}h[m]=n}return c.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(l,"int32",h)}},ZR=yg(Fe,(e=>Math.asin(e))),QR={kernelName:Fe,backendName:"cpu",kernelFunc:ZR},JR=yg(_e,(e=>Math.asinh(e))),ez={kernelName:_e,backendName:"cpu",kernelFunc:JR},tz=yg(Me,(e=>Math.atan(e))),nz={kernelName:Me,backendName:"cpu",kernelFunc:tz},rz=Xm(((e,t)=>Math.atan2(e,t))),az=ig(Re,rz),iz={kernelName:Re,backendName:"cpu",kernelFunc:az},oz=yg(Oe,(e=>Math.atanh(e))),sz={kernelName:Oe,backendName:"cpu",kernelFunc:oz};function uz(e,t,n,r,a,i){const o=a.strideHeight,s=a.strideWidth,u=a.dilationHeight,c=a.dilationWidth,l=a.effectiveFilterHeight,p=a.effectiveFilterWidth,h=a.padInfo.top,d=a.padInfo.left,f="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=wo(a.outShape,n),g=m.values,y=a.outShape[1]*a.outShape[2]*a.outShape[3],v=a.outShape[2]*a.outShape[3],b=a.outShape[3];for(let x=0;x<a.batchSize;++x){const t=x*y,n=x*r[0];for(let m=0;m<a.inChannels;++m)for(let y=0;y<a.outHeight;++y){const x=y*o-h,w=Math.max(0,x),N=Math.min(a.inHeight,l+x),S=t+y*v;for(let t=0;t<a.outWidth;++t){const o=t*s-d,l=Math.max(0,o),h=Math.min(a.inWidth,p+o);let y=f,v=0,x=0;for(let t=w;t<N;t+=u){const a=n+t*r[1];for(let t=l;t<h;t+=c){const n=e[a+t*r[2]+m];"max"===i&&n>y?y=n:"avg"===i&&(v+=n,x++)}if(isNaN(y))break}g[S+t*b+m]="avg"===i?v/x:y}}}return m}function cz(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=wo(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,p=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,m=wo(t,n,e);for(let g=0;g<r.batchSize;++g)for(let e=0;e<r.inChannels;++e)for(let t=0;t<r.outHeight;++t){const n=t*s-d;let y=n;for(;y<0;)y+=c;const v=Math.min(r.inHeight,p+n);for(let s=0;s<r.outWidth;++s){const p=s*u-f;let d=p;for(;d<0;)d+=l;const b=Math.min(r.inWidth,h+p);let x=Number.NEGATIVE_INFINITY,w=-1;for(let t=y;t<v;t+=c){const o=t-n;for(let n=d;n<b;n+=l){const s=n-p,u=m.get(g,t,n,e);u>x&&(x=u,w=a?i?((g*r.inHeight+t)*r.inWidth+n)*r.inChannels+e:(t*r.inWidth+n)*r.inChannels+e:o*h+s)}}o.set(w,g,t,s,e)}}return o}function lz(e,t,n,r,a,i){const o=a.strideDepth,s=a.strideHeight,u=a.strideWidth,c=a.dilationDepth,l=a.dilationHeight,p=a.dilationWidth,h=a.effectiveFilterDepth,d=a.effectiveFilterHeight,f=a.effectiveFilterWidth,m=a.padInfo.front,g=a.padInfo.top,y=a.padInfo.left,v="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=wo(a.outShape,n),x=b.values,w=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],N=a.outShape[2]*a.outShape[3]*a.outShape[4],S=a.outShape[3]*a.outShape[4],k=a.outShape[4];for(let E=0;E<a.batchSize;++E){const t=E*w,n=E*r[0];for(let b=0;b<a.inChannels;++b)for(let w=0;w<a.outDepth;++w){const E=w*o-m;let C=E;for(;C<0;)C+=c;const T=Math.min(a.inDepth,h+E),D=t+w*N;for(let t=0;t<a.outHeight;++t){const o=t*s-g;let h=o;for(;h<0;)h+=l;const m=Math.min(a.inHeight,d+o),w=D+t*S;for(let t=0;t<a.outWidth;++t){const o=t*u-y;let s=o;for(;s<0;)s+=p;const d=Math.min(a.inWidth,f+o),g=w+t*k;let N=v,S=0,E=0;for(let t=C;t<T;t+=c){const a=n+t*r[1];for(let t=h;t<m;t+=l){const n=a+t*r[2];for(let t=s;t<d;t+=p){const a=e[n+t*r[3]+b];if("max"===i&&a>N?N=a:"avg"===i&&(S+=a,E++),isNaN(N))break}if(isNaN(N))break}if(isNaN(N))break}x[g+b]="avg"===i?S/Math.max(E,1):N}}}}return b}const pz={kernelName:ze,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t;Gm(a,"avgPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:u}=r;B(fu(o,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")));const c=au(a.shape,i,o,1,s,u);let l;if(1===c.filterWidth&&1===c.filterHeight&&W(c.inShape,c.outShape))l=Qm({inputs:{x:a},backend:n});else{const e=n.data.get(a.dataId).values,t=ae(a.shape),r=uz(e,a.shape,a.dtype,t,c,"avg");l=n.makeTensorInfo(c.outShape,a.dtype,r.values)}return l}};const hz={kernelName:Le,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:o,pad:s,dimRoundingMode:u,dataFormat:c}=r;Gm(a,"avgPool3d");const l=iu(a.shape,i,o,1,s,u,c),p=lz(n.data.get(a.dataId).values,a.shape,a.dtype,ae(a.shape),l,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}};const dz={kernelName:Pe,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:o,strides:s,pad:u,dimRoundingMode:c}=r;Gm([a,i],"avgPool3DGrad");const l=iu(i.shape,o,s,1,u,c),p=l.strideDepth,h=l.strideHeight,d=l.strideWidth,f=l.filterDepth,m=l.filterHeight,g=l.filterWidth,y=l.dilationDepth,v=l.dilationHeight,b=l.dilationWidth,x=l.effectiveFilterDepth,w=l.effectiveFilterHeight,N=l.effectiveFilterWidth,S=x-1-l.padInfo.front,k=N-1-l.padInfo.left,E=w-1-l.padInfo.top,C=wo(i.shape,"float32"),T=1/(f*m*g),D=n.bufferSync(a);for(let I=0;I<l.batchSize;++I)for(let e=0;e<l.inChannels;++e)for(let t=0;t<l.inDepth;++t)for(let n=0;n<l.inHeight;++n)for(let r=0;r<l.inWidth;++r){const a=t-S,i=n-E,o=r-k;let s=0;for(let t=0;t<x;t+=y){const n=(a+t)/p;if(!(n<0||n>=l.outDepth||Math.floor(n)!==n))for(let t=0;t<w;t+=v){const r=(i+t)/h;if(!(r<0||r>=l.outHeight||Math.floor(r)!==r))for(let t=0;t<N;t+=b){const a=(o+t)/d;if(a<0||a>=l.outWidth||Math.floor(a)!==a)continue;s+=D.get(I,n,r,a,e)}}}C.set(s*T,I,t,n,r,e)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}};const fz={kernelName:Be,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,o=i;Gm([a,i],"avgPoolGrad");const{filterSize:s,strides:u,pad:c}=r,l=au(o.shape,s,u,1,c),p=l.strideHeight,h=l.strideWidth,d=l.filterHeight,f=l.filterWidth,m=l.dilationHeight,g=l.dilationWidth,y=l.effectiveFilterHeight,v=l.effectiveFilterWidth,b=v-1-l.padInfo.left,x=y-1-l.padInfo.top,w=wo(o.shape,"float32"),N=1/(d*f),S=n.data.get(a.dataId).values,k=wo(a.shape,"float32",S);for(let E=0;E<l.batchSize;++E)for(let e=0;e<l.inChannels;++e)for(let t=0;t<l.inHeight;++t)for(let n=0;n<l.inWidth;++n){const r=t-x,a=n-b;let i=0;for(let t=0;t<y;t+=m){const n=(r+t)/p;if(!(n<0||n>=l.outHeight||Math.floor(n)!==n))for(let t=0;t<v;t+=g){const r=(a+t)/h;if(r<0||r>=l.outWidth||Math.floor(r)!==r)continue;i+=k.get(E,n,r,e)}}w.set(i*N,E,t,n,e)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};const mz={kernelName:_t,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,scale:i,offset:o,mean:s,variance:u}=t;B(s.shape.length===u.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),B(null==o||s.shape.length===o.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),B(null==i||s.shape.length===i.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks.")),Gm([a,s,u,i,o],"batchNorm");let{varianceEpsilon:c}=r;null==c&&(c=.001);const l=n.data.get(a.dataId).values,p=n.data.get(s.dataId).values,h=n.data.get(u.dataId).values,d=i?n.data.get(i.dataId).values:new Float32Array([1]),f=o?n.data.get(o.dataId).values:new Float32Array([0]),m=new Float32Array(l.length),g=f.length,y=d.length,v=h.length,b=p.length;let x=0,w=0,N=0,S=0;for(let k=0;k<l.length;++k)m[k]=f[x++]+(l[k]-p[w++])*d[N++]/Math.sqrt(h[S++]+c),x>=g&&(x=0),w>=b&&(w=0),N>=y&&(N=0),S>=v&&(S=0);return n.makeTensorInfo(a.shape,a.dtype,m)}};const gz={kernelName:We,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,crops:o}=r;Gm([a],"batchToSpaceND");const s=i.reduce(((e,t)=>e*t)),u=kd(a.shape,i,s),c=Ed(u.length,i.length),l=Cd(a.shape,i,s),p=Td(o,i.length),h=Dd(l,o,i.length),d=BR({inputs:{x:a},backend:n,attrs:{shape:u}}),f=gy({inputs:{x:d},backend:n,attrs:{perm:c}}),m=BR({inputs:{x:f},backend:n,attrs:{shape:l}}),g=Uy({inputs:{x:m},backend:n,attrs:{begin:p,size:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}};const yz={kernelName:Ve,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:o}=r,s=pg(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,s)}};const vz={kernelName:je,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:r,s1:a}=t,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=Yo(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},bz=yg(Ke,((e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e})),xz={kernelName:Ke,backendName:"cpu",kernelFunc:bz},wz={kernelName:Ye,backendName:"cpu",kernelFunc:e=>{const{x:t}=e.inputs,n=e.backend,r=new Float32Array(U(t.shape)),a=n.data.get(t.dataId),i=a.complexTensorInfos.real,o=a.complexTensorInfos.imag,s=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values;for(let c=0;c<s.length;c++){const e=s[c],t=u[c];r[c]=Math.hypot(e,t)}return n.makeOutput(r,t.shape,"float32")}};function Nz(e){const{inputs:t,backend:n}=e,{input:r}=t,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}const Sz={kernelName:Pt,backendName:"cpu",kernelFunc:Nz};function kz(e){const{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,i=K(a,t[0].shape)[0];fd(t.map((e=>e.shape)),i);let o=md(t.map((e=>e.shape)),i);if(0===U(o))return n.makeTensorInfo(o,t[0].dtype,[]);const s=t.filter((e=>U(e.shape)>0));if(1===s.length)return Qm({inputs:{x:s[0]},backend:n});if("complex64"===s[0].dtype){const e=s.map((e=>eg({inputs:{input:e},backend:n}))),t=s.map((e=>Nz({inputs:{input:e},backend:n}))),r=kz({inputs:e,backend:n,attrs:{axis:i}}),a=kz({inputs:t,backend:n,attrs:{axis:i}}),o=Ym({inputs:{real:r,imag:a},backend:n});return e.forEach((e=>n.disposeIntermediateTensorInfo(e))),t.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),o}const u=s.map((e=>{const t=U(e.shape.slice(i));return BR({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),c=u.map((e=>({vals:n.data.get(e.dataId).values,shape:e.shape})));o=md(u.map((e=>e.shape)),1);const l=1===u[0].shape[0],p=Ng(c,o,t[0].dtype,l),h=md(s.map((e=>e.shape)),i),d=n.makeTensorInfo(h,t[0].dtype,p);return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),d}const Ez={kernelName:$e,backendName:"cpu",kernelFunc:kz};function Cz(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:o,pad:s,dataFormat:u,dilations:c,dimRoundingMode:l}=r;Gm([a,i],"conv2d");const p=gu(u),h=ou(a.shape,i.shape,o,c,s,l,!1,p),d=h.filterHeight,f=h.filterWidth,m=h.dilationHeight,g=h.dilationWidth,y=h.padInfo.left,v=h.padInfo.top,b="channelsLast"===h.dataFormat,x=new xa(h.outShape,a.dtype),w=ae(a.shape),N=ae(i.shape),S=w[0],k=b?w[1]:w[2],E=b?w[2]:1,C=b?1:w[1],T=x.strides[0],D=b?x.strides[1]:x.strides[2],I=b?x.strides[2]:1,A=b?1:x.strides[1],F=n.data.get(a.dataId).values,_=n.data.get(i.dataId).values,M=x.values;for(let O=0;O<h.batchSize;++O){const e=O*S,t=O*T;for(let n=0;n<h.outHeight;++n){const r=t+n*D,a=n*h.strideHeight-v;for(let t=0;t<d;++t){const n=a+t*m;if(n<0||n>=h.inHeight)continue;const i=t*N[0],o=e+n*k;for(let e=0;e<h.outWidth;++e){const t=r+e*I,n=e*h.strideWidth-y;for(let e=0;e<f;++e){const r=n+e*g;if(r<0||r>=h.inWidth)continue;const a=o+r*E;let s=i+e*N[1];for(let e=0;e<h.inChannels;++e){const n=F[a+e*C];for(let e=0;e<h.outChannels;++e)M[t+e*A]+=n*_[s+e];s+=h.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,M)}const Tz={kernelName:Ze,backendName:"cpu",kernelFunc:Cz};const Dz={kernelName:Qe,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:o,pad:s,dataFormat:u,dimRoundingMode:c,filterShape:l}=r;Gm([a,i],"conv2dBackpropFilter");const p=gu(u),h=ou(a.shape,l,o,1,s,c,!1,p),{strideHeight:d,strideWidth:f,filterHeight:m,filterWidth:g}=h,y="channelsLast"===h.dataFormat,v=new xa(h.filterShape,"float32"),b=h.padInfo.left,x=h.padInfo.top,w=n.data.get(a.dataId).values,N=n.data.get(i.dataId).values,S=new xa(a.shape,a.dtype,w),k=new xa(i.shape,i.dtype,N);for(let E=0;E<m;++E){const e=Math.max(0,Math.ceil((x-E)/d)),t=Math.min(h.outHeight,(h.inHeight+x-E)/d);for(let n=0;n<g;++n){const r=Math.max(0,Math.ceil((b-n)/f)),a=Math.min(h.outWidth,(h.inWidth+b-n)/f);for(let i=0;i<h.inChannels;++i)for(let o=0;o<h.outChannels;++o){let s=0;for(let u=0;u<h.batchSize;++u)for(let c=e;c<t;++c){const e=E+c*d-x;for(let t=r;t<a;++t){const r=n+t*f-b;s+=y?S.get(u,e,r,i)*k.get(u,c,t,o):S.get(u,i,e,r)*k.get(u,o,c,t)}}v.set(s,E,n,i,o)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};const Iz={kernelName:Je,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{inputShape:o,strides:s,pad:u,dataFormat:c,dimRoundingMode:l}=r;Gm([a,i],"conv2dBackpropInput");const p=ae(i.shape),h=ae(a.shape);let d=gu(c);const f=ou(o,i.shape,s,1,u,l,!1,d),m=new xa(f.inShape,"float32"),g=m.values,y=n.data.get(a.dataId).values,v=n.data.get(i.dataId).values,[b,x,w]=p,{batchSize:N,filterHeight:S,filterWidth:k,inChannels:E,inHeight:C,inWidth:T,outChannels:D,outHeight:I,outWidth:A,strideHeight:F,strideWidth:_}=f;d=f.dataFormat;const M=S-1-f.padInfo.top,O=k-1-f.padInfo.left,R="channelsLast"===d,z=m.strides[0],B=R?m.strides[1]:m.strides[2],L=R?m.strides[2]:1,P=R?1:m.strides[1],U=h[0],W=R?h[1]:h[2],V=R?h[2]:1,q=R?1:h[1];for(let j=0;j<N;++j)for(let e=0;e<E;++e)for(let t=0;t<C;++t){const n=t-M,r=Math.max(0,Math.ceil(n/F)),a=Math.min(I,(S+n)/F);for(let i=0;i<T;++i){const o=i-O,s=Math.max(0,Math.ceil(o/_)),u=Math.min(A,(k+o)/_);let c=0;for(let t=r;t<a;++t){const r=t*F-n;for(let n=s;n<u;++n){const a=U*j+W*t+V*n,i=b*(S-1-r)+x*(k-1-(n*_-o))+w*e;for(let e=0;e<D;++e){c+=y[a+q*e]*v[i+e]}}}g[z*j+B*t+L*i+P*e]=c}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};const Az={kernelName:et,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:o,pad:s,dilations:u}=r;Gm([a,i],"conv3d");const c=su(a.shape,i.shape,o,u,s),{filterDepth:l,filterHeight:p,filterWidth:h,dilationDepth:d,dilationHeight:f,dilationWidth:m,padInfo:g}=c,y=g.front,v=g.left,b=g.top,x=new xa(c.outShape,a.dtype),w=n.data.get(a.dataId).values,N=n.data.get(i.dataId).values,S=x.values,k=ae(a.shape),E=ae(i.shape);for(let C=0;C<c.batchSize;++C){const e=C*k[0],t=C*x.strides[0];for(let n=0;n<c.outDepth;++n){const r=t+n*x.strides[1],a=n*c.strideDepth-y;for(let t=0;t<l;++t){const n=a+t*d;if(n<0||n>=c.inDepth)continue;const i=t*E[0],o=e+n*k[1];for(let e=0;e<c.outHeight;++e){const t=r+e*x.strides[2],n=e*c.strideHeight-b;for(let e=0;e<p;++e){const r=n+e*f;if(r<0||r>=c.inHeight)continue;const a=i+e*E[1],s=o+r*k[2];for(let e=0;e<c.outWidth;++e){const n=t+e*c.outChannels,r=e*c.strideWidth-v;for(let e=0;e<h;++e){const t=r+e*m;if(t<0||t>=c.inWidth)continue;const i=a+e*E[2],o=s+t*c.inChannels;let u=i;for(let e=0;e<c.inChannels;++e){const t=w[o+e];for(let e=0;e<c.outChannels;++e)S[n+e]+=t*N[u+e];u+=c.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};const Fz={kernelName:tt,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:o,pad:s,filterShape:u}=r;Gm([a,i],"conv3dBackpropFilterV2");const c=ae(a.shape),l=ae(i.shape),p=su(a.shape,u,o,1,s),h=p.strideDepth,d=p.strideHeight,f=p.strideWidth,m=p.filterDepth,g=p.filterHeight,y=p.filterWidth,v=new xa(p.filterShape,"float32"),b=v.values,[x,w,N,S]=v.strides,k=n.data.get(i.dataId).values,[E,C,T,D]=l,I=n.data.get(a.dataId).values,[A,F,_,M]=c,O=p.padInfo.front,R=p.padInfo.left,z=p.padInfo.top;for(let B=0;B<m;++B){const e=Math.max(0,Math.ceil((O-B)/h)),t=Math.min(p.outDepth,(p.inDepth+O-B)/h),n=B*x;for(let r=0;r<g;++r){const a=Math.max(0,Math.ceil((z-r)/d)),i=Math.min(p.outHeight,(p.inHeight+z-r)/d),o=r*w+n;for(let n=0;n<y;++n){const s=Math.max(0,Math.ceil((R-n)/f)),u=Math.min(p.outWidth,(p.inWidth+R-n)/f),c=n*N+o;for(let o=0;o<p.inChannels;++o){const l=o*S+c;for(let c=0;c<p.outChannels;++c){let m=0;for(let l=0;l<p.batchSize;++l){const p=l*A,g=l*E;for(let l=e;l<t;++l){const e=(B+l*h-O)*F+p,t=l*C+g;for(let l=a;l<i;++l){const a=(r+l*d-z)*_+e,i=l*T+t;for(let e=s;e<u;++e){const t=e*D+i;m+=I[(n+e*f-R)*M+a+o]*k[t+c]}}}}b[l+c]=m}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};const _z={kernelName:nt,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{pad:o,strides:s,inputShape:u}=r;Gm([a],"conv3dBackpropInputV2");const c=ae(a.shape),l=ae(i.shape),p=su(u,i.shape,s,1,o),h=new xa(p.inShape,"float32"),d=h.values,[f,m,g,y]=h.strides,v=n.data.get(a.dataId).values,[b,x,w,N]=c,S=n.data.get(i.dataId).values,[k,E,C,T]=l,{batchSize:D,filterDepth:I,filterHeight:A,filterWidth:F,inChannels:_,inDepth:M,inHeight:O,inWidth:R,outChannels:z,outDepth:B,outHeight:L,outWidth:P,strideDepth:U,strideHeight:W,strideWidth:V}=p,q=I-1-p.padInfo.front,j=A-1-p.padInfo.top,G=F-1-p.padInfo.left;for(let H=0;H<D;++H)for(let e=0;e<_;++e)for(let t=0;t<M;++t){const n=t-q,r=Math.max(0,Math.ceil(n/U)),a=Math.min(B,(I+n)/U);for(let i=0;i<O;++i){const o=i-j,s=Math.max(0,Math.ceil(o/W)),u=Math.min(L,(A+o)/W);for(let c=0;c<R;++c){const l=c-G,p=Math.max(0,Math.ceil(l/V)),h=Math.min(P,(F+l)/V);let D=0;for(let t=r;t<a;++t){const r=t*U-n;for(let n=s;n<u;++n){const a=n*W-o;for(let i=p;i<h;++i){const o=b*H+x*t+w*n+N*i,s=k*(I-1-r)+E*(A-1-a)+C*(F-1-(i*V-l))+T*e;for(let e=0;e<z;++e){D+=v[o+e]*S[s+e]}}}}d[f*H+m*t+g*i+y*c+e]=D}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}},Mz=yg(rt,(e=>Math.cos(e))),Oz={kernelName:rt,backendName:"cpu",kernelFunc:Mz},Rz=yg(at,(e=>Math.cosh(e))),zz={kernelName:at,backendName:"cpu",kernelFunc:Rz};const Bz={kernelName:st,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:i,boxInd:o}=t,{cropSize:s,method:u,extrapolationValue:c}=r,[l,p,h,d]=a.shape,f=i.shape[0],[m,g]=s,y=wo([f,m,g,d],"float32"),v=n.data.get(i.dataId).values,b=n.data.get(o.dataId).values,x=n.data.get(a.dataId).values,w=ae(a.shape),N=ae(y.shape);for(let S=0;S<f;S++){const e=4*S,t=v[e],n=v[e+1],r=v[e+2],a=v[e+3],i=b[S];if(i>=l)continue;const o=m>1?(r-t)*(p-1)/(m-1):0,s=g>1?(a-n)*(h-1)/(g-1):0;for(let l=0;l<m;l++){const e=m>1?t*(p-1)+l*o:.5*(t+r)*(p-1);if(e<0||e>p-1)for(let t=0;t<g;t++)for(let e=0;e<d;e++){const n=e+t*N[2]+l*N[1]+S*N[0];y.values[n]=c}else if("bilinear"===u){const t=Math.floor(e),r=Math.ceil(e),o=e-t;for(let e=0;e<g;e++){const u=g>1?n*(h-1)+e*s:.5*(n+a)*(h-1);if(u<0||u>h-1){for(let t=0;t<d;t++){const n=t+e*N[2]+l*N[1]+S*N[0];y.values[n]=c}continue}const p=Math.floor(u),f=Math.ceil(u),m=u-p;for(let n=0;n<d;n++){let a=n+p*w[2]+t*w[1]+i*w[0];const s=x[a];a=n+f*w[2]+t*w[1]+i*w[0];const u=x[a];a=n+p*w[2]+r*w[1]+i*w[0];const c=x[a];a=n+f*w[2]+r*w[1]+i*w[0];const h=s+(u-s)*m,d=c+(x[a]-c)*m;a=n+e*N[2]+l*N[1]+S*N[0],y.values[a]=h+(d-h)*o}}}else for(let t=0;t<g;++t){const r=g>1?n*(h-1)+t*s:.5*(n+a)*(h-1);if(r<0||r>h-1){for(let e=0;e<d;e++){const n=e+t*N[2]+l*N[1]+S*N[0];y.values[n]=c}continue}const o=Math.round(r),u=Math.round(e);for(let e=0;e<d;e++){const n=e+o*w[2]+u*w[1]+i*w[0],r=e+t*N[2]+l*N[1]+S*N[0];y.values[r]=x[n]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};const Lz={kernelName:it,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:o,reverse:s}=r;Gm(a,"cumprod");const u=yc([i],a.shape.length);let c=a;null!=u&&(c=gy({inputs:{x:a},backend:n,attrs:{perm:u}}));const l=bc(1,a.shape.length)[0];if(l!==c.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(l));const p=Ma(c.dtype,"int32"),h=se(U(c.shape),p),d=n.data.get(c.dataId).values,f=c.shape[c.shape.length-1],m=s?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let y=0;y<d.length;y+=f)for(let e=0;e<f;e++){const t=m(y,e);if(0===e)h[t]=o?1:d[t];else{const n=m(y,e-1);h[t]=o?d[n]*h[n]:d[t]*h[n]}}const g=n.makeTensorInfo(c.shape,p,h);if(null!=u){const e=gy({inputs:{x:g},backend:n,attrs:{perm:vc(u)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),e}return g}};const Pz={kernelName:ot,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:o,reverse:s}=r;Gm(a,"cumsum");const u=yc([i],a.shape.length);let c=a;null!=u&&(c=gy({inputs:{x:a},backend:n,attrs:{perm:u}}));const l=bc(1,a.shape.length)[0];if(l!==c.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(l));const p=Ma(c.dtype,"int32"),h=ue(U(c.shape),p),d=n.data.get(c.dataId).values,f=c.shape[c.shape.length-1],m=s?(e,t)=>e+f-t-1:(e,t)=>e+t;for(let y=0;y<d.length;y+=f)for(let e=0;e<f;e++){const t=m(y,e);if(0===e)h[t]=o?0:d[t];else{const n=m(y,e-1);h[t]=o?d[n]+h[n]:d[t]+h[n]}}const g=n.makeTensorInfo(c.shape,p,h);if(null!=u){const e=gy({inputs:{x:g},backend:n,attrs:{perm:vc(u)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),e}return g}};const Uz={kernelName:ut,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:o,binaryOutput:s}=r;if(1===a.shape.length){const e=pg(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,e)}if(2===a.shape.length){const e=hg(n.bufferSync(a),n.bufferSync(i),o,s);return n.makeTensorInfo(e.shape,i.dtype,e.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};const Wz={kernelName:ct,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:i,dataFormat:o}=r;B("NHWC"===o,(()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(o)));const s=a.shape[0],u=a.shape[1],c=a.shape[2],l=a.shape[3],p=u*i,h=c*i,d=l/(i*i),f=n.data.get(a.dataId).values,m=new Float32Array(s*p*h*d);let g=0;for(let y=0;y<s;++y)for(let e=0;e<p;++e){const t=Math.floor(e/i),n=e%i;for(let e=0;e<h;++e){const r=Math.floor(e/i),a=(n*i+e%i)*d;for(let e=0;e<d;++e){const n=e+a+l*(r+c*(t+u*y));m[g++]=f[n]}}}return n.makeTensorInfo([s,p,h,d],a.dtype,m)}};function Vz(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:o,pad:s,dilations:u,dimRoundingMode:c}=r;Gm([a,i],"depthwiseConv2DNative");const l=ae(a.shape),p=ae(i.shape);let h=u;null==h&&(h=[1,1]),B(fu(o,h),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(h,"'")));const d=ou(a.shape,i.shape,o,h,s,c,!0),{filterHeight:f,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:v}=d,b=v.left,x=v.top,w=d.outChannels/d.inChannels,N=new xa(d.outShape,a.dtype),S=n.data.get(a.dataId).values,k=n.data.get(i.dataId).values,E=N.values;for(let C=0;C<d.batchSize;++C){const e=C*l[0],t=C*N.strides[0];for(let n=0;n<d.outHeight;++n){const r=t+n*N.strides[1],a=n*d.strideHeight-x;for(let t=0;t<f;++t){const n=a+t*g;if(n<0||n>=d.inHeight)continue;const i=t*p[0],o=e+n*l[1];for(let e=0;e<d.outWidth;++e){const t=r+e*N.strides[2],n=e*d.strideWidth-b;for(let e=0;e<m;++e){const r=n+e*y;if(r<0||r>=d.inWidth)continue;const a=i+e*p[1],s=o+r*d.inChannels;let u=t,c=a;for(let e=0;e<d.inChannels;++e){const t=S[s+e];for(let e=0;e<w;++e)E[u+e]+=t*k[c+e];u+=w,c+=w}}}}}}return n.makeTensorInfo(N.shape,N.dtype,N.values)}const qz={kernelName:lt,backendName:"cpu",kernelFunc:Vz};const jz={kernelName:pt,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:o,dilations:s,pad:u,dimRoundingMode:c,filterShape:l}=r;Gm([a,i],"depthwiseConv2dNativeBackpropFilter");const p=ou(a.shape,l,o,s,u,c,!0),{strideHeight:h,strideWidth:d,filterHeight:f,filterWidth:m}=p,g=new xa(p.filterShape,"float32"),y=p.padInfo.left,v=p.padInfo.top,b=p.outChannels/p.inChannels,x=n.data.get(a.dataId).values,w=new xa(a.shape,a.dtype,x),N=n.data.get(i.dataId).values,S=new xa(i.shape,i.dtype,N);for(let k=0;k<f;++k){const e=Math.max(0,Math.ceil((v-k)/h)),t=Math.min(p.outHeight,(p.inHeight+v-k)/h);for(let n=0;n<m;++n){const r=Math.max(0,Math.ceil((y-n)/d)),a=Math.min(p.outWidth,(p.inWidth+y-n)/d);for(let i=0;i<p.outChannels;++i){const o=Math.trunc(i/b),s=i%b;let u=0;for(let c=0;c<p.batchSize;++c)for(let s=e;s<t;++s){const e=k+s*h-v;for(let t=r;t<a;++t){const r=n+t*d-y;u+=w.get(c,e,r,o)*S.get(c,s,t,i)}}g.set(u,k,n,o,s)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};const Gz={kernelName:ht,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{strides:o,dilations:s,pad:u,dimRoundingMode:c,inputShape:l}=r;Gm([a,i],"depthwiseConv2DNativeBackpropInput");const p=ae(a.shape),h=ae(i.shape),d=ou(l,i.shape,o,s,u,c,!0),f=new xa(d.inShape,"float32"),m=f.values,[g,y,v]=f.strides,b=n.data.get(a.dataId).values,[x,w,N]=p,S=n.data.get(i.dataId).values,[k,E,C]=h,{batchSize:T,filterHeight:D,filterWidth:I,inChannels:A,inHeight:F,inWidth:_,outChannels:M,outHeight:O,outWidth:R,strideHeight:z,strideWidth:B}=d,L=D-1-d.padInfo.top,P=I-1-d.padInfo.left,U=M/A;for(let W=0;W<T;++W)for(let e=0;e<A;++e)for(let t=0;t<F;++t){const n=t-L,r=Math.max(0,Math.ceil(n/z)),a=Math.min(O,(D+n)/z);for(let i=0;i<_;++i){const o=i-P,s=Math.max(0,Math.ceil(o/B)),u=Math.min(R,(I+o)/B);let c=0;for(let t=r;t<a;++t){const r=t*z-n;for(let n=s;n<u;++n){const a=x*W+w*t+N*n,i=k*(D-1-r)+E*(I-1-(n*B-o))+C*e;for(let t=0;t<U;++t){c+=b[a+(e*U+t)]*S[i+t]}}}m[g*W+y*t+v*i+e]=c}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}};const Hz={kernelName:dt,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,a=U(r.shape),i=n.data.get(r.dataId).values,o=wo([a,a],r.dtype),s=o.values;for(let c=0;c<i.length;c++)s[c*a+c]=i[c];const u=[...r.shape,...r.shape];return n.makeTensorInfo(u,o.dtype,o.values)}},Kz={kernelName:ft,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:a,filter:i}=t,{strides:o,pad:s,dilations:u}=r,c=n,l=c.data.get(a.dataId).values,p=a.shape.length,h=c.data.get(i.dataId).values,d=i.shape.length,{batchSize:f,inHeight:m,inWidth:g,inChannels:y,outHeight:v,outWidth:b,padInfo:x,strideHeight:w,strideWidth:N,filterHeight:S,filterWidth:k,dilationHeight:E,dilationWidth:C,outShape:T}=ru(a.shape,i.shape,o,s,"NHWC",u),D=U(T),I=T.length,A=$(a.dtype,D);for(let F=0;F<f;++F)for(let e=0;e<v;++e){const t=e*w-x.top;for(let n=0;n<b;++n){const r=n*N-x.left;for(let o=0;o<y;++o){let s=Number.MIN_SAFE_INTEGER;for(let e=0;e<S;++e){const n=t+e*E;if(n>=0&&n<m)for(let t=0;t<k;++t){const u=r+t*C;if(u>=0&&u<g){const r=pe([F,n,u,o],p,ae(a.shape)),c=pe([e,t,o],d,ae(i.shape)),f=l[r]+h[c];f>s&&(s=f)}}}A[pe([F,e,n,o],I,ae(T))]=s}}}return{dataId:c.write(oa(A,a.dtype),T,a.dtype),shape:T,dtype:a.dtype}}},Xz={kernelName:gt,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:a,filter:i,dy:o}=t,{strides:s,pad:u,dilations:c}=r,l=n,p=oe(a.shape,l.data.get(a.dataId).values),h=oe(i.shape,l.data.get(i.dataId).values),{batchSize:d,inHeight:f,inWidth:m,inChannels:g,outHeight:y,outWidth:v,padInfo:b,strideHeight:x,strideWidth:w,filterHeight:N,filterWidth:S,dilationHeight:k,dilationWidth:E,outShape:C}=ru(a.shape,i.shape,s,u,"NHWC",c);B(o.rank===C.length,(()=>"Error in ".concat(gt,", dy ")+"must have the same rank as output ".concat(C.length,", but got ")+"".concat(o.rank)));const T=oe(C,l.data.get(o.dataId).values),D=ce(i.shape,i.dtype);for(let I=0;I<d;++I)for(let e=0;e<y;++e){const t=e*x-b.top;for(let n=0;n<v;++n){const r=n*w-b.left;for(let a=0;a<g;++a){let i=Number.MIN_SAFE_INTEGER,o=0,s=0;for(let e=0;e<N;++e){const n=t+e*k;if(n>=0&&n<f)for(let t=0;t<S;++t){const u=r+t*E;if(u>=0&&u<m){const r=p[I][n][u][a]+h[e][t][a];r>i&&(i=r,o=e,s=t)}}}D[o][s][a]+=T[I][e][n][a]}}}return{dataId:l.write(oa(D,a.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},Yz={kernelName:mt,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:a,filter:i,dy:o}=t,{strides:s,pad:u,dilations:c}=r,l=n,p=oe(a.shape,l.data.get(a.dataId).values),h=oe(i.shape,l.data.get(i.dataId).values),{batchSize:d,inHeight:f,inWidth:m,inChannels:g,outHeight:y,outWidth:v,padInfo:b,strideHeight:x,strideWidth:w,filterHeight:N,filterWidth:S,dilationHeight:k,dilationWidth:E,outShape:C}=ru(a.shape,i.shape,s,u,"NHWC",c);B(o.rank===C.length,(()=>"Error in ".concat(mt,", dy ")+"must have the same rank as output ".concat(C.length,", but got ")+"".concat(o.rank)));const T=oe(C,l.data.get(o.dataId).values),D=ce(a.shape,a.dtype);for(let I=0;I<d;++I)for(let e=0;e<y;++e){const t=e*x-b.top;for(let n=0;n<v;++n){const r=n*w-b.left;for(let a=0;a<g;++a){let i=Number.MIN_SAFE_INTEGER,o=t<0?0:t,s=r<0?0:r;for(let e=0;e<N;++e){const n=t+e*k;if(n>=0&&n<f)for(let t=0;t<S;++t){const u=r+t*E;if(u>=0&&u<m){const r=p[I][n][u][a]+h[e][t][a];r>i&&(i=r,o=n,s=u)}}}D[I][o][s][a]+=T[I][e][n][a]}}}return{dataId:l.write(oa(D,a.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}};const $z={kernelName:yt,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:a}=t,{canvas:i,options:o}=r,{contextOptions:s,imageOptions:u}=o||{},c=(null===u||void 0===u?void 0:u.alpha)||1,l=(null===s||void 0===s?void 0:s.contextType)||"2d";if("2d"!==l)throw new Error("Context type ".concat(s.contextType," is not supported by the CPU backend."));const p=i.getContext(l,(null===s||void 0===s?void 0:s.contextAttributes)||{});if(null==p)throw new Error("Could not get the context with ".concat(l," type."));const[h,d]=a.shape.slice(0,2),f=2===a.shape.length?1:a.shape[2],m=n.data.get(a.dataId).values,g="float32"===a.dtype?255:1,y=new Uint8ClampedArray(d*h*4);for(let b=0;b<h*d;++b){const e=[0,0,0,255*c];for(let n=0;n<f;n++){const t=m[b*f+n];if("float32"===a.dtype){if(t<0||t>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(t,"."))}else if("int32"===a.dtype&&(t<0||t>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(t,"."));1===f?(e[0]=t*g,e[1]=t*g,e[2]=t*g):e[n]=t*g}const t=4*b;y[t+0]=Math.round(e[0]),y[t+1]=Math.round(e[1]),y[t+2]=Math.round(e[2]),y[t+3]=Math.round(e[3])}i.width=d,i.height=h;const v=new ImageData(y,d,h);return p.putImageData(v,0,0),a}};function Zz(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r;let s;Gm(a,"sum"),s="bool"===a.dtype?rg({inputs:{x:a},backend:n,attrs:{dtype:"int32"}}):Qm({inputs:{x:a},backend:n});const u=s.shape.length,c=K(i,s.shape),l=yc(c,u);let p=c,h=s;null!=l&&(h=gy({inputs:{x:s},backend:n,attrs:{perm:l}}),p=bc(p.length,u)),gc("sum",p,h.shape.length);const[d,f]=fc(h.shape,p);let m=Zm(n,d,Ma(h.dtype,"int32"));const g=U(f),y=n.data.get(m.dataId).values,v=n.data.get(h.dataId).values;for(let b=0;b<y.length;++b){const e=b*g;let t=0;for(let n=0;n<g;++n)t+=v[e+n];y[b]=t}if(o){const e=m;m=BR({inputs:{x:m},backend:n,attrs:{shape:mc(m.shape,c)}}),n.disposeIntermediateTensorInfo(e)}return n.disposeIntermediateTensorInfo(s),null!=l&&n.disposeIntermediateTensorInfo(h),m}const Qz={kernelName:tr,backendName:"cpu",kernelFunc:Zz};const Jz={kernelName:bt,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,i=t,{allDims:o,summedDims:s,idDims:u}=$d(a,i.length);Qd(o.length,u,i);const{path:c,steps:l}=Jd(s,u),p=l.length;let h=null,d=o.length;const f=[];for(let m=0;m<p;++m){for(const e of l[m]){const{permutationIndices:t,expandDims:r}=Zd(d,u[e]);let a;ef(t)?a=i[e]:(a=gy({inputs:{x:i[e]},backend:n,attrs:{perm:t}}),f.push(a));const o=a.shape.slice();for(let e=0;e<r.length;++e)o.splice(r[e],0,1);W(a.shape,o)||(a=BR({inputs:{x:a},backend:n,attrs:{shape:o}}),f.push(a)),null===h?h=a:(h=uy({inputs:{a:a,b:h},backend:n}),f.push(h))}m<p-1&&(c[m]>=0&&(h=Zz({inputs:{x:h},backend:n,attrs:{axis:c[m]-(o.length-d),keepDims:!1}}),f.push(h)),d--)}for(const m of f)m!==h&&n.disposeIntermediateTensorInfo(m);return h}};const eB={kernelName:wt,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{dy:r,y:a}=t;Gm([r,a],"eluGrad");const i=new Float32Array(U(a.shape)),o=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values;for(let u=0;u<o.length;++u){const e=o[u];i[u]=e>=0?s[u]:s[u]*(e+1)}return n.makeTensorInfo(a.shape,"float32",i)}},tB=_d,nB=Md,rB=Od,aB=Rd,iB=zd,oB=Bd,sB=yg(Nt,(e=>{const t=Math.sign(e),n=Math.abs(e),r=1/(1+tB*n);return t*(1-((((oB*r+iB)*r+aB)*r+rB)*r+nB)*r*Math.exp(-n*n))})),uB={kernelName:Nt,backendName:"cpu",kernelFunc:sB};function cB(e){const{inputs:t,backend:n,attrs:r}=e,{input:a}=t,{dim:i}=r,o=a.shape.length,s=a.shape.slice();let u=i;return i<0&&(B(-(o+1)<=i,(()=>"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]"))),u=o+i+1),s.splice(u,0,1),BR({inputs:{x:a},backend:n,attrs:{shape:s}})}const lB={kernelName:Et,backendName:"cpu",kernelFunc:cB},pB=Xm(((e,t)=>e/t)),hB=ig(vt,pB),dB={kernelName:vt,backendName:"cpu",kernelFunc:hB};function fB(e,t,n){const r=e.shape,a=r[0],i=r[1],o=n.data.get(e.dataId),s=o.complexTensorInfos.real,u=o.complexTensorInfos.imag,c=[a,i],l=U(c),p=Y("float32",l),h=Y("float32",l);for(let g=0;g<a;g++){const e=Uy({inputs:{x:s},backend:n,attrs:{begin:[g,0],size:[1,i]}}),r=Uy({inputs:{x:u},backend:n,attrs:{begin:[g,0],size:[1,i]}}),a=Ym({inputs:{real:e,imag:r},backend:n}),{real:o,imag:c}=mB(a,t,n),l=Ld(o,c);for(let t=0;t<i;t++){const e=Vd(l,t);p[g*i+t]=e.real,h[g*i+t]=e.imag}n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a)}const d=n.makeTensorInfo(c,"float32",p),f=n.makeTensorInfo(c,"float32",h),m=Ym({inputs:{real:d,imag:f},backend:n});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),m}function mB(e,t,n){const r=U(e.shape),a=n.data.get(e.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,o=n.data.get(a.complexTensorInfos.imag.dataId).values;if(0===((s=r)&s-1)){const a=gB(i,o,r,t,n),s=[e.shape[0],e.shape[1]];if(t){const e=n.makeTensorInfo(s,"float32",a.real),t=n.makeTensorInfo(s,"float32",a.imag),i=n.makeTensorInfo([],"float32",ia(r,"float32")),o=Qm({inputs:{x:i},backend:n}),u=dB.kernelFunc({inputs:{a:e,b:i},backend:n}),c=dB.kernelFunc({inputs:{a:t,b:o},backend:n}),l=n.data.get(u.dataId).values,p=n.data.get(c.dataId).values;return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),{real:l,imag:p}}return a}{const e=function(e,t,n){const r=new Float32Array(2*t);for(let a=0;a<t;a++){let i=0,o=0;for(let r=0;r<t;r++){const s=Gd(a*r,t,n),u=Vd(e,r);i+=u.real*s.real-u.imag*s.imag,o+=u.real*s.imag+u.imag*s.real}n&&(i/=t,o/=t),qd(r,i,o,a)}return r}(Ld(i,o),r,t);return Pd(e)}var s}function gB(e,t,n,r,a){if(1===n)return{real:e,imag:t};const i=Ld(e,t),o=n/2,s=Ud(i),u=s.real,c=s.imag,l=[u.length],p=a.makeTensorInfo(l,"float32",u),h=a.makeTensorInfo(l,"float32",c),d=Ym({inputs:{real:p,imag:h},backend:a}),f=Wd(i),m=f.real,g=f.imag,y=[m.length],v=a.makeTensorInfo(y,"float32",m),b=a.makeTensorInfo(y,"float32",g),x=Ym({inputs:{real:v,imag:b},backend:a}),w=gB(u,c,o,r,a),N=w.real,S=w.imag,k=[N.length],E=a.makeTensorInfo(k,"float32",N),C=a.makeTensorInfo(k,"float32",S),T=Ym({inputs:{real:E,imag:C},backend:a}),D=gB(m,g,o,r,a),I=D.real,A=D.imag,F=[I.length],_=a.makeTensorInfo(F,"float32",I),M=a.makeTensorInfo(F,"float32",A),O=Ym({inputs:{real:_,imag:M},backend:a}),R=jd(n,r),z=[R.real.length],B=a.makeTensorInfo(z,"float32",R.real),L=a.makeTensorInfo(z,"float32",R.imag),P=Ym({inputs:{real:B,imag:L},backend:a}),U=uy({inputs:{a:P,b:O},backend:a}),W=cg({inputs:{a:T,b:U},backend:a}),V=iv({inputs:{a:T,b:U},backend:a}),q=eg({inputs:{input:W},backend:a}),j=eg({inputs:{input:V},backend:a}),G=Nz({inputs:{input:W},backend:a}),H=Nz({inputs:{input:V},backend:a}),K=kz({inputs:[q,j],backend:a,attrs:{axis:0}}),X=kz({inputs:[G,H],backend:a,attrs:{axis:0}}),Y=a.data.get(K.dataId).values,$=a.data.get(X.dataId).values;return a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(v),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(E),a.disposeIntermediateTensorInfo(C),a.disposeIntermediateTensorInfo(T),a.disposeIntermediateTensorInfo(_),a.disposeIntermediateTensorInfo(M),a.disposeIntermediateTensorInfo(O),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(L),a.disposeIntermediateTensorInfo(P),a.disposeIntermediateTensorInfo(U),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(V),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(K),a.disposeIntermediateTensorInfo(X),{real:Y,imag:$}}const yB={kernelName:Tt,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t,a=U(r.shape),i=r.shape[r.shape.length-1],o=BR({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=fB(o,!1,n),u=BR({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}};function vB(e){const{backend:t,attrs:n}=e,{shape:r,value:a,dtype:i}=n,o=i||te(a),s=$(o,U(r));return function(e,t){e.fill(t)}(s,a),t.makeTensorInfo(r,o,s)}const bB={kernelName:Dt,backendName:"cpu",kernelFunc:vB};const xB={kernelName:It,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:a}=t,i=r,o=Y(a.dtype,U(a.shape)),[s,u,c,l]=a.shape,p=i.data.get(a.dataId).values;for(let h=0;h<s;h++){const e=h*c*u*l;for(let t=0;t<u;t++){const n=t*(c*l);for(let t=0;t<c;t++){const r=t*l;for(let a=0;a<l;a++){const i=Math.round(c-t-1),s=e+n+r+a;let u=p[s];if(i>=0&&i<c){u=p[e+n+i*l+a]}o[s]=u}}}}return{dataId:i.write(o,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},wB=Xm(((e,t)=>Math.floor(e/t))),NB=ig(Ft,wB,null,"int32"),SB={kernelName:Ft,backendName:"cpu",kernelFunc:NB};const kB={kernelName:_r,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:o,preluActivationWeights:s}=t,{strides:u,pad:c,dataFormat:l,dilations:p,dimRoundingMode:h,activation:d,leakyreluAlpha:f}=r;let m=Cz({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:p,dimRoundingMode:h}});if(o){const e=m;if("NCHW"===l&&1===o.shape.length&&1!==o.shape[0]){const e=BR({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=cg({inputs:{a:m,b:e},backend:n}),n.disposeIntermediateTensorInfo(e)}else m=cg({inputs:{a:m,b:o},backend:n});n.disposeIntermediateTensorInfo(e)}if(d){const e=m;if("NCHW"===l&&"prelu"===d&&1===s.shape.length&&1!==s.shape[0]){const e=BR({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});m=zR(n,m,d,e,f),n.disposeIntermediateTensorInfo(e)}else m=zR(n,m,d,s,f);n.disposeIntermediateTensorInfo(e)}return m}};const EB={kernelName:Mr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:o,preluActivationWeights:s}=t,{strides:u,pad:c,dataFormat:l,dilations:p,dimRoundingMode:h,activation:d,leakyreluAlpha:f}=r;let m=Vz({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:p,dimRoundingMode:h}});if(o){const e=m;m=cg({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(e)}if(d){const e=m;m=zR(n,m,d,s,f),n.disposeIntermediateTensorInfo(e)}return m}};const CB={kernelName:Ot,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:r,indices:a}=t,i=U(r.shape),o=a.shape,s=o[o.length-1],[u,c,l,p]=Id(r,a);if(0===c)return n.makeTensorInfo(u,r.dtype,[]);const h=Rg(n.data.get(a.dataId).values,n.bufferSync(r),r.dtype,c,s,l,p,r.shape,i);return n.makeTensorInfo(u,r.dtype,h.values)}};const TB={kernelName:Mt,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,indices:i}=t,{axis:o,batchDims:s}=r;Gm([a,i],"gatherV2");const u=K(o,a.shape)[0],c=n.data.get(i.dataId).values,l=a.shape[u];for(let b=0;b<c.length;++b){const e=c[b];B(e<=l-1&&e>=0,(()=>"GatherV2: the index value ".concat(e," is not in [0, ").concat(l-1,"]")))}let p=s;null==s&&(p=0);const h=U(i.shape),d=vf(a,i,u,p),f=BR({inputs:{x:a},backend:n,attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]}}),m=BR({inputs:{x:i},backend:n,attrs:{shape:[d.batchSize,h/d.batchSize]}}),g=[d.batchSize,d.outerSize,h/d.batchSize,d.sliceSize],y=n.bufferSync(m),v=zg(n.bufferSync(f),y,g);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(d.outputShape,v.dtype,v.values)}};const DB={kernelName:Lt,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t,a=U(r.shape),i=r.shape[r.shape.length-1],o=BR({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=fB(o,!0,n),u=BR({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}},IB=yg(Ut,(e=>Number.isFinite(e)?1:0),"bool"),AB={kernelName:Ut,backendName:"cpu",kernelFunc:IB},FB=yg(Wt,(e=>Math.abs(e)===1/0?1:0),"bool"),_B={kernelName:Wt,backendName:"cpu",kernelFunc:FB},MB=yg(Vt,(e=>Number.isNaN(e)?1:0),"bool"),OB={kernelName:Vt,backendName:"cpu",kernelFunc:MB};const RB={kernelName:Ht,backendName:"cpu",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:a,num:i}=n,o=Yg(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},zB=yg(Xt,(e=>Math.log1p(e))),BB={kernelName:Xt,backendName:"cpu",kernelFunc:zB},LB=Xm(((e,t)=>e&&t)),PB=ig(Yt,LB,null,"bool"),UB={kernelName:Yt,backendName:"cpu",kernelFunc:PB},WB=yg($t,(e=>e?0:1),"bool"),VB={kernelName:$t,backendName:"cpu",kernelFunc:WB},qB=Xm(((e,t)=>e||t)),jB=ig(Zt,qB,null,"bool"),GB={kernelName:Zt,backendName:"cpu",kernelFunc:jB};const HB={kernelName:Qt,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:i,bias:o,alpha:s,beta:u}=r;Gm(a,"LRN");const c=a.shape[3],l=c-1,p=n.data.get(a.dataId).values,h=U(a.shape),d=new Float32Array(h);function f(e){const t=e%c;let n=e-t+Math.max(0,t-i);const r=e-t+Math.min(t+i,l);let a=0;for(;n<=r;n++){const e=p[n];a+=e*e}return a}for(let m=0;m<h;m++){const e=f(m),t=p[m]*Math.pow(o+s*e,-u);d[m]=t}return n.makeTensorInfo(a.shape,a.dtype,d)}};const KB={kernelName:Jt,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,y:i,dy:o}=t,{depthRadius:s,bias:u,alpha:c,beta:l}=r;Gm(o,"LRNGrad");const p=U(o.shape),h=o.shape[3],d=n.data.get(o.dataId).values,f=n.data.get(a.dataId).values,m=n.data.get(i.dataId).values,g=new Float32Array(p),y=p;for(let v=0;v<y;v++){const e=v%h,t=v-e+Math.max(0,e-s),n=v-e+Math.min(h,e+s+1);let r=0;for(let a=t;a<n;a++)r+=Math.pow(f[a],2);r=c*r+u;for(let a=t;a<n;a++){let e=-2*c*l*f[a]*m[v]/r;v===a&&(e+=Math.pow(r,-l)),e*=d[v],g[a]+=e}}return n.makeTensorInfo(o.shape,a.dtype,g)}};function XB(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reductionIndices:i,keepDims:o}=r,s=n;let u=a.shape;const c=u.length,l=K(i,u);let p=l;const h=yc(p,c);let d=s.data.get(a.dataId).values;if(null!=h){const e=new Array(c);for(let t=0;t<e.length;t++)e[t]=u[h[t]];d=my(d,u,a.dtype,h,e),p=bc(p.length,c),u=e}Gm(a,"max"),gc("max",p,c);const[f,m]=fc(u,p),g=Jg(d,U(m),f,a.dtype),y=s.write(g,f,a.dtype);let v=f;if(o){v=mc(f,l)}return{dataId:y,shape:v,dtype:a.dtype}}const YB={kernelName:en,backendName:"cpu",kernelFunc:XB};const $B={kernelName:nn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t;Gm(a,"maxPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:u}=r;B(fu(o,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")));const c=au(a.shape,i,o,1,s,u);let l;if(1===c.filterWidth&&1===c.filterHeight&&W(c.inShape,c.outShape))l=Qm({inputs:{x:a},backend:n});else{const e=n.data.get(a.dataId).values,t=ae(a.shape),r=uz(e,a.shape,a.dtype,t,c,"max");l=n.makeTensorInfo(c.outShape,a.dtype,r.values)}return l}};const ZB={kernelName:an,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:o,pad:s,dimRoundingMode:u,dataFormat:c}=r;Gm(a,"maxPool3d");const l=iu(a.shape,i,o,1,s,u,c),p=lz(n.data.get(a.dataId).values,a.shape,a.dtype,ae(a.shape),l,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}};const QB={kernelName:on,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:o,strides:s,pad:u,dimRoundingMode:c}=r;Gm([a,i],"maxPool3DGrad");const l=iu(i.shape,o,s,1,u,c),p=function(e,t){const n=wo(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,p=t.effectiveFilterWidth,h=t.padInfo.front,d=t.padInfo.top,f=t.padInfo.left;for(let m=0;m<t.batchSize;++m)for(let g=0;g<t.inChannels;++g)for(let y=0;y<t.outDepth;++y){const v=y*r-h;let b=v;for(;b<0;)b+=o;const x=Math.min(t.inDepth,c+v);for(let r=0;r<t.outHeight;++r){const c=r*a-d;let h=c;for(;h<0;)h+=s;const w=Math.min(t.inHeight,l+c);for(let a=0;a<t.outWidth;++a){const d=a*i-f;let N=d;for(;N<0;)N+=u;const S=Math.min(t.inWidth,p+d);let k=Number.NEGATIVE_INFINITY,E=-1;for(let t=b;t<x;t+=o){const n=t-v;for(let r=h;r<w;r+=s){const a=r-c;for(let i=N;i<S;i+=u){const o=i-d,s=e.get(m,t,r,i,g);s>=k&&(k=s,E=n*l*p+a*l+o)}}}n.set(E,m,y,r,a,g)}}}return n}(n.bufferSync(i),l),h=l.strideDepth,d=l.strideHeight,f=l.strideWidth,m=l.dilationDepth,g=l.dilationHeight,y=l.dilationWidth,v=l.effectiveFilterDepth,b=l.effectiveFilterHeight,x=l.effectiveFilterWidth,w=v-1-l.padInfo.front,N=x-1-l.padInfo.left,S=b-1-l.padInfo.top,k=wo(i.shape,"float32"),E=n.bufferSync(a);for(let C=0;C<l.batchSize;++C)for(let e=0;e<l.inChannels;++e)for(let t=0;t<l.inDepth;++t)for(let n=0;n<l.inHeight;++n)for(let r=0;r<l.inWidth;++r){const a=t-w,i=n-S,o=r-N;let s=0;for(let t=0;t<v;t+=m){const n=(a+t)/h;if(!(n<0||n>=l.outDepth||Math.floor(n)!==n))for(let r=0;r<b;r+=g){const a=(i+r)/d;if(!(a<0||a>=l.outHeight||Math.floor(a)!==a))for(let i=0;i<x;i+=y){const u=(o+i)/f;if(u<0||u>=l.outWidth||Math.floor(u)!==u)continue;const c=v*b*x-1-p.get(C,n,a,u,e)===t*b*x+r*x+i?1:0;if(0===c)continue;s+=E.get(C,n,a,u,e)*c}}}k.set(s,C,t,n,r,e)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}};const JB={kernelName:rn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i,output:o}=t,s=i;Gm([i,o],"maxPoolGrad");const{filterSize:u,strides:c,pad:l,dimRoundingMode:p}=r,h=au(s.shape,u,c,1,l,p),d=n.data.get(s.dataId).values,f=wo(h.outShape,s.dtype,cz(d,s.shape,s.dtype,h).values),m=h.strideHeight,g=h.strideWidth,y=h.dilationHeight,v=h.dilationWidth,b=h.effectiveFilterHeight,x=h.effectiveFilterWidth,w=x-1-h.padInfo.left,N=b-1-h.padInfo.top,S=wo(s.shape,"float32"),k=n.data.get(a.dataId).values,E=wo(a.shape,"float32",k);for(let C=0;C<h.batchSize;++C)for(let e=0;e<h.inChannels;++e)for(let t=0;t<h.inHeight;++t)for(let n=0;n<h.inWidth;++n){const r=t-N,a=n-w;let i=0;for(let t=0;t<b;t+=y){const n=(r+t)/m;if(!(n<0||n>=h.outHeight||Math.floor(n)!==n))for(let r=0;r<x;r+=v){const o=(a+r)/g;if(o<0||o>=h.outWidth||Math.floor(o)!==o)continue;const s=b*x-1-f.get(C,n,o,e)===t*x+r?1:0;if(0===s)continue;i+=E.get(C,n,o,e)*s}}S.set(i,C,t,n,e)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};const eL={kernelName:sn,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:a}=t,{filterSize:i,strides:o,pad:s,includeBatchInIndex:u}=n,c=r;Gm(a,"MaxPoolWithArgmax");const l=c.data.get(a.dataId).values,p=au(a.shape,i,o,[1,1],s),[h,d]=function(e,t,n,r,a){const i=uz(e,0,n,ae(t),a,"max"),o=cz(e,t,n,a,!0,r);return[i.values,o.values]}(l,a.shape,a.dtype,u,p),f=c.write(h,p.outShape,a.dtype),m=c.write(d,p.outShape,a.dtype);return[{dataId:f,shape:p.outShape,dtype:a.dtype},{dataId:m,shape:p.outShape,dtype:"int32"}]}};const tL={kernelName:un,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r,s=K(i,a.shape),u=U(fc(a.shape,s)[1]),c=[],l=n.makeTensorInfo([],"float32",new Float32Array([u]));c.push(l);const p=rg({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});c.push(p);const h=hB({inputs:{a:p,b:l},backend:n});c.push(h);const d=Zz({inputs:{x:h},backend:n,attrs:{axis:i,keepDims:o}});return c.forEach((e=>n.disposeIntermediateTensorInfo(e))),d}};const nL={kernelName:cn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r;Gm(a,"min");const s=K(i,a.shape);let u=s;const c=yc(u,a.shape.length);let l=a;null!=c&&(l=gy({inputs:{x:a},backend:n,attrs:{perm:c}}),u=bc(u.length,a.shape.length)),gc("min",u,l.shape.length);const[p,h]=fc(l.shape,u),d=U(h),f=ue(U(p),l.dtype),m=n.data.get(l.dataId).values;for(let y=0;y<f.length;++y){const e=y*d;let t=m[e];for(let n=0;n<d;++n){const r=m[e+n];(Number.isNaN(r)||r<t)&&(t=r)}f[y]=t}null!=c&&n.disposeIntermediateTensorInfo(l);const g=n.makeTensorInfo(p,l.dtype,f);if(o){const e=BR({inputs:{x:g},backend:n,attrs:{shape:mc(p,s)}});return n.disposeIntermediateTensorInfo(g),e}return g}};const rL={kernelName:pn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,mode:o}=r;Gm(a,"mirrorPad");const s=i.map(((e,t)=>e[0]+a.shape[t]+e[1])),u=i.map((e=>e[0])),c=i.map(((e,t)=>e[0]+a.shape[t])),l="reflect"===o?0:1,p=n.data.get(a.dataId).values,h=a.shape.length,d=ae(a.shape),f=U(s),m=s.length,g=ae(s),y=Y(a.dtype,f);for(let v=0;v<f;v++){let e=he(v,m,g);for(let n=0;n<m;n++)e[n]<u[n]?e[n]=2*u[n]-e[n]-l:e[n]>=c[n]&&(e[n]=2*(c[n]-1)-e[n]+l);e=e.map(((e,t)=>e-u[t]));const t=pe(e,h,d);y[v]=p[t]}return{dataId:n.write(y,s,a.dtype),shape:s,dtype:a.dtype}}},aL=Xm(((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),iL=ig(hn,aL),oL={kernelName:hn,backendName:"cpu",kernelFunc:iL};function sL(e){const{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:i}=r,o=a.shape.length;let s=i;if(-1===s&&(s=o-1),s!==o-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(o," and dim was ").concat(s));const u=K([s],a.shape),c=XB({inputs:{x:a},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),l=mc(c.shape,u),p=BR({inputs:{x:c},backend:n,attrs:{shape:l}}),h=iv({inputs:{a:a,b:p},backend:n}),d=Tg({inputs:{x:h},backend:n}),f=Zz({inputs:{x:d},backend:n,attrs:{axis:u,keepDims:!1}}),m=BR({inputs:{x:f},backend:n,attrs:{shape:l}}),g=hB({inputs:{a:d,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}const uL={kernelName:ar,backendName:"cpu",kernelFunc:sL};const cL={kernelName:dn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:i,seed:o,normalized:s}=r;Gm(a,"multinomial");const u=s?a:sL({inputs:{logits:a},backend:n,attrs:{dim:-1}}),c=u.shape[0],l=u.shape[1],p=n.data.get(u.dataId).values,h=[c,i],d=ue(U(h),"int32");for(let f=0;f<c;++f){const e=f*l,t=new Float32Array(l-1);t[0]=p[e];for(let a=1;a<t.length;++a)t[a]=t[a-1]+p[e+a];const n=Ol.alea(o.toString()),r=f*i;for(let a=0;a<i;++a){const e=n();d[r+a]=t.length;for(let n=0;n<t.length;n++)if(e<t[n]){d[r+a]=n;break}}}return s||n.disposeIntermediateTensorInfo(u),n.makeTensorInfo(h,"int32",d)}},lL=xh;const pL={kernelName:yn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:u}=r;Gm(a,"NonMaxSuppression");const c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,{selectedIndices:p}=lL(c,l,o,s,u);return n.makeTensorInfo([p.length],"int32",new Int32Array(p))}},hL=wh;const dL={kernelName:vn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:u,padToMaxOutputSize:c}=r;Gm(a,"NonMaxSuppressionPadded");const l=n.data.get(a.dataId).values,p=n.data.get(i.dataId).values,{selectedIndices:h,validOutputs:d}=hL(l,p,o,s,u,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([d]))]}},fL=Nh;const mL={kernelName:bn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:u,softNmsSigma:c}=r;Gm(a,"NonMaxSuppressionWithScore");const l=n.data.get(a.dataId).values,p=n.data.get(i.dataId).values,h=o,d=s,f=u,m=c,{selectedIndices:g,selectedScores:y}=fL(l,p,h,d,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}};const gL={kernelName:wn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:i,depth:o,onValue:s,offValue:u}=r;Gm(a,"oneHot");const c=U(a.shape),l=new Float32Array(c*o);l.fill(u);const p=n.data.get(a.dataId).values;for(let h=0;h<c;++h)p[h]>=0&&p[h]<o&&(l[h*o+p[h]]=s);return n.makeTensorInfo([...a.shape,o],i,l)}};function yL(e){const{inputs:t,backend:n}=e,{x:r}=t;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const e=eg({inputs:{input:r},backend:n}),t=yL({inputs:{x:e},backend:n}),a=Nz({inputs:{input:r},backend:n}),i=yL({inputs:{x:a},backend:n}),o=Ym({inputs:{real:t,imag:i},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),o}return vB({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const vL={kernelName:Tr,backendName:"cpu",kernelFunc:yL};const bL={kernelName:xn,backendName:"cpu",kernelFunc:function e(t){const{inputs:n,backend:r}=t,{x:a}=n;if("string"===a.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===a.dtype){const t=eg({inputs:{input:a},backend:r}),n=e({inputs:{x:t},backend:r}),i=Nz({inputs:{input:a},backend:r}),o=yL({inputs:{x:i},backend:r}),s=Ym({inputs:{real:n,imag:o},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}return vB({backend:r,attrs:{shape:a.shape,value:1,dtype:a.dtype}})}};function xL(e){const{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(1===t.length)return cB({inputs:{input:t[0]},backend:n,attrs:{dim:a}});const i=t[0].shape,o=t[0].dtype;t.forEach((e=>{L(i,e.shape,"All tensors passed to stack must have matching shapes"),B(o===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const s=[],u=kz({inputs:t.map((e=>{const t=cB({inputs:{input:e},backend:n,attrs:{dim:a}});return s.push(t),t})),backend:n,attrs:{axis:a}});return s.forEach((e=>n.disposeIntermediateTensorInfo(e))),u}const wL={kernelName:Nn,backendName:"cpu",kernelFunc:xL};const NL={kernelName:Sn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,constantValue:o}=r;Gm(a,"pad");const s=i.map(((e,t)=>e[0]+a.shape[t]+e[1])),u=i.map((e=>e[0])),c=n.data.get(a.dataId).values,l=U(a.shape),p=a.shape.length,h=ae(a.shape),d=U(s),f=s.length,m=ae(s),g=Y(a.dtype,d);0!==o&&g.fill(o);for(let y=0;y<l;y++){g[pe(he(y,p,h).map(((e,t)=>e+u[t])),f,m)]=c[y]}return{dataId:n.write(g,s,a.dtype),shape:s,dtype:a.dtype}}},SL=Xm(((e,t)=>Math.pow(e,t))),kL=ig(kn,SL),EL={kernelName:kn,backendName:"cpu",kernelFunc:kL};const CL={kernelName:Tn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:a,paramsDenseValues:i,indices:o}=t,{outputRaggedRank:s}=r,u=a.map((e=>n.data.get(e.dataId).values)),c=a.map((e=>e.shape)),l=n.data.get(i.dataId).values,p=n.data.get(o.dataId).values,[h,d,f]=Sy(u,c,l,i.shape,i.dtype,p,o.shape),m=h.map((e=>n.makeTensorInfo([e.length],"int32",e))),g=n.makeTensorInfo(f,i.dtype,d);return m.concat([g])}};const TL={kernelName:Dn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{starts:r,limits:a,deltas:i}=t,o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,[c,l]=Ey(o,r.shape,r.dtype,s,a.shape,u,i.shape);return[n.makeTensorInfo([c.length],"int32",c),n.makeTensorInfo([l.length],r.dtype,l)]}};const DL={kernelName:In,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{shape:a,values:i,defaultValue:o,rowPartitionTensors:s}=t,{rowPartitionTypes:u}=r,c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,p=n.data.get(o.dataId).values,h=s.map((e=>n.data.get(e.dataId).values)),d=s.map((e=>e.shape)),[f,m]=Ay(c,a.shape,l,i.shape,i.dtype,p,o.shape,h,d,u);return n.makeTensorInfo(f,i.dtype,m)}};const IL={kernelName:An,backendName:"cpu",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:a,dtype:i,step:o}=n,s=Fy(r,a,o,i);return t.makeTensorInfo([s.length],i,s)}},AL=yg(_n,(e=>1/e)),FL={kernelName:_n,backendName:"cpu",kernelFunc:AL};const _L={kernelName:Bn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:o,size:s}=r;Gm(a,"resizeBilinear");const u=ae(a.shape),[c,l]=s,[p,h,d,f]=a.shape,m=n.data.get(a.dataId).values,g=new Float32Array(U([p,c,l,f])),y=[i&&c>1?h-1:h,i&&l>1?d-1:d],v=[i&&c>1?c-1:c,i&&l>1?l-1:l];let b=0;const x=y[0]/v[0],w=y[1]/v[1];for(let N=0;N<p;N++)for(let e=0;e<c;e++){let t;t=o?x*(e+.5)-.5:x*e;const n=Math.max(0,Math.floor(t)),r=t-n,a=Math.min(h-1,Math.ceil(t)),i=N*u[0]+n*u[1],s=N*u[0]+a*u[1];for(let e=0;e<l;e++){let t;t=o?w*(e+.5)-.5:w*e;const n=Math.max(0,Math.floor(t)),a=t-n,c=Math.min(d-1,Math.ceil(t)),l=i+n*u[2],p=s+n*u[2],h=i+c*u[2],y=s+c*u[2];for(let e=0;e<f;e++){const t=m[l+e],n=m[p+e],i=t+(m[h+e]-t)*a,o=i+(n+(m[y+e]-n)*a-i)*r;g[b++]=o}}}return n.makeTensorInfo([p,c,l,f],"float32",g)}};const ML={kernelName:Ln,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:o}=r;Gm([i,a],"resizeBilinearGrad");const s=ae(a.shape),[u,c,l,p]=a.shape,[,h,d]=i.shape,f=new Float32Array(u*c*l*p),m=[o&&h>1?c-1:c,o&&d>1?l-1:l],g=[o&&h>1?h-1:h,o&&d>1?d-1:d],y=m[0]/g[0],v=m[1]/g[1],b=n.data.get(i.dataId).values;let x=0;for(let w=0;w<u;w++){const e=w*s[0];for(let t=0;t<h;t++){const n=t*y,r=Math.floor(n),a=Math.min(Math.ceil(n),c-1),i=e+r*s[1],o=e+a*s[1],u=n-r,h=1-u;for(let e=0;e<d;e++){const t=e*v,n=Math.floor(t),r=Math.min(Math.ceil(t),l-1),a=t-n,c=1-a,d=i+n*s[2],m=i+r*s[2],g=o+n*s[2],y=o+r*s[2],w=h*c,N=h*a,S=u*c,k=u*a;for(let e=0;e<p;e++){const t=b[x++];f[d+e]+=t*w,f[m+e]+=t*N,f[g+e]+=t*S,f[y+e]+=t*k}}}}return n.makeTensorInfo([u,l,c,p],"float32",f)}};const OL={kernelName:Rn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:o,size:s}=r;Gm(a,"resizeNearestNeighbor");const u=ae(a.shape),[c,l]=s,[p,h,d,f]=a.shape,m=n.data.get(a.dataId).values,g=new Float32Array(p*c*l*f),y=[i&&c>1?h-1:h,i&&l>1?d-1:d],v=[i&&c>1?c-1:c,i&&l>1?l-1:l],b=y[0]/v[0],x=y[1]/v[1];let w=0;for(let N=0;N<p;N++){const e=N*u[0];for(let t=0;t<c;t++){const n=o?b*(t+.5):b*t;let r=Math.min(h-1,i?Math.round(n):Math.floor(n));o&&(r=Math.max(0,r));const a=e+r*u[1];for(let e=0;e<l;e++){const t=o?x*(e+.5):x*e;let n=Math.min(d-1,i?Math.round(t):Math.floor(t));o&&(n=Math.max(0,n));const r=a+n*u[2];for(let e=0;e<f;e++){const t=m[r+e];g[w++]=t}}}}return n.makeTensorInfo([p,c,l,f],a.dtype,g)}};const RL={kernelName:zn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:o}=r;Gm([i,a],"resizeNearestNeighborGrad");const s=ae(a.shape),u=ae(i.shape),[c,l,p,h]=a.shape,[,d,f]=i.shape,m=new Float32Array(c*l*p*h),g=n.data.get(i.dataId).values,y=[o&&d>1?l-1:l,o&&f>1?p-1:p],v=[o&&d>1?d-1:d,o&&f>1?f-1:f],b=y[0]/v[0],x=y[1]/v[1],w=1/b,N=1/x,S=2*Math.ceil(w)+2,k=2*Math.ceil(N)+2;for(let E=0;E<c;E++){const e=E*s[0];for(let t=0;t<l;t++){const n=e+t*s[1],r=Math.floor(t*w),a=Math.floor(r-S/2);for(let i=0;i<p;i++){const r=n+i*s[2],c=Math.floor(i*N),y=Math.floor(c-k/2);for(let n=0;n<h;n++){let s=0;for(let r=0;r<S;r++){const c=r+a;if(c<0||c>=d)continue;const h=e+c*u[1],m=c*b;if(t===Math.min(l-1,o?Math.round(m):Math.floor(m)))for(let e=0;e<k;e++){const t=e+y;if(t<0||t>=f)continue;const r=h+t*u[2],a=t*x;i===Math.min(p-1,o?Math.round(a):Math.floor(a))&&(s+=g[r+n])}}m[r+n]=s}}}}return n.makeTensorInfo(a.shape,a.dtype,m)}};const zL={kernelName:Un,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:i}=r;Gm(a,"reverse");const o=a.shape.length,s=K(i,a.shape);if(0===o)return Qm({inputs:{x:a},backend:n});const u=new xa(a.shape,a.dtype),c=n.bufferSync(a);for(let l=0;l<u.size;l++){const e=u.indexToLoc(l),t=e.slice();s.forEach((e=>t[e]=a.shape[e]-1-t[e])),u.set(c.get(...t),...e)}return n.makeTensorInfo(u.shape,u.dtype,u.values)}},BL={kernelName:Ar,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:a}=t,{radians:i,fillValue:o,center:s}=n,u=r,c=Y(a.dtype,U(a.shape)),[l,p,h,d]=a.shape,[f,m]=Sd(s,p,h),g=Math.sin(i),y=Math.cos(i),v=u.data.get(a.dataId).values;for(let b=0;b<l;b++){const e=b*h*p*d;for(let t=0;t<p;t++){const n=t*(h*d);for(let r=0;r<h;r++){const a=r*d;for(let i=0;i<d;i++){const s=[l,t,r,i],u=s[2],b=s[1];let x=(u-f)*y-(b-m)*g,w=(u-f)*g+(b-m)*y;x=Math.round(x+f),w=Math.round(w+m);let N=o;if("number"!==typeof o&&(N=3===i?255:o[i]),x>=0&&x<h&&w>=0&&w<p){N=v[e+w*(h*d)+x*d+i]}c[e+n+a+i]=N}}}}return{dataId:u.write(c,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},LL=yg(Wn,(e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1})),PL={kernelName:Wn,backendName:"cpu",kernelFunc:LL};const UL={kernelName:qn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:i}=t,{shape:o}=r,{sliceRank:s,numUpdates:u,sliceSize:c,strides:l,outputSize:p}=Ap(0,a,o),h=Ry(n.bufferSync(a),n.bufferSync(i),o,p,c,u,s,l,0,!0);return n.makeTensorInfo(o,h.dtype,h.values)}};function WL(e,t){let n=0,r=e.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),e[a]<t?n=a+1:r=a;return r}function VL(e,t){let n=0,r=e.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),e[a]<=t?n=a+1:r=a;return r}const qL={kernelName:Gn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:i}=t,{side:o}=r,s=function(e,t,n,r,a,i){const o=$("int32",n*a);for(let s=0;s<n;++s){const n=e.slice(s*r,(s+1)*r),u=s*a;for(let e=0;e<a;++e)o[u+e]="left"===i?WL(n,t[e+u]):VL(n,t[e+u])}return o}(n.data.get(a.dataId).values,n.data.get(i.dataId).values,a.shape[0],a.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",s)}};const jL={kernelName:Hn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:r,t:a,e:i}=t;Gm([r,a,i],"select");const o=r.shape.length,s=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,l=Ma(a.dtype,i.dtype),p=ue(U(a.shape),l);let h=0;const d=0===o||o>1||1===a.shape.length?1:U(a.shape.slice(1));for(let f=0;f<s.length;f++)for(let e=0;e<d;e++)1===s[f]?p[h++]=u[f]:p[h++]=c[f];return n.makeTensorInfo(a.shape,l,p)}},GL=Ad,HL=Fd,KL=yg(Kn,(e=>e>=0?HL*e:GL*(Math.exp(e)-1))),XL={kernelName:Kn,backendName:"cpu",kernelFunc:KL},YL=yg(Zn,(e=>e<0?-1:e>0?1:0)),$L={kernelName:Zn,backendName:"cpu",kernelFunc:YL},ZL=yg(Yn,(e=>Math.sin(e))),QL={kernelName:Yn,backendName:"cpu",kernelFunc:ZL},JL=yg($n,(e=>Math.sinh(e))),eP={kernelName:$n,backendName:"cpu",kernelFunc:JL},tP=Math.log(1.1920928955078125e-7)+2,nP=yg(Jn,(e=>{const t=e>-tP,n=e<tP,r=Math.exp(e);let a;return a=n?r:t?e:Math.log(1+r),a})),rP={kernelName:Jn,backendName:"cpu",kernelFunc:nP};const aP={kernelName:nr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,paddings:o}=r;Gm([a],"spaceToBatchND");const s=U(i),u=[[0,0]];u.push(...o);for(let g=1+i.length;g<a.shape.length;++g)u.push([0,0]);const c=NL.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),l=kd(c.shape,i,s,!1),p=Ed(l.length,i.length,!1),h=Cd(c.shape,i,s,!1),d=BR({inputs:{x:c},backend:n,attrs:{shape:l}}),f=gy({inputs:{x:d},backend:n,attrs:{perm:p}}),m=BR({inputs:{x:f},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),m}};const iP={kernelName:ir,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{indices:r,values:a,denseShape:i,defaultValue:o}=t;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(a.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));const s=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[p,h,d,f,m]=Vy(s,r.shape,r.dtype,u,a.dtype,c,l);return[n.makeTensorInfo(h,r.dtype,p),n.makeTensorInfo([h[0]],a.dtype,d),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((e=>Number(e))))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};const oP={kernelName:or,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:a,newShape:i}=t;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));const o=Array.from(n.data.get(a.dataId).values),s=n.data.get(r.dataId).values,u=Array.from(n.data.get(i.dataId).values),[c,l,p]=qy(s,r.shape,r.dtype,o,u);return[n.makeTensorInfo(l,r.dtype,c),n.makeTensorInfo([p.length],i.dtype,new Int32Array(p))]}};const sP={kernelName:sr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,[c,l]=jy(o,r.shape,r.dtype,s,u,!0);return n.makeTensorInfo(l,r.dtype,c)}};const uP={kernelName:ur,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,[c,l]=jy(o,r.shape,r.dtype,s,u);return n.makeTensorInfo(l,r.dtype,c)}};const cP={kernelName:cr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:a,sparseValues:i,defaultValue:o}=t,{outputShape:s}=r,{sliceRank:u,numUpdates:c,sliceSize:l,strides:p,outputSize:h}=Ap(0,a,s),d=!1,f=n.bufferSync(a);let m;switch(i.dtype){case"bool":m=Ry(f,n.bufferSync(i),s,h,l,c,u,p,Boolean(n.data.get(o.dataId).values[0]),d);break;case"float32":m=Ry(f,n.bufferSync(i),s,h,l,c,u,p,n.data.get(o.dataId).values[0],d);break;case"int32":m=Ry(f,n.bufferSync(i),s,h,l,c,u,p,n.data.get(o.dataId).values[0],d);break;case"string":m=Ry(f,n.bufferSync(i),s,h,l,c,u,p,ca(n.data.get(o.dataId).values[0]),d);break;default:throw new Error("Unsupported type ".concat(i.dtype))}return n.makeTensorInfo(s,m.dtype,m.values)}};const lP={kernelName:rr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:i,axis:o}=r,s=K(o,a.shape)[0],u=nf(a,i,s),c=new Array(a.shape.length).fill(0),l=a.shape.slice();return u.map((e=>{const t=[...l];t[s]=e;const r=Uy({inputs:{x:a},backend:n,attrs:{begin:c,size:t}});return c[s]+=e,r}))}},pP={kernelName:pr,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n}=e;const{x:r}=t,a=n;Gm(r,"square");const i=a.data.get(r.dataId).values,o=new Float32Array(i.length);for(let s=0;s<i.length;++s){const e=i[s];o[s]=e*e}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},hP=Xm(((e,t)=>{const n=e-t;return n*n})),dP=ig(lr,hP),fP={kernelName:lr,backendName:"cpu",kernelFunc:dP},mP=yg(Dr,((e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),gP={kernelName:Dr,backendName:"cpu",kernelFunc:mP};const yP={kernelName:dr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,end:o,strides:s,beginMask:u,endMask:c,ellipsisMask:l,newAxisMask:p,shrinkAxisMask:h}=r;Gm(a,"stridedSlice");const{finalShapeSparse:d,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:v,end:b,strides:x}=qs(a.shape,i,o,s,u,c,l,p,h);let w;if(m)w=BR({inputs:{x:a},backend:n,attrs:{shape:f}});else if(g||y){B(a.shape.length>=1,(()=>"Input must have rank at least 1, got: ".concat(a.shape.length)));const e=As(v,b,x),t=Uy({inputs:{x:a},backend:n,attrs:{begin:v,size:e}});w=BR({inputs:{x:t},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(t)}else{const e=Zy(d,n.bufferSync(a),x,v);w=n.makeTensorInfo(f,e.dtype,e.values)}return w}};const vP={kernelName:fr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:i,leftPad:o,rightPad:s,padWidth:u,preserveShortSequences:c}=r,{data:l,dataSplits:p}=t,h=n.data.get(l.dataId).values,d=n.data.get(p.dataId).values,[f,m]=Jy(h,d,a,i,o,s,u,c);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(p.shape,"int32",m)]}};const bP={kernelName:mr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:a}=r,{input:i,delimiter:o}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(1!==i.shape.length)throw new Error("Input must be a vector, got shape: ".concat(i.shape));if(0!==o.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(o.shape));const s=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values[0],[c,l,p]=tv(s,u,a),h=l.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",l),n.makeTensorInfo([2],"int32",new Int32Array(p))]}};const xP={kernelName:gr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:a}=r,{input:i}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const o=nv(n.data.get(i.dataId).values,a);return n.makeTensorInfo(i.shape,"int32",o)}},wP=yg(vr,(e=>Math.tan(e))),NP={kernelName:vr,backendName:"cpu",kernelFunc:wP},SP=yg(br,(e=>Math.tanh(e)));const kP={kernelName:jn,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{tensor:r,indices:a,updates:i}=t,{sliceRank:o,numUpdates:s,sliceSize:u,strides:c,outputSize:l}=Ap(0,a,r.shape),p=n.bufferSync(a),h=n.bufferSync(i),d=n.bufferSync(r),f=Ry(p,h,r.shape,l,u,s,o,c,d,!1);return n.makeTensorInfo(r.shape,f.dtype,f.values)}};const EP={kernelName:xr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:i}=r;Gm(a,"tile");const o=sv(n.bufferSync(a),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}};const CP={kernelName:wr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:i,sorted:o}=r;Gm(a,"topk");const s=n.data.get(a.dataId).values,[u,c]=lv(s,a.shape,a.dtype,i,o);return[n.makeTensorInfo(u.shape,u.dtype,u.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}};const TP={kernelName:Nr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{image:a,transforms:i}=t,{interpolation:o,fillMode:s,fillValue:u,outputShape:c}=n,[l,p,h,d]=a.shape,[f,m]=null!=c?c:[p,h],g=[l,f,m,d],y=ae(a.shape),v=y[0],b=y[1],x=y[2],w=ae(g),N=w[0],S=w[1],k=w[2],E=Y(a.dtype,U(g));E.fill(u);const C=r.data.get(a.dataId).values,T=r.data.get(i.dataId).values;for(let D=0;D<l;++D){const e=1===i.shape[0]?T:T.subarray(8*D,8*D+8);for(let t=0;t<f;++t)for(let n=0;n<m;++n)for(let r=0;r<d;++r){let a;const i=e[6]*n+e[7]*t+1;if(0===i)continue;const c=(e[0]*n+e[1]*t+e[2])/i,l=(e[3]*n+e[4]*t+e[5])/i,d=DP(c,h,s),f=DP(l,p,s);switch(o){case"nearest":a=AP(C,p,h,v,b,x,D,f,d,r,u);break;case"bilinear":a=FP(C,p,h,v,b,x,D,f,d,r,u);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(o))}E[D*N+t*S+n*k+r]=a}return r.makeTensorInfo(g,a.dtype,E)}return{dataId:r.write(E,g,a.dtype),shape:a.shape,dtype:a.dtype}}};function DP(e,t,n){switch(n){case"reflect":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const e=2*t;n<e&&(n=e*Math.trunc(-n/e)+n),n=n<-t?n+e:-n-1}else if(n>t-1)if(t<=1)n=0;else{const e=2*t;n-=e*Math.trunc(n/e),n>=t&&(n=e-n-1)}return O(0,n,t-1)}(e,t);case"wrap":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const e=t-1;n+=t*(Math.trunc(-n/e)+1)}else if(n>t-1)if(t<=1)n=0;else{const e=t-1;n-=t*Math.trunc(n/e)}return O(0,n,t-1)}(e,t);case"nearest":return function(e,t){return O(0,e,t-1)}(e,t);default:return function(e){return e}(e)}}function IP(e,t,n,r,a,i,o,s,u,c,l){return 0<=s&&s<t&&0<=u&&u<n?e[o*r+s*a+u*i+c]:l}function AP(e,t,n,r,a,i,o,s,u,c,l){return IP(e,t,n,r,a,i,o,Math.round(s),Math.round(u),c,l)}function FP(e,t,n,r,a,i,o,s,u,c,l){const p=Math.floor(s),h=Math.floor(u),d=p+1,f=h+1;return(d-s)*((f-u)*IP(e,t,n,r,a,i,o,p,h,c,l)+(u-h)*IP(e,t,n,r,a,i,o,p,f,c,l))+(s-p)*((f-u)*IP(e,t,n,r,a,i,o,d,h,c,l)+(u-h)*IP(e,t,n,r,a,i,o,d,f,c,l))}const _P={kernelName:kr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:i}=t;Gm(i,"unique");const o=r.data.get(i.dataId).values,{outputValues:s,outputShape:u,indices:c}=pv(o,a,i.shape,i.dtype);return[r.makeTensorInfo(u,i.dtype,s),r.makeTensorInfo([c.length],"int32",c)]}};const MP={kernelName:Er,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:a}=t;let{axis:i}=r;i<0&&(i+=a.shape.length);const o=a.shape.length,s=a.shape[i],u=new Array(o-1);let c=0;for(let d=0;d<o;d++)d!==i&&(u[c++]=a.shape[d]);const l=new Array(o).fill(0),p=a.shape.slice();p[i]=1;const h=new Array(s);for(let d=0;d<h.length;d++){l[i]=d;const e=Uy({inputs:{x:a},backend:n,attrs:{begin:l,size:p}});h[d]=BR({inputs:{x:e},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(e)}return h}};const OP={kernelName:Cr,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:i}=t,{numSegments:o}=r;Gm(a,"unsortedSegmentSum");const s=[],u=[],c=a.shape.length-i.shape.length;let l=i;for(let h=0;h<c;++h){const e=cB({inputs:{input:l},backend:n,attrs:{dim:h+1}});l=e,u.push(e)}for(let h=0;h<o;++h){const e=ia(h,"int32"),t=n.makeTensorInfo([],"int32",e),r=kg({inputs:{a:t,b:l},backend:n}),i=rg({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),o=uy({inputs:{a:i,b:a},backend:n}),c=Zz({inputs:{x:o},backend:n,attrs:{axis:0,keepDims:!1}});s.push(c),u.push(t),u.push(r),u.push(i),u.push(o),u.push(c)}const p=xL({inputs:s,backend:n,attrs:{axis:0}});return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),p}},RP=[WR,Km,qR,GR,lg,HR,KR,XR,YR,$R,QR,ez,nz,iz,sz,pz,hz,dz,fz,UR,mz,gz,yz,mg,vz,ag,wg,xz,$m,wz,Ez,Tz,Dz,Iz,Az,Fz,_z,Oz,zz,Bz,Lz,Pz,Uz,Wz,qz,jz,Gz,Hz,Kz,Xz,Yz,$z,Jz,CR,eB,Eg,uB,Dg,lB,Fg,yB,bB,xB,Og,SB,kB,EB,CB,TB,Pg,Vg,Jm,DB,Sz,AB,_B,OB,DR,Gg,Xg,RB,Qg,BB,UB,VB,GB,HB,KB,YB,ny,$B,ZB,QB,JB,eL,tL,nL,iy,rL,oL,cL,cy,py,pL,dL,mL,fy,gL,bL,wL,NL,EL,FR,by,CL,TL,DL,IL,tg,dB,FL,MR,RR,LR,_L,ML,OL,RL,zL,BL,PL,Oy,UL,qL,jL,XL,Ly,$L,QL,eP,Wy,uL,rP,aP,iP,oP,sP,uP,cP,lP,Ky,pP,fP,$y,gP,yP,vP,bP,xP,ov,Qz,NP,{kernelName:br,backendName:"cpu",kernelFunc:SP},kP,EP,CP,TP,yy,_P,MP,OP,vL];for(const n of RP)Wr(n);function zP(){return zP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zP.apply(null,arguments)}var BP=n(422);function LP(e,t,n,r){if(!(this instanceof LP))throw new SyntaxError("Constructor must be called with the new operator");this.fn=e,this.count=t,this.min=n,this.max=r,this.message="Wrong number of arguments in function "+e+" ("+t+" provided, "+n+(void 0!==r&&null!==r?"-"+r:"")+" expected)",this.stack=(new Error).stack}function PP(e,t,n){if(!(this instanceof PP))throw new SyntaxError("Constructor must be called with the new operator");this.actual=e,this.expected=t,this.relation=n,this.message="Dimension mismatch ("+(Array.isArray(e)?"["+e.join(", ")+"]":e)+" "+(this.relation||"!=")+" "+(Array.isArray(t)?"["+t.join(", ")+"]":t)+")",this.stack=(new Error).stack}function UP(e,t,n){if(!(this instanceof UP))throw new SyntaxError("Constructor must be called with the new operator");this.index=e,arguments.length<3?(this.min=0,this.max=t):(this.min=t,this.max=n),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}function WP(e,t){if(qP(e,t))return e[t];if("function"===typeof e[t]&&jP(e,t))throw new Error('Cannot access method "'+t+'" as a property');throw new Error('No access to property "'+t+'"')}function VP(e,t,n){if(qP(e,t))return e[t]=n,n;throw new Error('No access to property "'+t+'"')}function qP(e,t){return!(!function(e){return"object"===typeof e&&e&&e.constructor===Object}(e)&&!Array.isArray(e))&&(!!$U(GP,t)||!(t in Object.prototype)&&!(t in Function.prototype))}function jP(e,t){return null!==e&&void 0!==e&&"function"===typeof e[t]&&(!($U(e,t)&&Object.getPrototypeOf&&t in Object.getPrototypeOf(e))&&(!!$U(HP,t)||!(t in Object.prototype)&&!(t in Function.prototype)))}LP.prototype=new Error,LP.prototype.constructor=Error,LP.prototype.name="ArgumentsError",LP.prototype.isArgumentsError=!0,PP.prototype=new RangeError,PP.prototype.constructor=RangeError,PP.prototype.name="DimensionError",PP.prototype.isDimensionError=!0,UP.prototype=new RangeError,UP.prototype.constructor=RangeError,UP.prototype.name="IndexError",UP.prototype.isIndexError=!0;var GP={length:!0,name:!0},HP={toString:!0,valueOf:!0,toLocaleString:!0};class KP{constructor(e){this.wrappedObject=e,this[Symbol.iterator]=this.entries}keys(){return Object.keys(this.wrappedObject).filter((e=>this.has(e))).values()}get(e){return WP(this.wrappedObject,e)}set(e,t){return VP(this.wrappedObject,e,t),this}has(e){return qP(this.wrappedObject,e)&&e in this.wrappedObject}entries(){return YP(this.keys(),(e=>[e,this.get(e)]))}forEach(e){for(var t of this.keys())e(this.get(t),t,this)}delete(e){qP(this.wrappedObject,e)&&delete this.wrappedObject[e]}clear(){for(var e of this.keys())this.delete(e)}get size(){return Object.keys(this.wrappedObject).length}}class XP{constructor(e,t,n){this.a=e,this.b=t,this.bKeys=n,this[Symbol.iterator]=this.entries}get(e){return this.bKeys.has(e)?this.b.get(e):this.a.get(e)}set(e,t){return this.bKeys.has(e)?this.b.set(e,t):this.a.set(e,t),this}has(e){return this.b.has(e)||this.a.has(e)}keys(){return new Set([...this.a.keys(),...this.b.keys()])[Symbol.iterator]()}entries(){return YP(this.keys(),(e=>[e,this.get(e)]))}forEach(e){for(var t of this.keys())e(this.get(t),t,this)}delete(e){return this.bKeys.has(e)?this.b.delete(e):this.a.delete(e)}clear(){this.a.clear(),this.b.clear()}get size(){return[...this.keys()].length}}function YP(e,t){return{next:()=>{var n=e.next();return n.done?n:{value:t(n.value),done:!1}}}}function $P(){return new Map}function ZP(e){if(!e)return $P();if(bU(e))return e;if(vU(e))return new KP(e);throw new Error("createMap can create maps from objects or Maps")}function QP(e){return"number"===typeof e}function JP(e){return!(!e||"object"!==typeof e||"function"!==typeof e.constructor)&&(!0===e.isBigNumber&&"object"===typeof e.constructor.prototype&&!0===e.constructor.prototype.isBigNumber||"function"===typeof e.constructor.isDecimal&&!0===e.constructor.isDecimal(e))}function eU(e){return"bigint"===typeof e}function tU(e){return e&&"object"===typeof e&&!0===Object.getPrototypeOf(e).isComplex||!1}function nU(e){return e&&"object"===typeof e&&!0===Object.getPrototypeOf(e).isFraction||!1}function rU(e){return e&&!0===e.constructor.prototype.isUnit||!1}function aU(e){return"string"===typeof e}var iU=Array.isArray;function oU(e){return e&&!0===e.constructor.prototype.isMatrix||!1}function sU(e){return Array.isArray(e)||oU(e)}function uU(e){return e&&e.isDenseMatrix&&!0===e.constructor.prototype.isMatrix||!1}function cU(e){return e&&e.isSparseMatrix&&!0===e.constructor.prototype.isMatrix||!1}function lU(e){return e&&!0===e.constructor.prototype.isRange||!1}function pU(e){return e&&!0===e.constructor.prototype.isIndex||!1}function hU(e){return"boolean"===typeof e}function dU(e){return e&&!0===e.constructor.prototype.isResultSet||!1}function fU(e){return e&&!0===e.constructor.prototype.isHelp||!1}function mU(e){return"function"===typeof e}function gU(e){return e instanceof Date}function yU(e){return e instanceof RegExp}function vU(e){return!(!e||"object"!==typeof e||e.constructor!==Object||tU(e)||nU(e))}function bU(e){return!!e&&(e instanceof Map||e instanceof KP||"function"===typeof e.set&&"function"===typeof e.get&&"function"===typeof e.keys&&"function"===typeof e.has)}function xU(e){return bU(e)&&bU(e.a)&&bU(e.b)}function wU(e){return bU(e)&&vU(e.wrappedObject)}function NU(e){return null===e}function SU(e){return void 0===e}function kU(e){return e&&!0===e.isAccessorNode&&!0===e.constructor.prototype.isNode||!1}function EU(e){return e&&!0===e.isArrayNode&&!0===e.constructor.prototype.isNode||!1}function CU(e){return e&&!0===e.isAssignmentNode&&!0===e.constructor.prototype.isNode||!1}function TU(e){return e&&!0===e.isBlockNode&&!0===e.constructor.prototype.isNode||!1}function DU(e){return e&&!0===e.isConditionalNode&&!0===e.constructor.prototype.isNode||!1}function IU(e){return e&&!0===e.isConstantNode&&!0===e.constructor.prototype.isNode||!1}function AU(e){return IU(e)||zU(e)&&1===e.args.length&&IU(e.args[0])&&"-+~".includes(e.op)}function FU(e){return e&&!0===e.isFunctionAssignmentNode&&!0===e.constructor.prototype.isNode||!1}function _U(e){return e&&!0===e.isFunctionNode&&!0===e.constructor.prototype.isNode||!1}function MU(e){return e&&!0===e.isIndexNode&&!0===e.constructor.prototype.isNode||!1}function OU(e){return e&&!0===e.isNode&&!0===e.constructor.prototype.isNode||!1}function RU(e){return e&&!0===e.isObjectNode&&!0===e.constructor.prototype.isNode||!1}function zU(e){return e&&!0===e.isOperatorNode&&!0===e.constructor.prototype.isNode||!1}function BU(e){return e&&!0===e.isParenthesisNode&&!0===e.constructor.prototype.isNode||!1}function LU(e){return e&&!0===e.isRangeNode&&!0===e.constructor.prototype.isNode||!1}function PU(e){return e&&!0===e.isRelationalNode&&!0===e.constructor.prototype.isNode||!1}function UU(e){return e&&!0===e.isSymbolNode&&!0===e.constructor.prototype.isNode||!1}function WU(e){return e&&!0===e.constructor.prototype.isChain||!1}function VU(e){var t=typeof e;return"object"===t?null===e?"null":JP(e)?"BigNumber":e.constructor&&e.constructor.name?e.constructor.name:"Object":t}function qU(e){var t=typeof e;if("number"===t||"bigint"===t||"string"===t||"boolean"===t||null===e||void 0===e)return e;if("function"===typeof e.clone)return e.clone();if(Array.isArray(e))return e.map((function(e){return qU(e)}));if(e instanceof Date)return new Date(e.valueOf());if(JP(e))return e;if(vU(e))return function(e,t){var n={};for(var r in e)$U(e,r)&&(n[r]=t(e[r]));return n}(e,qU);if("function"===t)return e;throw new TypeError("Cannot clone: unknown type of value (value: ".concat(e,")"))}function jU(e,t){for(var n in t)$U(t,n)&&(e[n]=t[n]);return e}function GU(e,t){if(Array.isArray(t))throw new TypeError("Arrays are not supported by deepExtend");for(var n in t)if($U(t,n)&&!(n in Object.prototype)&&!(n in Function.prototype))if(t[n]&&t[n].constructor===Object)void 0===e[n]&&(e[n]={}),e[n]&&e[n].constructor===Object?GU(e[n],t[n]):e[n]=t[n];else{if(Array.isArray(t[n]))throw new TypeError("Arrays are not supported by deepExtend");e[n]=t[n]}return e}function HU(e,t){var n,r,a;if(Array.isArray(e)){if(!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(r=0,a=e.length;r<a;r++)if(!HU(e[r],t[r]))return!1;return!0}if("function"===typeof e)return e===t;if(e instanceof Object){if(Array.isArray(t)||!(t instanceof Object))return!1;for(n in e)if(!(n in t)||!HU(e[n],t[n]))return!1;for(n in t)if(!(n in e))return!1;return!0}return e===t}function KU(e){var t={};return XU(e,t),t}function XU(e,t){for(var n in e)if($U(e,n)){var r=e[n];"object"===typeof r&&null!==r?XU(r,t):t[n]=r}}function YU(e,t,n){var r,a=!0;Object.defineProperty(e,t,{get:function(){return a&&(r=n(),a=!1),r},set:function(e){r=e,a=!1},configurable:!0,enumerable:!0})}function $U(e,t){return e&&Object.hasOwnProperty.call(e,t)}function ZU(e,t,n,r){function a(r){var a=function(e,t){for(var n={},r=0;r<t.length;r++){var a=t[r],i=e[a];void 0!==i&&(n[a]=i)}return n}(r,t.map(JU));return function(e,t,n){var r=t.filter((e=>!function(e){return e&&"?"===e[0]}(e))).every((e=>void 0!==n[e]));if(!r){var a=t.filter((e=>void 0===n[e]));throw new Error('Cannot create function "'.concat(e,'", ')+"some dependencies are missing: ".concat(a.map((e=>'"'.concat(e,'"'))).join(", "),"."))}}(e,t,r),n(a)}return a.isFactory=!0,a.fn=e,a.dependencies=t.slice().sort(),r&&(a.meta=r),a}function QU(e){return"function"===typeof e&&"string"===typeof e.fn&&Array.isArray(e.dependencies)}function JU(e){return e&&"?"===e[0]?e.slice(1):e}var eW=n(841);var tW={relTol:1e-12,absTol:1e-15,matrix:"Matrix",number:"number",numberFallback:"number",precision:64,predictable:!1,randomSeed:null},nW=["Matrix","Array"],rW=["number","BigNumber","Fraction"];function aW(e,t){function n(r){if(r){if(void 0!==r.epsilon){console.warn('Warning: The configuration option "epsilon" is deprecated. Use "relTol" and "absTol" instead.');var a=qU(r);return a.relTol=r.epsilon,a.absTol=.001*r.epsilon,delete a.epsilon,n(a)}var i=qU(e);iW(r,"matrix",nW),iW(r,"number",rW),GU(e,r);var o=qU(e),s=qU(r);return t("config",o,i,s),o}return qU(e)}return n.MATRIX_OPTIONS=nW,n.NUMBER_OPTIONS=rW,Object.keys(tW).forEach((t=>{Object.defineProperty(n,t,{get:()=>e[t],enumerable:!0,configurable:!0})})),n}function iW(e,t,n){void 0===e[t]||n.includes(e[t])||console.warn('Warning: Unknown value "'+e[t]+'" for configuration option "'+t+'". Available options: '+n.map((e=>JSON.stringify(e))).join(", ")+".")}function oW(e,t,n,r){function a(t,a,o){var s;if(o.wrap&&"function"===typeof a&&(a=function(e){var t=function(){for(var t=[],r=0,a=arguments.length;r<a;r++){var i=arguments[r];t[r]=i&&i.valueOf()}return e.apply(n,t)};e.transform&&(t.transform=e.transform);return t}(a)),function(e){return"function"===typeof e&&"string"===typeof e.signature}(a)&&(a=e(t,{[a.signature]:a})),e.isTypedFunction(n[t])&&e.isTypedFunction(a))return a=o.override?e(t,a.signatures):e(n[t],a),n[t]=a,delete r[t],i(t,a),void n.emit("import",t,(function(){return a}));var u=void 0!==n[t],c=null===(s=n.Unit)||void 0===s?void 0:s.isValuelessUnit(t);if(!u&&!c||o.override)return n[t]=a,delete r[t],i(t,a),void n.emit("import",t,(function(){return a}));if(!o.silent)throw new Error('Cannot import "'+t+'": already exists')}function i(e,t){t&&"function"===typeof t.transform?(n.expression.transform[e]=t.transform,u(e)&&(n.expression.mathWithTransform[e]=t.transform)):(delete n.expression.transform[e],u(e)&&(n.expression.mathWithTransform[e]=t))}function o(e){delete n.expression.transform[e],u(e)?n.expression.mathWithTransform[e]=n[e]:delete n.expression.mathWithTransform[e]}function s(t,a){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.fn;if(i.includes("."))throw new Error("Factory name should not contain a nested path. Name: "+JSON.stringify(i));var s=l(t)?n.expression.transform:n,u=i in n.expression.transform,p=$U(s,i)?s[i]:void 0,h=function(){var r={};t.dependencies.map(JU).forEach((e=>{if(e.includes("."))throw new Error("Factory dependency should not contain a nested path. Name: "+JSON.stringify(e));"math"===e?r.math=n:"mathWithTransform"===e?r.mathWithTransform=n.expression.mathWithTransform:"classes"===e?r.classes=n:r[e]=n[e]}));var o=t(r);if(o&&"function"===typeof o.transform)throw new Error('Transforms cannot be attached to factory functions. Please create a separate function for it with export const path = "expression.transform"');if(void 0===p||a.override)return o;if(e.isTypedFunction(p)&&e.isTypedFunction(o))return e(p,o);if(a.silent)return p;throw new Error('Cannot import "'+i+'": already exists')};t.meta&&!1===t.meta.lazy?(s[i]=h(),p&&u?o(i):(l(t)||c(t))&&YU(n.expression.mathWithTransform,i,(()=>s[i]))):(YU(s,i,h),p&&u?o(i):(l(t)||c(t))&&YU(n.expression.mathWithTransform,i,(()=>s[i]))),r[i]=t,n.emit("import",i,h)}function u(e){return!$U(p,e)}function c(e){return!e.fn.includes(".")&&!$U(p,e.fn)&&(!e.meta||!e.meta.isClass)}function l(e){return void 0!==e&&void 0!==e.meta&&!0===e.meta.isTransformFunction||!1}var p={expression:!0,type:!0,docs:!0,error:!0,json:!0,chain:!0};return function(e,t){var n=arguments.length;if(1!==n&&2!==n)throw new LP("import",n,1,2);t||(t={});var r,i={};for(var o in function e(n,r,a){if(Array.isArray(r))r.forEach((t=>e(n,t)));else if("object"===typeof r)for(var i in r)$U(r,i)&&e(n,r[i],i);else if(QU(r)||void 0!==a){var o=QU(r)?l(r)?r.fn+".transform":r.fn:a;if($U(n,o)&&n[o]!==r&&!t.silent)throw new Error('Cannot import "'+o+'" twice');n[o]=r}else if(!t.silent)throw new TypeError("Factory, Object, or Array expected")}(i,e),i)if($U(i,o)){var u=i[o];if(QU(u))s(u,t);else if("function"===typeof(r=u)||"number"===typeof r||"string"===typeof r||"boolean"===typeof r||null===r||rU(r)||tU(r)||JP(r)||nU(r)||oU(r)||Array.isArray(r))a(o,u,t);else if(!t.silent)throw new TypeError("Factory, Object, or Array expected")}}}function sW(e){return"boolean"===typeof e||!!isFinite(e)&&e===Math.round(e)}function uW(e,t){if("bigint"===t.number)try{BigInt(e)}catch(n){return t.numberFallback}return t.number}var cW=Math.sign||function(e){return e>0?1:e<0?-1:0},lW=Math.log2||function(e){return Math.log(e)/Math.LN2},pW=Math.log10||function(e){return Math.log(e)/Math.LN10},hW=Math.log1p||function(e){return Math.log(e+1)},dW=Math.cbrt||function(e){if(0===e)return e;var t,n=e<0;return n&&(e=-e),t=isFinite(e)?(e/((t=Math.exp(Math.log(e)/3))*t)+2*t)/3:e,n?-t:t},fW=Math.expm1||function(e){return e>=2e-4||e<=-2e-4?Math.exp(e)-1:e+e*e/2+e*e*e/6};function mW(e,t,n){var r={2:"0b",8:"0o",16:"0x"}[t],a="";if(n){if(n<1)throw new Error("size must be in greater than 0");if(!sW(n))throw new Error("size must be an integer");if(e>2**(n-1)-1||e<-(2**(n-1)))throw new Error("Value must be in range [-2^".concat(n-1,", 2^").concat(n-1,"-1]"));if(!sW(e))throw new Error("Value must be an integer");e<0&&(e+=2**n),a="i".concat(n)}var i="";return e<0&&(e=-e,i="-"),"".concat(i).concat(r).concat(e.toString(t)).concat(a)}function gW(e,t){if("function"===typeof t)return t(e);if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity";if(isNaN(e))return"NaN";var{notation:n,precision:r,wordSize:a}=yW(t);switch(n){case"fixed":return bW(e,r);case"exponential":return xW(e,r);case"engineering":return function(e,t){if(isNaN(e)||!isFinite(e))return String(e);var n=vW(e),r=wW(n,t),a=r.exponent,i=r.coefficients,o=a%3===0?a:a<0?a-3-a%3:a-a%3;if(QP(t))for(;t>i.length||a-o+1>i.length;)i.push(0);else for(var s=Math.abs(a-o)-(i.length-1),u=0;u<s;u++)i.push(0);var c=Math.abs(a-o),l=1;for(;c>0;)l++,c--;var p=i.slice(l).join(""),h=QP(t)&&p.length||p.match(/[1-9]/)?"."+p:"",d=i.slice(0,l).join("")+h+"e"+(a>=0?"+":"")+o.toString();return r.sign+d}(e,r);case"bin":return mW(e,2,a);case"oct":return mW(e,8,a);case"hex":return mW(e,16,a);case"auto":return function(e,t,n){if(isNaN(e)||!isFinite(e))return String(e);var r=FW(null===n||void 0===n?void 0:n.lowerExp,-3),a=FW(null===n||void 0===n?void 0:n.upperExp,5),i=vW(e),o=t?wW(i,t):i;if(o.exponent<r||o.exponent>=a)return xW(e,t);var s=o.coefficients,u=o.exponent;s.length<t&&(s=s.concat(NW(t-s.length))),s=s.concat(NW(u-s.length+1+(s.length<t?t-s.length:0)));var c=u>0?u:0;return c<(s=NW(-u).concat(s)).length-1&&s.splice(c+1,0,"."),o.sign+s.join("")}(e,r,t).replace(/((\.\d*?)(0+))($|e)/,(function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t}));default:throw new Error('Unknown notation "'+n+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function yW(e){var t,n,r="auto";if(void 0!==e)if(QP(e))t=e;else if(JP(e))t=e.toNumber();else{if(!vU(e))throw new Error("Unsupported type of options, number, BigNumber, or object expected");void 0!==e.precision&&(t=AW(e.precision,(()=>{throw new Error('Option "precision" must be a number or BigNumber')}))),void 0!==e.wordSize&&(n=AW(e.wordSize,(()=>{throw new Error('Option "wordSize" must be a number or BigNumber')}))),e.notation&&(r=e.notation)}return{notation:r,precision:t,wordSize:n}}function vW(e){var t=String(e).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!t)throw new SyntaxError("Invalid number "+e);var n=t[1],r=t[2],a=parseFloat(t[4]||"0"),i=r.indexOf(".");a+=-1!==i?i-1:r.length-1;var o=r.replace(".","").replace(/^0*/,(function(e){return a-=e.length,""})).replace(/0*$/,"").split("").map((function(e){return parseInt(e)}));return 0===o.length&&(o.push(0),a++),{sign:n,coefficients:o,exponent:a}}function bW(e,t){if(isNaN(e)||!isFinite(e))return String(e);var n=vW(e),r="number"===typeof t?wW(n,n.exponent+1+t):n,a=r.coefficients,i=r.exponent+1,o=i+(t||0);return a.length<o&&(a=a.concat(NW(o-a.length))),i<0&&(a=NW(1-i).concat(a),i=1),i<a.length&&a.splice(i,0,0===i?"0.":"."),r.sign+a.join("")}function xW(e,t){if(isNaN(e)||!isFinite(e))return String(e);var n=vW(e),r=t?wW(n,t):n,a=r.coefficients,i=r.exponent;a.length<t&&(a=a.concat(NW(t-a.length)));var o=a.shift();return r.sign+o+(a.length>0?"."+a.join(""):"")+"e"+(i>=0?"+":"")+i}function wW(e,t){for(var n={sign:e.sign,coefficients:e.coefficients,exponent:e.exponent},r=n.coefficients;t<=0;)r.unshift(0),n.exponent++,t++;if(r.length>t&&r.splice(t,r.length-t)[0]>=5){var a=t-1;for(r[a]++;10===r[a];)r.pop(),0===a&&(r.unshift(0),n.exponent++,a++),r[--a]++}return n}function NW(e){for(var t=[],n=0;n<e;n++)t.push(0);return t}function SW(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(n<=0)throw new Error("Relative tolerance must be greater than 0");if(r<0)throw new Error("Absolute tolerance must be at least 0");return!isNaN(e)&&!isNaN(t)&&(isFinite(e)&&isFinite(t)?e===t||Math.abs(e-t)<=Math.max(n*Math.max(Math.abs(e),Math.abs(t)),r):e===t)}var kW=Math.acosh||function(e){return Math.log(Math.sqrt(e*e-1)+e)},EW=Math.asinh||function(e){return Math.log(Math.sqrt(e*e+1)+e)},CW=Math.atanh||function(e){return Math.log((1+e)/(1-e))/2},TW=Math.cosh||function(e){return(Math.exp(e)+Math.exp(-e))/2},DW=Math.sinh||function(e){return(Math.exp(e)-Math.exp(-e))/2},IW=Math.tanh||function(e){var t=Math.exp(2*e);return(t-1)/(t+1)};function AW(e,t){return QP(e)?e:JP(e)?e.toNumber():void t()}function FW(e,t){return QP(e)?e:JP(e)?e.toNumber():t}var _W=function(){return _W=BP.create,BP},MW=ZU("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],(function(e){var{BigNumber:t,Complex:n,DenseMatrix:r,Fraction:a}=e,i=_W();return i.clear(),i.addTypes([{name:"number",test:QP},{name:"Complex",test:tU},{name:"BigNumber",test:JP},{name:"bigint",test:eU},{name:"Fraction",test:nU},{name:"Unit",test:rU},{name:"identifier",test:e=>aU&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(e)},{name:"string",test:aU},{name:"Chain",test:WU},{name:"Array",test:iU},{name:"Matrix",test:oU},{name:"DenseMatrix",test:uU},{name:"SparseMatrix",test:cU},{name:"Range",test:lU},{name:"Index",test:pU},{name:"boolean",test:hU},{name:"ResultSet",test:dU},{name:"Help",test:fU},{name:"function",test:mU},{name:"Date",test:gU},{name:"RegExp",test:yU},{name:"null",test:NU},{name:"undefined",test:SU},{name:"AccessorNode",test:kU},{name:"ArrayNode",test:EU},{name:"AssignmentNode",test:CU},{name:"BlockNode",test:TU},{name:"ConditionalNode",test:DU},{name:"ConstantNode",test:IU},{name:"FunctionNode",test:_U},{name:"FunctionAssignmentNode",test:FU},{name:"IndexNode",test:MU},{name:"Node",test:OU},{name:"ObjectNode",test:RU},{name:"OperatorNode",test:zU},{name:"ParenthesisNode",test:BU},{name:"RangeNode",test:LU},{name:"RelationalNode",test:PU},{name:"SymbolNode",test:UU},{name:"Map",test:bU},{name:"Object",test:vU}]),i.addConversions([{from:"number",to:"BigNumber",convert:function(e){if(t||OW(e),e.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+e+"). Use function bignumber(x) to convert to BigNumber.");return new t(e)}},{from:"number",to:"Complex",convert:function(e){return n||RW(e),new n(e,0)}},{from:"BigNumber",to:"Complex",convert:function(e){return n||RW(e),new n(e.toNumber(),0)}},{from:"bigint",to:"number",convert:function(e){if(e>Number.MAX_SAFE_INTEGER)throw new TypeError("Cannot implicitly convert bigint to number: value exceeds the max safe integer value (value: "+e+")");return Number(e)}},{from:"bigint",to:"BigNumber",convert:function(e){return t||OW(e),new t(e.toString())}},{from:"bigint",to:"Fraction",convert:function(e){return a||zW(e),new a(e)}},{from:"Fraction",to:"BigNumber",convert:function(e){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(e){return n||RW(e),new n(e.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(e){a||zW(e);var t=new a(e);if(t.valueOf()!==e)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+e+"). Use function fraction(x) to convert to Fraction.");return t}},{from:"string",to:"number",convert:function(e){var t=Number(e);if(isNaN(t))throw new Error('Cannot convert "'+e+'" to a number');return t}},{from:"string",to:"BigNumber",convert:function(e){t||OW(e);try{return new t(e)}catch(r5){throw new Error('Cannot convert "'+e+'" to BigNumber')}}},{from:"string",to:"bigint",convert:function(e){try{return BigInt(e)}catch(r5){throw new Error('Cannot convert "'+e+'" to BigInt')}}},{from:"string",to:"Fraction",convert:function(e){a||zW(e);try{return new a(e)}catch(r5){throw new Error('Cannot convert "'+e+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(e){n||RW(e);try{return new n(e)}catch(r5){throw new Error('Cannot convert "'+e+'" to Complex')}}},{from:"boolean",to:"number",convert:function(e){return+e}},{from:"boolean",to:"BigNumber",convert:function(e){return t||OW(e),new t(+e)}},{from:"boolean",to:"bigint",convert:function(e){return BigInt(+e)}},{from:"boolean",to:"Fraction",convert:function(e){return a||zW(e),new a(+e)}},{from:"boolean",to:"string",convert:function(e){return String(e)}},{from:"Array",to:"Matrix",convert:function(e){return r||function(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new r(e)}},{from:"Matrix",to:"Array",convert:function(e){return e.valueOf()}}]),i.onMismatch=(e,t,n)=>{var r=i.createError(e,t,n);if(["wrongType","mismatch"].includes(r.data.category)&&1===t.length&&sU(t[0])&&n.some((e=>!e.params.includes(",")))){var a=new TypeError("Function '".concat(e,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(e,")'."));throw a.data=r.data,a}throw r},i.onMismatch=(e,t,n)=>{var r=i.createError(e,t,n);if(["wrongType","mismatch"].includes(r.data.category)&&1===t.length&&sU(t[0])&&n.some((e=>!e.params.includes(",")))){var a=new TypeError("Function '".concat(e,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(e,")'."));throw a.data=r.data,a}throw r},i}));function OW(e){throw new Error("Cannot convert value ".concat(e," into a BigNumber: no class 'BigNumber' provided"))}function RW(e){throw new Error("Cannot convert value ".concat(e," into a Complex number: no class 'Complex' provided"))}function zW(e){throw new Error("Cannot convert value ".concat(e," into a Fraction, no class 'Fraction' provided."))}var BW,LW,PW=ZU("ResultSet",[],(()=>{function e(t){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");this.entries=t||[]}return e.prototype.type="ResultSet",e.prototype.isResultSet=!0,e.prototype.valueOf=function(){return this.entries},e.prototype.toString=function(){return"["+this.entries.map(String).join(", ")+"]"},e.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},e.fromJSON=function(t){return new e(t.entries)},e}),{isClass:!0}),UW=9e15,WW=1e9,VW="0123456789abcdef",qW="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",jW="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",GW={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-UW,maxE:UW,crypto:!1},HW=!0,KW="[DecimalError] ",XW=KW+"Invalid argument: ",YW=KW+"Precision limit exceeded",$W=KW+"crypto unavailable",ZW="[object Decimal]",QW=Math.floor,JW=Math.pow,eV=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,tV=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,nV=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,rV=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,aV=1e7,iV=qW.length-1,oV=jW.length-1,sV={toStringTag:ZW};function uV(e){var t,n,r,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)(n=7-(r=e[t]+"").length)&&(i+=bV(n)),i+=r;(n=7-(r=(o=e[t])+"").length)&&(i+=bV(n))}else if(0===o)return"0";for(;o%10===0;)o/=10;return i+o}function cV(e,t,n){if(e!==~~e||e<t||e>n)throw Error(XW+e)}function lV(e,t,n,r){var a,i,o,s;for(i=e[0];i>=10;i/=10)--t;return--t<0?(t+=7,a=0):(a=Math.ceil((t+1)/7),t%=7),i=JW(10,7-t),s=e[a]%i|0,null==r?t<3?(0==t?s=s/100|0:1==t&&(s=s/10|0),o=n<4&&99999==s||n>3&&49999==s||5e4==s||0==s):o=(n<4&&s+1==i||n>3&&s+1==i/2)&&(e[a+1]/i/100|0)==JW(10,t-2)-1||(s==i/2||0==s)&&0==(e[a+1]/i/100|0):t<4?(0==t?s=s/1e3|0:1==t?s=s/100|0:2==t&&(s=s/10|0),o=(r||n<4)&&9999==s||!r&&n>3&&4999==s):o=((r||n<4)&&s+1==i||!r&&n>3&&s+1==i/2)&&(e[a+1]/i/1e3|0)==JW(10,t-3)-1,o}function pV(e,t,n){for(var r,a,i=[0],o=0,s=e.length;o<s;){for(a=i.length;a--;)i[a]*=t;for(i[0]+=VW.indexOf(e.charAt(o++)),r=0;r<i.length;r++)i[r]>n-1&&(void 0===i[r+1]&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}sV.absoluteValue=sV.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),dV(e)},sV.ceil=function(){return dV(new this.constructor(this),this.e+1,2)},sV.clampedTo=sV.clamp=function(e,t){var n=this,r=n.constructor;if(e=new r(e),t=new r(t),!e.s||!t.s)return new r(NaN);if(e.gt(t))throw Error(XW+t);return n.cmp(e)<0?e:n.cmp(t)>0?t:new r(n)},sV.comparedTo=sV.cmp=function(e){var t,n,r,a,i=this,o=i.d,s=(e=new i.constructor(e)).d,u=i.s,c=e.s;if(!o||!s)return u&&c?u!==c?u:o===s?0:!o^u<0?1:-1:NaN;if(!o[0]||!s[0])return o[0]?u:s[0]?-c:0;if(u!==c)return u;if(i.e!==e.e)return i.e>e.e^u<0?1:-1;for(t=0,n=(r=o.length)<(a=s.length)?r:a;t<n;++t)if(o[t]!==s[t])return o[t]>s[t]^u<0?1:-1;return r===a?0:r>a^u<0?1:-1},sV.cosine=sV.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+7,r.rounding=1,n=function(e,t){var n,r,a;if(t.isZero())return t;r=t.d.length,r<32?a=(1/IV(4,n=Math.ceil(r/3))).toString():(n=16,a="2.3283064365386962890625e-10");e.precision+=n,t=DV(e,1,t.times(a),new e(1));for(var i=n;i--;){var o=t.times(t);t=o.times(o).minus(o).times(8).plus(1)}return e.precision-=n,t}(r,AV(r,n)),r.precision=e,r.rounding=t,dV(2==LW||3==LW?n.neg():n,e,t,!0)):new r(1):new r(NaN)},sV.cubeRoot=sV.cbrt=function(){var e,t,n,r,a,i,o,s,u,c,l=this,p=l.constructor;if(!l.isFinite()||l.isZero())return new p(l);for(HW=!1,(i=l.s*JW(l.s*l,1/3))&&Math.abs(i)!=1/0?r=new p(i.toString()):(n=uV(l.d),(i=((e=l.e)-n.length+1)%3)&&(n+=1==i||-2==i?"0":"00"),i=JW(n,1/3),e=QW((e+1)/3)-(e%3==(e<0?-1:2)),(r=new p(n=i==1/0?"5e"+e:(n=i.toExponential()).slice(0,n.indexOf("e")+1)+e)).s=l.s),o=(e=p.precision)+3;;)if(c=(u=(s=r).times(s).times(s)).plus(l),r=hV(c.plus(l).times(s),c.plus(u),o+2,1),uV(s.d).slice(0,o)===(n=uV(r.d)).slice(0,o)){if("9999"!=(n=n.slice(o-3,o+1))&&(a||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(dV(r,e+1,1),t=!r.times(r).times(r).eq(l));break}if(!a&&(dV(s,e+1,0),s.times(s).times(s).eq(l))){r=s;break}o+=4,a=1}return HW=!0,dV(r,e,p.rounding,t)},sV.decimalPlaces=sV.dp=function(){var e,t=this.d,n=NaN;if(t){if(n=7*((e=t.length-1)-QW(this.e/7)),e=t[e])for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n},sV.dividedBy=sV.div=function(e){return hV(this,new this.constructor(e))},sV.dividedToIntegerBy=sV.divToInt=function(e){var t=this.constructor;return dV(hV(this,new t(e),0,1,1),t.precision,t.rounding)},sV.equals=sV.eq=function(e){return 0===this.cmp(e)},sV.floor=function(){return dV(new this.constructor(this),this.e+1,3)},sV.greaterThan=sV.gt=function(e){return this.cmp(e)>0},sV.greaterThanOrEqualTo=sV.gte=function(e){var t=this.cmp(e);return 1==t||0===t},sV.hyperbolicCosine=sV.cosh=function(){var e,t,n,r,a,i=this,o=i.constructor,s=new o(1);if(!i.isFinite())return new o(i.s?1/0:NaN);if(i.isZero())return s;n=o.precision,r=o.rounding,o.precision=n+Math.max(i.e,i.sd())+4,o.rounding=1,(a=i.d.length)<32?t=(1/IV(4,e=Math.ceil(a/3))).toString():(e=16,t="2.3283064365386962890625e-10"),i=DV(o,1,i.times(t),new o(1),!0);for(var u,c=e,l=new o(8);c--;)u=i.times(i),i=s.minus(u.times(l.minus(u.times(l))));return dV(i,o.precision=n,o.rounding=r,!0)},sV.hyperbolicSine=sV.sinh=function(){var e,t,n,r,a=this,i=a.constructor;if(!a.isFinite()||a.isZero())return new i(a);if(t=i.precision,n=i.rounding,i.precision=t+Math.max(a.e,a.sd())+4,i.rounding=1,(r=a.d.length)<3)a=DV(i,2,a,a,!0);else{e=(e=1.4*Math.sqrt(r))>16?16:0|e,a=DV(i,2,a=a.times(1/IV(5,e)),a,!0);for(var o,s=new i(5),u=new i(16),c=new i(20);e--;)o=a.times(a),a=a.times(s.plus(o.times(u.times(o).plus(c))))}return i.precision=t,i.rounding=n,dV(a,t,n,!0)},sV.hyperbolicTangent=sV.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,hV(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)},sV.inverseCosine=sV.acos=function(){var e=this,t=e.constructor,n=e.abs().cmp(1),r=t.precision,a=t.rounding;return-1!==n?0===n?e.isNeg()?yV(t,r,a):new t(0):new t(NaN):e.isZero()?yV(t,r+4,a).times(.5):(t.precision=r+6,t.rounding=1,e=new t(1).minus(e).div(e.plus(1)).sqrt().atan(),t.precision=r,t.rounding=a,e.times(2))},sV.inverseHyperbolicCosine=sV.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,HW=!1,n=n.times(n).minus(1).sqrt().plus(n),HW=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)},sV.inverseHyperbolicSine=sV.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,HW=!1,n=n.times(n).plus(1).sqrt().plus(n),HW=!0,r.precision=e,r.rounding=t,n.ln())},sV.inverseHyperbolicTangent=sV.atanh=function(){var e,t,n,r,a=this,i=a.constructor;return a.isFinite()?a.e>=0?new i(a.abs().eq(1)?a.s/0:a.isZero()?a:NaN):(e=i.precision,t=i.rounding,r=a.sd(),Math.max(r,e)<2*-a.e-1?dV(new i(a),e,t,!0):(i.precision=n=r-a.e,a=hV(a.plus(1),new i(1).minus(a),n+e,1),i.precision=e+4,i.rounding=1,a=a.ln(),i.precision=e,i.rounding=t,a.times(.5))):new i(NaN)},sV.inverseSine=sV.asin=function(){var e,t,n,r,a=this,i=a.constructor;return a.isZero()?new i(a):(t=a.abs().cmp(1),n=i.precision,r=i.rounding,-1!==t?0===t?((e=yV(i,n+4,r).times(.5)).s=a.s,e):new i(NaN):(i.precision=n+6,i.rounding=1,a=a.div(new i(1).minus(a.times(a)).sqrt().plus(1)).atan(),i.precision=n,i.rounding=r,a.times(2)))},sV.inverseTangent=sV.atan=function(){var e,t,n,r,a,i,o,s,u,c=this,l=c.constructor,p=l.precision,h=l.rounding;if(c.isFinite()){if(c.isZero())return new l(c);if(c.abs().eq(1)&&p+4<=oV)return(o=yV(l,p+4,h).times(.25)).s=c.s,o}else{if(!c.s)return new l(NaN);if(p+4<=oV)return(o=yV(l,p+4,h).times(.5)).s=c.s,o}for(l.precision=s=p+10,l.rounding=1,e=n=Math.min(28,s/7+2|0);e;--e)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(HW=!1,t=Math.ceil(s/7),r=1,u=c.times(c),o=new l(c),a=c;-1!==e;)if(a=a.times(u),i=o.minus(a.div(r+=2)),a=a.times(u),void 0!==(o=i.plus(a.div(r+=2))).d[t])for(e=t;o.d[e]===i.d[e]&&e--;);return n&&(o=o.times(2<<n-1)),HW=!0,dV(o,l.precision=p,l.rounding=h,!0)},sV.isFinite=function(){return!!this.d},sV.isInteger=sV.isInt=function(){return!!this.d&&QW(this.e/7)>this.d.length-2},sV.isNaN=function(){return!this.s},sV.isNegative=sV.isNeg=function(){return this.s<0},sV.isPositive=sV.isPos=function(){return this.s>0},sV.isZero=function(){return!!this.d&&0===this.d[0]},sV.lessThan=sV.lt=function(e){return this.cmp(e)<0},sV.lessThanOrEqualTo=sV.lte=function(e){return this.cmp(e)<1},sV.logarithm=sV.log=function(e){var t,n,r,a,i,o,s,u,c=this,l=c.constructor,p=l.precision,h=l.rounding;if(null==e)e=new l(10),t=!0;else{if(n=(e=new l(e)).d,e.s<0||!n||!n[0]||e.eq(1))return new l(NaN);t=e.eq(10)}if(n=c.d,c.s<0||!n||!n[0]||c.eq(1))return new l(n&&!n[0]?-1/0:1!=c.s?NaN:n?0:1/0);if(t)if(n.length>1)i=!0;else{for(a=n[0];a%10===0;)a/=10;i=1!==a}if(HW=!1,o=kV(c,s=p+5),r=t?gV(l,s+10):kV(e,s),lV((u=hV(o,r,s,1)).d,a=p,h))do{if(o=kV(c,s+=10),r=t?gV(l,s+10):kV(e,s),u=hV(o,r,s,1),!i){+uV(u.d).slice(a+1,a+15)+1==1e14&&(u=dV(u,p+1,0));break}}while(lV(u.d,a+=10,h));return HW=!0,dV(u,p,h)},sV.minus=sV.sub=function(e){var t,n,r,a,i,o,s,u,c,l,p,h,d=this,f=d.constructor;if(e=new f(e),!d.d||!e.d)return d.s&&e.s?d.d?e.s=-e.s:e=new f(e.d||d.s!==e.s?d:NaN):e=new f(NaN),e;if(d.s!=e.s)return e.s=-e.s,d.plus(e);if(c=d.d,h=e.d,s=f.precision,u=f.rounding,!c[0]||!h[0]){if(h[0])e.s=-e.s;else{if(!c[0])return new f(3===u?-0:0);e=new f(d)}return HW?dV(e,s,u):e}if(n=QW(e.e/7),l=QW(d.e/7),c=c.slice(),i=l-n){for((p=i<0)?(t=c,i=-i,o=h.length):(t=h,n=l,o=c.length),i>(r=Math.max(Math.ceil(s/7),o)+2)&&(i=r,t.length=1),t.reverse(),r=i;r--;)t.push(0);t.reverse()}else{for((p=(r=c.length)<(o=h.length))&&(o=r),r=0;r<o;r++)if(c[r]!=h[r]){p=c[r]<h[r];break}i=0}for(p&&(t=c,c=h,h=t,e.s=-e.s),o=c.length,r=h.length-o;r>0;--r)c[o++]=0;for(r=h.length;r>i;){if(c[--r]<h[r]){for(a=r;a&&0===c[--a];)c[a]=aV-1;--c[a],c[r]+=aV}c[r]-=h[r]}for(;0===c[--o];)c.pop();for(;0===c[0];c.shift())--n;return c[0]?(e.d=c,e.e=mV(c,n),HW?dV(e,s,u):e):new f(3===u?-0:0)},sV.modulo=sV.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?dV(new r(n),r.precision,r.rounding):(HW=!1,9==r.modulo?(t=hV(n,e.abs(),0,3,1)).s*=e.s:t=hV(n,e,0,r.modulo,1),t=t.times(e),HW=!0,n.minus(t))},sV.naturalExponential=sV.exp=function(){return SV(this)},sV.naturalLogarithm=sV.ln=function(){return kV(this)},sV.negated=sV.neg=function(){var e=new this.constructor(this);return e.s=-e.s,dV(e)},sV.plus=sV.add=function(e){var t,n,r,a,i,o,s,u,c,l,p=this,h=p.constructor;if(e=new h(e),!p.d||!e.d)return p.s&&e.s?p.d||(e=new h(e.d||p.s===e.s?p:NaN)):e=new h(NaN),e;if(p.s!=e.s)return e.s=-e.s,p.minus(e);if(c=p.d,l=e.d,s=h.precision,u=h.rounding,!c[0]||!l[0])return l[0]||(e=new h(p)),HW?dV(e,s,u):e;if(i=QW(p.e/7),r=QW(e.e/7),c=c.slice(),a=i-r){for(a<0?(n=c,a=-a,o=l.length):(n=l,r=i,o=c.length),a>(o=(i=Math.ceil(s/7))>o?i+1:o+1)&&(a=o,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for((o=c.length)-(a=l.length)<0&&(a=o,n=l,l=c,c=n),t=0;a;)t=(c[--a]=c[a]+l[a]+t)/aV|0,c[a]%=aV;for(t&&(c.unshift(t),++r),o=c.length;0==c[--o];)c.pop();return e.d=c,e.e=mV(c,r),HW?dV(e,s,u):e},sV.precision=sV.sd=function(e){var t,n=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(XW+e);return n.d?(t=vV(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t},sV.round=function(){var e=this,t=e.constructor;return dV(new t(e),e.e+1,t.rounding)},sV.sine=sV.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+7,r.rounding=1,n=function(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:DV(e,2,t,t);n=(n=1.4*Math.sqrt(r))>16?16:0|n,t=t.times(1/IV(5,n)),t=DV(e,2,t,t);for(var a,i=new e(5),o=new e(16),s=new e(20);n--;)a=t.times(t),t=t.times(i.plus(a.times(o.times(a).minus(s))));return t}(r,AV(r,n)),r.precision=e,r.rounding=t,dV(LW>2?n.neg():n,e,t,!0)):new r(NaN)},sV.squareRoot=sV.sqrt=function(){var e,t,n,r,a,i,o=this,s=o.d,u=o.e,c=o.s,l=o.constructor;if(1!==c||!s||!s[0])return new l(!c||c<0&&(!s||s[0])?NaN:s?o:1/0);for(HW=!1,0==(c=Math.sqrt(+o))||c==1/0?(((t=uV(s)).length+u)%2==0&&(t+="0"),c=Math.sqrt(t),u=QW((u+1)/2)-(u<0||u%2),r=new l(t=c==1/0?"5e"+u:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+u)):r=new l(c.toString()),n=(u=l.precision)+3;;)if(r=(i=r).plus(hV(o,i,n+2,1)).times(.5),uV(i.d).slice(0,n)===(t=uV(r.d)).slice(0,n)){if("9999"!=(t=t.slice(n-3,n+1))&&(a||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(dV(r,u+1,1),e=!r.times(r).eq(o));break}if(!a&&(dV(i,u+1,0),i.times(i).eq(o))){r=i;break}n+=4,a=1}return HW=!0,dV(r,u,l.rounding,e)},sV.tangent=sV.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,(n=n.sin()).s=1,n=hV(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,dV(2==LW||4==LW?n.neg():n,e,t,!0)):new r(NaN)},sV.times=sV.mul=function(e){var t,n,r,a,i,o,s,u,c,l=this,p=l.constructor,h=l.d,d=(e=new p(e)).d;if(e.s*=l.s,!h||!h[0]||!d||!d[0])return new p(!e.s||h&&!h[0]&&!d||d&&!d[0]&&!h?NaN:h&&d?0*e.s:e.s/0);for(n=QW(l.e/7)+QW(e.e/7),(u=h.length)<(c=d.length)&&(i=h,h=d,d=i,o=u,u=c,c=o),i=[],r=o=u+c;r--;)i.push(0);for(r=c;--r>=0;){for(t=0,a=u+r;a>r;)s=i[a]+d[r]*h[a-r-1]+t,i[a--]=s%aV|0,t=s/aV|0;i[a]=(i[a]+t)%aV|0}for(;!i[--o];)i.pop();return t?++n:i.shift(),e.d=i,e.e=mV(i,n),HW?dV(e,p.precision,p.rounding):e},sV.toBinary=function(e,t){return FV(this,2,e,t)},sV.toDecimalPlaces=sV.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(cV(e,0,WW),void 0===t?t=r.rounding:cV(t,0,8),dV(n,e+n.e+1,t))},sV.toExponential=function(e,t){var n,r=this,a=r.constructor;return void 0===e?n=fV(r,!0):(cV(e,0,WW),void 0===t?t=a.rounding:cV(t,0,8),n=fV(r=dV(new a(r),e+1,t),!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n},sV.toFixed=function(e,t){var n,r,a=this,i=a.constructor;return void 0===e?n=fV(a):(cV(e,0,WW),void 0===t?t=i.rounding:cV(t,0,8),n=fV(r=dV(new i(a),e+a.e+1,t),!1,e+r.e+1)),a.isNeg()&&!a.isZero()?"-"+n:n},sV.toFraction=function(e){var t,n,r,a,i,o,s,u,c,l,p,h,d=this,f=d.d,m=d.constructor;if(!f)return new m(d);if(c=n=new m(1),r=u=new m(0),o=(i=(t=new m(r)).e=vV(f)-d.e-1)%7,t.d[0]=JW(10,o<0?7+o:o),null==e)e=i>0?t:c;else{if(!(s=new m(e)).isInt()||s.lt(c))throw Error(XW+s);e=s.gt(t)?i>0?t:c:s}for(HW=!1,s=new m(uV(f)),l=m.precision,m.precision=i=7*f.length*2;p=hV(s,t,0,1,1),1!=(a=n.plus(p.times(r))).cmp(e);)n=r,r=a,a=c,c=u.plus(p.times(a)),u=a,a=t,t=s.minus(p.times(a)),s=a;return a=hV(e.minus(n),r,0,1,1),u=u.plus(a.times(c)),n=n.plus(a.times(r)),u.s=c.s=d.s,h=hV(c,r,i,1).minus(d).abs().cmp(hV(u,n,i,1).minus(d).abs())<1?[c,r]:[u,n],m.precision=l,HW=!0,h},sV.toHexadecimal=sV.toHex=function(e,t){return FV(this,16,e,t)},sV.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),null==e){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),void 0===t?t=r.rounding:cV(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(HW=!1,n=hV(n,e,0,t,1).times(e),HW=!0,dV(n)):(e.s=n.s,n=e),n},sV.toNumber=function(){return+this},sV.toOctal=function(e,t){return FV(this,8,e,t)},sV.toPower=sV.pow=function(e){var t,n,r,a,i,o,s=this,u=s.constructor,c=+(e=new u(e));if(!s.d||!e.d||!s.d[0]||!e.d[0])return new u(JW(+s,c));if((s=new u(s)).eq(1))return s;if(r=u.precision,i=u.rounding,e.eq(1))return dV(s,r,i);if((t=QW(e.e/7))>=e.d.length-1&&(n=c<0?-c:c)<=9007199254740991)return a=xV(u,s,n,r),e.s<0?new u(1).div(a):dV(a,r,i);if((o=s.s)<0){if(t<e.d.length-1)return new u(NaN);if(0==(1&e.d[t])&&(o=1),0==s.e&&1==s.d[0]&&1==s.d.length)return s.s=o,s}return(t=0!=(n=JW(+s,c))&&isFinite(n)?new u(n+"").e:QW(c*(Math.log("0."+uV(s.d))/Math.LN10+s.e+1)))>u.maxE+1||t<u.minE-1?new u(t>0?o/0:0):(HW=!1,u.rounding=s.s=1,n=Math.min(12,(t+"").length),(a=SV(e.times(kV(s,r+n)),r)).d&&lV((a=dV(a,r+5,1)).d,r,i)&&(t=r+10,+uV((a=dV(SV(e.times(kV(s,t+n)),t),t+5,1)).d).slice(r+1,r+15)+1==1e14&&(a=dV(a,r+1,0))),a.s=o,HW=!0,u.rounding=i,dV(a,r,i))},sV.toPrecision=function(e,t){var n,r=this,a=r.constructor;return void 0===e?n=fV(r,r.e<=a.toExpNeg||r.e>=a.toExpPos):(cV(e,1,WW),void 0===t?t=a.rounding:cV(t,0,8),n=fV(r=dV(new a(r),e,t),e<=r.e||r.e<=a.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n},sV.toSignificantDigits=sV.toSD=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(cV(e,1,WW),void 0===t?t=n.rounding:cV(t,0,8)),dV(new n(this),e,t)},sV.toString=function(){var e=this,t=e.constructor,n=fV(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n},sV.truncated=sV.trunc=function(){return dV(new this.constructor(this),this.e+1,1)},sV.valueOf=sV.toJSON=function(){var e=this,t=e.constructor,n=fV(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};var hV=function(){function e(e,t,n){var r,a=0,i=e.length;for(e=e.slice();i--;)r=e[i]*t+a,e[i]=r%n|0,a=r/n|0;return a&&e.unshift(a),e}function t(e,t,n,r){var a,i;if(n!=r)i=n>r?1:-1;else for(a=i=0;a<n;a++)if(e[a]!=t[a]){i=e[a]>t[a]?1:-1;break}return i}function n(e,t,n,r){for(var a=0;n--;)e[n]-=a,a=e[n]<t[n]?1:0,e[n]=a*r+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,a,i,o,s,u){var c,l,p,h,d,f,m,g,y,v,b,x,w,N,S,k,E,C,T,D,I=r.constructor,A=r.s==a.s?1:-1,F=r.d,_=a.d;if(!F||!F[0]||!_||!_[0])return new I(r.s&&a.s&&(F?!_||F[0]!=_[0]:_)?F&&0==F[0]||!_?0*A:A/0:NaN);for(u?(d=1,l=r.e-a.e):(u=aV,d=7,l=QW(r.e/d)-QW(a.e/d)),T=_.length,E=F.length,v=(y=new I(A)).d=[],p=0;_[p]==(F[p]||0);p++);if(_[p]>(F[p]||0)&&l--,null==i?(N=i=I.precision,o=I.rounding):N=s?i+(r.e-a.e)+1:i,N<0)v.push(1),f=!0;else{if(N=N/d+2|0,p=0,1==T){for(h=0,_=_[0],N++;(p<E||h)&&N--;p++)S=h*u+(F[p]||0),v[p]=S/_|0,h=S%_|0;f=h||p<E}else{for((h=u/(_[0]+1)|0)>1&&(_=e(_,h,u),F=e(F,h,u),T=_.length,E=F.length),k=T,x=(b=F.slice(0,T)).length;x<T;)b[x++]=0;(D=_.slice()).unshift(0),C=_[0],_[1]>=u/2&&++C;do{h=0,(c=t(_,b,T,x))<0?(w=b[0],T!=x&&(w=w*u+(b[1]||0)),(h=w/C|0)>1?(h>=u&&(h=u-1),1==(c=t(m=e(_,h,u),b,g=m.length,x=b.length))&&(h--,n(m,T<g?D:_,g,u))):(0==h&&(c=h=1),m=_.slice()),(g=m.length)<x&&m.unshift(0),n(b,m,x,u),-1==c&&(c=t(_,b,T,x=b.length))<1&&(h++,n(b,T<x?D:_,x,u)),x=b.length):0===c&&(h++,b=[0]),v[p++]=h,c&&b[0]?b[x++]=F[k]||0:(b=[F[k]],x=1)}while((k++<E||void 0!==b[0])&&N--);f=void 0!==b[0]}v[0]||v.shift()}if(1==d)y.e=l,BW=f;else{for(p=1,h=v[0];h>=10;h/=10)p++;y.e=p+l*d-1,dV(y,s?i+y.e+1:i,o,f)}return y}}();function dV(e,t,n,r){var a,i,o,s,u,c,l,p,h,d=e.constructor;e:if(null!=t){if(!(p=e.d))return e;for(a=1,s=p[0];s>=10;s/=10)a++;if((i=t-a)<0)i+=7,o=t,u=(l=p[h=0])/JW(10,a-o-1)%10|0;else if((h=Math.ceil((i+1)/7))>=(s=p.length)){if(!r)break e;for(;s++<=h;)p.push(0);l=u=0,a=1,o=(i%=7)-7+1}else{for(l=s=p[h],a=1;s>=10;s/=10)a++;u=(o=(i%=7)-7+a)<0?0:l/JW(10,a-o-1)%10|0}if(r=r||t<0||void 0!==p[h+1]||(o<0?l:l%JW(10,a-o-1)),c=n<4?(u||r)&&(0==n||n==(e.s<0?3:2)):u>5||5==u&&(4==n||r||6==n&&(i>0?o>0?l/JW(10,a-o):0:p[h-1])%10&1||n==(e.s<0?8:7)),t<1||!p[0])return p.length=0,c?(t-=e.e+1,p[0]=JW(10,(7-t%7)%7),e.e=-t||0):p[0]=e.e=0,e;if(0==i?(p.length=h,s=1,h--):(p.length=h+1,s=JW(10,7-i),p[h]=o>0?(l/JW(10,a-o)%JW(10,o)|0)*s:0),c)for(;;){if(0==h){for(i=1,o=p[0];o>=10;o/=10)i++;for(o=p[0]+=s,s=1;o>=10;o/=10)s++;i!=s&&(e.e++,p[0]==aV&&(p[0]=1));break}if(p[h]+=s,p[h]!=aV)break;p[h--]=0,s=1}for(i=p.length;0===p[--i];)p.pop()}return HW&&(e.e>d.maxE?(e.d=null,e.e=NaN):e.e<d.minE&&(e.e=0,e.d=[0])),e}function fV(e,t,n){if(!e.isFinite())return EV(e);var r,a=e.e,i=uV(e.d),o=i.length;return t?(n&&(r=n-o)>0?i=i.charAt(0)+"."+i.slice(1)+bV(r):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(e.e<0?"e":"e+")+e.e):a<0?(i="0."+bV(-a-1)+i,n&&(r=n-o)>0&&(i+=bV(r))):a>=o?(i+=bV(a+1-o),n&&(r=n-a-1)>0&&(i=i+"."+bV(r))):((r=a+1)<o&&(i=i.slice(0,r)+"."+i.slice(r)),n&&(r=n-o)>0&&(a+1===o&&(i+="."),i+=bV(r))),i}function mV(e,t){var n=e[0];for(t*=7;n>=10;n/=10)t++;return t}function gV(e,t,n){if(t>iV)throw HW=!0,n&&(e.precision=n),Error(YW);return dV(new e(qW),t,1,!0)}function yV(e,t,n){if(t>oV)throw Error(YW);return dV(new e(jW),t,n,!0)}function vV(e){var t=e.length-1,n=7*t+1;if(t=e[t]){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function bV(e){for(var t="";e--;)t+="0";return t}function xV(e,t,n,r){var a,i=new e(1),o=Math.ceil(r/7+4);for(HW=!1;;){if(n%2&&_V((i=i.times(t)).d,o)&&(a=!0),0===(n=QW(n/2))){n=i.d.length-1,a&&0===i.d[n]&&++i.d[n];break}_V((t=t.times(t)).d,o)}return HW=!0,i}function wV(e){return 1&e.d[e.d.length-1]}function NV(e,t,n){for(var r,a,i=new e(t[0]),o=0;++o<t.length;){if(!(a=new e(t[o])).s){i=a;break}((r=i.cmp(a))===n||0===r&&i.s===n)&&(i=a)}return i}function SV(e,t){var n,r,a,i,o,s,u,c=0,l=0,p=0,h=e.constructor,d=h.rounding,f=h.precision;if(!e.d||!e.d[0]||e.e>17)return new h(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(HW=!1,u=f):u=t,s=new h(.03125);e.e>-2;)e=e.times(s),p+=5;for(u+=r=Math.log(JW(2,p))/Math.LN10*2+5|0,n=i=o=new h(1),h.precision=u;;){if(i=dV(i.times(e),u,1),n=n.times(++l),uV((s=o.plus(hV(i,n,u,1))).d).slice(0,u)===uV(o.d).slice(0,u)){for(a=p;a--;)o=dV(o.times(o),u,1);if(null!=t)return h.precision=f,o;if(!(c<3&&lV(o.d,u-r,d,c)))return dV(o,h.precision=f,d,HW=!0);h.precision=u+=10,n=i=s=new h(1),l=0,c++}o=s}}function kV(e,t){var n,r,a,i,o,s,u,c,l,p,h,d=1,f=e,m=f.d,g=f.constructor,y=g.rounding,v=g.precision;if(f.s<0||!m||!m[0]||!f.e&&1==m[0]&&1==m.length)return new g(m&&!m[0]?-1/0:1!=f.s?NaN:m?0:f);if(null==t?(HW=!1,l=v):l=t,g.precision=l+=10,r=(n=uV(m)).charAt(0),!(Math.abs(i=f.e)<15e14))return c=gV(g,l+2,v).times(i+""),f=kV(new g(r+"."+n.slice(1)),l-10).plus(c),g.precision=v,null==t?dV(f,v,y,HW=!0):f;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=uV((f=f.times(e)).d)).charAt(0),d++;for(i=f.e,r>1?(f=new g("0."+n),i++):f=new g(r+"."+n.slice(1)),p=f,u=o=f=hV(f.minus(1),f.plus(1),l,1),h=dV(f.times(f),l,1),a=3;;){if(o=dV(o.times(h),l,1),uV((c=u.plus(hV(o,new g(a),l,1))).d).slice(0,l)===uV(u.d).slice(0,l)){if(u=u.times(2),0!==i&&(u=u.plus(gV(g,l+2,v).times(i+""))),u=hV(u,new g(d),l,1),null!=t)return g.precision=v,u;if(!lV(u.d,l-10,y,s))return dV(u,g.precision=v,y,HW=!0);g.precision=l+=10,c=o=f=hV(p.minus(1),p.plus(1),l,1),h=dV(f.times(f),l,1),a=s=1}u=c,a+=2}}function EV(e){return String(e.s*e.s/0)}function CV(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);r++);for(a=t.length;48===t.charCodeAt(a-1);--a);if(t=t.slice(r,a)){if(a-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%7,n<0&&(r+=7),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=7;r<a;)e.d.push(+t.slice(r,r+=7));r=7-(t=t.slice(r)).length}else r-=a;for(;r--;)t+="0";e.d.push(+t),HW&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function TV(e,t){var n,r,a,i,o,s,u,c,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),rV.test(t))return CV(e,t)}else if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(tV.test(t))n=16,t=t.toLowerCase();else if(eV.test(t))n=2;else{if(!nV.test(t))throw Error(XW+t);n=8}for((i=t.search(/p/i))>0?(u=+t.slice(i+1),t=t.substring(2,i)):t=t.slice(2),o=(i=t.indexOf("."))>=0,r=e.constructor,o&&(i=(s=(t=t.replace(".","")).length)-i,a=xV(r,new r(n),i,2*i)),i=l=(c=pV(t,n,aV)).length-1;0===c[i];--i)c.pop();return i<0?new r(0*e.s):(e.e=mV(c,l),e.d=c,HW=!1,o&&(e=hV(e,a,4*s)),u&&(e=e.times(Math.abs(u)<54?JW(2,u):bq.pow(2,u))),HW=!0,e)}function DV(e,t,n,r,a){var i,o,s,u,c=e.precision,l=Math.ceil(c/7);for(HW=!1,u=n.times(n),s=new e(r);;){if(o=hV(s.times(u),new e(t++*t++),c,1),s=a?r.plus(o):r.minus(o),r=hV(o.times(u),new e(t++*t++),c,1),void 0!==(o=s.plus(r)).d[l]){for(i=l;o.d[i]===s.d[i]&&i--;);if(-1==i)break}i=s,s=r,r=o,o=i}return HW=!0,o.d.length=l+1,o}function IV(e,t){for(var n=e;--t;)n*=e;return n}function AV(e,t){var n,r=t.s<0,a=yV(e,e.precision,1),i=a.times(.5);if((t=t.abs()).lte(i))return LW=r?4:1,t;if((n=t.divToInt(a)).isZero())LW=r?3:2;else{if((t=t.minus(n.times(a))).lte(i))return LW=wV(n)?r?2:3:r?4:1,t;LW=wV(n)?r?1:4:r?3:2}return t.minus(a).abs()}function FV(e,t,n,r){var a,i,o,s,u,c,l,p,h,d=e.constructor,f=void 0!==n;if(f?(cV(n,1,WW),void 0===r?r=d.rounding:cV(r,0,8)):(n=d.precision,r=d.rounding),e.isFinite()){for(f?(a=2,16==t?n=4*n-3:8==t&&(n=3*n-2)):a=t,(o=(l=fV(e)).indexOf("."))>=0&&(l=l.replace(".",""),(h=new d(1)).e=l.length-o,h.d=pV(fV(h),10,a),h.e=h.d.length),i=u=(p=pV(l,10,a)).length;0==p[--u];)p.pop();if(p[0]){if(o<0?i--:((e=new d(e)).d=p,e.e=i,p=(e=hV(e,h,n,r,0,a)).d,i=e.e,c=BW),o=p[n],s=a/2,c=c||void 0!==p[n+1],c=r<4?(void 0!==o||c)&&(0===r||r===(e.s<0?3:2)):o>s||o===s&&(4===r||c||6===r&&1&p[n-1]||r===(e.s<0?8:7)),p.length=n,c)for(;++p[--n]>a-1;)p[n]=0,n||(++i,p.unshift(1));for(u=p.length;!p[u-1];--u);for(o=0,l="";o<u;o++)l+=VW.charAt(p[o]);if(f){if(u>1)if(16==t||8==t){for(o=16==t?4:3,--u;u%o;u++)l+="0";for(u=(p=pV(l,a,t)).length;!p[u-1];--u);for(o=1,l="1.";o<u;o++)l+=VW.charAt(p[o])}else l=l.charAt(0)+"."+l.slice(1);l=l+(i<0?"p":"p+")+i}else if(i<0){for(;++i;)l="0"+l;l="0."+l}else if(++i>u)for(i-=u;i--;)l+="0";else i<u&&(l=l.slice(0,i)+"."+l.slice(i))}else l=f?"0p+0":"0";l=(16==t?"0x":2==t?"0b":8==t?"0o":"")+l}else l=EV(e);return e.s<0?"-"+l:l}function _V(e,t){if(e.length>t)return e.length=t,!0}function MV(e){return new this(e).abs()}function OV(e){return new this(e).acos()}function RV(e){return new this(e).acosh()}function zV(e,t){return new this(e).plus(t)}function BV(e){return new this(e).asin()}function LV(e){return new this(e).asinh()}function PV(e){return new this(e).atan()}function UV(e){return new this(e).atanh()}function WV(e,t){e=new this(e),t=new this(t);var n,r=this.precision,a=this.rounding,i=r+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(n=t.s<0?yV(this,r,a):new this(0)).s=e.s:!e.d||t.isZero()?(n=yV(this,i,1).times(.5)).s=e.s:t.s<0?(this.precision=i,this.rounding=1,n=this.atan(hV(e,t,i,1)),t=yV(this,i,1),this.precision=r,this.rounding=a,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(hV(e,t,i,1)):(n=yV(this,i,1).times(t.s>0?.25:.75)).s=e.s:n=new this(NaN),n}function VV(e){return new this(e).cbrt()}function qV(e){return dV(e=new this(e),e.e+1,2)}function jV(e,t,n){return new this(e).clamp(t,n)}function GV(e){if(!e||"object"!==typeof e)throw Error(KW+"Object expected");var t,n,r,a=!0===e.defaults,i=["precision",1,WW,"rounding",0,8,"toExpNeg",-UW,0,"toExpPos",0,UW,"maxE",0,UW,"minE",-UW,0,"modulo",0,9];for(t=0;t<i.length;t+=3)if(n=i[t],a&&(this[n]=GW[n]),void 0!==(r=e[n])){if(!(QW(r)===r&&r>=i[t+1]&&r<=i[t+2]))throw Error(XW+n+": "+r);this[n]=r}if(n="crypto",a&&(this[n]=GW[n]),void 0!==(r=e[n])){if(!0!==r&&!1!==r&&0!==r&&1!==r)throw Error(XW+n+": "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error($W);this[n]=!0}else this[n]=!1}return this}function HV(e){return new this(e).cos()}function KV(e){return new this(e).cosh()}function XV(e,t){return new this(e).div(t)}function YV(e){return new this(e).exp()}function $V(e){return dV(e=new this(e),e.e+1,3)}function ZV(){var e,t,n=new this(0);for(HW=!1,e=0;e<arguments.length;)if((t=new this(arguments[e++])).d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return HW=!0,new this(1/0);n=t}return HW=!0,n.sqrt()}function QV(e){return e instanceof bq||e&&e.toStringTag===ZW||!1}function JV(e){return new this(e).ln()}function eq(e,t){return new this(e).log(t)}function tq(e){return new this(e).log(2)}function nq(e){return new this(e).log(10)}function rq(){return NV(this,arguments,-1)}function aq(){return NV(this,arguments,1)}function iq(e,t){return new this(e).mod(t)}function oq(e,t){return new this(e).mul(t)}function sq(e,t){return new this(e).pow(t)}function uq(e){var t,n,r,a,i=0,o=new this(1),s=[];if(void 0===e?e=this.precision:cV(e,1,WW),r=Math.ceil(e/7),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));i<r;)(a=t[i])>=429e7?t[i]=crypto.getRandomValues(new Uint32Array(1))[0]:s[i++]=a%1e7;else{if(!crypto.randomBytes)throw Error($W);for(t=crypto.randomBytes(r*=4);i<r;)(a=t[i]+(t[i+1]<<8)+(t[i+2]<<16)+((127&t[i+3])<<24))>=214e7?crypto.randomBytes(4).copy(t,i):(s.push(a%1e7),i+=4);i=r/4}else for(;i<r;)s[i++]=1e7*Math.random()|0;for(e%=7,(r=s[--i])&&e&&(a=JW(10,7-e),s[i]=(r/a|0)*a);0===s[i];i--)s.pop();if(i<0)n=0,s=[0];else{for(n=-1;0===s[0];n-=7)s.shift();for(r=1,a=s[0];a>=10;a/=10)r++;r<7&&(n-=7-r)}return o.e=n,o.d=s,o}function cq(e){return dV(e=new this(e),e.e+1,this.rounding)}function lq(e){return(e=new this(e)).d?e.d[0]?e.s:0*e.s:e.s||NaN}function pq(e){return new this(e).sin()}function hq(e){return new this(e).sinh()}function dq(e){return new this(e).sqrt()}function fq(e,t){return new this(e).sub(t)}function mq(){var e=0,t=arguments,n=new this(t[e]);for(HW=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return HW=!0,dV(n,this.precision,this.rounding)}function gq(e){return new this(e).tan()}function yq(e){return new this(e).tanh()}function vq(e){return dV(e=new this(e),e.e+1,1)}sV[Symbol.for("nodejs.util.inspect.custom")]=sV.toString,sV[Symbol.toStringTag]="Decimal";var bq=sV.constructor=function e(t){var n,r,a;function i(e){var t,n,r,a=this;if(!(a instanceof i))return new i(e);if(a.constructor=i,QV(e))return a.s=e.s,void(HW?!e.d||e.e>i.maxE?(a.e=NaN,a.d=null):e.e<i.minE?(a.e=0,a.d=[0]):(a.e=e.e,a.d=e.d.slice()):(a.e=e.e,a.d=e.d?e.d.slice():e.d));if("number"===(r=typeof e)){if(0===e)return a.s=1/e<0?-1:1,a.e=0,void(a.d=[0]);if(e<0?(e=-e,a.s=-1):a.s=1,e===~~e&&e<1e7){for(t=0,n=e;n>=10;n/=10)t++;return void(HW?t>i.maxE?(a.e=NaN,a.d=null):t<i.minE?(a.e=0,a.d=[0]):(a.e=t,a.d=[e]):(a.e=t,a.d=[e]))}return 0*e!==0?(e||(a.s=NaN),a.e=NaN,void(a.d=null)):CV(a,e.toString())}if("string"===r)return 45===(n=e.charCodeAt(0))?(e=e.slice(1),a.s=-1):(43===n&&(e=e.slice(1)),a.s=1),rV.test(e)?CV(a,e):TV(a,e);if("bigint"===r)return e<0?(e=-e,a.s=-1):a.s=1,CV(a,e.toString());throw Error(XW+e)}if(i.prototype=sV,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=GV,i.clone=e,i.isDecimal=QV,i.abs=MV,i.acos=OV,i.acosh=RV,i.add=zV,i.asin=BV,i.asinh=LV,i.atan=PV,i.atanh=UV,i.atan2=WV,i.cbrt=VV,i.ceil=qV,i.clamp=jV,i.cos=HV,i.cosh=KV,i.div=XV,i.exp=YV,i.floor=$V,i.hypot=ZV,i.ln=JV,i.log=eq,i.log10=nq,i.log2=tq,i.max=rq,i.min=aq,i.mod=iq,i.mul=oq,i.pow=sq,i.random=uq,i.round=cq,i.sign=lq,i.sin=pq,i.sinh=hq,i.sqrt=dq,i.sub=fq,i.sum=mq,i.tan=gq,i.tanh=yq,i.trunc=vq,void 0===t&&(t={}),t&&!0!==t.defaults)for(a=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],n=0;n<a.length;)t.hasOwnProperty(r=a[n++])||(t[r]=this[r]);return i.config(t),i}(GW);qW=new bq(qW),jW=new bq(jW);const xq=bq;var wq=ZU("BigNumber",["?on","config"],(e=>{var{on:t,config:n}=e,r=xq.clone({precision:n.precision,modulo:xq.EUCLID});return r.prototype=Object.create(r.prototype),r.prototype.type="BigNumber",r.prototype.isBigNumber=!0,r.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},r.fromJSON=function(e){return new r(e.value)},t&&t("config",(function(e,t){e.precision!==t.precision&&r.config({precision:e.precision})})),r}),{isClass:!0});const Nq=Math.cosh||function(e){return Math.abs(e)<1e-9?1-e:.5*(Math.exp(e)+Math.exp(-e))},Sq=Math.sinh||function(e){return Math.abs(e)<1e-9?e:.5*(Math.exp(e)-Math.exp(-e))},kq=function(e,t){return(e=Math.abs(e))<(t=Math.abs(t))&&([e,t]=[t,e]),e<1e8?Math.sqrt(e*e+t*t):(t/=e,e*Math.sqrt(1+t*t))},Eq=function(){throw SyntaxError("Invalid Param")};function Cq(e,t){const n=Math.abs(e),r=Math.abs(t);return 0===e?Math.log(r):0===t?Math.log(n):n<3e3&&r<3e3?.5*Math.log(e*e+t*t):(e*=.5,t*=.5,.5*Math.log(e*e+t*t)+Math.LN2)}const Tq={re:0,im:0},Dq=function(e,t){const n=Tq;if(void 0===e||null===e)n.re=n.im=0;else if(void 0!==t)n.re=e,n.im=t;else switch(typeof e){case"object":if("im"in e&&"re"in e)n.re=e.re,n.im=e.im;else if("abs"in e&&"arg"in e){if(!isFinite(e.abs)&&isFinite(e.arg))return Iq.INFINITY;n.re=e.abs*Math.cos(e.arg),n.im=e.abs*Math.sin(e.arg)}else if("r"in e&&"phi"in e){if(!isFinite(e.r)&&isFinite(e.phi))return Iq.INFINITY;n.re=e.r*Math.cos(e.phi),n.im=e.r*Math.sin(e.phi)}else 2===e.length?(n.re=e[0],n.im=e[1]):Eq();break;case"string":n.im=n.re=0;const t=e.replace(/_/g,"").match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g);let r=1,a=0;null===t&&Eq();for(let e=0;e<t.length;e++){const i=t[e];" "===i||"\t"===i||"\n"===i||("+"===i?r++:"-"===i?a++:"i"===i||"I"===i?(r+a===0&&Eq()," "===t[e+1]||isNaN(t[e+1])?n.im+=parseFloat((a%2?"-":"")+"1"):(n.im+=parseFloat((a%2?"-":"")+t[e+1]),e++),r=a=0):((r+a===0||isNaN(i))&&Eq(),"i"===t[e+1]||"I"===t[e+1]?(n.im+=parseFloat((a%2?"-":"")+i),e++):n.re+=parseFloat((a%2?"-":"")+i),r=a=0))}r+a>0&&Eq();break;case"number":n.im=0,n.re=e;break;default:Eq()}return isNaN(n.re)||isNaN(n.im),n};function Iq(e,t){if(!(this instanceof Iq))return new Iq(e,t);const n=Dq(e,t);this.re=n.re,this.im=n.im}Iq.prototype={re:0,im:0,sign:function(){const e=kq(this.re,this.im);return new Iq(this.re/e,this.im/e)},add:function(e,t){const n=Dq(e,t),r=this.isInfinite(),a=!(isFinite(n.re)&&isFinite(n.im));return r||a?r&&a?Iq.NAN:Iq.INFINITY:new Iq(this.re+n.re,this.im+n.im)},sub:function(e,t){const n=Dq(e,t),r=this.isInfinite(),a=!(isFinite(n.re)&&isFinite(n.im));return r||a?r&&a?Iq.NAN:Iq.INFINITY:new Iq(this.re-n.re,this.im-n.im)},mul:function(e,t){const n=Dq(e,t),r=this.isInfinite(),a=!(isFinite(n.re)&&isFinite(n.im)),i=0===this.re&&0===this.im,o=0===n.re&&0===n.im;return r&&o||a&&i?Iq.NAN:r||a?Iq.INFINITY:0===n.im&&0===this.im?new Iq(this.re*n.re,0):new Iq(this.re*n.re-this.im*n.im,this.re*n.im+this.im*n.re)},div:function(e,t){const n=Dq(e,t),r=this.isInfinite(),a=!(isFinite(n.re)&&isFinite(n.im)),i=0===this.re&&0===this.im,o=0===n.re&&0===n.im;if(i&&o||r&&a)return Iq.NAN;if(o||r)return Iq.INFINITY;if(i||a)return Iq.ZERO;if(0===n.im)return new Iq(this.re/n.re,this.im/n.re);if(Math.abs(n.re)<Math.abs(n.im)){const e=n.re/n.im,t=n.re*e+n.im;return new Iq((this.re*e+this.im)/t,(this.im*e-this.re)/t)}{const e=n.im/n.re,t=n.im*e+n.re;return new Iq((this.re+this.im*e)/t,(this.im-this.re*e)/t)}},pow:function(e,t){const n=Dq(e,t),r=0===this.re&&0===this.im;if(0===n.re&&0===n.im)return Iq.ONE;if(0===n.im){if(0===this.im&&this.re>0)return new Iq(Math.pow(this.re,n.re),0);if(0===this.re)switch((n.re%4+4)%4){case 0:return new Iq(Math.pow(this.im,n.re),0);case 1:return new Iq(0,Math.pow(this.im,n.re));case 2:return new Iq(-Math.pow(this.im,n.re),0);case 3:return new Iq(0,-Math.pow(this.im,n.re))}}if(r&&n.re>0)return Iq.ZERO;const a=Math.atan2(this.im,this.re),i=Cq(this.re,this.im);let o=Math.exp(n.re*i-n.im*a),s=n.im*i+n.re*a;return new Iq(o*Math.cos(s),o*Math.sin(s))},sqrt:function(){const e=this.re,t=this.im;if(0===t)return e>=0?new Iq(Math.sqrt(e),0):new Iq(0,Math.sqrt(-e));const n=kq(e,t);let r=Math.sqrt(.5*(n+Math.abs(e))),a=Math.abs(t)/(2*r);return e>=0?new Iq(r,t<0?-a:a):new Iq(a,t<0?-r:r)},exp:function(){const e=Math.exp(this.re);return 0===this.im?new Iq(e,0):new Iq(e*Math.cos(this.im),e*Math.sin(this.im))},expm1:function(){const e=this.re,t=this.im;return new Iq(Math.expm1(e)*Math.cos(t)+function(e){const t=Math.PI/4;if(-t>e||e>t)return Math.cos(e)-1;const n=e*e;return n*(n*(n*(n*(n*(n*(n*(n/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)}(t),Math.exp(e)*Math.sin(t))},log:function(){const e=this.re,t=this.im;return 0===t&&e>0?new Iq(Math.log(e),0):new Iq(Cq(e,t),Math.atan2(t,e))},abs:function(){return kq(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){const e=this.re,t=this.im;return new Iq(Math.sin(e)*Nq(t),Math.cos(e)*Sq(t))},cos:function(){const e=this.re,t=this.im;return new Iq(Math.cos(e)*Nq(t),-Math.sin(e)*Sq(t))},tan:function(){const e=2*this.re,t=2*this.im,n=Math.cos(e)+Nq(t);return new Iq(Math.sin(e)/n,Sq(t)/n)},cot:function(){const e=2*this.re,t=2*this.im,n=Math.cos(e)-Nq(t);return new Iq(-Math.sin(e)/n,Sq(t)/n)},sec:function(){const e=this.re,t=this.im,n=.5*Nq(2*t)+.5*Math.cos(2*e);return new Iq(Math.cos(e)*Nq(t)/n,Math.sin(e)*Sq(t)/n)},csc:function(){const e=this.re,t=this.im,n=.5*Nq(2*t)-.5*Math.cos(2*e);return new Iq(Math.sin(e)*Nq(t)/n,-Math.cos(e)*Sq(t)/n)},asin:function(){const e=this.re,t=this.im,n=new Iq(t*t-e*e+1,-2*e*t).sqrt(),r=new Iq(n.re-t,n.im+e).log();return new Iq(r.im,-r.re)},acos:function(){const e=this.re,t=this.im,n=new Iq(t*t-e*e+1,-2*e*t).sqrt(),r=new Iq(n.re-t,n.im+e).log();return new Iq(Math.PI/2-r.im,r.re)},atan:function(){const e=this.re,t=this.im;if(0===e){if(1===t)return new Iq(0,1/0);if(-1===t)return new Iq(0,-1/0)}const n=e*e+(1-t)*(1-t),r=new Iq((1-t*t-e*e)/n,-2*e/n).log();return new Iq(-.5*r.im,.5*r.re)},acot:function(){const e=this.re,t=this.im;if(0===t)return new Iq(Math.atan2(1,e),0);const n=e*e+t*t;return 0!==n?new Iq(e/n,-t/n).atan():new Iq(0!==e?e/0:0,0!==t?-t/0:0).atan()},asec:function(){const e=this.re,t=this.im;if(0===e&&0===t)return new Iq(0,1/0);const n=e*e+t*t;return 0!==n?new Iq(e/n,-t/n).acos():new Iq(0!==e?e/0:0,0!==t?-t/0:0).acos()},acsc:function(){const e=this.re,t=this.im;if(0===e&&0===t)return new Iq(Math.PI/2,1/0);const n=e*e+t*t;return 0!==n?new Iq(e/n,-t/n).asin():new Iq(0!==e?e/0:0,0!==t?-t/0:0).asin()},sinh:function(){const e=this.re,t=this.im;return new Iq(Sq(e)*Math.cos(t),Nq(e)*Math.sin(t))},cosh:function(){const e=this.re,t=this.im;return new Iq(Nq(e)*Math.cos(t),Sq(e)*Math.sin(t))},tanh:function(){const e=2*this.re,t=2*this.im,n=Nq(e)+Math.cos(t);return new Iq(Sq(e)/n,Math.sin(t)/n)},coth:function(){const e=2*this.re,t=2*this.im,n=Nq(e)-Math.cos(t);return new Iq(Sq(e)/n,-Math.sin(t)/n)},csch:function(){const e=this.re,t=this.im,n=Math.cos(2*t)-Nq(2*e);return new Iq(-2*Sq(e)*Math.cos(t)/n,2*Nq(e)*Math.sin(t)/n)},sech:function(){const e=this.re,t=this.im,n=Math.cos(2*t)+Nq(2*e);return new Iq(2*Nq(e)*Math.cos(t)/n,-2*Sq(e)*Math.sin(t)/n)},asinh:function(){let e=this.im;this.im=-this.re,this.re=e;const t=this.asin();return this.re=-this.im,this.im=e,e=t.re,t.re=-t.im,t.im=e,t},acosh:function(){const e=this.acos();if(e.im<=0){const t=e.re;e.re=-e.im,e.im=t}else{const t=e.im;e.im=-e.re,e.re=t}return e},atanh:function(){const e=this.re,t=this.im,n=e>1&&0===t,r=1-e,a=1+e,i=r*r+t*t,o=0!==i?new Iq((a*r-t*t)/i,(t*r+a*t)/i):new Iq(-1!==e?e/0:0,0!==t?t/0:0),s=o.re;return o.re=Cq(o.re,o.im)/2,o.im=Math.atan2(o.im,s)/2,n&&(o.im=-o.im),o},acoth:function(){const e=this.re,t=this.im;if(0===e&&0===t)return new Iq(0,Math.PI/2);const n=e*e+t*t;return 0!==n?new Iq(e/n,-t/n).atanh():new Iq(0!==e?e/0:0,0!==t?-t/0:0).atanh()},acsch:function(){const e=this.re,t=this.im;if(0===t)return new Iq(0!==e?Math.log(e+Math.sqrt(e*e+1)):1/0,0);const n=e*e+t*t;return 0!==n?new Iq(e/n,-t/n).asinh():new Iq(0!==e?e/0:0,0!==t?-t/0:0).asinh()},asech:function(){const e=this.re,t=this.im;if(this.isZero())return Iq.INFINITY;const n=e*e+t*t;return 0!==n?new Iq(e/n,-t/n).acosh():new Iq(0!==e?e/0:0,0!==t?-t/0:0).acosh()},inverse:function(){if(this.isZero())return Iq.INFINITY;if(this.isInfinite())return Iq.ZERO;const e=this.re,t=this.im,n=e*e+t*t;return new Iq(e/n,-t/n)},conjugate:function(){return new Iq(this.re,-this.im)},neg:function(){return new Iq(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new Iq(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new Iq(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new Iq(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,t){const n=Dq(e,t);return Math.abs(n.re-this.re)<=Iq.EPSILON&&Math.abs(n.im-this.im)<=Iq.EPSILON},clone:function(){return new Iq(this.re,this.im)},toString:function(){let e=this.re,t=this.im,n="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(e)<Iq.EPSILON&&(e=0),Math.abs(t)<Iq.EPSILON&&(t=0),0===t?n+e:(0!==e?(n+=e,n+=" ",t<0?(t=-t,n+="-"):n+="+",n+=" "):t<0&&(t=-t,n+="-"),1!==t&&(n+=t),n+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!this.isFinite()}},Iq.ZERO=new Iq(0,0),Iq.ONE=new Iq(1,0),Iq.I=new Iq(0,1),Iq.PI=new Iq(Math.PI,0),Iq.E=new Iq(Math.E,0),Iq.INFINITY=new Iq(1/0,1/0),Iq.NAN=new Iq(NaN,NaN),Iq.EPSILON=1e-15;var Aq=ZU("Complex",[],(()=>(Object.defineProperty(Iq,"name",{value:"Complex"}),Iq.prototype.constructor=Iq,Iq.prototype.type="Complex",Iq.prototype.isComplex=!0,Iq.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},Iq.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},Iq.prototype.format=function(e){var t=this.im,n=this.re,r=gW(this.re,e),a=gW(this.im,e),i=QP(e)?e:e?e.precision:null;if(null!==i){var o=Math.pow(10,-i);Math.abs(n/t)<o&&(n=0),Math.abs(t/n)<o&&(t=0)}return 0===t?r:0===n?1===t?"i":-1===t?"-i":a+"i":t<0?-1===t?r+" - i":r+" - "+a.substring(1)+"i":1===t?r+" + i":r+" + "+a+"i"},Iq.fromPolar=function(e){switch(arguments.length){case 1:var t=arguments[0];if("object"===typeof t)return Iq(t);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var n=arguments[0],r=arguments[1];if(QP(n)){if(rU(r)&&r.hasBase("ANGLE")&&(r=r.toNumber("rad")),QP(r))return new Iq({r:n,phi:r});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},Iq.prototype.valueOf=Iq.prototype.toString,Iq.fromJSON=function(e){return new Iq(e)},Iq.compare=function(e,t){return e.re>t.re?1:e.re<t.re?-1:e.im>t.im?1:e.im<t.im?-1:0},Iq)),{isClass:!0});"undefined"===typeof BigInt&&(BigInt=function(e){if(isNaN(e))throw new Error("");return e});const Fq=BigInt(0),_q=BigInt(1),Mq=BigInt(2),Oq=BigInt(5),Rq=BigInt(10),zq={s:_q,n:Fq,d:_q};function Bq(e,t){try{e=BigInt(e)}catch(Z2){throw Hq()}return e*t}function Lq(e){return"bigint"===typeof e?e:Math.floor(e)}function Pq(e,t){if(t===Fq)throw Gq();const n=Object.create(jq.prototype);n.s=e<Fq?-_q:_q;const r=qq(e=e<Fq?-e:e,t);return n.n=e/r,n.d=t/r,n}function Uq(e){const t={};let n=e,r=Mq,a=Oq-_q;for(;a<=n;){for(;n%r===Fq;)n/=r,t[r]=(t[r]||Fq)+_q;a+=_q+Mq*r++}return n!==e?n>1&&(t[n]=(t[n]||Fq)+_q):t[e]=(t[e]||Fq)+_q,t}const Wq=function(e,t){let n=Fq,r=_q,a=_q;if(void 0===e||null===e);else if(void 0!==t){if("bigint"===typeof e)n=e;else{if(isNaN(e))throw Hq();if(e%1!==0)throw Kq();n=BigInt(e)}if("bigint"===typeof t)r=t;else{if(isNaN(t))throw Hq();if(t%1!==0)throw Kq();r=BigInt(t)}a=n*r}else if("object"===typeof e){if("d"in e&&"n"in e)n=BigInt(e.n),r=BigInt(e.d),"s"in e&&(n*=BigInt(e.s));else if(0 in e)n=BigInt(e[0]),1 in e&&(r=BigInt(e[1]));else{if("bigint"!==typeof e)throw Hq();n=e}a=n*r}else if("number"===typeof e){if(isNaN(e))throw Hq();if(e<0&&(a=-_q,e=-e),e%1===0)n=BigInt(e);else if(e>0){let t=1,a=0,i=1,o=1,s=1,u=1e7;for(e>=1&&(t=10**Math.floor(1+Math.log10(e)),e/=t);i<=u&&s<=u;){let t=(a+o)/(i+s);if(e===t){i+s<=u?(n=a+o,r=i+s):s>i?(n=o,r=s):(n=a,r=i);break}e>t?(a+=o,i+=s):(o+=a,s+=i),i>u?(n=o,r=s):(n=a,r=i)}n=BigInt(n)*BigInt(t),r=BigInt(r)}}else if("string"===typeof e){let t=0,i=Fq,o=Fq,s=Fq,u=_q,c=_q,l=e.replace(/_/g,"").match(/\d+|./g);if(null===l)throw Hq();if("-"===l[t]?(a=-_q,t++):"+"===l[t]&&t++,l.length===t+1?o=Bq(l[t++],a):"."===l[t+1]||"."===l[t]?("."!==l[t]&&(i=Bq(l[t++],a)),t++,(t+1===l.length||"("===l[t+1]&&")"===l[t+3]||"'"===l[t+1]&&"'"===l[t+3])&&(o=Bq(l[t],a),u=Rq**BigInt(l[t].length),t++),("("===l[t]&&")"===l[t+2]||"'"===l[t]&&"'"===l[t+2])&&(s=Bq(l[t+1],a),c=Rq**BigInt(l[t+1].length)-_q,t+=3)):"/"===l[t+1]||":"===l[t+1]?(o=Bq(l[t],a),u=Bq(l[t+2],_q),t+=3):"/"===l[t+3]&&" "===l[t+1]&&(i=Bq(l[t],a),o=Bq(l[t+2],a),u=Bq(l[t+4],_q),t+=5),!(l.length<=t))throw Hq();r=u*c,a=n=s+r*i+c*o}else{if("bigint"!==typeof e)throw Hq();n=e,a=e,r=_q}if(r===Fq)throw Gq();zq.s=a<Fq?-_q:_q,zq.n=n<Fq?-n:n,zq.d=r<Fq?-r:r};function Vq(e,t,n){let r=_q,a=function(e,t,n){let r=_q;for(;t>Fq;e=e*e%n,t>>=_q)t&_q&&(r=r*e%n);return r}(Rq,n,t);for(let i=0;i<300;i++){if(r===a)return BigInt(i);r=r*Rq%t,a=a*Rq%t}return 0}function qq(e,t){if(!e)return t;if(!t)return e;for(;;){if(!(e%=t))return t;if(!(t%=e))return e}}function jq(e,t){if(Wq(e,t),!(this instanceof jq))return Pq(zq.s*zq.n,zq.d);e=qq(zq.d,zq.n),this.s=zq.s,this.n=zq.n/e,this.d=zq.d/e}var Gq=function(){return new Error("Division by Zero")},Hq=function(){return new Error("Invalid argument")},Kq=function(){return new Error("Parameters must be integer")};jq.prototype={s:_q,n:Fq,d:_q,abs:function(){return Pq(this.n,this.d)},neg:function(){return Pq(-this.s*this.n,this.d)},add:function(e,t){return Wq(e,t),Pq(this.s*this.n*zq.d+zq.s*this.d*zq.n,this.d*zq.d)},sub:function(e,t){return Wq(e,t),Pq(this.s*this.n*zq.d-zq.s*this.d*zq.n,this.d*zq.d)},mul:function(e,t){return Wq(e,t),Pq(this.s*zq.s*this.n*zq.n,this.d*zq.d)},div:function(e,t){return Wq(e,t),Pq(this.s*zq.s*this.n*zq.d,this.d*zq.n)},clone:function(){return Pq(this.s*this.n,this.d)},mod:function(e,t){if(void 0===e)return Pq(this.s*this.n%this.d,_q);if(Wq(e,t),Fq===zq.n*this.d)throw Gq();return Pq(this.s*(zq.d*this.n)%(zq.n*this.d),zq.d*this.d)},gcd:function(e,t){return Wq(e,t),Pq(qq(zq.n,this.n)*qq(zq.d,this.d),zq.d*this.d)},lcm:function(e,t){return Wq(e,t),zq.n===Fq&&this.n===Fq?Pq(Fq,_q):Pq(zq.n*this.n,qq(zq.n,this.n)*qq(zq.d,this.d))},inverse:function(){return Pq(this.s*this.d,this.n)},pow:function(e,t){if(Wq(e,t),zq.d===_q)return zq.s<Fq?Pq((this.s*this.d)**zq.n,this.n**zq.n):Pq((this.s*this.n)**zq.n,this.d**zq.n);if(this.s<Fq)return null;let n=Uq(this.n),r=Uq(this.d),a=_q,i=_q;for(let o in n)if("1"!==o){if("0"===o){a=Fq;break}if(n[o]*=zq.n,n[o]%zq.d!==Fq)return null;n[o]/=zq.d,a*=BigInt(o)**n[o]}for(let o in r)if("1"!==o){if(r[o]*=zq.n,r[o]%zq.d!==Fq)return null;r[o]/=zq.d,i*=BigInt(o)**r[o]}return zq.s<Fq?Pq(i,a):Pq(a,i)},log:function(e,t){if(Wq(e,t),this.s<=Fq||zq.s<=Fq)return null;const n={},r=Uq(zq.n),a=Uq(zq.d),i=Uq(this.n),o=Uq(this.d);for(const c in a)r[c]=(r[c]||Fq)-a[c];for(const c in o)i[c]=(i[c]||Fq)-o[c];for(const c in r)"1"!==c&&(n[c]=!0);for(const c in i)"1"!==c&&(n[c]=!0);let s=null,u=null;for(const c in n){const e=r[c]||Fq,t=i[c]||Fq;if(e===Fq){if(t!==Fq)return null;continue}let n=t,a=e;const o=qq(n,a);if(n/=o,a/=o,null===s&&null===u)s=n,u=a;else if(n*u!==s*a)return null}return null!==s&&null!==u?Pq(s,u):null},equals:function(e,t){return Wq(e,t),this.s*this.n*zq.d===zq.s*zq.n*this.d},lt:function(e,t){return Wq(e,t),this.s*this.n*zq.d<zq.s*zq.n*this.d},lte:function(e,t){return Wq(e,t),this.s*this.n*zq.d<=zq.s*zq.n*this.d},gt:function(e,t){return Wq(e,t),this.s*this.n*zq.d>zq.s*zq.n*this.d},gte:function(e,t){return Wq(e,t),this.s*this.n*zq.d>=zq.s*zq.n*this.d},compare:function(e,t){Wq(e,t);let n=this.s*this.n*zq.d-zq.s*zq.n*this.d;return(Fq<n)-(n<Fq)},ceil:function(e){return e=Rq**BigInt(e||0),Pq(Lq(this.s*e*this.n/this.d)+(e*this.n%this.d>Fq&&this.s>=Fq?_q:Fq),e)},floor:function(e){return e=Rq**BigInt(e||0),Pq(Lq(this.s*e*this.n/this.d)-(e*this.n%this.d>Fq&&this.s<Fq?_q:Fq),e)},round:function(e){return e=Rq**BigInt(e||0),Pq(Lq(this.s*e*this.n/this.d)+this.s*((this.s>=Fq?_q:Fq)+Mq*(e*this.n%this.d)>this.d?_q:Fq),e)},roundTo:function(e,t){Wq(e,t);const n=this.n*zq.d,r=this.d*zq.n,a=n%r;let i=Lq(n/r);return a+a>=r&&i++,Pq(this.s*i*zq.n,zq.d)},divisible:function(e,t){return Wq(e,t),!(!(zq.n*this.d)||this.n*zq.d%(zq.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(e){let t=this.n,n=this.d;e=e||15;let r=function(e,t){for(;t%Mq===Fq;t/=Mq);for(;t%Oq===Fq;t/=Oq);if(t===_q)return Fq;let n=Rq%t,r=1;for(;n!==_q;r++)if(n=n*Rq%t,r>2e3)return Fq;return BigInt(r)}(0,n),a=Vq(0,n,r),i=this.s<Fq?"-":"";if(i+=Lq(t/n),t%=n,t*=Rq,t&&(i+="."),r){for(let e=a;e--;)i+=Lq(t/n),t%=n,t*=Rq;i+="(";for(let e=r;e--;)i+=Lq(t/n),t%=n,t*=Rq;i+=")"}else for(let o=e;t&&o--;)i+=Lq(t/n),t%=n,t*=Rq;return i},toFraction:function(e){let t=this.n,n=this.d,r=this.s<Fq?"-":"";if(n===_q)r+=t;else{let a=Lq(t/n);e&&a>Fq&&(r+=a,r+=" ",t%=n),r+=t,r+="/",r+=n}return r},toLatex:function(e){let t=this.n,n=this.d,r=this.s<Fq?"-":"";if(n===_q)r+=t;else{let a=Lq(t/n);e&&a>Fq&&(r+=a,t%=n),r+="\\frac{",r+=t,r+="}{",r+=n,r+="}"}return r},toContinued:function(){let e=this.n,t=this.d,n=[];do{n.push(Lq(e/t));let r=e%t;e=t,t=r}while(e!==_q);return n},simplify:function(e){const t=BigInt(1/(e||.001)|0),n=this.abs(),r=n.toContinued();for(let a=1;a<r.length;a++){let e=Pq(r[a-1],_q);for(let t=a-2;t>=0;t--)e=e.inverse().add(r[t]);let i=e.sub(n);if(i.n*t<i.d)return e.mul(this.s)}return this}};var Xq=ZU("Fraction",[],(()=>(Object.defineProperty(jq,"name",{value:"Fraction"}),jq.prototype.constructor=jq,jq.prototype.type="Fraction",jq.prototype.isFraction=!0,jq.prototype.toJSON=function(){return{mathjs:"Fraction",n:String(this.s*this.n),d:String(this.d)}},jq.fromJSON=function(e){return new jq(e)},jq)),{isClass:!0}),Yq=ZU("Range",[],(()=>{function e(t,n,r){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");var a=null!==t&&void 0!==t,i=null!==n&&void 0!==n,o=null!==r&&void 0!==r;if(a)if(JP(t))t=t.toNumber();else if("number"!==typeof t)throw new TypeError("Parameter start must be a number");if(i)if(JP(n))n=n.toNumber();else if("number"!==typeof n)throw new TypeError("Parameter end must be a number");if(o)if(JP(r))r=r.toNumber();else if("number"!==typeof r)throw new TypeError("Parameter step must be a number");this.start=a?parseFloat(t):0,this.end=i?parseFloat(n):0,this.step=o?parseFloat(r):1}return e.prototype.type="Range",e.prototype.isRange=!0,e.parse=function(t){if("string"!==typeof t)return null;var n=t.split(":").map((function(e){return parseFloat(e)}));if(n.some((function(e){return isNaN(e)})))return null;switch(n.length){case 2:return new e(n[0],n[1]);case 3:return new e(n[0],n[2],n[1]);default:return null}},e.prototype.clone=function(){return new e(this.start,this.end,this.step)},e.prototype.size=function(){var e=0,t=this.start,n=this.step,r=this.end-t;return cW(n)===cW(r)?e=Math.ceil(r/n):0===r&&(e=0),isNaN(e)&&(e=0),[e]},e.prototype.min=function(){var e=this.size()[0];return e>0?this.step>0?this.start:this.start+(e-1)*this.step:void 0},e.prototype.max=function(){var e=this.size()[0];return e>0?this.step>0?this.start+(e-1)*this.step:this.start:void 0},e.prototype.forEach=function(e){var t=this.start,n=this.step,r=this.end,a=0;if(n>0)for(;t<r;)e(t,[a],this),t+=n,a++;else if(n<0)for(;t>r;)e(t,[a],this),t+=n,a++},e.prototype.map=function(e){var t=[];return this.forEach((function(n,r,a){t[r[0]]=e(n,r,a)})),t},e.prototype.toArray=function(){var e=[];return this.forEach((function(t,n){e[n[0]]=t})),e},e.prototype.valueOf=function(){return this.toArray()},e.prototype.format=function(e){var t=gW(this.start,e);return 1!==this.step&&(t+=":"+gW(this.step,e)),t+=":"+gW(this.end,e)},e.prototype.toString=function(){return this.format()},e.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},e.fromJSON=function(t){return new e(t.start,t.end,t.step)},e}),{isClass:!0}),$q=ZU("Matrix",[],(()=>{function e(){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator")}return e.prototype.type="Matrix",e.prototype.isMatrix=!0,e.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},e.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},e.prototype.create=function(e,t){throw new Error("Cannot invoke create on a Matrix interface")},e.prototype.subset=function(e,t,n){throw new Error("Cannot invoke subset on a Matrix interface")},e.prototype.get=function(e){throw new Error("Cannot invoke get on a Matrix interface")},e.prototype.set=function(e,t,n){throw new Error("Cannot invoke set on a Matrix interface")},e.prototype.resize=function(e,t){throw new Error("Cannot invoke resize on a Matrix interface")},e.prototype.reshape=function(e,t){throw new Error("Cannot invoke reshape on a Matrix interface")},e.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},e.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},e.prototype.map=function(e,t){throw new Error("Cannot invoke map on a Matrix interface")},e.prototype.forEach=function(e){throw new Error("Cannot invoke forEach on a Matrix interface")},e.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},e.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},e.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},e.prototype.format=function(e){throw new Error("Cannot invoke format on a Matrix interface")},e.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},e}),{isClass:!0});function Zq(e,t,n){var r=new(0,e.constructor)(2),a="";if(n){if(n<1)throw new Error("size must be in greater than 0");if(!sW(n))throw new Error("size must be an integer");if(e.greaterThan(r.pow(n-1).sub(1))||e.lessThan(r.pow(n-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(n-1,", 2^").concat(n-1,"-1]"));if(!e.isInteger())throw new Error("Value must be an integer");e.lessThan(0)&&(e=e.add(r.pow(n))),a="i".concat(n)}switch(t){case 2:return"".concat(e.toBinary()).concat(a);case 8:return"".concat(e.toOctal()).concat(a);case 16:return"".concat(e.toHexadecimal()).concat(a);default:throw new Error("Base ".concat(t," not supported "))}}function Qq(e,t){if("function"===typeof t)return t(e);if(!e.isFinite())return e.isNaN()?"NaN":e.gt(0)?"Infinity":"-Infinity";var{notation:n,precision:r,wordSize:a}=yW(t);switch(n){case"fixed":return function(e,t){return e.toFixed(t)}(e,r);case"exponential":return Jq(e,r);case"engineering":return function(e,t){var n=e.e,r=n%3===0?n:n<0?n-3-n%3:n-n%3,a=e.mul(Math.pow(10,-r)),i=a.toPrecision(t);if(i.includes("e")){i=new(0,e.constructor)(i).toFixed()}return i+"e"+(n>=0?"+":"")+r.toString()}(e,r);case"bin":return Zq(e,2,a);case"oct":return Zq(e,8,a);case"hex":return Zq(e,16,a);case"auto":var i=ej(null===t||void 0===t?void 0:t.lowerExp,-3),o=ej(null===t||void 0===t?void 0:t.upperExp,5);if(e.isZero())return"0";var s=e.toSignificantDigits(r),u=s.e;return(u>=i&&u<o?s.toFixed():Jq(e,r)).replace(/((\.\d*?)(0+))($|e)/,(function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t}));default:throw new Error('Unknown notation "'+n+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function Jq(e,t){return void 0!==t?e.toExponential(t-1):e.toExponential()}function ej(e,t){return QP(e)?e:JP(e)?e.toNumber():t}function tj(e,t){var n=e.length-t.length,r=e.length;return e.substring(n,r)===t}function nj(e,t){var n=function(e,t){if("number"===typeof e)return gW(e,t);if(JP(e))return Qq(e,t);if(function(e){return e&&"object"===typeof e&&"bigint"===typeof e.s&&"bigint"===typeof e.n&&"bigint"===typeof e.d||!1}(e))return t&&"decimal"===t.fraction?e.toString():"".concat(e.s*e.n,"/").concat(e.d);if(Array.isArray(e))return oj(e,t);if(aU(e))return rj(e);if("function"===typeof e)return e.syntax?String(e.syntax):"function";if(e&&"object"===typeof e){return"function"===typeof e.format?e.format(t):e&&e.toString(t)!=={}.toString()?e.toString(t):"{"+Object.keys(e).map((n=>rj(n)+": "+nj(e[n],t))).join(", ")+"}"}return String(e)}(e,t);return t&&"object"===typeof t&&"truncate"in t&&n.length>t.truncate?n.substring(0,t.truncate-3)+"...":n}function rj(e){for(var t=String(e),n="",r=0;r<t.length;){var a=t.charAt(r);n+=a in aj?aj[a]:a,r++}return'"'+n+'"'}var aj={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"};function ij(e){var t=String(e);return t=t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function oj(e,t){if(Array.isArray(e)){for(var n="[",r=e.length,a=0;a<r;a++)0!==a&&(n+=", "),n+=oj(e[a],t);return n+="]"}return nj(e,t)}function sj(e,t){if(!aU(e))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+VU(e)+", index: 0)");if(!aU(t))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+VU(t)+", index: 1)");return e===t?0:e>t?1:-1}function uj(e){for(var t=[];Array.isArray(e);)t.push(e.length),e=e[0];return t}function cj(e,t,n){var r,a=e.length;if(a!==t[n])throw new PP(a,t[n]);if(n<t.length-1){var i=n+1;for(r=0;r<a;r++){var o=e[r];if(!Array.isArray(o))throw new PP(t.length-1,t.length,"<");cj(e[r],t,i)}}else for(r=0;r<a;r++)if(Array.isArray(e[r]))throw new PP(t.length+1,t.length,">")}function lj(e,t){if(0===t.length){if(Array.isArray(e))throw new PP(e.length,0)}else cj(e,t,0)}function pj(e,t){var n=e.isMatrix?e._size:uj(e);t._sourceSize.forEach(((e,t)=>{if(null!==e&&e!==n[t])throw new PP(e,n[t])}))}function hj(e,t){if(void 0!==e){if(!QP(e)||!sW(e))throw new TypeError("Index must be an integer (value: "+e+")");if(e<0||"number"===typeof t&&e>=t)throw new UP(e,t)}}function dj(e){for(var t=0;t<e._dimensions.length;++t){var n=e._dimensions[t];if(n._data&&iU(n._data)){if(0===n._size[0])return!0}else if(n.isRange){if(n.start===n.end)return!0}else if(aU(n)&&0===n.length)return!0}return!1}function fj(e,t,n){if(!Array.isArray(t))throw new TypeError("Array expected");if(0===t.length)throw new Error("Resizing to scalar is not supported");return t.forEach((function(e){if(!QP(e)||!sW(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+nj(t)+")")})),(QP(e)||JP(e))&&(e=[e]),mj(e,t,0,void 0!==n?n:0),e}function mj(e,t,n,r){var a,i,o=e.length,s=t[n],u=Math.min(o,s);if(e.length=s,n<t.length-1){var c=n+1;for(a=0;a<u;a++)i=e[a],Array.isArray(i)||(i=[i],e[a]=i),mj(i,t,c,r);for(a=u;a<s;a++)i=[],e[a]=i,mj(i,t,c,r)}else{for(a=0;a<u;a++)for(;Array.isArray(e[a]);)e[a]=e[a][0];for(a=u;a<s;a++)e[a]=r}}function gj(e,t){var n=Sj(e),r=n.length;if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("Array expected");if(0===t.length)throw new PP(0,r,"!=");var a=vj(t=yj(t,r));if(r!==a)throw new PP(a,r,"!=");try{return function(e,t){for(var n,r=e,a=t.length-1;a>0;a--){var i=t[a];n=[];for(var o=r.length/i,s=0;s<o;s++)n.push(r.slice(s*i,(s+1)*i));r=n}return r}(n,t)}catch(Z2){if(Z2 instanceof PP)throw new PP(a,r,"!=");throw Z2}}function yj(e,t){var n=vj(e),r=e.slice(),a=e.indexOf(-1);if(e.indexOf(-1,a+1)>=0)throw new Error("More than one wildcard in sizes");if(a>=0){if(!(t%n===0))throw new Error("Could not replace wildcard, since "+t+" is no multiple of "+-n);r[a]=-t/n}return r}function vj(e){return e.reduce(((e,t)=>e*t),1)}function bj(e,t){for(var n=t||uj(e);Array.isArray(e)&&1===e.length;)e=e[0],n.shift();for(var r=n.length;1===n[r-1];)r--;return r<n.length&&(e=xj(e,r,0),n.length=r),e}function xj(e,t,n){var r,a;if(n<t){var i=n+1;for(r=0,a=e.length;r<a;r++)e[r]=xj(e[r],t,i)}else for(;Array.isArray(e);)e=e[0];return e}function wj(e,t,n,r){var a=r||uj(e);if(n)for(var i=0;i<n;i++)e=[e],a.unshift(1);for(e=Nj(e,t,0);a.length<t;)a.push(1);return e}function Nj(e,t,n){var r,a;if(Array.isArray(e)){var i=n+1;for(r=0,a=e.length;r<a;r++)e[r]=Nj(e[r],t,i)}else for(var o=n;o<t;o++)e=[e];return e}function Sj(e){if(!Array.isArray(e))return e;var t=[];return e.forEach((function e(n){Array.isArray(n)?n.forEach(e):t.push(n)})),t}function kj(e,t){return Array.prototype.map.call(e,t)}function Ej(e,t){Array.prototype.forEach.call(e,t)}function Cj(e,t){if(1!==uj(e).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(e,(e=>t.test(e)))}function Tj(e,t){return Array.prototype.join.call(e,t)}function Dj(e){if(!Array.isArray(e))throw new TypeError("Array input expected");if(0===e.length)return e;var t=[],n=0;t[0]={value:e[0],identifier:0};for(var r=1;r<e.length;r++)e[r]===e[r-1]?n++:n=0,t.push({value:e[r],identifier:n});return t}function Ij(e){if(!Array.isArray(e))throw new TypeError("Array input expected");if(0===e.length)return e;for(var t=[],n=0;n<e.length;n++)t.push(e[n].value);return t}function Aj(e,t){for(var n,r=0,a=0;a<e.length;a++){var i=e[a],o=Array.isArray(i);if(0===a&&o&&(r=i.length),o&&i.length!==r)return;var s=o?Aj(i,t):t(i);if(void 0===n)n=s;else if(n!==s)return"mixed"}return n}function Fj(e,t,n,r){if(r<n){if(e.length!==t.length)throw new PP(e.length,t.length);for(var a=[],i=0;i<e.length;i++)a[i]=Fj(e[i],t[i],n,r+1);return a}return e.concat(t)}function _j(){var e=Array.prototype.slice.call(arguments,0,-1),t=Array.prototype.slice.call(arguments,-1);if(1===e.length)return e[0];if(e.length>1)return e.slice(1).reduce((function(e,n){return Fj(e,n,t,0)}),e[0]);throw new Error("Wrong number of arguments in function concat")}function Mj(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=t.map((e=>e.length)),a=Math.max(...r),i=new Array(a).fill(null),o=0;o<t.length;o++)for(var s=t[o],u=r[o],c=0;c<u;c++){var l=a-u+c;s[c]>i[l]&&(i[l]=s[c])}for(var p=0;p<t.length;p++)Oj(t[p],i);return i}function Oj(e,t){for(var n=t.length,r=e.length,a=0;a<r;a++){var i=n-r+a;if(e[a]<t[i]&&e[a]>1||e[a]>t[i])throw new Error("shape missmatch: missmatch is found in arg with shape (".concat(e,") not possible to broadcast dimension ").concat(r," with size ").concat(e[a]," to size ").concat(t[i]))}}function Rj(e,t){var n=uj(e);if(HU(n,t))return e;Oj(n,t);var r,a,i,o=Mj(n,t),s=o.length,u=[...Array(s-n.length).fill(1),...n],c=function(e){return zP([],e)}(e);n.length<s&&(n=uj(c=gj(c,u)));for(var l=0;l<s;l++)n[l]<o[l]&&(r=c,a=o[l],i=l,n=uj(c=_j(...Array(a).fill(r),i)));return c}function zj(e,t){if(!Array.isArray(e))throw new Error("Array expected");var n=uj(e);if(t.length!==n.length)throw new PP(t.length,n.length);for(var r=0;r<t.length;r++)hj(t[r],n[r]);return t.reduce(((e,t)=>e[t]),e)}function Bj(e,t,n,r){return Array.isArray(e)?e.map((function(e,a){return Bj(e,t.concat(a),n,r)})):r(e,t,n)}function Lj(e,t,n){if(BP.isTypedFunction(e)){var r=(t.isMatrix?t.size():uj(t)).map((()=>0)),a=t.isMatrix?t.get(r):zj(t,r),i=1===Object.keys(e.signatures).length,o=function(e,t,n,r){for(var a=[t,n,r],i=3;i>0;i--){var o=a.slice(0,i);if(null!==BP.resolve(e,o))return i}}(e,a,r,t),s=i?Object.values(e.signatures)[0]:e;return o>=1&&o<=3?function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return Pj(s,r.slice(0,o),n,e.name)}:function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return Pj(s,r,n,e.name)}}return e}function Pj(e,t,n,r){try{return e(...t)}catch(r5){!function(e,t,n,r){var a;if(e instanceof TypeError&&"wrongType"===(null===(a=e.data)||void 0===a?void 0:a.category)){var i=[];throw i.push("value: ".concat(VU(t[0]))),t.length>=2&&i.push("index: ".concat(VU(t[1]))),t.length>=3&&i.push("array: ".concat(VU(t[2]))),new TypeError("Function ".concat(n," cannot apply callback arguments ")+"".concat(r,"(").concat(i.join(", "),") at index ").concat(JSON.stringify(t[1])))}throw new TypeError("Function ".concat(n," cannot apply callback arguments ")+"to function ".concat(r,": ").concat(e.message))}(r5,t,n,r)}}var Uj=ZU("DenseMatrix",["Matrix"],(e=>{var{Matrix:t}=e;function n(e,t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!aU(t))throw new Error("Invalid datatype: "+t);if(oU(e))"DenseMatrix"===e.type?(this._data=qU(e._data),this._size=qU(e._size),this._datatype=t||e._datatype):(this._data=e.toArray(),this._size=e.size(),this._datatype=t||e._datatype);else if(e&&iU(e.data)&&iU(e.size))this._data=e.data,this._size=e.size,lj(this._data,this._size),this._datatype=t||e.datatype;else if(iU(e))this._data=s(e),this._size=uj(this._data),lj(this._data,this._size),this._datatype=t;else{if(e)throw new TypeError("Unsupported type of data ("+VU(e)+")");this._data=[],this._size=[0],this._datatype=t}}function r(e,t,n,a){var i=a===n-1,o=t.dimension(a);return i?o.map((function(t){return hj(t,e.length),e[t]})).valueOf():o.map((function(i){return hj(i,e.length),r(e[i],t,n,a+1)})).valueOf()}function a(e,t,n,r,i){var o=i===r-1,s=t.dimension(i);o?s.forEach((function(t,r){hj(t),e[t]=n[r[0]]})):s.forEach((function(o,s){hj(o),a(e[o],t,n[s[0]],r,i+1)}))}function i(e,t,n){if(0===t.length){for(var r=e._data;iU(r);)r=r[0];return r}return e._size=t.slice(0),e._data=fj(e._data,e._size,n),e}function o(e,t,n){for(var r=e._size.slice(0),a=!1;r.length<t.length;)r.push(0),a=!0;for(var o=0,s=t.length;o<s;o++)t[o]>r[o]&&(r[o]=t[o],a=!0);a&&i(e,r,n)}function s(e){return oU(e)?s(e.valueOf()):iU(e)?e.map(s):e}return n.prototype=new t,n.prototype.createDenseMatrix=function(e,t){return new n(e,t)},Object.defineProperty(n,"name",{value:"DenseMatrix"}),n.prototype.constructor=n,n.prototype.type="DenseMatrix",n.prototype.isDenseMatrix=!0,n.prototype.getDataType=function(){return Aj(this._data,VU)},n.prototype.storage=function(){return"dense"},n.prototype.datatype=function(){return this._datatype},n.prototype.create=function(e,t){return new n(e,t)},n.prototype.subset=function(e,t,i){switch(arguments.length){case 1:return function(e,t){if(!pU(t))throw new TypeError("Invalid index");var a=t.isScalar();if(a)return e.get(t.min());var i=t.size();if(i.length!==e._size.length)throw new PP(i.length,e._size.length);for(var o=t.min(),s=t.max(),u=0,c=e._size.length;u<c;u++)hj(o[u],e._size[u]),hj(s[u],e._size[u]);return new n(r(e._data,t,i.length,0),e._datatype)}(this,e);case 2:case 3:return function(e,t,n,r){if(!t||!0!==t.isIndex)throw new TypeError("Invalid index");var i,s=t.size(),u=t.isScalar();oU(n)?(i=n.size(),n=n.valueOf()):i=uj(n);if(u){if(0!==i.length)throw new TypeError("Scalar expected");e.set(t.min(),n,r)}else{if(!HU(i,s))try{i=uj(n=0===i.length?Rj([n],s):Rj(n,s))}catch(f){}if(s.length<e._size.length)throw new PP(s.length,e._size.length,"<");if(i.length<s.length){for(var c=0,l=0;1===s[c]&&1===i[c];)c++;for(;1===s[c];)l++,c++;n=wj(n,s.length,l,i)}if(!HU(s,i))throw new PP(s,i,">");var p=t.max().map((function(e){return e+1}));o(e,p,r);var h=s.length,d=0;a(e._data,t,n,h,d)}return e}(this,e,t,i);default:throw new SyntaxError("Wrong number of arguments")}},n.prototype.get=function(e){return zj(this._data,e)},n.prototype.set=function(e,t,n){if(!iU(e))throw new TypeError("Array expected");if(e.length<this._size.length)throw new PP(e.length,this._size.length,"<");var r,a,i,s=e.map((function(e){return e+1}));o(this,s,n);var u=this._data;for(r=0,a=e.length-1;r<a;r++)hj(i=e[r],u.length),u=u[i];return hj(i=e[e.length-1],u.length),u[i]=t,this},n.prototype.resize=function(e,t,n){if(!sU(e))throw new TypeError("Array or Matrix expected");var r=e.valueOf().map((e=>Array.isArray(e)&&1===e.length?e[0]:e));return i(n?this.clone():this,r,t)},n.prototype.reshape=function(e,t){var n=t?this.clone():this;n._data=gj(n._data,e);var r=n._size.reduce(((e,t)=>e*t));return n._size=yj(e,r),n},n.prototype.clone=function(){return new n({data:qU(this._data),size:qU(this._size),datatype:this._datatype})},n.prototype.size=function(){return this._size.slice(0)},n.prototype._forEach=function(e){var t=this,n=t.size();if(1!==n.length){var r=Array(n.length).fill(0),a=Array(n.length-1),i=a.length-1;a[0]=t._data[0];for(var o=0;o<i;o++)a[o+1]=a[o][0];for(r[i]=-1;;){var s=void 0;for(s=i;s>=0;s--){if(r[s]++,r[s]!==n[s]){a[s]=0===s?t._data[r[s]]:a[s-1][r[s]];for(var u=s;u<i;u++)a[u+1]=a[u][0];for(var c=0;c<n[a.length];c++)r[a.length]=c,e(a[i],c,r.slice(0));break}r[s]=0}if(-1===s)break}}else for(var l=0;l<n[0];l++)e(t._data,l,[l])},n.prototype.map=function(e){var t=this,r=new n(t),a=Lj(e,t._data,"map");return r._forEach((function(e,n,r){e[n]=a(e[n],r,t)})),r},n.prototype.forEach=function(e){var t=this,n=Lj(e,t._data,"map");t._forEach((function(e,r,a){n(e[r],a,t)}))},n.prototype[Symbol.iterator]=function*(){var e=function*(t,n){if(iU(t))for(var r=0;r<t.length;r++)yield*e(t[r],n.concat(r));else yield{value:t,index:n}};yield*e(this._data,[])},n.prototype.rows=function(){var e=[];if(2!==this.size().length)throw new TypeError("Rows can only be returned for a 2D matrix.");var t=this._data;for(var r of t)e.push(new n([r],this._datatype));return e},n.prototype.columns=function(){var e=this,t=[],r=this.size();if(2!==r.length)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var a=this._data,i=function(r){var i=a.map((e=>[e[r]]));t.push(new n(i,e._datatype))},o=0;o<r[1];o++)i(o);return t},n.prototype.toArray=function(){return qU(this._data)},n.prototype.valueOf=function(){return this._data},n.prototype.format=function(e){return nj(this._data,e)},n.prototype.toString=function(){return nj(this._data)},n.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},n.prototype.diagonal=function(e){if(e){if(JP(e)&&(e=e.toNumber()),!QP(e)||!sW(e))throw new TypeError("The parameter k must be an integer number")}else e=0;for(var t=e>0?e:0,r=e<0?-e:0,a=this._size[0],i=this._size[1],o=Math.min(a-r,i-t),s=[],u=0;u<o;u++)s[u]=this._data[u+r][u+t];return new n({data:s,size:[o],datatype:this._datatype})},n.diagonal=function(e,t,r,a){if(!iU(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map((function(e){if(JP(e)&&(e=e.toNumber()),!QP(e)||!sW(e)||e<1)throw new Error("Size values must be positive integers");return e})),r){if(JP(r)&&(r=r.toNumber()),!QP(r)||!sW(r))throw new TypeError("The parameter k must be an integer number")}else r=0;var i,o=r>0?r:0,s=r<0?-r:0,u=e[0],c=e[1],l=Math.min(u-s,c-o);if(iU(t)){if(t.length!==l)throw new Error("Invalid value array length");i=function(e){return t[e]}}else if(oU(t)){var p=t.size();if(1!==p.length||p[0]!==l)throw new Error("Invalid matrix length");i=function(e){return t.get([e])}}else i=function(){return t};a||(a=JP(i(0))?i(0).mul(0):0);var h=[];if(e.length>0){h=fj(h,e,a);for(var d=0;d<l;d++)h[d+s][d+o]=i(d)}return new n({data:h,size:[u,c]})},n.fromJSON=function(e){return new n(e)},n.prototype.swapRows=function(e,t){if(!QP(e)||!sW(e)||!QP(t)||!sW(t))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return hj(e,this._size[0]),hj(t,this._size[0]),n._swapRows(e,t,this._data),this},n._swapRows=function(e,t,n){var r=n[e];n[e]=n[t],n[t]=r},n}),{isClass:!0}),Wj="clone",Vj=ZU(Wj,["typed"],(e=>{var{typed:t}=e;return t(Wj,{any:qU})}));function qj(e){var t,n,r=e.length,a=e[0].length,i=[];for(n=0;n<a;n++){var o=[];for(t=0;t<r;t++)o.push(e[t][n]);i.push(o)}return i}function jj(e){for(var t=0;t<e.length;t++)if(sU(e[t]))return!0;return!1}function Gj(e,t){oU(e)&&(e=e.valueOf());for(var n=0,r=e.length;n<r;n++){var a=e[n];Array.isArray(a)?Gj(a,t):t(a)}}function Hj(e,t,n){return e&&"function"===typeof e.map?e.map((function(e){return Hj(e,t,n)})):t(e)}function Kj(e,t,n){var r=Array.isArray(e)?uj(e):e.size();if(t<0||t>=r.length)throw new UP(t,r.length);return oU(e)?e.create(Xj(e.valueOf(),t,n),e.datatype()):Xj(e,t,n)}function Xj(e,t,n){var r,a,i,o;if(t<=0){if(Array.isArray(e[0])){for(o=qj(e),a=[],r=0;r<o.length;r++)a[r]=Xj(o[r],t-1,n);return a}for(i=e[0],r=1;r<e.length;r++)i=n(i,e[r]);return i}for(a=[],r=0;r<e.length;r++)a[r]=Xj(e[r],t-1,n);return a}function Yj(e,t,n,r,a,i,o,s,u,c,l){var p,h,d,f,m=e._values,g=e._index,y=e._ptr;if(r)for(h=y[t],d=y[t+1],p=h;p<d;p++)n[f=g[p]]!==i?(n[f]=i,o.push(f),c?(r[f]=u?s(m[p],l):s(l,m[p]),a[f]=i):r[f]=m[p]):(r[f]=u?s(m[p],r[f]):s(r[f],m[p]),a[f]=i);else for(h=y[t],d=y[t+1],p=h;p<d;p++)n[f=g[p]]!==i?(n[f]=i,o.push(f)):a[f]=i}var $j="isInteger",Zj=ZU($j,["typed"],(e=>{var{typed:t}=e;return t($j,{number:sW,BigNumber:function(e){return e.isInt()},bigint:function(e){return!0},Fraction:function(e){return 1n===e.d},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),Qj="number";function Jj(e){return e<0}function eG(e){return e>0}function tG(e){return Number.isNaN(e)}function nG(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-9,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(n<=0)throw new Error("Relative tolerance must be greater than 0");if(r<0)throw new Error("Absolute tolerance must be at least 0");return!e.isNaN()&&!t.isNaN()&&(e.isFinite()&&t.isFinite()?!!e.eq(t)||e.minus(t).abs().lte(e.constructor.max(e.constructor.max(e.abs(),t.abs()).mul(n),r)):e.eq(t))}Jj.signature=Qj,eG.signature=Qj,tG.signature=Qj;var rG="isNegative",aG=ZU(rG,["typed","config"],(e=>{var{typed:t,config:n}=e;return t(rG,{number:e=>!SW(e,0,n.relTol,n.absTol)&&Jj(e),BigNumber:e=>!nG(e,new e.constructor(0),n.relTol,n.absTol)&&(e.isNeg()&&!e.isZero()&&!e.isNaN()),bigint:e=>e<0n,Fraction:e=>e.s<0n,Unit:t.referToSelf((e=>n=>t.find(e,n.valueType())(n.value))),"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),iG="isNumeric",oG=ZU(iG,["typed"],(e=>{var{typed:t}=e;return t(iG,{"number | BigNumber | bigint | Fraction | boolean":()=>!0,"Complex | Unit | string | null | undefined | Node":()=>!1,"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),sG="hasNumericValue",uG=ZU(sG,["typed","isNumeric"],(e=>{var{typed:t,isNumeric:n}=e;return t(sG,{boolean:()=>!0,string:function(e){return e.trim().length>0&&!isNaN(Number(e))},any:function(e){return n(e)}})})),cG="isPositive",lG=ZU(cG,["typed","config"],(e=>{var{typed:t,config:n}=e;return t(cG,{number:e=>!SW(e,0,n.relTol,n.absTol)&&eG(e),BigNumber:e=>!nG(e,new e.constructor(0),n.relTol,n.absTol)&&(!e.isNeg()&&!e.isZero()&&!e.isNaN()),bigint:e=>e>0n,Fraction:e=>e.s>0n&&e.n>0n,Unit:t.referToSelf((e=>n=>t.find(e,n.valueType())(n.value))),"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),pG="isZero",hG=ZU(pG,["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return t(pG,{"number | BigNumber | Complex | Fraction":e=>n(e,0),bigint:e=>0n===e,Unit:t.referToSelf((e=>n=>t.find(e,n.valueType())(n.value))),"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),dG="isNaN",fG=ZU(dG,["typed"],(e=>{var{typed:t}=e;return t(dG,{number:tG,BigNumber:function(e){return e.isNaN()},bigint:function(e){return!1},Fraction:function(e){return!1},Complex:function(e){return e.isNaN()},Unit:function(e){return Number.isNaN(e.value)},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),mG="typeOf",gG=ZU(mG,["typed"],(e=>{var{typed:t}=e;return t(mG,{any:VU})}));var yG=ZU("compareUnits",["typed"],(e=>{var{typed:t}=e;return{"Unit, Unit":t.referToSelf((e=>(n,r)=>{if(!n.equalBase(r))throw new Error("Cannot compare units with different base");return t.find(e,[n.valueType(),r.valueType()])(n.value,r.value)}))}})),vG="equalScalar",bG=ZU(vG,["typed","config"],(e=>{var{typed:t,config:n}=e,r=yG({typed:t});return t(vG,{"boolean, boolean":function(e,t){return e===t},"number, number":function(e,t){return SW(e,t,n.relTol,n.absTol)},"BigNumber, BigNumber":function(e,t){return e.eq(t)||nG(e,t,n.relTol,n.absTol)},"bigint, bigint":function(e,t){return e===t},"Fraction, Fraction":function(e,t){return e.equals(t)},"Complex, Complex":function(e,t){return function(e,t,n,r){return SW(e.re,t.re,n,r)&&SW(e.im,t.im,n,r)}(e,t,n.relTol,n.absTol)}},r)})),xG=(ZU(vG,["typed","config"],(e=>{var{typed:t,config:n}=e;return t(vG,{"number, number":function(e,t){return SW(e,t,n.relTol,n.absTol)}})})),ZU("SparseMatrix",["typed","equalScalar","Matrix"],(e=>{var{typed:t,equalScalar:n,Matrix:r}=e;function a(e,t){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!aU(t))throw new Error("Invalid datatype: "+t);if(oU(e))!function(e,t,n){"SparseMatrix"===t.type?(e._values=t._values?qU(t._values):void 0,e._index=qU(t._index),e._ptr=qU(t._ptr),e._size=qU(t._size),e._datatype=n||t._datatype):i(e,t.valueOf(),n||t._datatype)}(this,e,t);else if(e&&iU(e.index)&&iU(e.ptr)&&iU(e.size))this._values=e.values,this._index=e.index,this._ptr=e.ptr,this._size=e.size,this._datatype=t||e.datatype;else if(iU(e))i(this,e,t);else{if(e)throw new TypeError("Unsupported type of data ("+VU(e)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=t}}function i(e,r,a){e._values=[],e._index=[],e._ptr=[],e._datatype=a;var i=r.length,o=0,s=n,u=0;if(aU(a)&&(s=t.find(n,[a,a])||n,u=t.convert(0,a)),i>0){var c=0;do{e._ptr.push(e._index.length);for(var l=0;l<i;l++){var p=r[l];if(iU(p)){if(0===c&&o<p.length&&(o=p.length),c<p.length){var h=p[c];s(h,u)||(e._values.push(h),e._index.push(l))}}else 0===c&&o<1&&(o=1),s(p,u)||(e._values.push(p),e._index.push(l))}c++}while(c<o)}e._ptr.push(e._index.length),e._size=[i,o]}function o(e,t,n,r){if(n-t===0)return n;for(var a=t;a<n;a++)if(r[a]===e)return a;return t}function s(e,t,n,r,a,i,o){a.splice(e,0,r),i.splice(e,0,t);for(var s=n+1;s<o.length;s++)o[s]++}function u(e,r,a,i){var o=i||0,s=n,u=0;aU(e._datatype)&&(s=t.find(n,[e._datatype,e._datatype])||n,u=t.convert(0,e._datatype),o=t.convert(o,e._datatype));var c,l,p,h=!s(o,u),d=e._size[0],f=e._size[1];if(a>f){for(l=f;l<a;l++)if(e._ptr[l]=e._values.length,h)for(c=0;c<d;c++)e._values.push(o),e._index.push(c);e._ptr[a]=e._values.length}else a<f&&(e._ptr.splice(a+1,f-a),e._values.splice(e._ptr[a],e._values.length),e._index.splice(e._ptr[a],e._index.length));if(f=a,r>d){if(h){var m=0;for(l=0;l<f;l++){e._ptr[l]=e._ptr[l]+m,p=e._ptr[l+1]+m;var g=0;for(c=d;c<r;c++,g++)e._values.splice(p+g,0,o),e._index.splice(p+g,0,c),m++}e._ptr[f]=e._values.length}}else if(r<d){var y=0;for(l=0;l<f;l++){e._ptr[l]=e._ptr[l]-y;var v=e._ptr[l],b=e._ptr[l+1]-y;for(p=v;p<b;p++)(c=e._index[p])>r-1&&(e._values.splice(p,1),e._index.splice(p,1),y++)}e._ptr[l]=e._values.length}return e._size[0]=r,e._size[1]=a,e}function c(e,t,n,r,a){var i,o,s=r[0],u=r[1],c=[];for(i=0;i<s;i++)for(c[i]=[],o=0;o<u;o++)c[i][o]=0;for(o=0;o<u;o++)for(var l=n[o],p=n[o+1],h=l;h<p;h++)c[i=t[h]][o]=e?a?qU(e[h]):e[h]:1;return c}return a.prototype=new r,a.prototype.createSparseMatrix=function(e,t){return new a(e,t)},Object.defineProperty(a,"name",{value:"SparseMatrix"}),a.prototype.constructor=a,a.prototype.type="SparseMatrix",a.prototype.isSparseMatrix=!0,a.prototype.getDataType=function(){return Aj(this._values,VU)},a.prototype.storage=function(){return"sparse"},a.prototype.datatype=function(){return this._datatype},a.prototype.create=function(e,t){return new a(e,t)},a.prototype.density=function(){var e=this._size[0],t=this._size[1];return 0!==e&&0!==t?this._index.length/(e*t):0},a.prototype.subset=function(e,t,n){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return function(e,t){if(!pU(t))throw new TypeError("Invalid index");if(t.isScalar())return e.get(t.min());var n,r,i,o,s=t.size();if(s.length!==e._size.length)throw new PP(s.length,e._size.length);var u=t.min(),c=t.max();for(n=0,r=e._size.length;n<r;n++)hj(u[n],e._size[n]),hj(c[n],e._size[n]);var l=e._values,p=e._index,h=e._ptr,d=t.dimension(0),f=t.dimension(1),m=[],g=[];d.forEach((function(e,t){g[e]=t[0],m[e]=!0}));var y=l?[]:void 0,v=[],b=[];return f.forEach((function(e){for(b.push(v.length),i=h[e],o=h[e+1];i<o;i++)n=p[i],!0===m[n]&&(v.push(g[n]),y&&y.push(l[i]))})),b.push(v.length),new a({values:y,index:v,ptr:b,size:s,datatype:e._datatype})}(this,e);case 2:case 3:return function(e,t,n,r){if(!t||!0!==t.isIndex)throw new TypeError("Invalid index");var a,i=t.size(),o=t.isScalar();oU(n)?(a=n.size(),n=n.toArray()):a=uj(n);if(o){if(0!==a.length)throw new TypeError("Scalar expected");e.set(t.min(),n,r)}else{if(1!==i.length&&2!==i.length)throw new PP(i.length,e._size.length,"<");if(a.length<i.length){for(var s=0,u=0;1===i[s]&&1===a[s];)s++;for(;1===i[s];)u++,s++;n=wj(n,i.length,u,a)}if(!HU(i,a))throw new PP(i,a,">");if(1===i.length){t.dimension(0).forEach((function(t,a){hj(t),e.set([t,0],n[a[0]],r)}))}else{var c=t.dimension(0),l=t.dimension(1);c.forEach((function(t,a){hj(t),l.forEach((function(i,o){hj(i),e.set([t,i],n[a[0]][o[0]],r)}))}))}}return e}(this,e,t,n);default:throw new SyntaxError("Wrong number of arguments")}},a.prototype.get=function(e){if(!iU(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new PP(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var t=e[0],n=e[1];hj(t,this._size[0]),hj(n,this._size[1]);var r=o(t,this._ptr[n],this._ptr[n+1],this._index);return r<this._ptr[n+1]&&this._index[r]===t?this._values[r]:0},a.prototype.set=function(e,r,a){if(!iU(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new PP(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var i=e[0],c=e[1],l=this._size[0],p=this._size[1],h=n,d=0;aU(this._datatype)&&(h=t.find(n,[this._datatype,this._datatype])||n,d=t.convert(0,this._datatype)),(i>l-1||c>p-1)&&(u(this,Math.max(i+1,l),Math.max(c+1,p),a),l=this._size[0],p=this._size[1]),hj(i,l),hj(c,p);var f=o(i,this._ptr[c],this._ptr[c+1],this._index);return f<this._ptr[c+1]&&this._index[f]===i?h(r,d)?function(e,t,n,r,a){n.splice(e,1),r.splice(e,1);for(var i=t+1;i<a.length;i++)a[i]--}(f,c,this._values,this._index,this._ptr):this._values[f]=r:h(r,d)||s(f,i,c,r,this._values,this._index,this._ptr),this},a.prototype.resize=function(e,t,n){if(!sU(e))throw new TypeError("Array or Matrix expected");var r=e.valueOf().map((e=>Array.isArray(e)&&1===e.length?e[0]:e));if(2!==r.length)throw new Error("Only two dimensions matrix are supported");return r.forEach((function(e){if(!QP(e)||!sW(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+nj(r)+")")})),u(n?this.clone():this,r[0],r[1],t)},a.prototype.reshape=function(e,t){if(!iU(e))throw new TypeError("Array expected");if(2!==e.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");e.forEach((function(t){if(!QP(t)||!sW(t)||t<=-2||0===t)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+nj(e)+")")}));var n=this._size[0]*this._size[1];if(n!==(e=yj(e,n))[0]*e[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var r=t?this.clone():this;if(this._size[0]===e[0]&&this._size[1]===e[1])return r;for(var a=[],i=0;i<r._ptr.length;i++)for(var u=0;u<r._ptr[i+1]-r._ptr[i];u++)a.push(i);for(var c=r._values.slice(),l=r._index.slice(),p=0;p<r._index.length;p++){var h=l[p],d=a[p],f=h*r._size[1]+d;a[p]=f%e[1],l[p]=Math.floor(f/e[1])}r._values.length=0,r._index.length=0,r._ptr.length=e[1]+1,r._size=e.slice();for(var m=0;m<r._ptr.length;m++)r._ptr[m]=0;for(var g=0;g<c.length;g++){var y=l[g],v=a[g],b=c[g];s(o(y,r._ptr[v],r._ptr[v+1],r._index),y,v,b,r._values,r._index,r._ptr)}return r},a.prototype.clone=function(){return new a({values:this._values?qU(this._values):void 0,index:qU(this._index),ptr:qU(this._ptr),size:qU(this._size),datatype:this._datatype})},a.prototype.size=function(){return this._size.slice(0)},a.prototype.map=function(e,r){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var i=this,o=this._size[0],s=this._size[1],u=Lj(e,i,"map");return function(e,r,i,o,s,u,c){var l=[],p=[],h=[],d=n,f=0;aU(e._datatype)&&(d=t.find(n,[e._datatype,e._datatype])||n,f=t.convert(0,e._datatype));for(var m=function(e,t,n){var r=u(e,t,n);d(r,f)||(l.push(r),p.push(t))},g=o;g<=s;g++){h.push(l.length);var y=e._ptr[g],v=e._ptr[g+1];if(c)for(var b=y;b<v;b++){var x=e._index[b];x>=r&&x<=i&&m(e._values[b],x-r,g-o)}else{for(var w={},N=y;N<v;N++){w[e._index[N]]=e._values[N]}for(var S=r;S<=i;S++){m(S in w?w[S]:0,S-r,g-o)}}}return h.push(l.length),new a({values:l,index:p,ptr:h,size:[i-r+1,s-o+1]})}(this,0,o-1,0,s-1,(function(e,t,n){return u(e,[t,n],i)}),r)},a.prototype.forEach=function(e,t){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var n=this,r=this._size[0],a=this._size[1],i=Lj(e,n,"forEach"),o=0;o<a;o++){var s=this._ptr[o],u=this._ptr[o+1];if(t)for(var c=s;c<u;c++){var l=this._index[c];i(this._values[c],[l,o],n)}else{for(var p={},h=s;h<u;h++){p[this._index[h]]=this._values[h]}for(var d=0;d<r;d++){i(d in p?p[d]:0,[d,o],n)}}}},a.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var e=this._size[1],t=0;t<e;t++)for(var n=this._ptr[t],r=this._ptr[t+1],a=n;a<r;a++){var i=this._index[a];yield{value:this._values[a],index:[i,t]}}},a.prototype.toArray=function(){return c(this._values,this._index,this._ptr,this._size,!0)},a.prototype.valueOf=function(){return c(this._values,this._index,this._ptr,this._size,!1)},a.prototype.format=function(e){for(var t=this._size[0],n=this._size[1],r=this.density(),a="Sparse Matrix ["+nj(t,e)+" x "+nj(n,e)+"] density: "+nj(r,e)+"\n",i=0;i<n;i++)for(var o=this._ptr[i],s=this._ptr[i+1],u=o;u<s;u++){a+="\n    ("+nj(this._index[u],e)+", "+nj(i,e)+") ==> "+(this._values?nj(this._values[u],e):"X")}return a},a.prototype.toString=function(){return nj(this.toArray())},a.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},a.prototype.diagonal=function(e){if(e){if(JP(e)&&(e=e.toNumber()),!QP(e)||!sW(e))throw new TypeError("The parameter k must be an integer number")}else e=0;var t=e>0?e:0,n=e<0?-e:0,r=this._size[0],i=this._size[1],o=Math.min(r-n,i-t),s=[],u=[],c=[];c[0]=0;for(var l=t;l<i&&s.length<o;l++)for(var p=this._ptr[l],h=this._ptr[l+1],d=p;d<h;d++){var f=this._index[d];if(f===l-t+n){s.push(this._values[d]),u[s.length-1]=f-n;break}}return c.push(s.length),new a({values:s,index:u,ptr:c,size:[o,1]})},a.fromJSON=function(e){return new a(e)},a.diagonal=function(e,r,i,o,s){if(!iU(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map((function(e){if(JP(e)&&(e=e.toNumber()),!QP(e)||!sW(e)||e<1)throw new Error("Size values must be positive integers");return e})),i){if(JP(i)&&(i=i.toNumber()),!QP(i)||!sW(i))throw new TypeError("The parameter k must be an integer number")}else i=0;var u=n,c=0;aU(s)&&(u=t.find(n,[s,s])||n,c=t.convert(0,s));var l,p=i>0?i:0,h=i<0?-i:0,d=e[0],f=e[1],m=Math.min(d-h,f-p);if(iU(r)){if(r.length!==m)throw new Error("Invalid value array length");l=function(e){return r[e]}}else if(oU(r)){var g=r.size();if(1!==g.length||g[0]!==m)throw new Error("Invalid matrix length");l=function(e){return r.get([e])}}else l=function(){return r};for(var y=[],v=[],b=[],x=0;x<f;x++){b.push(y.length);var w=x-p;if(w>=0&&w<m){var N=l(w);u(N,c)||(v.push(w+h),y.push(N))}}return b.push(y.length),new a({values:y,index:v,ptr:b,size:[d,f]})},a.prototype.swapRows=function(e,t){if(!QP(e)||!sW(e)||!QP(t)||!sW(t))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return hj(e,this._size[0]),hj(t,this._size[0]),a._swapRows(e,t,this._size[1],this._values,this._index,this._ptr),this},a._forEachRow=function(e,t,n,r,a){for(var i=r[e],o=r[e+1],s=i;s<o;s++)a(n[s],t[s])},a._swapRows=function(e,t,n,r,a,i){for(var s=0;s<n;s++){var u=i[s],c=i[s+1],l=o(e,u,c,a),p=o(t,u,c,a);if(l<c&&p<c&&a[l]===e&&a[p]===t){if(r){var h=r[l];r[l]=r[p],r[p]=h}}else if(l<c&&a[l]===e&&(p>=c||a[p]!==t)){var d=r?r[l]:void 0;a.splice(p,0,t),r&&r.splice(p,0,d),a.splice(p<=l?l+1:l,1),r&&r.splice(p<=l?l+1:l,1)}else if(p<c&&a[p]===t&&(l>=c||a[l]!==e)){var f=r?r[p]:void 0;a.splice(l,0,e),r&&r.splice(l,0,f),a.splice(l<=p?p+1:p,1),r&&r.splice(l<=p?p+1:p,1)}}},a}),{isClass:!0}));var wG=ZU("number",["typed"],(e=>{var{typed:t}=e,n=t("number",{"":function(){return 0},number:function(e){return e},string:function(e){if("NaN"===e)return NaN;var t=function(e){var t=e.match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/);return t?{input:e,radix:{"0b":2,"0o":8,"0x":16}[t[1]],integerPart:t[2],fractionalPart:t[3]}:null}(e);if(t)return function(e){for(var t=parseInt(e.integerPart,e.radix),n=0,r=0;r<e.fractionalPart.length;r++)n+=parseInt(e.fractionalPart[r],e.radix)/Math.pow(e.radix,r+1);var a=t+n;if(isNaN(a))throw new SyntaxError('String "'+e.input+'" is not a valid number');return a}(t);var n=0,r=e.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);r&&(n=Number(r[2]),e=r[1]);var a=Number(e);if(isNaN(a))throw new SyntaxError('String "'+e+'" is not a valid number');if(r){if(a>2**n-1)throw new SyntaxError('String "'.concat(e,'" is out of range'));a>=2**(n-1)&&(a-=2**n)}return a},BigNumber:function(e){return e.toNumber()},bigint:function(e){return Number(e)},Fraction:function(e){return e.valueOf()},Unit:t.referToSelf((e=>t=>{var n=t.clone();return n.value=e(t.value),n})),null:function(e){return 0},"Unit, string | Unit":function(e,t){return e.toNumber(t)},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))});return n.fromJSON=function(e){return parseFloat(e.value)},n})),NG=ZU("bigint",["typed"],(e=>{var{typed:t}=e,n=t("bigint",{"":function(){return 0n},bigint:function(e){return e},number:function(e){return BigInt(e.toFixed())},BigNumber:function(e){return BigInt(e.round().toString())},Fraction:function(e){return BigInt(e.valueOf().toFixed())},"string | boolean":function(e){return BigInt(e)},null:function(e){return 0n},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))});return n.fromJSON=function(e){return BigInt(e.value)},n})),SG="string",kG=ZU(SG,["typed"],(e=>{var{typed:t}=e;return t(SG,{"":function(){return""},number:gW,null:function(e){return"null"},boolean:function(e){return e+""},string:function(e){return e},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e))),any:function(e){return String(e)}})})),EG="boolean",CG=ZU(EG,["typed"],(e=>{var{typed:t}=e;return t(EG,{"":function(){return!1},boolean:function(e){return e},number:function(e){return!!e},null:function(e){return!1},BigNumber:function(e){return!e.isZero()},string:function(e){var t=e.toLowerCase();if("true"===t)return!0;if("false"===t)return!1;var n=Number(e);if(""!==e&&!isNaN(n))return!!n;throw new Error('Cannot convert "'+e+'" to a boolean')},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),TG=ZU("bignumber",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t("bignumber",{"":function(){return new n(0)},number:function(e){return new n(e+"")},string:function(e){var t=e.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(t){var r=t[2],a=n(t[1]),i=new n(2).pow(Number(r));if(a.gt(i.sub(1)))throw new SyntaxError('String "'.concat(e,'" is out of range'));var o=new n(2).pow(Number(r)-1);return a.gte(o)?a.sub(i):a}return new n(e)},BigNumber:function(e){return e},bigint:function(e){return new n(e.toString())},Unit:t.referToSelf((e=>t=>{var n=t.clone();return n.value=e(t.value),n})),Fraction:function(e){return new n(String(e.n)).div(String(e.d)).times(String(e.s))},null:function(e){return new n(0)},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),DG=ZU("complex",["typed","Complex"],(e=>{var{typed:t,Complex:n}=e;return t("complex",{"":function(){return n.ZERO},number:function(e){return new n(e,0)},"number, number":function(e,t){return new n(e,t)},"BigNumber, BigNumber":function(e,t){return new n(e.toNumber(),t.toNumber())},Fraction:function(e){return new n(e.valueOf(),0)},Complex:function(e){return e.clone()},string:function(e){return n(e)},null:function(e){return n(0)},Object:function(e){if("re"in e&&"im"in e)return new n(e.re,e.im);if("r"in e&&"phi"in e||"abs"in e&&"arg"in e)return new n(e);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),IG=ZU("fraction",["typed","Fraction"],(e=>{var{typed:t,Fraction:n}=e;return t("fraction",{number:function(e){if(!isFinite(e)||isNaN(e))throw new Error(e+" cannot be represented as a fraction");return new n(e)},string:function(e){return new n(e)},"number, number":function(e,t){return new n(e,t)},"bigint, bigint":function(e,t){return new n(e,t)},null:function(e){return new n(0)},BigNumber:function(e){return new n(e.toString())},bigint:function(e){return new n(e.toString())},Fraction:function(e){return e},Unit:t.referToSelf((e=>t=>{var n=t.clone();return n.value=e(t.value),n})),Object:function(e){return new n(e)},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),AG="matrix",FG=ZU(AG,["typed","Matrix","DenseMatrix","SparseMatrix"],(e=>{var{typed:t,Matrix:n,DenseMatrix:r,SparseMatrix:a}=e;return t(AG,{"":function(){return i([])},string:function(e){return i([],e)},"string, string":function(e,t){return i([],e,t)},Array:function(e){return i(e)},Matrix:function(e){return i(e,e.storage())},"Array | Matrix, string":i,"Array | Matrix, string, string":i});function i(e,t,n){if("dense"===t||"default"===t||void 0===t)return new r(e,n);if("sparse"===t)return new a(e,n);throw new TypeError("Unknown matrix type "+JSON.stringify(t)+".")}})),_G="matrixFromFunction",MG=ZU(_G,["typed","matrix","isZero"],(e=>{var{typed:t,matrix:n,isZero:r}=e;return t(_G,{"Array | Matrix, function, string, string":function(e,t,n,r){return a(e,t,n,r)},"Array | Matrix, function, string":function(e,t,n){return a(e,t,n)},"Matrix, function":function(e,t){return a(e,t,"dense")},"Array, function":function(e,t){return a(e,t,"dense").toArray()},"Array | Matrix, string, function":function(e,t,n){return a(e,n,t)},"Array | Matrix, string, string, function":function(e,t,n,r){return a(e,r,t,n)}});function a(e,t,a,i){var o;return(o=void 0!==i?n(a,i):n(a)).resize(e),o.forEach((function(e,n){var a=t(n);r(a)||o.set(n,a)})),o}})),OG="matrixFromRows",RG=ZU(OG,["typed","matrix","flatten","size"],(e=>{var{typed:t,matrix:n,flatten:r,size:a}=e;return t(OG,{"...Array":function(e){return i(e)},"...Matrix":function(e){return n(i(e.map((e=>e.toArray()))))}});function i(e){if(0===e.length)throw new TypeError("At least one row is needed to construct a matrix.");var t=o(e[0]),n=[];for(var a of e){var i=o(a);if(i!==t)throw new TypeError("The vectors had different length: "+(0|t)+" \u2260 "+(0|i));n.push(r(a))}return n}function o(e){var t=a(e);if(1===t.length)return t[0];if(2===t.length){if(1===t[0])return t[1];if(1===t[1])return t[0];throw new TypeError("At least one of the arguments is not a vector.")}throw new TypeError("Only one- or two-dimensional vectors are supported.")}})),zG="matrixFromColumns",BG=ZU(zG,["typed","matrix","flatten","size"],(e=>{var{typed:t,matrix:n,flatten:r,size:a}=e;return t(zG,{"...Array":function(e){return i(e)},"...Matrix":function(e){return n(i(e.map((e=>e.toArray()))))}});function i(e){if(0===e.length)throw new TypeError("At least one column is needed to construct a matrix.");for(var t=o(e[0]),n=[],a=0;a<t;a++)n[a]=[];for(var i of e){var s=o(i);if(s!==t)throw new TypeError("The vectors had different length: "+(0|t)+" \u2260 "+(0|s));for(var u=r(i),c=0;c<t;c++)n[c].push(u[c])}return n}function o(e){var t=a(e);if(1===t.length)return t[0];if(2===t.length){if(1===t[0])return t[1];if(1===t[1])return t[0];throw new TypeError("At least one of the arguments is not a vector.")}throw new TypeError("Only one- or two-dimensional vectors are supported.")}})),LG="splitUnit",PG=ZU(LG,["typed"],(e=>{var{typed:t}=e;return t(LG,{"Unit, Array":function(e,t){return e.splitUnit(t)}})})),UG="number",WG="number, number";function VG(e){return Math.abs(e)}function qG(e,t){return e+t}function jG(e,t){return e-t}function GG(e,t){return e*t}function HG(e){return-e}function KG(e){return e}function XG(e){return dW(e)}function YG(e){return e*e*e}function $G(e){return Math.exp(e)}function ZG(e){return fW(e)}function QG(e,t){if(!sW(e)||!sW(t))throw new Error("Parameters in function lcm must be integer numbers");if(0===e||0===t)return 0;for(var n,r=e*t;0!==t;)t=e%(n=t),e=n;return Math.abs(r/e)}function JG(e,t){return t?Math.log(e)/Math.log(t):Math.log(e)}function eH(e){return pW(e)}function tH(e){return lW(e)}function nH(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=t<0;if(n&&(t=-t),0===t)throw new Error("Root must be non-zero");if(e<0&&Math.abs(t)%2!==1)throw new Error("Root must be odd when a is negative.");if(0===e)return n?1/0:0;if(!isFinite(e))return n?0:e;var r=Math.pow(Math.abs(e),1/t);return r=e<0?-r:r,n?1/r:r}function rH(e){return cW(e)}function aH(e){return e*e}function iH(e,t){var n,r,a,i=0,o=1,s=1,u=0;if(!sW(e)||!sW(t))throw new Error("Parameters in function xgcd must be integer numbers");for(;t;)a=e-(r=Math.floor(e/t))*t,n=i,i=o-r*i,o=n,n=s,s=u-r*s,u=n,e=t,t=a;return e<0?[-e,-o,-u]:[e,e?o:0,u]}function oH(e,t){return e*e<1&&t===1/0||e*e>1&&t===-1/0?0:Math.pow(e,t)}function sH(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!sW(t)||t<0||t>15)throw new Error("Number of decimals in function round must be an integer from 0 to 15 inclusive");return parseFloat(bW(e,t))}VG.signature=UG,qG.signature=WG,jG.signature=WG,GG.signature=WG,HG.signature=UG,KG.signature=UG,XG.signature=UG,YG.signature=UG,$G.signature=UG,ZG.signature=UG,QG.signature=WG,eH.signature=UG,tH.signature=UG,rH.signature=UG,aH.signature=UG,iH.signature=WG,oH.signature=WG;var uH="unaryMinus",cH=ZU(uH,["typed"],(e=>{var{typed:t}=e;return t(uH,{number:HG,"Complex | BigNumber | Fraction":e=>e.neg(),bigint:e=>-e,Unit:t.referToSelf((e=>n=>{var r=n.clone();return r.value=t.find(e,r.valueType())(n.value),r})),"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e,!0)))})})),lH="unaryPlus",pH=ZU(lH,["typed","config","numeric"],(e=>{var{typed:t,config:n,numeric:r}=e;return t(lH,{number:KG,Complex:function(e){return e},BigNumber:function(e){return e},bigint:function(e){return e},Fraction:function(e){return e},Unit:function(e){return e.clone()},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e,!0))),boolean:function(e){return r(e?1:0,n.number)},string:function(e){return r(e,uW(e,n))}})})),hH=ZU("abs",["typed"],(e=>{var{typed:t}=e;return t("abs",{number:VG,"Complex | BigNumber | Fraction | Unit":e=>e.abs(),bigint:e=>e<0n?-e:e,"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e,!0)))})})),dH="apply",fH=ZU(dH,["typed","isInteger"],(e=>{var{typed:t,isInteger:n}=e;return t(dH,{"Array | Matrix, number | BigNumber, function":function(e,t,r){if(!n(t))throw new TypeError("Integer number expected for dimension");var a=Array.isArray(e)?uj(e):e.size();if(t<0||t>=a.length)throw new UP(t,a.length);return oU(e)?e.create(mH(e.valueOf(),t,r),e.datatype()):mH(e,t,r)}})}));function mH(e,t,n){var r,a,i;if(t<=0){if(Array.isArray(e[0])){for(i=function(e){var t,n,r=e.length,a=e[0].length,i=[];for(n=0;n<a;n++){var o=[];for(t=0;t<r;t++)o.push(e[t][n]);i.push(o)}return i}(e),a=[],r=0;r<i.length;r++)a[r]=mH(i[r],t-1,n);return a}return n(e)}for(a=[],r=0;r<e.length;r++)a[r]=mH(e[r],t-1,n);return a}var gH="addScalar",yH=ZU(gH,["typed"],(e=>{var{typed:t}=e;return t(gH,{"number, number":qG,"Complex, Complex":function(e,t){return e.add(t)},"BigNumber, BigNumber":function(e,t){return e.plus(t)},"bigint, bigint":function(e,t){return e+t},"Fraction, Fraction":function(e,t){return e.add(t)},"Unit, Unit":t.referToSelf((e=>(n,r)=>{if(null===n.value||void 0===n.value)throw new Error("Parameter x contains a unit with undefined value");if(null===r.value||void 0===r.value)throw new Error("Parameter y contains a unit with undefined value");if(!n.equalBase(r))throw new Error("Units do not match");var a=n.clone();return a.value=t.find(e,[a.valueType(),r.valueType()])(a.value,r.value),a.fixPrefix=!1,a}))})})),vH="subtractScalar",bH=ZU(vH,["typed"],(e=>{var{typed:t}=e;return t(vH,{"number, number":jG,"Complex, Complex":function(e,t){return e.sub(t)},"BigNumber, BigNumber":function(e,t){return e.minus(t)},"bigint, bigint":function(e,t){return e-t},"Fraction, Fraction":function(e,t){return e.sub(t)},"Unit, Unit":t.referToSelf((e=>(n,r)=>{if(null===n.value||void 0===n.value)throw new Error("Parameter x contains a unit with undefined value");if(null===r.value||void 0===r.value)throw new Error("Parameter y contains a unit with undefined value");if(!n.equalBase(r))throw new Error("Units do not match");var a=n.clone();return a.value=t.find(e,[a.valueType(),r.valueType()])(a.value,r.value),a.fixPrefix=!1,a}))})})),xH="cbrt",wH=ZU(xH,["config","typed","isNegative","unaryMinus","matrix","Complex","BigNumber","Fraction"],(e=>{var{config:t,typed:n,isNegative:r,unaryMinus:a,matrix:i,Complex:o,BigNumber:s,Fraction:u}=e;return n(xH,{number:XG,Complex:c,"Complex, boolean":c,BigNumber:function(e){return e.cbrt()},Unit:function(e){if(e.value&&tU(e.value)){var t=e.clone();return t.value=1,(t=t.pow(1/3)).value=c(e.value),t}var n,i=r(e.value);i&&(e.value=a(e.value)),n=JP(e.value)?new s(1).div(3):nU(e.value)?new u(1,3):1/3;var o=e.pow(n);return i&&(o.value=a(o.value)),o}});function c(e,n){var r=e.arg()/3,a=e.abs(),s=new o(XG(a),0).mul(new o(0,r).exp());if(n){var u=[s,new o(XG(a),0).mul(new o(0,r+2*Math.PI/3).exp()),new o(XG(a),0).mul(new o(0,r-2*Math.PI/3).exp())];return"Array"===t.matrix?u:i(u)}return s}})),NH=ZU("matAlgo11xS0s",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return function(e,r,a,i){var o=e._values,s=e._index,u=e._ptr,c=e._size,l=e._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var p,h=c[0],d=c[1],f=n,m=0,g=a;"string"===typeof l&&(p=l,f=t.find(n,[p,p]),m=t.convert(0,p),r=t.convert(r,p),g=t.find(a,[p,p]));for(var y=[],v=[],b=[],x=0;x<d;x++){b[x]=v.length;for(var w=u[x],N=u[x+1],S=w;S<N;S++){var k=s[S],E=i?g(r,o[S]):g(o[S],r);f(E,m)||(v.push(k),y.push(E))}}return b[d]=v.length,e.createSparseMatrix({values:y,index:v,ptr:b,size:[h,d],datatype:p})}})),SH=ZU("matAlgo12xSfs",["typed","DenseMatrix"],(e=>{var{typed:t,DenseMatrix:n}=e;return function(e,r,a,i){var o=e._values,s=e._index,u=e._ptr,c=e._size,l=e._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var p,h=c[0],d=c[1],f=a;"string"===typeof l&&(p=l,r=t.convert(r,p),f=t.find(a,[p,p]));for(var m=[],g=[],y=[],v=0;v<d;v++){for(var b=v+1,x=u[v],w=u[v+1],N=x;N<w;N++){var S=s[N];g[S]=o[N],y[S]=b}for(var k=0;k<h;k++)0===v&&(m[k]=[]),y[k]===b?m[k][v]=i?f(r,g[k]):f(g[k],r):m[k][v]=i?f(r,0):f(0,r)}return new n({data:m,size:[h,d],datatype:p})}})),kH=ZU("matAlgo14xDs",["typed"],(e=>{var{typed:t}=e;return function(e,r,a,i){var o,s=e._data,u=e._size,c=e._datatype,l=a;"string"===typeof c&&(o=c,r=t.convert(r,o),l=t.find(a,[o,o]));var p=u.length>0?n(l,0,u,u[0],s,r,i):[];return e.createDenseMatrix({data:p,size:qU(u),datatype:o})};function n(e,t,r,a,i,o,s){var u=[];if(t===r.length-1)for(var c=0;c<a;c++)u[c]=s?e(o,i[c]):e(i[c],o);else for(var l=0;l<a;l++)u[l]=n(e,t+1,r,r[t+1],i[l],o,s);return u}})),EH="ceil",CH=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],TH=ZU(EH,["typed","config","round"],(e=>{var{typed:t,config:n,round:r}=e;return t(EH,{number:function(e){return SW(e,r(e),n.relTol,n.absTol)?r(e):Math.ceil(e)},"number, number":function(e,t){if(SW(e,r(e,t),n.relTol,n.absTol))return r(e,t);var[a,i]="".concat(e,"e").split("e"),o=Math.ceil(Number("".concat(a,"e").concat(Number(i)+t)));return[a,i]="".concat(o,"e").split("e"),Number("".concat(a,"e").concat(Number(i)-t))}})})),DH=ZU(EH,CH,(e=>{var{typed:t,config:n,round:r,matrix:a,equalScalar:i,zeros:o,DenseMatrix:s}=e,u=NH({typed:t,equalScalar:i}),c=SH({typed:t,DenseMatrix:s}),l=kH({typed:t}),p=TH({typed:t,config:n,round:r});return t("ceil",{number:p.signatures.number,"number,number":p.signatures["number,number"],Complex:function(e){return e.ceil()},"Complex, number":function(e,t){return e.ceil(t)},"Complex, BigNumber":function(e,t){return e.ceil(t.toNumber())},BigNumber:function(e){return nG(e,r(e),n.relTol,n.absTol)?r(e):e.ceil()},"BigNumber, BigNumber":function(e,t){return nG(e,r(e,t),n.relTol,n.absTol)?r(e,t):e.toDecimalPlaces(t.toNumber(),xq.ROUND_CEIL)},Fraction:function(e){return e.ceil()},"Fraction, number":function(e,t){return e.ceil(t)},"Fraction, BigNumber":function(e,t){return e.ceil(t.toNumber())},"Unit, number, Unit":t.referToSelf((e=>function(t,n,r){var a=t.toNumeric(r);return r.multiply(e(a,n))})),"Unit, BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>e(t,n.toNumber(),r))),"Array | Matrix, number | BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>Hj(t,(t=>e(t,n,r)),!0))),"Array | Matrix | Unit, Unit":t.referToSelf((e=>(t,n)=>e(t,0,n))),"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e,!0))),"Array, number | BigNumber":t.referToSelf((e=>(t,n)=>Hj(t,(t=>e(t,n)),!0))),"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>u(t,n,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>l(t,n,e,!1))),"number | Complex | Fraction | BigNumber, Array":t.referToSelf((e=>(t,n)=>l(a(n),t,e,!0).valueOf())),"number | Complex | Fraction | BigNumber, Matrix":t.referToSelf((e=>(t,n)=>i(t,0)?o(n.size(),n.storage()):"dense"===n.storage()?l(n,t,e,!0):c(n,t,e,!0)))})})),IH="cube",AH=ZU(IH,["typed"],(e=>{var{typed:t}=e;return t(IH,{number:YG,Complex:function(e){return e.mul(e).mul(e)},BigNumber:function(e){return e.times(e).times(e)},bigint:function(e){return e*e*e},Fraction:function(e){return e.pow(3)},Unit:function(e){return e.pow(3)}})})),FH=ZU("exp",["typed"],(e=>{var{typed:t}=e;return t("exp",{number:$G,Complex:function(e){return e.exp()},BigNumber:function(e){return e.exp()}})})),_H="expm1",MH=ZU(_H,["typed","Complex"],(e=>{var{typed:t,Complex:n}=e;return t(_H,{number:ZG,Complex:function(e){var t=Math.exp(e.re);return new n(t*Math.cos(e.im)-1,t*Math.sin(e.im))},BigNumber:function(e){return e.exp().minus(1)}})})),OH="fix",RH=["typed","Complex","matrix","ceil","floor","equalScalar","zeros","DenseMatrix"],zH=ZU(OH,["typed","ceil","floor"],(e=>{var{typed:t,ceil:n,floor:r}=e;return t(OH,{number:function(e){return e>0?r(e):n(e)},"number, number":function(e,t){return e>0?r(e,t):n(e,t)}})})),BH=ZU(OH,RH,(e=>{var{typed:t,Complex:n,matrix:r,ceil:a,floor:i,equalScalar:o,zeros:s,DenseMatrix:u}=e,c=SH({typed:t,DenseMatrix:u}),l=kH({typed:t}),p=zH({typed:t,ceil:a,floor:i});return t("fix",{number:p.signatures.number,"number, number | BigNumber":p.signatures["number,number"],Complex:function(e){return new n(e.re>0?Math.floor(e.re):Math.ceil(e.re),e.im>0?Math.floor(e.im):Math.ceil(e.im))},"Complex, number":function(e,t){return new n(e.re>0?i(e.re,t):a(e.re,t),e.im>0?i(e.im,t):a(e.im,t))},"Complex, BigNumber":function(e,t){var r=t.toNumber();return new n(e.re>0?i(e.re,r):a(e.re,r),e.im>0?i(e.im,r):a(e.im,r))},BigNumber:function(e){return e.isNegative()?a(e):i(e)},"BigNumber, number | BigNumber":function(e,t){return e.isNegative()?a(e,t):i(e,t)},Fraction:function(e){return e.s<0n?e.ceil():e.floor()},"Fraction, number | BigNumber":function(e,t){return e.s<0n?a(e,t):i(e,t)},"Unit, number, Unit":t.referToSelf((e=>function(t,n,r){var a=t.toNumeric(r);return r.multiply(e(a,n))})),"Unit, BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>e(t,n.toNumber(),r))),"Array | Matrix, number | BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>Hj(t,(t=>e(t,n,r)),!0))),"Array | Matrix | Unit, Unit":t.referToSelf((e=>(t,n)=>e(t,0,n))),"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e,!0))),"Array | Matrix, number | BigNumber":t.referToSelf((e=>(t,n)=>Hj(t,(t=>e(t,n)),!0))),"number | Complex | Fraction | BigNumber, Array":t.referToSelf((e=>(t,n)=>l(r(n),t,e,!0).valueOf())),"number | Complex | Fraction | BigNumber, Matrix":t.referToSelf((e=>(t,n)=>o(t,0)?s(n.size(),n.storage()):"dense"===n.storage()?l(n,t,e,!0):c(n,t,e,!0)))})})),LH="floor",PH=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],UH=ZU(LH,["typed","config","round"],(e=>{var{typed:t,config:n,round:r}=e;return t(LH,{number:function(e){return SW(e,r(e),n.relTol,n.absTol)?r(e):Math.floor(e)},"number, number":function(e,t){if(SW(e,r(e,t),n.relTol,n.absTol))return r(e,t);var[a,i]="".concat(e,"e").split("e"),o=Math.floor(Number("".concat(a,"e").concat(Number(i)+t)));return[a,i]="".concat(o,"e").split("e"),Number("".concat(a,"e").concat(Number(i)-t))}})})),WH=ZU(LH,PH,(e=>{var{typed:t,config:n,round:r,matrix:a,equalScalar:i,zeros:o,DenseMatrix:s}=e,u=NH({typed:t,equalScalar:i}),c=SH({typed:t,DenseMatrix:s}),l=kH({typed:t}),p=UH({typed:t,config:n,round:r});return t("floor",{number:p.signatures.number,"number,number":p.signatures["number,number"],Complex:function(e){return e.floor()},"Complex, number":function(e,t){return e.floor(t)},"Complex, BigNumber":function(e,t){return e.floor(t.toNumber())},BigNumber:function(e){return nG(e,r(e),n.relTol,n.absTol)?r(e):e.floor()},"BigNumber, BigNumber":function(e,t){return nG(e,r(e,t),n.relTol,n.absTol)?r(e,t):e.toDecimalPlaces(t.toNumber(),xq.ROUND_FLOOR)},Fraction:function(e){return e.floor()},"Fraction, number":function(e,t){return e.floor(t)},"Fraction, BigNumber":function(e,t){return e.floor(t.toNumber())},"Unit, number, Unit":t.referToSelf((e=>function(t,n,r){var a=t.toNumeric(r);return r.multiply(e(a,n))})),"Unit, BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>e(t,n.toNumber(),r))),"Array | Matrix, number | BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>Hj(t,(t=>e(t,n,r)),!0))),"Array | Matrix | Unit, Unit":t.referToSelf((e=>(t,n)=>e(t,0,n))),"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e,!0))),"Array, number | BigNumber":t.referToSelf((e=>(t,n)=>Hj(t,(t=>e(t,n)),!0))),"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>u(t,n,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>l(t,n,e,!1))),"number | Complex | Fraction | BigNumber, Array":t.referToSelf((e=>(t,n)=>l(a(n),t,e,!0).valueOf())),"number | Complex | Fraction | BigNumber, Matrix":t.referToSelf((e=>(t,n)=>i(t,0)?o(n.size(),n.storage()):"dense"===n.storage()?l(n,t,e,!0):c(n,t,e,!0)))})})),VH=ZU("matAlgo02xDS0",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return function(e,r,a,i){var o=e._data,s=e._size,u=e._datatype||e.getDataType(),c=r._values,l=r._index,p=r._ptr,h=r._size,d=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(s.length!==h.length)throw new PP(s.length,h.length);if(s[0]!==h[0]||s[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+h+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var f,m=s[0],g=s[1],y=n,v=0,b=a;"string"===typeof u&&u===d&&"mixed"!==u&&(f=u,y=t.find(n,[f,f]),v=t.convert(0,f),b=t.find(a,[f,f]));for(var x=[],w=[],N=[],S=0;S<g;S++){N[S]=w.length;for(var k=p[S],E=p[S+1],C=k;C<E;C++){var T=l[C],D=i?b(c[C],o[T][S]):b(o[T][S],c[C]);y(D,v)||(w.push(T),x.push(D))}}return N[g]=w.length,r.createSparseMatrix({values:x,index:w,ptr:N,size:[m,g],datatype:u===e._datatype&&d===r._datatype?f:void 0})}})),qH=ZU("matAlgo03xDSf",["typed"],(e=>{var{typed:t}=e;return function(e,n,r,a){var i=e._data,o=e._size,s=e._datatype||e.getDataType(),u=n._values,c=n._index,l=n._ptr,p=n._size,h=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(o.length!==p.length)throw new PP(o.length,p.length);if(o[0]!==p[0]||o[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+p+")");if(!u)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d,f=o[0],m=o[1],g=0,y=r;"string"===typeof s&&s===h&&"mixed"!==s&&(d=s,g=t.convert(0,d),y=t.find(r,[d,d]));for(var v=[],b=0;b<f;b++)v[b]=[];for(var x=[],w=[],N=0;N<m;N++){for(var S=N+1,k=l[N],E=l[N+1],C=k;C<E;C++){var T=c[C];x[T]=a?y(u[C],i[T][N]):y(i[T][N],u[C]),w[T]=S}for(var D=0;D<f;D++)w[D]===S?v[D][N]=x[D]:v[D][N]=a?y(g,i[D][N]):y(i[D][N],g)}return e.createDenseMatrix({data:v,size:[f,m],datatype:s===e._datatype&&h===n._datatype?d:void 0})}})),jH=ZU("matAlgo05xSfSf",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return function(e,r,a){var i=e._values,o=e._index,s=e._ptr,u=e._size,c=e._datatype||void 0===e._data?e._datatype:e.getDataType(),l=r._values,p=r._index,h=r._ptr,d=r._size,f=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(u.length!==d.length)throw new PP(u.length,d.length);if(u[0]!==d[0]||u[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+d+")");var m,g=u[0],y=u[1],v=n,b=0,x=a;"string"===typeof c&&c===f&&"mixed"!==c&&(m=c,v=t.find(n,[m,m]),b=t.convert(0,m),x=t.find(a,[m,m]));var w,N,S,k,E=i&&l?[]:void 0,C=[],T=[],D=E?[]:void 0,I=E?[]:void 0,A=[],F=[];for(N=0;N<y;N++){T[N]=C.length;var _=N+1;for(S=s[N],k=s[N+1];S<k;S++)w=o[S],C.push(w),A[w]=_,D&&(D[w]=i[S]);for(S=h[N],k=h[N+1];S<k;S++)A[w=p[S]]!==_&&C.push(w),F[w]=_,I&&(I[w]=l[S]);if(E)for(S=T[N];S<C.length;){var M=A[w=C[S]],O=F[w];if(M===_||O===_){var R=x(M===_?D[w]:b,O===_?I[w]:b);v(R,b)?C.splice(S,1):(E.push(R),S++)}}}return T[y]=C.length,e.createSparseMatrix({values:E,index:C,ptr:T,size:[g,y],datatype:c===e._datatype&&f===r._datatype?m:void 0})}})),GH=ZU("matAlgo13xDD",["typed"],(e=>{var{typed:t}=e;return function(e,r,a){var i,o=e._data,s=e._size,u=e._datatype,c=r._data,l=r._size,p=r._datatype,h=[];if(s.length!==l.length)throw new PP(s.length,l.length);for(var d=0;d<s.length;d++){if(s[d]!==l[d])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+l+")");h[d]=s[d]}var f=a;"string"===typeof u&&u===p&&(i=u,f=t.find(a,[i,i]));var m=h.length>0?n(f,0,h,h[0],o,c):[];return e.createDenseMatrix({data:m,size:h,datatype:i})};function n(e,t,r,a,i,o){var s=[];if(t===r.length-1)for(var u=0;u<a;u++)s[u]=e(i[u],o[u]);else for(var c=0;c<a;c++)s[c]=n(e,t+1,r,r[t+1],i[c],o[c]);return s}}));function HH(e,t){if(HU(e.size(),t.size()))return[e,t];var n=Mj(e.size(),t.size());return[e,t].map((e=>function(e,t){if(HU(e.size(),t))return e;return e.create(Rj(e.valueOf(),t),e.datatype())}(e,n)))}var KH=ZU("matrixAlgorithmSuite",["typed","matrix"],(e=>{var{typed:t,matrix:n}=e,r=GH({typed:t}),a=kH({typed:t});return function(e){var i,o=e.elop,s=e.SD||e.DS;o?(i={"DenseMatrix, DenseMatrix":(e,t)=>r(...HH(e,t),o),"Array, Array":(e,t)=>r(...HH(n(e),n(t)),o).valueOf(),"Array, DenseMatrix":(e,t)=>r(...HH(n(e),t),o),"DenseMatrix, Array":(e,t)=>r(...HH(e,n(t)),o)},e.SS&&(i["SparseMatrix, SparseMatrix"]=(t,n)=>e.SS(...HH(t,n),o,!1)),e.DS&&(i["DenseMatrix, SparseMatrix"]=(t,n)=>e.DS(...HH(t,n),o,!1),i["Array, SparseMatrix"]=(t,r)=>e.DS(...HH(n(t),r),o,!1)),s&&(i["SparseMatrix, DenseMatrix"]=(e,t)=>s(...HH(t,e),o,!0),i["SparseMatrix, Array"]=(e,t)=>s(...HH(n(t),e),o,!0))):(i={"DenseMatrix, DenseMatrix":t.referToSelf((e=>(t,n)=>r(...HH(t,n),e))),"Array, Array":t.referToSelf((e=>(t,a)=>r(...HH(n(t),n(a)),e).valueOf())),"Array, DenseMatrix":t.referToSelf((e=>(t,a)=>r(...HH(n(t),a),e))),"DenseMatrix, Array":t.referToSelf((e=>(t,a)=>r(...HH(t,n(a)),e)))},e.SS&&(i["SparseMatrix, SparseMatrix"]=t.referToSelf((t=>(n,r)=>e.SS(...HH(n,r),t,!1)))),e.DS&&(i["DenseMatrix, SparseMatrix"]=t.referToSelf((t=>(n,r)=>e.DS(...HH(n,r),t,!1))),i["Array, SparseMatrix"]=t.referToSelf((t=>(r,a)=>e.DS(...HH(n(r),a),t,!1)))),s&&(i["SparseMatrix, DenseMatrix"]=t.referToSelf((e=>(t,n)=>s(...HH(n,t),e,!0))),i["SparseMatrix, Array"]=t.referToSelf((e=>(t,r)=>s(...HH(n(r),t),e,!0)))));var u=e.scalar||"any";(e.Ds||e.Ss)&&(o?(i["DenseMatrix,"+u]=(e,t)=>a(e,t,o,!1),i[u+", DenseMatrix"]=(e,t)=>a(t,e,o,!0),i["Array,"+u]=(e,t)=>a(n(e),t,o,!1).valueOf(),i[u+", Array"]=(e,t)=>a(n(t),e,o,!0).valueOf()):(i["DenseMatrix,"+u]=t.referToSelf((e=>(t,n)=>a(t,n,e,!1))),i[u+", DenseMatrix"]=t.referToSelf((e=>(t,n)=>a(n,t,e,!0))),i["Array,"+u]=t.referToSelf((e=>(t,r)=>a(n(t),r,e,!1).valueOf())),i[u+", Array"]=t.referToSelf((e=>(t,r)=>a(n(r),t,e,!0).valueOf()))));var c=void 0!==e.sS?e.sS:e.Ss;return o?(e.Ss&&(i["SparseMatrix,"+u]=(t,n)=>e.Ss(t,n,o,!1)),c&&(i[u+", SparseMatrix"]=(e,t)=>c(t,e,o,!0))):(e.Ss&&(i["SparseMatrix,"+u]=t.referToSelf((t=>(n,r)=>e.Ss(n,r,t,!1)))),c&&(i[u+", SparseMatrix"]=t.referToSelf((e=>(t,n)=>c(n,t,e,!0))))),o&&o.signatures&&jU(i,o.signatures),i}})),XH=ZU("mod",["typed","config","round","matrix","equalScalar","zeros","DenseMatrix","concat"],(e=>{var{typed:t,config:n,round:r,matrix:a,equalScalar:i,zeros:o,DenseMatrix:s,concat:u}=e,c=WH({typed:t,config:n,round:r,matrix:a,equalScalar:i,zeros:o,DenseMatrix:s}),l=VH({typed:t,equalScalar:i}),p=qH({typed:t}),h=jH({typed:t,equalScalar:i}),d=NH({typed:t,equalScalar:i}),f=SH({typed:t,DenseMatrix:s});return t("mod",{"number, number":function(e,t){return 0===t?e:e-t*c(e/t)},"BigNumber, BigNumber":function(e,t){return t.isZero()?e:e.sub(t.mul(c(e.div(t))))},"bigint, bigint":function(e,t){if(0n===t)return e;if(e<0){var n=e%t;return 0n===n?n:n+t}return e%t},"Fraction, Fraction":function(e,t){return t.equals(0)?e:e.sub(t.mul(c(e.div(t))))}},KH({typed:t,matrix:a,concat:u})({SS:h,DS:p,SD:l,Ss:d,sS:f}))})),YH=ZU("matAlgo01xDSid",["typed"],(e=>{var{typed:t}=e;return function(e,n,r,a){var i=e._data,o=e._size,s=e._datatype||e.getDataType(),u=n._values,c=n._index,l=n._ptr,p=n._size,h=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(o.length!==p.length)throw new PP(o.length,p.length);if(o[0]!==p[0]||o[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+p+")");if(!u)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d,f,m=o[0],g=o[1],y="string"===typeof s&&"mixed"!==s&&s===h?s:void 0,v=y?t.find(r,[y,y]):r,b=[];for(d=0;d<m;d++)b[d]=[];var x=[],w=[];for(f=0;f<g;f++){for(var N=f+1,S=l[f],k=l[f+1],E=S;E<k;E++)x[d=c[E]]=a?v(u[E],i[d][f]):v(i[d][f],u[E]),w[d]=N;for(d=0;d<m;d++)w[d]===N?b[d][f]=x[d]:b[d][f]=i[d][f]}return e.createDenseMatrix({data:b,size:[m,g],datatype:s===e._datatype&&h===n._datatype?y:void 0})}})),$H=ZU("matAlgo04xSidSid",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return function(e,r,a){var i=e._values,o=e._index,s=e._ptr,u=e._size,c=e._datatype||void 0===e._data?e._datatype:e.getDataType(),l=r._values,p=r._index,h=r._ptr,d=r._size,f=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(u.length!==d.length)throw new PP(u.length,d.length);if(u[0]!==d[0]||u[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+d+")");var m,g=u[0],y=u[1],v=n,b=0,x=a;"string"===typeof c&&c===f&&"mixed"!==c&&(m=c,v=t.find(n,[m,m]),b=t.convert(0,m),x=t.find(a,[m,m]));var w,N,S,k,E,C=i&&l?[]:void 0,T=[],D=[],I=i&&l?[]:void 0,A=i&&l?[]:void 0,F=[],_=[];for(N=0;N<y;N++){D[N]=T.length;var M=N+1;for(k=s[N],E=s[N+1],S=k;S<E;S++)w=o[S],T.push(w),F[w]=M,I&&(I[w]=i[S]);for(k=h[N],E=h[N+1],S=k;S<E;S++)if(F[w=p[S]]===M){if(I){var O=x(I[w],l[S]);v(O,b)?F[w]=null:I[w]=O}}else T.push(w),_[w]=M,A&&(A[w]=l[S]);if(I&&A)for(S=D[N];S<T.length;)F[w=T[S]]===M?(C[S]=I[w],S++):_[w]===M?(C[S]=A[w],S++):T.splice(S,1)}return D[y]=T.length,e.createSparseMatrix({values:C,index:T,ptr:D,size:[g,y],datatype:c===e._datatype&&f===r._datatype?m:void 0})}})),ZH=ZU("matAlgo10xSids",["typed","DenseMatrix"],(e=>{var{typed:t,DenseMatrix:n}=e;return function(e,r,a,i){var o=e._values,s=e._index,u=e._ptr,c=e._size,l=e._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var p,h=c[0],d=c[1],f=a;"string"===typeof l&&(p=l,r=t.convert(r,p),f=t.find(a,[p,p]));for(var m=[],g=[],y=[],v=0;v<d;v++){for(var b=v+1,x=u[v],w=u[v+1],N=x;N<w;N++){var S=s[N];g[S]=o[N],y[S]=b}for(var k=0;k<h;k++)0===v&&(m[k]=[]),y[k]===b?m[k][v]=i?f(r,g[k]):f(g[k],r):m[k][v]=r}return new n({data:m,size:[h,d],datatype:p})}})),QH=["typed","config","round","matrix","equalScalar","zeros","BigNumber","DenseMatrix","concat"],JH="number | BigNumber | Fraction | Matrix | Array",eK="".concat(JH,", ").concat(JH,", ...").concat(JH);function tK(e){return!e.some((e=>Array.isArray(e)))}var nK=ZU("gcd",QH,(e=>{var{typed:t,matrix:n,config:r,round:a,equalScalar:i,zeros:o,BigNumber:s,DenseMatrix:u,concat:c}=e,l=XH({typed:t,config:r,round:a,matrix:n,equalScalar:i,zeros:o,DenseMatrix:u,concat:c}),p=YH({typed:t}),h=$H({typed:t,equalScalar:i}),d=ZH({typed:t,DenseMatrix:u});return t("gcd",{"number, number":function(e,t){if(!sW(e)||!sW(t))throw new Error("Parameters in function gcd must be integer numbers");var n;for(;0!==t;)n=l(e,t),e=t,t=n;return e<0?-e:e},"BigNumber, BigNumber":function(e,t){if(!e.isInt()||!t.isInt())throw new Error("Parameters in function gcd must be integer numbers");var n=new s(0);for(;!t.isZero();){var r=l(e,t);e=t,t=r}return e.lt(n)?e.neg():e},"Fraction, Fraction":(e,t)=>e.gcd(t)},KH({typed:t,matrix:n,concat:c})({SS:h,DS:p,Ss:d}),{[eK]:t.referToSelf((e=>(t,n,r)=>{for(var a=e(t,n),i=0;i<r.length;i++)a=e(a,r[i]);return a})),Array:t.referToSelf((e=>t=>{if(1===t.length&&Array.isArray(t[0])&&tK(t[0]))return e(...t[0]);if(tK(t))return e(...t);throw new LP("gcd() supports only 1d matrices!")})),Matrix:t.referToSelf((e=>t=>e(t.toArray())))})})),rK=ZU("matAlgo06xS0S0",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return function(e,r,a){var i=e._values,o=e._size,s=e._datatype||void 0===e._data?e._datatype:e.getDataType(),u=r._values,c=r._size,l=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(o.length!==c.length)throw new PP(o.length,c.length);if(o[0]!==c[0]||o[1]!==c[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+c+")");var p,h=o[0],d=o[1],f=n,m=0,g=a;"string"===typeof s&&s===l&&"mixed"!==s&&(p=s,f=t.find(n,[p,p]),m=t.convert(0,p),g=t.find(a,[p,p]));for(var y=i&&u?[]:void 0,v=[],b=[],x=y?[]:void 0,w=[],N=[],S=0;S<d;S++){b[S]=v.length;var k=S+1;if(Yj(e,S,w,x,N,k,v,g),Yj(r,S,w,x,N,k,v,g),x)for(var E=b[S];E<v.length;){var C=v[E];if(N[C]===k){var T=x[C];f(T,m)?v.splice(E,1):(y.push(T),E++)}else v.splice(E,1)}else for(var D=b[S];D<v.length;){N[v[D]]!==k?v.splice(D,1):D++}}return b[d]=v.length,e.createSparseMatrix({values:y,index:v,ptr:b,size:[h,d],datatype:s===e._datatype&&l===r._datatype?p:void 0})}})),aK=ZU("lcm",["typed","matrix","equalScalar","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,concat:a}=e,i=VH({typed:t,equalScalar:r}),o=rK({typed:t,equalScalar:r}),s=NH({typed:t,equalScalar:r}),u=KH({typed:t,matrix:n,concat:a}),c="number | BigNumber | Fraction | Matrix | Array",l={};return l["".concat(c,", ").concat(c,", ...").concat(c)]=t.referToSelf((e=>(t,n,r)=>{for(var a=e(t,n),i=0;i<r.length;i++)a=e(a,r[i]);return a})),t("lcm",{"number, number":QG,"BigNumber, BigNumber":function(e,t){if(!e.isInt()||!t.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(e.isZero())return e;if(t.isZero())return t;var n=e.times(t);for(;!t.isZero();){var r=t;t=e.mod(r),e=r}return n.div(e).abs()},"Fraction, Fraction":(e,t)=>e.lcm(t)},u({SS:o,DS:i,Ss:s}),l)}));function iK(e,t,n,r){return function(a){if(a>0||n.predictable){if(a<=0)return NaN;var i=a.toString(16),o=i.substring(0,15);return e*(i.length-o.length)+t(Number("0x"+o))}return r(a.toNumber())}}var oK="log10",sK=["typed","config","Complex"],uK=eH(16),cK=ZU(oK,sK,(e=>{var{typed:t,config:n,Complex:r}=e;function a(e){return e.log().div(Math.LN10)}function i(e){return a(new r(e,0))}return t(oK,{number:function(e){return e>=0||n.predictable?eH(e):i(e)},bigint:iK(uK,eH,n,i),Complex:a,BigNumber:function(e){return!e.isNegative()||n.predictable?e.log():i(e.toNumber())},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),lK="log2",pK=ZU(lK,["typed","config","Complex"],(e=>{var{typed:t,config:n,Complex:r}=e;function a(e){return i(new r(e,0))}return t(lK,{number:function(e){return e>=0||n.predictable?tH(e):a(e)},bigint:iK(4,tH,n,a),Complex:i,BigNumber:function(e){return!e.isNegative()||n.predictable?e.log(2):a(e.toNumber())},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))});function i(e){var t=Math.sqrt(e.re*e.re+e.im*e.im);return new r(Math.log2?Math.log2(t):Math.log(t)/Math.LN2,Math.atan2(e.im,e.re)/Math.LN2)}})),hK=ZU("multiplyScalar",["typed"],(e=>{var{typed:t}=e;return t("multiplyScalar",{"number, number":GG,"Complex, Complex":function(e,t){return e.mul(t)},"BigNumber, BigNumber":function(e,t){return e.times(t)},"bigint, bigint":function(e,t){return e*t},"Fraction, Fraction":function(e,t){return e.mul(t)},"number | Fraction | BigNumber | Complex, Unit":(e,t)=>t.multiply(e),"Unit, number | Fraction | BigNumber | Complex | Unit":(e,t)=>e.multiply(t)})})),dK="multiply",fK=ZU(dK,["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],(e=>{var{typed:t,matrix:n,addScalar:r,multiplyScalar:a,equalScalar:i,dot:o}=e,s=NH({typed:t,equalScalar:i}),u=kH({typed:t});function c(e,t){switch(e.length){case 1:switch(t.length){case 1:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+e[0]+") must match Matrix rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)")}break;case 2:switch(t.length){case 1:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+e[1]+") must match Vector length ("+t[0]+")");break;case 2:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+e[1]+") must match Matrix B rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+e.length+" dimensions)")}}function l(e,n){if("dense"!==n.storage())throw new Error("Support for SparseMatrix not implemented");return function(e,n){var i,o=e._data,s=e._size,u=e._datatype||e.getDataType(),c=n._data,l=n._size,p=n._datatype||n.getDataType(),h=s[0],d=l[1],f=r,m=a;u&&p&&u===p&&"string"===typeof u&&"mixed"!==u&&(i=u,f=t.find(r,[i,i]),m=t.find(a,[i,i]));for(var g=[],y=0;y<d;y++){for(var v=m(o[0],c[0][y]),b=1;b<h;b++)v=f(v,m(o[b],c[b][y]));g[y]=v}return e.createDenseMatrix({data:g,size:[d],datatype:u===e._datatype&&p===n._datatype?i:void 0})}(e,n)}var p=t("_multiplyMatrixVector",{"DenseMatrix, any":function(e,n){var i,o=e._data,s=e._size,u=e._datatype||e.getDataType(),c=n._data,l=n._datatype||n.getDataType(),p=s[0],h=s[1],d=r,f=a;u&&l&&u===l&&"string"===typeof u&&"mixed"!==u&&(i=u,d=t.find(r,[i,i]),f=t.find(a,[i,i]));for(var m=[],g=0;g<p;g++){for(var y=o[g],v=f(y[0],c[0]),b=1;b<h;b++)v=d(v,f(y[b],c[b]));m[g]=v}return e.createDenseMatrix({data:m,size:[p],datatype:u===e._datatype&&l===n._datatype?i:void 0})},"SparseMatrix, any":function(e,n){var o=e._values,s=e._index,u=e._ptr,c=e._datatype||void 0===e._data?e._datatype:e.getDataType();if(!o)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var l,p=n._data,h=n._datatype||n.getDataType(),d=e._size[0],f=n._size[0],m=[],g=[],y=[],v=r,b=a,x=i,w=0;c&&h&&c===h&&"string"===typeof c&&"mixed"!==c&&(l=c,v=t.find(r,[l,l]),b=t.find(a,[l,l]),x=t.find(i,[l,l]),w=t.convert(0,l));var N=[],S=[];y[0]=0;for(var k=0;k<f;k++){var E=p[k];if(!x(E,w))for(var C=u[k],T=u[k+1],D=C;D<T;D++){var I=s[D];S[I]?N[I]=v(N[I],b(E,o[D])):(S[I]=!0,g.push(I),N[I]=b(E,o[D]))}}for(var A=g.length,F=0;F<A;F++){var _=g[F];m[F]=N[_]}return y[1]=g.length,e.createSparseMatrix({values:m,index:g,ptr:y,size:[d,1],datatype:c===e._datatype&&h===n._datatype?l:void 0})}}),h=t("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function(e,n){var i,o=e._data,s=e._size,u=e._datatype||e.getDataType(),c=n._data,l=n._size,p=n._datatype||n.getDataType(),h=s[0],d=s[1],f=l[1],m=r,g=a;u&&p&&u===p&&"string"===typeof u&&"mixed"!==u&&"mixed"!==u&&(i=u,m=t.find(r,[i,i]),g=t.find(a,[i,i]));for(var y=[],v=0;v<h;v++){var b=o[v];y[v]=[];for(var x=0;x<f;x++){for(var w=g(b[0],c[0][x]),N=1;N<d;N++)w=m(w,g(b[N],c[N][x]));y[v][x]=w}}return e.createDenseMatrix({data:y,size:[h,f],datatype:u===e._datatype&&p===n._datatype?i:void 0})},"DenseMatrix, SparseMatrix":function(e,n){var o=e._data,s=e._size,u=e._datatype||e.getDataType(),c=n._values,l=n._index,p=n._ptr,h=n._size,d=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(!c)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var f,m=s[0],g=h[1],y=r,v=a,b=i,x=0;u&&d&&u===d&&"string"===typeof u&&"mixed"!==u&&(f=u,y=t.find(r,[f,f]),v=t.find(a,[f,f]),b=t.find(i,[f,f]),x=t.convert(0,f));for(var w=[],N=[],S=[],k=n.createSparseMatrix({values:w,index:N,ptr:S,size:[m,g],datatype:u===e._datatype&&d===n._datatype?f:void 0}),E=0;E<g;E++){S[E]=N.length;var C=p[E],T=p[E+1];if(T>C)for(var D=0,I=0;I<m;I++){for(var A=I+1,F=void 0,_=C;_<T;_++){var M=l[_];D!==A?(F=v(o[I][M],c[_]),D=A):F=y(F,v(o[I][M],c[_]))}D!==A||b(F,x)||(N.push(I),w.push(F))}}return S[g]=N.length,k},"SparseMatrix, DenseMatrix":function(e,n){var o=e._values,s=e._index,u=e._ptr,c=e._datatype||void 0===e._data?e._datatype:e.getDataType();if(!o)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var l,p=n._data,h=n._datatype||n.getDataType(),d=e._size[0],f=n._size[0],m=n._size[1],g=r,y=a,v=i,b=0;c&&h&&c===h&&"string"===typeof c&&"mixed"!==c&&(l=c,g=t.find(r,[l,l]),y=t.find(a,[l,l]),v=t.find(i,[l,l]),b=t.convert(0,l));for(var x=[],w=[],N=[],S=e.createSparseMatrix({values:x,index:w,ptr:N,size:[d,m],datatype:c===e._datatype&&h===n._datatype?l:void 0}),k=[],E=[],C=0;C<m;C++){N[C]=w.length;for(var T=C+1,D=0;D<f;D++){var I=p[D][C];if(!v(I,b))for(var A=u[D],F=u[D+1],_=A;_<F;_++){var M=s[_];E[M]!==T?(E[M]=T,w.push(M),k[M]=y(I,o[_])):k[M]=g(k[M],y(I,o[_]))}}for(var O=N[C],R=w.length,z=O;z<R;z++){var B=w[z];x[z]=k[B]}}return N[m]=w.length,S},"SparseMatrix, SparseMatrix":function(e,n){var i,o=e._values,s=e._index,u=e._ptr,c=e._datatype||void 0===e._data?e._datatype:e.getDataType(),l=n._values,p=n._index,h=n._ptr,d=n._datatype||void 0===n._data?n._datatype:n.getDataType(),f=e._size[0],m=n._size[1],g=o&&l,y=r,v=a;c&&d&&c===d&&"string"===typeof c&&"mixed"!==c&&(i=c,y=t.find(r,[i,i]),v=t.find(a,[i,i]));for(var b,x,w,N,S,k,E,C,T=g?[]:void 0,D=[],I=[],A=e.createSparseMatrix({values:T,index:D,ptr:I,size:[f,m],datatype:c===e._datatype&&d===n._datatype?i:void 0}),F=g?[]:void 0,_=[],M=0;M<m;M++){I[M]=D.length;var O=M+1;for(S=h[M],k=h[M+1],N=S;N<k;N++)if(C=p[N],g)for(x=u[C],w=u[C+1],b=x;b<w;b++)_[E=s[b]]!==O?(_[E]=O,D.push(E),F[E]=v(l[N],o[b])):F[E]=y(F[E],v(l[N],o[b]));else for(x=u[C],w=u[C+1],b=x;b<w;b++)_[E=s[b]]!==O&&(_[E]=O,D.push(E));if(g)for(var R=I[M],z=D.length,B=R;B<z;B++){var L=D[B];T[B]=F[L]}}return I[m]=D.length,A}});return t(dK,a,{"Array, Array":t.referTo("Matrix, Matrix",(e=>(t,r)=>{c(uj(t),uj(r));var a=e(n(t),n(r));return oU(a)?a.valueOf():a})),"Matrix, Matrix":function(e,t){var n=e.size(),r=t.size();return c(n,r),1===n.length?1===r.length?function(e,t,n){if(0===n)throw new Error("Cannot multiply two empty vectors");return o(e,t)}(e,t,n[0]):l(e,t):1===r.length?p(e,t):h(e,t)},"Matrix, Array":t.referTo("Matrix,Matrix",(e=>(t,r)=>e(t,n(r)))),"Array, Matrix":t.referToSelf((e=>(t,r)=>e(n(t,r.storage()),r))),"SparseMatrix, any":function(e,t){return s(e,t,a,!1)},"DenseMatrix, any":function(e,t){return u(e,t,a,!1)},"any, SparseMatrix":function(e,t){return s(t,e,a,!0)},"any, DenseMatrix":function(e,t){return u(t,e,a,!0)},"Array, any":function(e,t){return u(n(e),t,a,!1).valueOf()},"any, Array":function(e,t){return u(n(t),e,a,!0).valueOf()},"any, any":a,"any, any, ...any":t.referToSelf((e=>(t,n,r)=>{for(var a=e(t,n),i=0;i<r.length;i++)a=e(a,r[i]);return a}))})})),mK="nthRoot",gK=ZU(mK,["typed","matrix","equalScalar","BigNumber","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,BigNumber:a,concat:i}=e,o=YH({typed:t}),s=VH({typed:t,equalScalar:r}),u=rK({typed:t,equalScalar:r}),c=NH({typed:t,equalScalar:r}),l=KH({typed:t,matrix:n,concat:i});function p(){throw new Error("Complex number not supported in function nthRoot. Use nthRoots instead.")}return t(mK,{number:nH,"number, number":nH,BigNumber:e=>h(e,new a(2)),"BigNumber, BigNumber":h,Complex:p,"Complex, number":p,Array:t.referTo("DenseMatrix,number",(e=>t=>e(n(t),2).valueOf())),DenseMatrix:t.referTo("DenseMatrix,number",(e=>t=>e(t,2))),SparseMatrix:t.referTo("SparseMatrix,number",(e=>t=>e(t,2))),"SparseMatrix, SparseMatrix":t.referToSelf((e=>(t,n)=>{if(1===n.density())return u(t,n,e);throw new Error("Root must be non-zero")})),"DenseMatrix, SparseMatrix":t.referToSelf((e=>(t,n)=>{if(1===n.density())return o(t,n,e,!1);throw new Error("Root must be non-zero")})),"Array, SparseMatrix":t.referTo("DenseMatrix,SparseMatrix",(e=>(t,r)=>e(n(t),r))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,n)=>{if(1===n.density())return c(n,t,e,!0);throw new Error("Root must be non-zero")}))},l({scalar:"number | BigNumber",SD:s,Ss:c,sS:!1}));function h(e,t){var n=a.precision,r=a.clone({precision:n+2}),i=new a(0),o=new r(1),s=t.isNegative();if(s&&(t=t.neg()),t.isZero())throw new Error("Root must be non-zero");if(e.isNegative()&&!t.abs().mod(2).equals(1))throw new Error("Root must be odd when a is negative.");if(e.isZero())return s?new r(1/0):0;if(!e.isFinite())return s?i:e;var u=e.abs().pow(o.div(t));return u=e.isNeg()?u.neg():u,new a((s?o.div(u):u).toPrecision(n))}})),yK="sign",vK=ZU(yK,["typed","BigNumber","Fraction","complex"],(e=>{var{typed:t,BigNumber:n,complex:r,Fraction:a}=e;return t(yK,{number:rH,Complex:function(e){return 0===e.im?r(rH(e.re)):e.sign()},BigNumber:function(e){return new n(e.cmp(0))},bigint:function(e){return e>0n?1n:e<0n?-1n:0n},Fraction:function(e){return new a(e.s)},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e,!0))),Unit:t.referToSelf((e=>n=>{if(!n._isDerived()&&0!==n.units[0].unit.offset)throw new TypeError("sign is ambiguous for units with offset");return t.find(e,n.valueType())(n.value)}))})})),bK=ZU("sqrt",["config","typed","Complex"],(e=>{var{config:t,typed:n,Complex:r}=e;return n("sqrt",{number:a,Complex:function(e){return e.sqrt()},BigNumber:function(e){return!e.isNegative()||t.predictable?e.sqrt():a(e.toNumber())},Unit:function(e){return e.pow(.5)}});function a(e){return isNaN(e)?NaN:e>=0||t.predictable?Math.sqrt(e):new r(e,0).sqrt()}})),xK="square",wK=ZU(xK,["typed"],(e=>{var{typed:t}=e;return t(xK,{number:aH,Complex:function(e){return e.mul(e)},BigNumber:function(e){return e.times(e)},bigint:function(e){return e*e},Fraction:function(e){return e.mul(e)},Unit:function(e){return e.pow(2)}})})),NK="subtract",SK=ZU(NK,["typed","matrix","equalScalar","subtractScalar","unaryMinus","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,subtractScalar:a,unaryMinus:i,DenseMatrix:o,concat:s}=e,u=YH({typed:t}),c=qH({typed:t}),l=jH({typed:t,equalScalar:r}),p=ZH({typed:t,DenseMatrix:o}),h=SH({typed:t,DenseMatrix:o}),d=KH({typed:t,matrix:n,concat:s});return t(NK,{"any, any":a},d({elop:a,SS:l,DS:u,SD:c,Ss:h,sS:p}))})),kK="xgcd",EK=ZU(kK,["typed","config","matrix","BigNumber"],(e=>{var{typed:t,config:n,matrix:r,BigNumber:a}=e;return t(kK,{"number, number":function(e,t){var a=iH(e,t);return"Array"===n.matrix?a:r(a)},"BigNumber, BigNumber":function(e,t){var i,o,s,u,c=new a(0),l=new a(1),p=c,h=l,d=l,f=c;if(!e.isInt()||!t.isInt())throw new Error("Parameters in function xgcd must be integer numbers");for(;!t.isZero();)o=e.div(t).floor(),s=e.mod(t),i=p,p=h.minus(o.times(p)),h=i,i=d,d=f.minus(o.times(d)),f=i,e=t,t=s;u=e.lt(c)?[e.neg(),h.neg(),f.neg()]:[e,e.isZero()?0:h,f];return"Array"===n.matrix?u:r(u)}})})),CK="invmod",TK=ZU(CK,["typed","config","BigNumber","xgcd","equal","smaller","mod","add","isInteger"],(e=>{var{typed:t,config:n,BigNumber:r,xgcd:a,equal:i,smaller:o,mod:s,add:u,isInteger:c}=e;return t(CK,{"number, number":l,"BigNumber, BigNumber":l});function l(e,t){if(!c(e)||!c(t))throw new Error("Parameters in function invmod must be integer numbers");if(e=s(e,t),i(t,0))throw new Error("Divisor must be non zero");var n=a(e,t);n=n.valueOf();var[l,p]=n;return i(l,r(1))?(p=s(p,t),o(p,r(0))&&(p=u(p,t)),p):NaN}})),DK=ZU("matAlgo09xS0Sf",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return function(e,r,a){var i=e._values,o=e._index,s=e._ptr,u=e._size,c=e._datatype||void 0===e._data?e._datatype:e.getDataType(),l=r._values,p=r._index,h=r._ptr,d=r._size,f=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(u.length!==d.length)throw new PP(u.length,d.length);if(u[0]!==d[0]||u[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+d+")");var m,g=u[0],y=u[1],v=n,b=0,x=a;"string"===typeof c&&c===f&&"mixed"!==c&&(m=c,v=t.find(n,[m,m]),b=t.convert(0,m),x=t.find(a,[m,m]));var w,N,S,k,E,C=i&&l?[]:void 0,T=[],D=[],I=C?[]:void 0,A=[];for(N=0;N<y;N++){D[N]=T.length;var F=N+1;if(I)for(k=h[N],E=h[N+1],S=k;S<E;S++)A[w=p[S]]=F,I[w]=l[S];for(k=s[N],E=s[N+1],S=k;S<E;S++)if(w=o[S],I){var _=A[w]===F?I[w]:b,M=x(i[S],_);v(M,b)||(T.push(w),C.push(M))}else T.push(w)}return D[y]=T.length,e.createSparseMatrix({values:C,index:T,ptr:D,size:[g,y],datatype:c===e._datatype&&f===r._datatype?m:void 0})}})),IK="dotMultiply",AK=ZU(IK,["typed","matrix","equalScalar","multiplyScalar","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,multiplyScalar:a,concat:i}=e,o=VH({typed:t,equalScalar:r}),s=DK({typed:t,equalScalar:r}),u=NH({typed:t,equalScalar:r}),c=KH({typed:t,matrix:n,concat:i});return t(IK,c({elop:a,SS:s,DS:o,Ss:u}))}));function FK(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitAnd");var n=e.constructor;if(e.isNaN()||t.isNaN())return new n(NaN);if(e.isZero()||t.eq(-1)||e.eq(t))return e;if(t.isZero()||e.eq(-1))return t;if(!e.isFinite()||!t.isFinite()){if(!e.isFinite()&&!t.isFinite())return e.isNegative()===t.isNegative()?e:new n(0);if(!e.isFinite())return t.isNegative()?e:e.isNegative()?new n(0):t;if(!t.isFinite())return e.isNegative()?t:t.isNegative()?new n(0):e}return OK(e,t,(function(e,t){return e&t}))}function _K(e){if(e.isFinite()&&!e.isInteger())throw new Error("Integer expected in function bitNot");var t=e.constructor,n=t.precision;t.config({precision:1e9});var r=e.plus(new t(1));return r.s=-r.s||null,t.config({precision:n}),r}function MK(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitOr");var n=e.constructor;if(e.isNaN()||t.isNaN())return new n(NaN);var r=new n(-1);return e.isZero()||t.eq(r)||e.eq(t)?t:t.isZero()||e.eq(r)?e:e.isFinite()&&t.isFinite()?OK(e,t,(function(e,t){return e|t})):!e.isFinite()&&!e.isNegative()&&t.isNegative()||e.isNegative()&&!t.isNegative()&&!t.isFinite()?r:e.isNegative()&&t.isNegative()?e.isFinite()?e:t:e.isFinite()?t:e}function OK(e,t,n){var r,a,i,o,s,u=e.constructor,c=+(e.s<0),l=+(t.s<0);if(c){r=RK(_K(e));for(var p=0;p<r.length;++p)r[p]^=1}else r=RK(e);if(l){a=RK(_K(t));for(var h=0;h<a.length;++h)a[h]^=1}else a=RK(t);r.length<=a.length?(i=r,o=a,s=c):(i=a,o=r,s=l);var d=i.length,f=o.length,m=1^n(c,l),g=new u(1^m),y=new u(1),v=new u(2),b=u.precision;for(u.config({precision:1e9});d>0;)n(i[--d],o[--f])===m&&(g=g.plus(y)),y=y.times(v);for(;f>0;)n(s,o[--f])===m&&(g=g.plus(y)),y=y.times(v);return u.config({precision:b}),0===m&&(g.s=-g.s),g}function RK(e){for(var t=e.d,n=t[0]+"",r=1;r<t.length;++r){for(var a=t[r]+"",i=7-a.length;i--;)a="0"+a;n+=a}for(var o=n.length;"0"===n.charAt(o);)o--;var s=e.e,u=n.slice(0,o+1||1),c=u.length;if(s>0)if(++s>c)for(s-=c;s--;)u+="0";else s<c&&(u=u.slice(0,s)+"."+u.slice(s));for(var l=[0],p=0;p<u.length;){for(var h=l.length;h--;)l[h]*=10;l[0]+=parseInt(u.charAt(p++));for(var d=0;d<l.length;++d)l[d]>1&&(null!==l[d+1]&&void 0!==l[d+1]||(l[d+1]=0),l[d+1]+=l[d]>>1,l[d]&=1)}return l.reverse()}function zK(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitXor");var n=e.constructor;if(e.isNaN()||t.isNaN())return new n(NaN);if(e.isZero())return t;if(t.isZero())return e;if(e.eq(t))return new n(0);var r=new n(-1);return e.eq(r)?_K(t):t.eq(r)?_K(e):e.isFinite()&&t.isFinite()?OK(e,t,(function(e,t){return e^t})):e.isFinite()||t.isFinite()?new n(e.isNegative()===t.isNegative()?1/0:-1/0):r}function BK(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function leftShift");var n=e.constructor;return e.isNaN()||t.isNaN()||t.isNegative()&&!t.isZero()?new n(NaN):e.isZero()||t.isZero()?e:e.isFinite()||t.isFinite()?t.lt(55)?e.times(Math.pow(2,t.toNumber())+""):e.times(new n(2).pow(t)):new n(NaN)}function LK(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function rightArithShift");var n=e.constructor;return e.isNaN()||t.isNaN()||t.isNegative()&&!t.isZero()?new n(NaN):e.isZero()||t.isZero()?e:t.isFinite()?t.lt(55)?e.div(Math.pow(2,t.toNumber())+"").floor():e.div(new n(2).pow(t)).floor():e.isNegative()?new n(-1):e.isFinite()?new n(0):new n(NaN)}var PK="number, number";function UK(e,t){if(!sW(e)||!sW(t))throw new Error("Integers expected in function bitAnd");return e&t}function WK(e){if(!sW(e))throw new Error("Integer expected in function bitNot");return~e}function VK(e,t){if(!sW(e)||!sW(t))throw new Error("Integers expected in function bitOr");return e|t}function qK(e,t){if(!sW(e)||!sW(t))throw new Error("Integers expected in function bitXor");return e^t}function jK(e,t){if(!sW(e)||!sW(t))throw new Error("Integers expected in function leftShift");return e<<t}function GK(e,t){if(!sW(e)||!sW(t))throw new Error("Integers expected in function rightArithShift");return e>>t}function HK(e,t){if(!sW(e)||!sW(t))throw new Error("Integers expected in function rightLogShift");return e>>>t}UK.signature=PK,WK.signature="number",VK.signature=PK,qK.signature=PK,jK.signature=PK,GK.signature=PK,HK.signature=PK;var KK="bitAnd",XK=ZU(KK,["typed","matrix","equalScalar","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,concat:a}=e,i=VH({typed:t,equalScalar:r}),o=rK({typed:t,equalScalar:r}),s=NH({typed:t,equalScalar:r}),u=KH({typed:t,matrix:n,concat:a});return t(KK,{"number, number":UK,"BigNumber, BigNumber":FK,"bigint, bigint":(e,t)=>e&t},u({SS:o,DS:i,Ss:s}))})),YK="bitNot",$K=ZU(YK,["typed"],(e=>{var{typed:t}=e;return t(YK,{number:WK,BigNumber:_K,bigint:e=>~e,"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),ZK="bitOr",QK=ZU(ZK,["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,DenseMatrix:a,concat:i}=e,o=YH({typed:t}),s=$H({typed:t,equalScalar:r}),u=ZH({typed:t,DenseMatrix:a}),c=KH({typed:t,matrix:n,concat:i});return t(ZK,{"number, number":VK,"BigNumber, BigNumber":MK,"bigint, bigint":(e,t)=>e|t},c({SS:s,DS:o,Ss:u}))})),JK=ZU("matAlgo07xSSf",["typed","SparseMatrix"],(e=>{var{typed:t,SparseMatrix:n}=e;return function(e,a,i){var o=e._size,s=e._datatype||void 0===e._data?e._datatype:e.getDataType(),u=a._size,c=a._datatype||void 0===a._data?a._datatype:a.getDataType();if(o.length!==u.length)throw new PP(o.length,u.length);if(o[0]!==u[0]||o[1]!==u[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+u+")");var l,p=o[0],h=o[1],d=0,f=i;"string"===typeof s&&s===c&&"mixed"!==s&&(l=s,d=t.convert(0,l),f=t.find(i,[l,l]));for(var m=[],g=[],y=new Array(h+1).fill(0),v=[],b=[],x=[],w=[],N=0;N<h;N++){var S=N+1,k=0;r(e,N,x,v,S),r(a,N,w,b,S);for(var E=0;E<p;E++){var C=f(x[E]===S?v[E]:d,w[E]===S?b[E]:d);0!==C&&!1!==C&&(g.push(E),m.push(C),k++)}y[N+1]=y[N]+k}return new n({values:m,index:g,ptr:y,size:[p,h],datatype:s===e._datatype&&c===a._datatype?l:void 0})};function r(e,t,n,r,a){for(var i=e._values,o=e._index,s=e._ptr,u=s[t],c=s[t+1];u<c;u++){var l=o[u];n[l]=a,r[l]=i[u]}}})),eX="bitXor",tX=ZU(eX,["typed","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,matrix:n,DenseMatrix:r,concat:a,SparseMatrix:i}=e,o=qH({typed:t}),s=JK({typed:t,SparseMatrix:i}),u=SH({typed:t,DenseMatrix:r}),c=KH({typed:t,matrix:n,concat:a});return t(eX,{"number, number":qK,"BigNumber, BigNumber":zK,"bigint, bigint":(e,t)=>e^t},c({SS:s,DS:o,Ss:u}))})),nX=ZU("arg",["typed"],(e=>{var{typed:t}=e;return t("arg",{number:function(e){return Math.atan2(0,e)},BigNumber:function(e){return e.constructor.atan2(0,e)},Complex:function(e){return e.arg()},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),rX="conj",aX=ZU(rX,["typed"],(e=>{var{typed:t}=e;return t(rX,{"number | BigNumber | Fraction":e=>e,Complex:e=>e.conjugate(),"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),iX=ZU("im",["typed"],(e=>{var{typed:t}=e;return t("im",{number:()=>0,"BigNumber | Fraction":e=>e.mul(0),Complex:e=>e.im,"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),oX=ZU("re",["typed"],(e=>{var{typed:t}=e;return t("re",{"number | BigNumber | Fraction":e=>e,Complex:e=>e.re,"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),sX="number, number";function uX(e){return!e}function cX(e,t){return!(!e&&!t)}function lX(e,t){return!!e!==!!t}function pX(e,t){return!(!e||!t)}uX.signature="number",cX.signature=sX,lX.signature=sX,pX.signature=sX;var hX=ZU("not",["typed"],(e=>{var{typed:t}=e;return t("not",{"null | undefined":()=>!0,number:uX,Complex:function(e){return 0===e.re&&0===e.im},BigNumber:function(e){return e.isZero()||e.isNaN()},bigint:e=>!e,Unit:t.referToSelf((e=>n=>t.find(e,n.valueType())(n.value))),"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),dX=ZU("or",["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,DenseMatrix:a,concat:i}=e,o=qH({typed:t}),s=jH({typed:t,equalScalar:r}),u=SH({typed:t,DenseMatrix:a}),c=KH({typed:t,matrix:n,concat:i});return t("or",{"number, number":cX,"Complex, Complex":function(e,t){return 0!==e.re||0!==e.im||0!==t.re||0!==t.im},"BigNumber, BigNumber":function(e,t){return!e.isZero()&&!e.isNaN()||!t.isZero()&&!t.isNaN()},"bigint, bigint":cX,"Unit, Unit":t.referToSelf((e=>(t,n)=>e(t.value||0,n.value||0)))},c({SS:s,DS:o,Ss:u}))})),fX=ZU("xor",["typed","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,matrix:n,DenseMatrix:r,concat:a,SparseMatrix:i}=e,o=qH({typed:t}),s=JK({typed:t,SparseMatrix:i}),u=SH({typed:t,DenseMatrix:r}),c=KH({typed:t,matrix:n,concat:a});return t("xor",{"number, number":lX,"Complex, Complex":function(e,t){return(0!==e.re||0!==e.im)!==(0!==t.re||0!==t.im)},"bigint, bigint":lX,"BigNumber, BigNumber":function(e,t){return(!e.isZero()&&!e.isNaN())!==(!t.isZero()&&!t.isNaN())},"Unit, Unit":t.referToSelf((e=>(t,n)=>e(t.value||0,n.value||0)))},c({SS:s,DS:o,Ss:u}))})),mX="concat",gX=ZU(mX,["typed","matrix","isInteger"],(e=>{var{typed:t,matrix:n,isInteger:r}=e;return t(mX,{"...Array | Matrix | number | BigNumber":function(e){var t,a,i=e.length,o=-1,s=!1,u=[];for(t=0;t<i;t++){var c=e[t];if(oU(c)&&(s=!0),QP(c)||JP(c)){if(t!==i-1)throw new Error("Dimension must be specified as last argument");if(a=o,o=c.valueOf(),!r(o))throw new TypeError("Integer number expected for dimension");if(o<0||t>0&&o>a)throw new UP(o,a+1)}else{var l=qU(c).valueOf(),p=uj(l);if(u[t]=l,a=o,o=p.length-1,t>0&&o!==a)throw new PP(a+1,o+1)}}if(0===u.length)throw new SyntaxError("At least one matrix expected");for(var h=u.shift();u.length;)h=_j(h,u.shift(),o);return s?n(h):h},"...string":function(e){return e.join("")}})})),yX="column",vX=ZU(yX,["typed","Index","matrix","range"],(e=>{var{typed:t,Index:n,matrix:r,range:a}=e;return t(yX,{"Matrix, number":i,"Array, number":function(e,t){return i(r(qU(e)),t).valueOf()}});function i(e,t){if(2!==e.size().length)throw new Error("Only two dimensional matrix is supported");hj(t,e.size()[1]);var i=a(0,e.size()[0]),o=new n(i,t),s=e.subset(o);return oU(s)?s:r([[s]])}})),bX="count",xX=ZU(bX,["typed","size","prod"],(e=>{var{typed:t,size:n,prod:r}=e;return t(bX,{string:function(e){return e.length},"Matrix | Array":function(e){return r(n(e))}})})),wX="cross",NX=ZU(wX,["typed","matrix","subtract","multiply"],(e=>{var{typed:t,matrix:n,subtract:r,multiply:a}=e;return t(wX,{"Matrix, Matrix":function(e,t){return n(i(e.toArray(),t.toArray()))},"Matrix, Array":function(e,t){return n(i(e.toArray(),t))},"Array, Matrix":function(e,t){return n(i(e,t.toArray()))},"Array, Array":i});function i(e,t){var n=Math.max(uj(e).length,uj(t).length);e=bj(e),t=bj(t);var i=uj(e),o=uj(t);if(1!==i.length||1!==o.length||3!==i[0]||3!==o[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+i.join(", ")+"], B = ["+o.join(", ")+"])");var s=[r(a(e[1],t[2]),a(e[2],t[1])),r(a(e[2],t[0]),a(e[0],t[2])),r(a(e[0],t[1]),a(e[1],t[0]))];return n>1?[s]:s}})),SX="diag",kX=ZU(SX,["typed","matrix","DenseMatrix","SparseMatrix"],(e=>{var{typed:t,matrix:n,DenseMatrix:r,SparseMatrix:a}=e;return t(SX,{Array:function(e){return i(e,0,uj(e),null)},"Array, number":function(e,t){return i(e,t,uj(e),null)},"Array, BigNumber":function(e,t){return i(e,t.toNumber(),uj(e),null)},"Array, string":function(e,t){return i(e,0,uj(e),t)},"Array, number, string":function(e,t,n){return i(e,t,uj(e),n)},"Array, BigNumber, string":function(e,t,n){return i(e,t.toNumber(),uj(e),n)},Matrix:function(e){return i(e,0,e.size(),e.storage())},"Matrix, number":function(e,t){return i(e,t,e.size(),e.storage())},"Matrix, BigNumber":function(e,t){return i(e,t.toNumber(),e.size(),e.storage())},"Matrix, string":function(e,t){return i(e,0,e.size(),t)},"Matrix, number, string":function(e,t,n){return i(e,t,e.size(),n)},"Matrix, BigNumber, string":function(e,t,n){return i(e,t.toNumber(),e.size(),n)}});function i(e,t,i,o){if(!sW(t))throw new TypeError("Second parameter in function diag must be an integer");var s=t>0?t:0,u=t<0?-t:0;switch(i.length){case 1:return function(e,t,n,i,o,s){var u=[i+o,i+s];if(n&&"sparse"!==n&&"dense"!==n)throw new TypeError("Unknown matrix type ".concat(n,'"'));var c="sparse"===n?a.diagonal(u,e,t):r.diagonal(u,e,t);return null!==n?c:c.valueOf()}(e,t,o,i[0],u,s);case 2:return function(e,t,r,a,i,o){if(oU(e)){var s=e.diagonal(t);return null!==r?r!==s.storage()?n(s,r):s:s.valueOf()}for(var u=Math.min(a[0]-i,a[1]-o),c=[],l=0;l<u;l++)c[l]=e[l+i][l+o];return null!==r?n(c):c}(e,t,o,i,u,s)}throw new RangeError("Matrix for function diag must be 2 dimensional")}})),EX=ZU("filter",["typed"],(e=>{var{typed:t}=e;return t("filter",{"Array, function":CX,"Matrix, function":function(e,t){return e.create(CX(e.valueOf(),t),e.datatype())},"Array, RegExp":Cj,"Matrix, RegExp":function(e,t){return e.create(Cj(e.valueOf(),t),e.datatype())}})}));function CX(e,t){var n=Lj(t,e,"filter");return function(e,t){if(1!==uj(e).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(e,t)}(e,(function(e,t,r){return n(e,[t],r)}))}var TX="flatten",DX=ZU(TX,["typed"],(e=>{var{typed:t}=e;return t(TX,{Array:function(e){return Sj(e)},Matrix:function(e){return e.create(Sj(e.toArray()),e.datatype())}})})),IX="forEach",AX=ZU(IX,["typed"],(e=>{var{typed:t}=e;return t(IX,{"Array, function":FX,"Matrix, function":function(e,t){e.forEach(t)}})}));function FX(e,t){Bj(e,[],e,Lj(t,e,IX))}var _X="getMatrixDataType",MX=ZU(_X,["typed"],(e=>{var{typed:t}=e;return t(_X,{Array:function(e){return Aj(e,VU)},Matrix:function(e){return e.getDataType()}})})),OX="identity",RX=ZU(OX,["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],(e=>{var{typed:t,config:n,matrix:r,BigNumber:a,DenseMatrix:i,SparseMatrix:o}=e;return t(OX,{"":function(){return"Matrix"===n.matrix?r([]):[]},string:function(e){return r(e)},"number | BigNumber":function(e){return u(e,e,"Matrix"===n.matrix?"dense":void 0)},"number | BigNumber, string":function(e,t){return u(e,e,t)},"number | BigNumber, number | BigNumber":function(e,t){return u(e,t,"Matrix"===n.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(e,t,n){return u(e,t,n)},Array:function(e){return s(e)},"Array, string":function(e,t){return s(e,t)},Matrix:function(e){return s(e.valueOf(),e.storage())},"Matrix, string":function(e,t){return s(e.valueOf(),t)}});function s(e,t){switch(e.length){case 0:return t?r(t):[];case 1:return u(e[0],e[0],t);case 2:return u(e[0],e[1],t);default:throw new Error("Vector containing two values expected")}}function u(e,t,n){var r=JP(e)||JP(t)?a:null;if(JP(e)&&(e=e.toNumber()),JP(t)&&(t=t.toNumber()),!sW(e)||e<1)throw new Error("Parameters in function identity must be positive integers");if(!sW(t)||t<1)throw new Error("Parameters in function identity must be positive integers");var s=r?new a(1):1,u=r?new r(0):0,c=[e,t];if(n){if("sparse"===n)return o.diagonal(c,s,0,u);if("dense"===n)return i.diagonal(c,s,0,u);throw new TypeError('Unknown matrix type "'.concat(n,'"'))}for(var l=fj([],c,u),p=e<t?e:t,h=0;h<p;h++)l[h][h]=s;return l}})),zX="kron",BX=ZU(zX,["typed","matrix","multiplyScalar"],(e=>{var{typed:t,matrix:n,multiplyScalar:r}=e;return t(zX,{"Matrix, Matrix":function(e,t){return n(a(e.toArray(),t.toArray()))},"Matrix, Array":function(e,t){return n(a(e.toArray(),t))},"Array, Matrix":function(e,t){return n(a(e,t.toArray()))},"Array, Array":a});function a(e,t){if(1===uj(e).length&&(e=[e]),1===uj(t).length&&(t=[t]),uj(e).length>2||uj(t).length>2)throw new RangeError("Vectors with dimensions greater then 2 are not supported expected (Size x = "+JSON.stringify(e.length)+", y = "+JSON.stringify(t.length)+")");var n=[],a=[];return e.map((function(e){return t.map((function(t){return a=[],n.push(a),e.map((function(e){return t.map((function(t){return a.push(r(e,t))}))}))}))}))&&n}})),LX="map",PX=ZU(LX,["typed"],(e=>{var{typed:t}=e;return t(LX,{"Array, function":n,"Matrix, function":function(e,t){return e.map(t)},"Array|Matrix, Array|Matrix, ...Array|Matrix|function":(e,r,a)=>function(e,r){if("function"!==typeof r)throw new Error("Last argument must be a callback function");var a,i=e[0].isMatrix,o=Mj(...e.map((e=>e.isMatrix?e.size():uj(e)))),s=i?(e,t)=>e.get(t):zj,u=i?e.map((t=>t.isMatrix?t.create(Rj(t.toArray(),o),t.datatype()):e[0].create(Rj(t.valueOf(),o)))):e.map((e=>e.isMatrix?Rj(e.toArray(),o):Rj(e,o)));if(t.isTypedFunction(r)){var c=o.map((()=>0)),l=u.map((e=>s(e,c))),p=y(r,l,c,u);a=m(p)}else{var h=e.length,d=g(r,h);a=m(d)}var f=(e,t)=>a([e,...u.slice(1).map((e=>s(e,t)))],t);return i?u[0].map(f):n(u[0],f);function m(e){switch(e){case 0:return e=>r(...e);case 1:return(e,t)=>r(...e,t);case 2:return(e,t)=>r(...e,t,...u)}}function g(e,t){return e.length>t+1?2:e.length===t+1?1:0}function y(e,n,r,a){return null!==t.resolve(e,[...n,r,...a])?2:null!==t.resolve(e,[...n,r])?1:(t.resolve(e,n),0)}}([e,r,...a.slice(0,a.length-1)],a[a.length-1])});function n(e,t){return Bj(e,[],e,Lj(t,e,LX))}})),UX="diff",WX=ZU(UX,["typed","matrix","subtract","number"],(e=>{var{typed:t,matrix:n,subtract:r,number:a}=e;return t(UX,{"Array | Matrix":function(e){return oU(e)?n(o(e.toArray())):o(e)},"Array | Matrix, number":function(e,t){if(!sW(t))throw new RangeError("Dimension must be a whole number");return oU(e)?n(i(e.toArray(),t)):i(e,t)},"Array, BigNumber":t.referTo("Array,number",(e=>(t,n)=>e(t,a(n)))),"Matrix, BigNumber":t.referTo("Matrix,number",(e=>(t,n)=>e(t,a(n))))});function i(e,t){if(oU(e)&&(e=e.toArray()),!Array.isArray(e))throw RangeError("Array/Matrix does not have that many dimensions");if(t>0){var n=[];return e.forEach((e=>{n.push(i(e,t-1))})),n}if(0===t)return o(e);throw RangeError("Cannot have negative dimension")}function o(e){for(var t=[],n=e.length,r=1;r<n;r++)t.push(s(e[r-1],e[r]));return t}function s(e,t){oU(e)&&(e=e.toArray()),oU(t)&&(t=t.toArray());var n=Array.isArray(e),a=Array.isArray(t);if(n&&a)return function(e,t){if(e.length!==t.length)throw RangeError("Not all sub-arrays have the same length");for(var n=[],r=e.length,a=0;a<r;a++)n.push(s(e[a],t[a]));return n}(e,t);if(!n&&!a)return r(t,e);throw TypeError("Cannot calculate difference between 1 array and 1 non-array")}})),VX=ZU("ones",["typed","config","matrix","BigNumber"],(e=>{var{typed:t,config:n,matrix:r,BigNumber:a}=e;return t("ones",{"":function(){return"Array"===n.matrix?i([]):i([],"default")},"...number | BigNumber | string":function(e){if("string"===typeof e[e.length-1]){var t=e.pop();return i(e,t)}return"Array"===n.matrix?i(e):i(e,"default")},Array:i,Matrix:function(e){var t=e.storage();return i(e.valueOf(),t)},"Array | Matrix, string":function(e,t){return i(e.valueOf(),t)}});function i(e,t){var n=function(e){var t=!1;return e.forEach((function(e,n,r){JP(e)&&(t=!0,r[n]=e.toNumber())})),t}(e),i=n?new a(1):1;if(function(e){e.forEach((function(e){if("number"!==typeof e||!sW(e)||e<0)throw new Error("Parameters in function ones must be positive integers")}))}(e),t){var o=r(t);return e.length>0?o.resize(e,i):o}var s=[];return e.length>0?fj(s,e,i):s}}));function qX(){throw new Error('No "bignumber" implementation available')}function jX(){throw new Error('No "fraction" implementation available')}function GX(){throw new Error('No "matrix" implementation available')}var HX="range",KX=ZU(HX,["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],(e=>{var{typed:t,config:n,matrix:r,bignumber:a,smaller:i,smallerEq:o,larger:s,largerEq:u,add:c,isPositive:l}=e;return t(HX,{string:h,"string, boolean":h,"number, number":function(e,t){return p(d(e,t,1,!1))},"number, number, number":function(e,t,n){return p(d(e,t,n,!1))},"number, number, boolean":function(e,t,n){return p(d(e,t,1,n))},"number, number, number, boolean":function(e,t,n,r){return p(d(e,t,n,r))},"BigNumber, BigNumber":function(e,t){return p(d(e,t,new(0,e.constructor)(1),!1))},"BigNumber, BigNumber, BigNumber":function(e,t,n){return p(d(e,t,n,!1))},"BigNumber, BigNumber, boolean":function(e,t,n){return p(d(e,t,new(0,e.constructor)(1),n))},"BigNumber, BigNumber, BigNumber, boolean":function(e,t,n,r){return p(d(e,t,n,r))},"Unit, Unit, Unit":function(e,t,n){return p(d(e,t,n,!1))},"Unit, Unit, Unit, boolean":function(e,t,n,r){return p(d(e,t,n,r))}});function p(e){return"Matrix"===n.matrix?r?r(e):GX():e}function h(e,t){var r=function(e){var t=e.split(":"),n=t.map((function(e){return Number(e)}));if(n.some((function(e){return isNaN(e)})))return null;switch(n.length){case 2:return{start:n[0],end:n[1],step:1};case 3:return{start:n[0],end:n[2],step:n[1]};default:return null}}(e);if(!r)throw new SyntaxError('String "'+e+'" is no valid range');return"BigNumber"===n.number?(void 0===a&&qX(),p(d(a(r.start),a(r.end),a(r.step)))):p(d(r.start,r.end,r.step,t))}function d(e,t,n,r){for(var a=[],p=l(n)?r?o:i:r?u:s,h=e;p(h,t);)a.push(h),h=c(h,n);return a}})),XX="reshape",YX=ZU(XX,["typed","isInteger","matrix"],(e=>{var{typed:t,isInteger:n}=e;return t(XX,{"Matrix, Array":function(e,t){return e.reshape(t,!0)},"Array, Array":function(e,t){return t.forEach((function(e){if(!n(e))throw new TypeError("Invalid size for dimension: "+e)})),gj(e,t)}})})),$X=ZU("resize",["config","matrix"],(e=>{var{config:t,matrix:n}=e;return function(e,r,a){if(2!==arguments.length&&3!==arguments.length)throw new LP("resize",arguments.length,2,3);if(oU(r)&&(r=r.valueOf()),JP(r[0])&&(r=r.map((function(e){return JP(e)?e.toNumber():e}))),oU(e))return e.resize(r,a,!0);if("string"===typeof e)return function(e,t,n){if(void 0!==n){if("string"!==typeof n||1!==n.length)throw new TypeError("Single character expected as defaultValue")}else n=" ";if(1!==t.length)throw new PP(t.length,1);var r=t[0];if("number"!==typeof r||!sW(r))throw new TypeError("Invalid size, must contain positive integers (size: "+nj(t)+")");if(e.length>r)return e.substring(0,r);if(e.length<r){for(var a=e,i=0,o=r-e.length;i<o;i++)a+=n;return a}return e}(e,r,a);var i=!Array.isArray(e)&&"Array"!==t.matrix;if(0===r.length){for(;Array.isArray(e);)e=e[0];return qU(e)}Array.isArray(e)||(e=[e]);var o=fj(e=qU(e),r,a);return i?n(o):o}})),ZX="rotate",QX=ZU(ZX,["typed","multiply","rotationMatrix"],(e=>{var{typed:t,multiply:n,rotationMatrix:r}=e;return t(ZX,{"Array , number | BigNumber | Complex | Unit":function(e,t){return a(e,2),n(r(t),e).toArray()},"Matrix , number | BigNumber | Complex | Unit":function(e,t){return a(e,2),n(r(t),e)},"Array, number | BigNumber | Complex | Unit, Array | Matrix":function(e,t,i){return a(e,3),n(r(t,i),e)},"Matrix, number | BigNumber | Complex | Unit, Array | Matrix":function(e,t,i){return a(e,3),n(r(t,i),e)}});function a(e,t){var n=Array.isArray(e)?uj(e):e.size();if(n.length>2)throw new RangeError("Vector must be of dimensions 1x".concat(t));if(2===n.length&&1!==n[1])throw new RangeError("Vector must be of dimensions 1x".concat(t));if(n[0]!==t)throw new RangeError("Vector must be of dimensions 1x".concat(t))}})),JX="rotationMatrix",eY=ZU(JX,["typed","config","multiplyScalar","addScalar","unaryMinus","norm","matrix","BigNumber","DenseMatrix","SparseMatrix","cos","sin"],(e=>{var{typed:t,config:n,multiplyScalar:r,addScalar:a,unaryMinus:i,norm:o,BigNumber:s,matrix:u,DenseMatrix:c,SparseMatrix:l,cos:p,sin:h}=e;return t(JX,{"":function(){return"Matrix"===n.matrix?u([]):[]},string:function(e){return u(e)},"number | BigNumber | Complex | Unit":function(e){return d(e,"Matrix"===n.matrix?"dense":void 0)},"number | BigNumber | Complex | Unit, string":function(e,t){return d(e,t)},"number | BigNumber | Complex | Unit, Array":function(e,t){var n=u(t);return f(n),y(e,n,void 0)},"number | BigNumber | Complex | Unit, Matrix":function(e,t){f(t);var r=t.storage()||("Matrix"===n.matrix?"dense":void 0);return y(e,t,r)},"number | BigNumber | Complex | Unit, Array, string":function(e,t,n){var r=u(t);return f(r),y(e,r,n)},"number | BigNumber | Complex | Unit, Matrix, string":function(e,t,n){return f(t),y(e,t,n)}});function d(e,t){var n=JP(e)?new s(-1):-1,a=p(e),i=h(e);return g([[a,r(n,i)],[i,a]],t)}function f(e){var t=e.size();if(t.length<1||3!==t[0])throw new RangeError("Vector must be of dimensions 1x3")}function m(e){return e.reduce(((e,t)=>r(e,t)))}function g(e,t){if(t){if("sparse"===t)return new l(e);if("dense"===t)return new c(e);throw new TypeError('Unknown matrix type "'.concat(t,'"'))}return e}function y(e,t,n){var r=o(t);if(0===r)throw new RangeError("Rotation around zero vector");var u=JP(e)?s:null,c=u?new u(1):1,l=u?new u(-1):-1,d=u?new u(t.get([0])/r):t.get([0])/r,f=u?new u(t.get([1])/r):t.get([1])/r,y=u?new u(t.get([2])/r):t.get([2])/r,v=p(e),b=a(c,i(v)),x=h(e);return g([[a(v,m([d,d,b])),a(m([d,f,b]),m([l,y,x])),a(m([d,y,b]),m([f,x]))],[a(m([d,f,b]),m([y,x])),a(v,m([f,f,b])),a(m([f,y,b]),m([l,d,x]))],[a(m([d,y,b]),m([l,f,x])),a(m([f,y,b]),m([d,x])),a(v,m([y,y,b]))]],n)}})),tY=ZU("row",["typed","Index","matrix","range"],(e=>{var{typed:t,Index:n,matrix:r,range:a}=e;return t("row",{"Matrix, number":i,"Array, number":function(e,t){return i(r(qU(e)),t).valueOf()}});function i(e,t){if(2!==e.size().length)throw new Error("Only two dimensional matrix is supported");hj(t,e.size()[0]);var i=a(0,e.size()[1]),o=new n(t,i),s=e.subset(o);return oU(s)?s:r([[s]])}})),nY="size",rY=ZU(nY,["typed","config","?matrix"],(e=>{var{typed:t,config:n,matrix:r}=e;return t(nY,{Matrix:function(e){return e.create(e.size(),"number")},Array:uj,string:function(e){return"Array"===n.matrix?[e.length]:r([e.length],"dense","number")},"number | Complex | BigNumber | Unit | boolean | null":function(e){return"Array"===n.matrix?[]:r?r([],"dense","number"):GX()}})})),aY="squeeze",iY=ZU(aY,["typed"],(e=>{var{typed:t}=e;return t(aY,{Array:function(e){return bj(qU(e))},Matrix:function(e){var t=bj(e.toArray());return Array.isArray(t)?e.create(t,e.datatype()):t},any:function(e){return qU(e)}})})),oY="subset",sY=ZU(oY,["typed","matrix","zeros","add"],(e=>{var{typed:t,matrix:n,zeros:r,add:a}=e;return t(oY,{"Matrix, Index":function(e,t){return dj(t)?n():(pj(e,t),e.subset(t))},"Array, Index":t.referTo("Matrix, Index",(function(e){return function(t,r){var a=e(n(t),r);return r.isScalar()?a:a.valueOf()}})),"Object, Index":lY,"string, Index":uY,"Matrix, Index, any, any":function(e,t,n,i){return dj(t)?e:(pj(e,t),e.clone().subset(t,function(e,t){if("string"===typeof e)throw new Error("can't boradcast a string");if(t._isScalar)return e;var n=t.size();if(!n.every((e=>e>0)))return e;try{return a(e,r(n))}catch(i){return e}}(n,t),i))},"Array, Index, any, any":t.referTo("Matrix, Index, any, any",(function(e){return function(t,r,a,i){var o=e(n(t),r,a,i);return o.isMatrix?o.valueOf():o}})),"Array, Index, any":t.referTo("Matrix, Index, any, any",(function(e){return function(t,r,a){return e(n(t),r,a,void 0).valueOf()}})),"Matrix, Index, any":t.referTo("Matrix, Index, any, any",(function(e){return function(t,n,r){return e(t,n,r,void 0)}})),"string, Index, string":cY,"string, Index, string, string":cY,"Object, Index, any":pY})}));function uY(e,t){if(!pU(t))throw new TypeError("Index expected");if(dj(t))return"";if(pj(Array.from(e),t),1!==t.size().length)throw new PP(t.size().length,1);var n=e.length;hj(t.min()[0],n),hj(t.max()[0],n);var r=t.dimension(0),a="";return r.forEach((function(t){a+=e.charAt(t)})),a}function cY(e,t,n,r){if(!t||!0!==t.isIndex)throw new TypeError("Index expected");if(dj(t))return e;if(pj(Array.from(e),t),1!==t.size().length)throw new PP(t.size().length,1);if(void 0!==r){if("string"!==typeof r||1!==r.length)throw new TypeError("Single character expected as defaultValue")}else r=" ";var a=t.dimension(0);if(a.size()[0]!==n.length)throw new PP(a.size()[0],n.length);var i=e.length;hj(t.min()[0]),hj(t.max()[0]);for(var o=[],s=0;s<i;s++)o[s]=e.charAt(s);if(a.forEach((function(e,t){o[e]=n.charAt(t[0])})),o.length>i)for(var u=i-1,c=o.length;u<c;u++)o[u]||(o[u]=r);return o.join("")}function lY(e,t){if(!dj(t)){if(1!==t.size().length)throw new PP(t.size(),1);var n=t.dimension(0);if("string"!==typeof n)throw new TypeError("String expected as index to retrieve an object property");return WP(e,n)}}function pY(e,t,n){if(dj(t))return e;if(1!==t.size().length)throw new PP(t.size(),1);var r=t.dimension(0);if("string"!==typeof r)throw new TypeError("String expected as index to retrieve an object property");var a=qU(e);return VP(a,r,n),a}var hY="transpose",dY=ZU(hY,["typed","matrix"],(e=>{var{typed:t,matrix:n}=e;return t(hY,{Array:e=>r(n(e)).valueOf(),Matrix:r,any:qU});function r(e){var t,n=e.size();switch(n.length){case 1:t=e.clone();break;case 2:var r=n[0],a=n[1];if(0===a)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+nj(n)+")");switch(e.storage()){case"dense":t=function(e,t,n){for(var r,a=e._data,i=[],o=0;o<n;o++){r=i[o]=[];for(var s=0;s<t;s++)r[s]=qU(a[s][o])}return e.createDenseMatrix({data:i,size:[n,t],datatype:e._datatype})}(e,r,a);break;case"sparse":t=function(e,t,n){for(var r,a,i,o=e._values,s=e._index,u=e._ptr,c=o?[]:void 0,l=[],p=[],h=[],d=0;d<t;d++)h[d]=0;for(r=0,a=s.length;r<a;r++)h[s[r]]++;for(var f=0,m=0;m<t;m++)p.push(f),f+=h[m],h[m]=p[m];for(p.push(f),i=0;i<n;i++)for(var g=u[i],y=u[i+1],v=g;v<y;v++){var b=h[s[v]]++;l[b]=i,o&&(c[b]=qU(o[v]))}return e.createSparseMatrix({values:c,index:l,ptr:p,size:[n,t],datatype:e._datatype})}(e,r,a)}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+nj(n)+")")}return t}})),fY="ctranspose",mY=ZU(fY,["typed","transpose","conj"],(e=>{var{typed:t,transpose:n,conj:r}=e;return t(fY,{any:function(e){return r(n(e))}})})),gY="zeros",yY=ZU(gY,["typed","config","matrix","BigNumber"],(e=>{var{typed:t,config:n,matrix:r,BigNumber:a}=e;return t(gY,{"":function(){return"Array"===n.matrix?i([]):i([],"default")},"...number | BigNumber | string":function(e){if("string"===typeof e[e.length-1]){var t=e.pop();return i(e,t)}return"Array"===n.matrix?i(e):i(e,"default")},Array:i,Matrix:function(e){var t=e.storage();return i(e.valueOf(),t)},"Array | Matrix, string":function(e,t){return i(e.valueOf(),t)}});function i(e,t){var n=function(e){var t=!1;return e.forEach((function(e,n,r){JP(e)&&(t=!0,r[n]=e.toNumber())})),t}(e),i=n?new a(0):0;if(function(e){e.forEach((function(e){if("number"!==typeof e||!sW(e)||e<0)throw new Error("Parameters in function zeros must be positive integers")}))}(e),t){var o=r(t);return e.length>0?o.resize(e,i):o}var s=[];return e.length>0?fj(s,e,i):s}})),vY=ZU("fft",["typed","matrix","addScalar","multiplyScalar","divideScalar","exp","tau","i","dotDivide","conj","pow","ceil","log2"],(e=>{var{typed:t,matrix:n,addScalar:r,multiplyScalar:a,divideScalar:i,exp:o,tau:s,i:u,dotDivide:c,conj:l,pow:p,ceil:h,log2:d}=e;return t("fft",{Array:f,Matrix:function(e){return e.create(f(e.valueOf()),e.datatype())}});function f(e){var t=uj(e);return 1===t.length?g(e,t[0]):m(e.map((e=>f(e,t.slice(1)))),0)}function m(e,t){var n=uj(e);if(0!==t)return new Array(n[0]).fill(0).map(((n,r)=>m(e[r],t-1)));if(1===n.length)return g(e);function r(e){var t=uj(e);return new Array(t[1]).fill(0).map(((n,r)=>new Array(t[0]).fill(0).map(((t,n)=>e[n][r]))))}return r(m(r(e),1))}function g(e){var t=e.length;if(1===t)return[e[0]];if(t%2===0){for(var n=[...g(e.filter(((e,t)=>t%2===0))),...g(e.filter(((e,t)=>t%2===1)))],m=0;m<t/2;m++){var y=n[m],v=a(n[m+t/2],o(a(a(s,u),i(-m,t))));n[m]=r(y,v),n[m+t/2]=r(y,a(-1,v))}return n}return function(e){for(var t=e.length,n=o(i(a(-1,a(u,s)),t)),r=[],m=1-t;m<t;m++)r.push(p(n,i(p(m,2),2)));for(var y=p(2,h(d(t+t-1))),v=[...new Array(t).fill(0).map(((n,i)=>a(e[i],r[t-1+i]))),...new Array(y-t).fill(0)],b=[...new Array(t+t-1).fill(0).map(((e,t)=>i(1,r[t]))),...new Array(y-(t+t-1)).fill(0)],x=g(v),w=g(b),N=new Array(y).fill(0).map(((e,t)=>a(x[t],w[t]))),S=c(l(f(l(N))),y),k=[],E=t-1;E<t+t-1;E++)k.push(a(S[E],r[E]));return k}(e)}})),bY="ifft",xY=ZU(bY,["typed","fft","dotDivide","conj"],(e=>{var{typed:t,fft:n,dotDivide:r,conj:a}=e;return t(bY,{"Array | Matrix":function(e){var t=oU(e)?e.size():uj(e);return r(a(n(a(e))),t.reduce(((e,t)=>e*t),1))}})}));function wY(e){return wY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wY(e)}function NY(e){var t=function(e,t){if("object"!=wY(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=wY(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==wY(t)?t:t+""}function SY(e,t,n){return(t=NY(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kY(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var EY=ZU("solveODE",["typed","add","subtract","multiply","divide","max","map","abs","isPositive","isNegative","larger","smaller","matrix","bignumber","unaryMinus"],(e=>{var{typed:t,add:n,subtract:r,multiply:a,divide:i,max:o,map:s,abs:u,isPositive:c,isNegative:l,larger:p,smaller:h,matrix:d,bignumber:f,unaryMinus:m}=e;function g(e){return function(t,d,g,y){if(!(2===d.length&&(d.every(x)||d.every(rU))))throw new Error('"tspan" must be an Array of two numeric values or two units [tStart, tEnd]');var v=d[0],b=d[1],w=p(b,v),N=y.firstStep;if(void 0!==N&&!c(N))throw new Error('"firstStep" must be positive');var S=y.maxStep;if(void 0!==S&&!c(S))throw new Error('"maxStep" must be positive');var k=y.minStep;if(k&&l(k))throw new Error('"minStep" must be positive or zero');var E=[v,b,N,k,S].filter((e=>void 0!==e));if(!E.every(x)&&!E.every(rU))throw new Error('Inconsistent type of "t" dependant variables');for(var C=y.tol?y.tol:1e-4,T=y.minDelta?y.minDelta:.2,D=y.maxDelta?y.maxDelta:5,I=y.maxIter?y.maxIter:1e4,A=[v,b,...g,S,k].some(JP),[F,_,M,O]=A?[f(e.a),f(e.c),f(e.b),f(e.bp)]:[e.a,e.c,e.b,e.bp],R=N?w?N:m(N):i(r(b,v),1),z=[v],B=[g],L=r(M,O),P=0,U=0,W=function(e){return e?h:p}(w),V=function(e){var t=e?p:h;return function(e,a,i){var o=n(e,i);return t(o,a)?r(a,e):i}}(w);W(z[P],b);){var q=[];R=V(z[P],b,R),q.push(t(z[P],B[P]));for(var j=1;j<_.length;++j)q.push(t(n(z[P],a(_[j],R)),n(B[P],a(R,F[j],q))));var G=o(u(s(a(L,q),(e=>rU(e)?e.value:e))));G<C&&C/G>1/4&&(z.push(n(z[P],R)),B.push(n(B[P],a(R,M,q))),P++);var H=.84*(C/G)**.2;if(h(H,T)?H=T:p(H,D)&&(H=D),H=A?f(H):H,R=a(R,H),S&&p(u(R),S)?R=w?S:m(S):k&&h(u(R),k)&&(R=w?k:m(k)),++U>I)throw new Error("Maximum number of iterations reached, try changing options")}return{t:z,y:B}}}function y(e,t,n,r){return g({a:[[],[.5],[0,3/4],[2/9,1/3,4/9]],c:[null,.5,3/4,1],b:[2/9,1/3,4/9,0],bp:[7/24,1/4,1/3,1/8]})(e,t,n,r)}function v(e,t,n,r){return g({a:[[],[.2],[3/40,9/40],[44/45,-56/15,32/9],[19372/6561,-25360/2187,64448/6561,-212/729],[9017/3168,-355/33,46732/5247,49/176,-5103/18656],[35/384,0,500/1113,125/192,-2187/6784,11/84]],c:[null,.2,.3,.8,8/9,1,1],b:[35/384,0,500/1113,125/192,-2187/6784,11/84,0],bp:[5179/57600,0,7571/16695,393/640,-92097/339200,187/2100,1/40]})(e,t,n,r)}function b(e,t,n,r){var a=r.method?r.method:"RK45",i={RK23:y,RK45:v};if(a.toUpperCase()in i){var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kY(Object(n),!0).forEach((function(t){SY(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kY(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r);return delete o.method,i[a.toUpperCase()](e,t,n,o)}var s=Object.keys(i).map((e=>'"'.concat(e,'"'))),u="".concat(s.slice(0,-1).join(", ")," and ").concat(s.slice(-1));throw new Error('Unavailable method "'.concat(a,'". Available methods are ').concat(u))}function x(e){return JP(e)||QP(e)}function w(e,t,n,r){var a=b(e,t.toArray(),n.toArray(),r);return{t:d(a.t),y:d(a.y)}}return t("solveODE",{"function, Array, Array, Object":b,"function, Matrix, Matrix, Object":w,"function, Array, Array":(e,t,n)=>b(e,t,n,{}),"function, Matrix, Matrix":(e,t,n)=>w(e,t,n,{}),"function, Array, number | BigNumber | Unit":(e,t,n)=>{var r=b(e,t,[n],{});return{t:r.t,y:r.y.map((e=>e[0]))}},"function, Matrix, number | BigNumber | Unit":(e,t,n)=>{var r=b(e,t.toArray(),[n],{});return{t:d(r.t),y:d(r.y.map((e=>e[0])))}},"function, Array, number | BigNumber | Unit, Object":(e,t,n,r)=>{var a=b(e,t,[n],r);return{t:a.t,y:a.y.map((e=>e[0]))}},"function, Matrix, number | BigNumber | Unit, Object":(e,t,n,r)=>{var a=b(e,t.toArray(),[n],r);return{t:d(a.t),y:d(a.y.map((e=>e[0])))}}})})),CY=ZU("erf",["typed"],(e=>{var{typed:t}=e;return t("name",{number:function(e){var t=Math.abs(e);return t>=FY?cW(e):t<=TY?cW(e)*function(e){var t,n=e*e,r=IY[0][4]*n,a=n;for(t=0;t<3;t+=1)r=(r+IY[0][t])*n,a=(a+AY[0][t])*n;return e*(r+IY[0][3])/(a+AY[0][3])}(t):t<=4?cW(e)*(1-function(e){var t,n=IY[1][8]*e,r=e;for(t=0;t<7;t+=1)n=(n+IY[1][t])*e,r=(r+AY[1][t])*e;var a=(n+IY[1][7])/(r+AY[1][7]),i=parseInt(16*e)/16,o=(e-i)*(e+i);return Math.exp(-i*i)*Math.exp(-o)*a}(t)):cW(e)*(1-function(e){var t,n=1/(e*e),r=IY[2][5]*n,a=n;for(t=0;t<4;t+=1)r=(r+IY[2][t])*n,a=(a+AY[2][t])*n;var i=n*(r+IY[2][4])/(a+AY[2][4]);i=(DY-i)/e,n=parseInt(16*e)/16;var o=(e-n)*(e+n);return Math.exp(-n*n)*Math.exp(-o)*i}(t))},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),TY=.46875,DY=.5641895835477563,IY=[[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,2.1531153547440383e-8],[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097]],AY=[[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]],FY=Math.pow(2,53),_Y="zeta",MY=ZU(_Y,["typed","config","multiply","pow","divide","factorial","equal","smallerEq","isNegative","gamma","sin","subtract","add","?Complex","?BigNumber","pi"],(e=>{var{typed:t,config:n,multiply:r,pow:a,divide:i,factorial:o,equal:s,smallerEq:u,isNegative:c,gamma:l,sin:p,subtract:h,add:d,Complex:f,BigNumber:m,pi:g}=e;return t(_Y,{number:e=>y(e,(e=>e),(()=>20)),BigNumber:e=>y(e,(e=>new m(e)),(()=>Math.abs(Math.log10(n.relTol)))),Complex:function(e){if(0===e.re&&0===e.im)return new f(-.5);if(1===e.re)return new f(NaN,NaN);if(e.re===1/0&&0===e.im)return new f(1);if(e.im===1/0||e.re===-1/0)return new f(NaN,NaN);return v(e,(e=>e),(e=>Math.round(19.5+.9*Math.abs(e.im))),(e=>e.re))}});function y(e,t,n){return s(e,0)?t(-.5):s(e,1)?t(NaN):isFinite(e)?v(e,t,n,(e=>e)):c(e)?t(NaN):t(1)}function v(e,t,n,o){var s=n(e);if(o(e)>-(s-1)/2)return function(e,t,n){for(var o=i(1,r(b(n(0),t),h(1,a(2,h(1,e))))),s=n(0),c=n(1);u(c,t);c=d(c,1))s=d(s,i(r((-1)**(c-1),b(c,t)),a(c,e)));return r(o,s)}(e,t(s),t);var c=r(a(2,e),a(t(g),h(e,1)));return c=r(c,p(r(i(t(g),2),e))),c=r(c,l(h(1,e))),r(c,v(h(1,e),t,n,o))}function b(e,t){for(var n=e,s=e;u(s,t);s=d(s,1)){var c=i(r(o(d(t,h(s,1))),a(4,s)),r(o(h(t,s)),o(r(2,s))));n=d(n,c)}return r(t,n)}})),OY="mode",RY=ZU(OY,["typed","isNaN","isNumeric"],(e=>{var{typed:t,isNaN:n,isNumeric:r}=e;return t(OY,{"Array | Matrix":a,"...":function(e){return a(e)}});function a(e){if(0===(e=Sj(e.valueOf())).length)throw new Error("Cannot calculate mode of an empty array");for(var t={},a=[],i=0,o=0;o<e.length;o++){var s=e[o];if(r(s)&&n(s))throw new Error("Cannot calculate mode of an array containing NaN values");s in t||(t[s]=0),t[s]++,t[s]===i?a.push(s):t[s]>i&&(i=t[s],a=[s])}return a}}));function zY(e,t,n){var r;return String(e).includes("Unexpected type")?(r=arguments.length>2?" (type: "+VU(n)+", value: "+JSON.stringify(n)+")":" (type: "+e.data.actual+")",new TypeError("Cannot calculate "+t+", unexpected type of argument"+r)):String(e).includes("complex numbers")?(r=arguments.length>2?" (type: "+VU(n)+", value: "+JSON.stringify(n)+")":"",new TypeError("Cannot calculate "+t+", no ordering relation is defined for complex numbers"+r)):e}var BY="prod",LY=ZU(BY,["typed","config","multiplyScalar","numeric"],(e=>{var{typed:t,config:n,multiplyScalar:r,numeric:a}=e;return t(BY,{"Array | Matrix":i,"Array | Matrix, number | BigNumber":function(e,t){throw new Error("prod(A, dim) is not yet supported")},"...":function(e){return i(e)}});function i(e){var t;if(Gj(e,(function(e){try{t=void 0===t?e:r(t,e)}catch(r5){throw zY(r5,"prod",e)}})),"string"===typeof t&&(t=a(t,uW(t,n))),void 0===t)throw new Error("Cannot calculate prod of an empty array");return t}})),PY="format",UY=ZU(PY,["typed"],(e=>{var{typed:t}=e;return t(PY,{any:nj,"any, Object | function | number | BigNumber":nj})})),WY=ZU("bin",["typed","format"],(e=>{var{typed:t,format:n}=e;return t("bin",{"number | BigNumber":function(e){return n(e,{notation:"bin"})},"number | BigNumber, number | BigNumber":function(e,t){return n(e,{notation:"bin",wordSize:t})}})})),VY=ZU("oct",["typed","format"],(e=>{var{typed:t,format:n}=e;return t("oct",{"number | BigNumber":function(e){return n(e,{notation:"oct"})},"number | BigNumber, number | BigNumber":function(e,t){return n(e,{notation:"oct",wordSize:t})}})})),qY=ZU("hex",["typed","format"],(e=>{var{typed:t,format:n}=e;return t("hex",{"number | BigNumber":function(e){return n(e,{notation:"hex"})},"number | BigNumber, number | BigNumber":function(e,t){return n(e,{notation:"hex",wordSize:t})}})})),jY=/\$([\w.]+)/g,GY="print",HY=ZU(GY,["typed"],(e=>{var{typed:t}=e;return t(GY,{"string, Object | Array":KY,"string, Object | Array, number | Object":KY})}));function KY(e,t,n){return e.replace(jY,(function(e,r){var a=r.split("."),i=t[a.shift()];for(void 0!==i&&i.isMatrix&&(i=i.toArray());a.length&&void 0!==i;){var o=a.shift();i=o?i[o]:i+"."}return void 0!==i?aU(i)?i:nj(i,n):e}))}var XY=ZU("to",["typed","matrix","concat"],(e=>{var{typed:t,matrix:n,concat:r}=e;return t("to",{"Unit, Unit | string":(e,t)=>e.to(t)},KH({typed:t,matrix:n,concat:r})({Ds:!0}))})),YY="isPrime",$Y=ZU(YY,["typed"],(e=>{var{typed:t}=e;return t(YY,{number:function(e){if(e<=3)return e>1;if(e%2===0||e%3===0)return!1;for(var t=5;t*t<=e;t+=6)if(e%t===0||e%(t+2)===0)return!1;return!0},bigint:function(e){if(e<=3n)return e>1n;if(e%2n===0n||e%3n===0n)return!1;for(var t=5n;t*t<=e;t+=6n)if(e%t===0n||e%(t+2n)===0n)return!1;return!0},BigNumber:function(e){if(e.lte(3))return e.gt(1);if(e.mod(2).eq(0)||e.mod(3).eq(0))return!1;if(e.lt(Math.pow(2,32))){for(var t=e.toNumber(),n=5;n*n<=t;n+=6)if(t%n===0||t%(n+2)===0)return!1;return!0}function r(e,t,n){for(var r=1;!t.eq(0);)t.mod(2).eq(0)?(t=t.div(2),e=e.mul(e).mod(n)):(t=t.sub(1),r=e.mul(r).mod(n));return r}for(var a=e.constructor.clone({precision:2*e.toFixed(0).length}),i=0,o=(e=new a(e)).sub(1);o.mod(2).eq(0);)o=o.div(2),i+=1;var s=null;if(e.lt("3317044064679887385961981"))s=[2,3,5,7,11,13,17,19,23,29,31,37,41].filter((t=>t<e));else{var u=Math.min(e.toNumber()-2,Math.floor(2*Math.pow(e.toFixed(0).length*Math.log(10),2)));s=[];for(var c=2;c<=u;c+=1)s.push(u)}for(var l=0;l<s.length;l+=1){var p=s[l],h=r(e.sub(e).add(p),o,e);if(!h.eq(1))for(var d=0,f=h;!f.eq(e.sub(1));d+=1,f=f.mul(f).mod(e))if(d===i-1)return!1}return!0},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),ZY=ZU("numeric",["number","?bignumber","?fraction"],(e=>{var{number:t,bignumber:n,fraction:r}=e,a={string:!0,number:!0,BigNumber:!0,Fraction:!0},i={number:e=>t(e),BigNumber:n?e=>n(e):qX,bigint:e=>BigInt(e),Fraction:r?e=>r(e):jX};return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number";if(void 0!==(arguments.length>2?arguments[2]:void 0))throw new SyntaxError("numeric() takes one or two arguments");var n=VU(e);if(!(n in a))throw new TypeError("Cannot convert "+e+' of type "'+n+'"; valid input types are '+Object.keys(a).join(", "));if(!(t in i))throw new TypeError("Cannot convert "+e+' to type "'+t+'"; valid output types are '+Object.keys(i).join(", "));return t===n?e:i[t](e)}})),QY="divideScalar",JY=ZU(QY,["typed","numeric"],(e=>{var{typed:t,numeric:n}=e;return t(QY,{"number, number":function(e,t){return e/t},"Complex, Complex":function(e,t){return e.div(t)},"BigNumber, BigNumber":function(e,t){return e.div(t)},"bigint, bigint":function(e,t){return e/t},"Fraction, Fraction":function(e,t){return e.div(t)},"Unit, number | Complex | Fraction | BigNumber | Unit":(e,t)=>e.divide(t),"number | Fraction | Complex | BigNumber, Unit":(e,t)=>t.divideInto(e)})})),e$=ZU("pow",["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],(e=>{var{typed:t,config:n,identity:r,multiply:a,matrix:i,inv:o,number:s,fraction:u,Complex:c}=e;return t("pow",{"number, number":l,"Complex, Complex":function(e,t){return e.pow(t)},"BigNumber, BigNumber":function(e,t){return t.isInteger()||e>=0||n.predictable?e.pow(t):new c(e.toNumber(),0).pow(t.toNumber(),0)},"bigint, bigint":(e,t)=>e**t,"Fraction, Fraction":function(e,t){var r=e.pow(t);if(null!=r)return r;if(n.predictable)throw new Error("Result of pow is non-rational and cannot be expressed as a fraction");return l(e.valueOf(),t.valueOf())},"Array, number":p,"Array, BigNumber":function(e,t){return p(e,t.toNumber())},"Matrix, number":h,"Matrix, BigNumber":function(e,t){return h(e,t.toNumber())},"Unit, number | BigNumber":function(e,t){return e.pow(t)}});function l(e,t){if(n.predictable&&!sW(t)&&e<0)try{var r=u(t),a=s(r);if((t===a||Math.abs((t-a)/t)<1e-14)&&r.d%2n===1n)return(r.n%2n===0n?1:-1)*Math.pow(-e,t)}catch(i){}return n.predictable&&(e<-1&&t===1/0||e>-1&&e<0&&t===-1/0)?NaN:sW(t)||e>=0||n.predictable?oH(e,t):e*e<1&&t===1/0||e*e>1&&t===-1/0?0:new c(e,0).pow(t,0)}function p(e,t){if(!sW(t))throw new TypeError("For A^b, b must be an integer (value is "+t+")");var n=uj(e);if(2!==n.length)throw new Error("For A^b, A must be 2 dimensional (A has "+n.length+" dimensions)");if(n[0]!==n[1])throw new Error("For A^b, A must be square (size is "+n[0]+"x"+n[1]+")");if(t<0)try{return p(o(e),-t)}catch(u){if("Cannot calculate inverse, determinant is zero"===u.message)throw new TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+t+")");throw u}for(var i=r(n[0]).valueOf(),s=e;t>=1;)1===(1&t)&&(i=a(s,i)),t>>=1,s=a(s,s);return i}function h(e,t){return i(p(e.valueOf(),t))}})),t$="Number of decimals in function round must be an integer",n$="round",r$=ZU(n$,["typed","config","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],(e=>{var{typed:t,config:n,matrix:r,equalScalar:a,zeros:i,BigNumber:o,DenseMatrix:s}=e,u=NH({typed:t,equalScalar:a}),c=SH({typed:t,DenseMatrix:s}),l=kH({typed:t});function p(e){return Math.abs(vW(e).exponent)}return t(n$,{number:function(e){var t=sH(e,p(n.relTol));return sH(SW(e,t,n.relTol,n.absTol)?t:e)},"number, number":function(e,t){var r=p(n.relTol);if(t>=r)return sH(e,t);var a=sH(e,r);return sH(SW(e,a,n.relTol,n.absTol)?a:e,t)},"number, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(t$);return new o(e).toDecimalPlaces(t.toNumber())},Complex:function(e){return e.round()},"Complex, number":function(e,t){if(t%1)throw new TypeError(t$);return e.round(t)},"Complex, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(t$);var n=t.toNumber();return e.round(n)},BigNumber:function(e){var t=new o(e).toDecimalPlaces(p(n.relTol));return(nG(e,t,n.relTol,n.absTol)?t:e).toDecimalPlaces(0)},"BigNumber, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(t$);var r=p(n.relTol);if(t>=r)return e.toDecimalPlaces(t.toNumber());var a=e.toDecimalPlaces(r);return(nG(e,a,n.relTol,n.absTol)?a:e).toDecimalPlaces(t.toNumber())},Fraction:function(e){return e.round()},"Fraction, number":function(e,t){if(t%1)throw new TypeError(t$);return e.round(t)},"Fraction, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(t$);return e.round(t.toNumber())},"Unit, number, Unit":t.referToSelf((e=>function(t,n,r){var a=t.toNumeric(r);return r.multiply(e(a,n))})),"Unit, BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>e(t,n.toNumber(),r))),"Array | Matrix, number | BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>Hj(t,(t=>e(t,n,r)),!0))),"Array | Matrix | Unit, Unit":t.referToSelf((e=>(t,n)=>e(t,0,n))),"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e,!0))),"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>u(t,n,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>l(t,n,e,!1))),"Array, number | BigNumber":t.referToSelf((e=>(t,n)=>l(r(t),n,e,!1).valueOf())),"number | Complex | BigNumber | Fraction, SparseMatrix":t.referToSelf((e=>(t,n)=>a(t,0)?i(n.size(),n.storage()):c(n,t,e,!0))),"number | Complex | BigNumber | Fraction, DenseMatrix":t.referToSelf((e=>(t,n)=>a(t,0)?i(n.size(),n.storage()):l(n,t,e,!0))),"number | Complex | BigNumber | Fraction, Array":t.referToSelf((e=>(t,n)=>l(r(n),t,e,!0).valueOf()))})})),a$=["config","typed","typeOf","divideScalar","Complex"],i$=Math.log(16),o$=ZU("log",a$,(e=>{var{typed:t,typeOf:n,config:r,divideScalar:a,Complex:i}=e;function o(e){return e.log()}function s(e){return o(new i(e,0))}return t("log",{number:function(e){return e>=0||r.predictable?JG(e):s(e)},bigint:iK(i$,JG,r,s),Complex:o,BigNumber:function(e){return!e.isNegative()||r.predictable?e.ln():s(e.toNumber())},"any, any":t.referToSelf((e=>(t,r)=>{if("Fraction"===n(t)&&"Fraction"===n(r)){var i=t.log(r);if(null!==i)return i}return a(e(t),e(r))}))})})),s$="log1p",u$=ZU(s$,["typed","config","divideScalar","log","Complex"],(e=>{var{typed:t,config:n,divideScalar:r,log:a,Complex:i}=e;return t(s$,{number:function(e){return e>=-1||n.predictable?hW(e):o(new i(e,0))},Complex:o,BigNumber:function(e){var t=e.plus(1);return!t.isNegative()||n.predictable?t.ln():o(new i(e.toNumber(),0))},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e))),"any, any":t.referToSelf((e=>(t,n)=>r(e(t),a(n))))});function o(e){var t=e.re+1;return new i(Math.log(Math.sqrt(t*t+e.im*e.im)),Math.atan2(e.im,t))}})),c$="nthRoots",l$=ZU(c$,["config","typed","divideScalar","Complex"],(e=>{var{typed:t,config:n,divideScalar:r,Complex:a}=e,i=[function(e){return new a(e,0)},function(e){return new a(0,e)},function(e){return new a(-e,0)},function(e){return new a(0,-e)}];function o(e,t){if(t<0)throw new Error("Root must be greater than zero");if(0===t)throw new Error("Root must be non-zero");if(t%1!==0)throw new Error("Root must be an integer");if(0===e||0===e.abs())return[new a(0,0)];var n,r="number"===typeof e;(r||0===e.re||0===e.im)&&(n=r?2*+(e<0):0===e.im?2*+(e.re<0):2*+(e.im<0)+1);for(var o=e.arg(),s=e.abs(),u=[],c=Math.pow(s,1/t),l=0;l<t;l++){var p=(n+4*l)/t;p!==Math.round(p)?u.push(new a({r:c,phi:(o+2*Math.PI*l)/t})):u.push(i[p%4](c))}return u}return t(c$,{Complex:function(e){return o(e,2)},"Complex, number":o})})),p$="dotPow",h$=ZU(p$,["typed","equalScalar","matrix","pow","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,equalScalar:n,matrix:r,pow:a,DenseMatrix:i,concat:o,SparseMatrix:s}=e,u=qH({typed:t}),c=JK({typed:t,SparseMatrix:s}),l=NH({typed:t,equalScalar:n}),p=SH({typed:t,DenseMatrix:i}),h=KH({typed:t,matrix:r,concat:o}),d={};for(var f in a.signatures)Object.prototype.hasOwnProperty.call(a.signatures,f)&&(f.includes("Matrix")||f.includes("Array")||(d[f]=a.signatures[f]));var m=t(d);return t(p$,h({elop:m,SS:c,DS:u,Ss:l,sS:p}))})),d$="dotDivide",f$=ZU(d$,["typed","matrix","equalScalar","divideScalar","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,matrix:n,equalScalar:r,divideScalar:a,DenseMatrix:i,concat:o,SparseMatrix:s}=e,u=VH({typed:t,equalScalar:r}),c=qH({typed:t}),l=JK({typed:t,SparseMatrix:s}),p=NH({typed:t,equalScalar:r}),h=SH({typed:t,DenseMatrix:i}),d=KH({typed:t,matrix:n,concat:o});return t(d$,d({elop:a,SS:l,DS:c,SD:u,Ss:p,sS:h}))}));function m$(e){var{DenseMatrix:t}=e;return function(e,n,r){var a=e.size();if(2!==a.length)throw new RangeError("Matrix must be two dimensional (size: "+nj(a)+")");var i=a[0];if(i!==a[1])throw new RangeError("Matrix must be square (size: "+nj(a)+")");var o=[];if(oU(n)){var s=n.size(),u=n._data;if(1===s.length){if(s[0]!==i)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var c=0;c<i;c++)o[c]=[u[c]];return new t({data:o,size:[i,1],datatype:n._datatype})}if(2===s.length){if(s[0]!==i||1!==s[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(uU(n)){if(r){o=[];for(var l=0;l<i;l++)o[l]=[u[l][0]];return new t({data:o,size:[i,1],datatype:n._datatype})}return n}if(cU(n)){for(var p=0;p<i;p++)o[p]=[0];for(var h=n._values,d=n._index,f=n._ptr,m=f[1],g=f[0];g<m;g++){o[d[g]][0]=h[g]}return new t({data:o,size:[i,1],datatype:n._datatype})}}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(iU(n)){var y=uj(n);if(1===y.length){if(y[0]!==i)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var v=0;v<i;v++)o[v]=[n[v]];return new t({data:o,size:[i,1]})}if(2===y.length){if(y[0]!==i||1!==y[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var b=0;b<i;b++)o[b]=[n[b][0]];return new t({data:o,size:[i,1]})}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}var g$="lsolve",y$=ZU(g$,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:n,divideScalar:r,multiplyScalar:a,subtractScalar:i,equalScalar:o,DenseMatrix:s}=e,u=m$({DenseMatrix:s});return t(g$,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var n=(t=u(e,t,!0))._data,c=e._size[0],l=e._size[1],p=e._values,h=e._index,d=e._ptr,f=[],m=0;m<l;m++){var g=n[m][0]||0;if(o(g,0))f[m]=[0];else{for(var y=0,v=[],b=[],x=d[m],w=d[m+1],N=x;N<w;N++){var S=h[N];S===m?y=p[N]:S>m&&(v.push(p[N]),b.push(S))}if(o(y,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var k=r(g,y),E=0,C=b.length;E<C;E++){var T=b[E];n[T]=[i(n[T][0]||0,a(k,v[E]))]}f[m]=[k]}}return new s({data:f,size:[c,1]})}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return c(e,t)},"Array, Array | Matrix":function(e,t){return c(n(e),t).valueOf()}});function c(e,t){for(var n=(t=u(e,t,!0))._data,c=e._size[0],l=e._size[1],p=[],h=e._data,d=0;d<l;d++){var f=n[d][0]||0,m=void 0;if(o(f,0))m=0;else{var g=h[d][d];if(o(g,0))throw new Error("Linear system cannot be solved since matrix is singular");m=r(f,g);for(var y=d+1;y<c;y++)n[y]=[i(n[y][0]||0,a(m,h[y][d]))]}p[d]=[m]}return new s({data:p,size:[c,1]})}})),v$="usolve",b$=ZU(v$,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:n,divideScalar:r,multiplyScalar:a,subtractScalar:i,equalScalar:o,DenseMatrix:s}=e,u=m$({DenseMatrix:s});return t(v$,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var n=(t=u(e,t,!0))._data,c=e._size[0],l=e._size[1],p=e._values,h=e._index,d=e._ptr,f=[],m=l-1;m>=0;m--){var g=n[m][0]||0;if(o(g,0))f[m]=[0];else{for(var y=0,v=[],b=[],x=d[m],w=d[m+1]-1;w>=x;w--){var N=h[w];N===m?y=p[w]:N<m&&(v.push(p[w]),b.push(N))}if(o(y,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var S=r(g,y),k=0,E=b.length;k<E;k++){var C=b[k];n[C]=[i(n[C][0],a(S,v[k]))]}f[m]=[S]}}return new s({data:f,size:[c,1]})}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return c(e,t)},"Array, Array | Matrix":function(e,t){return c(n(e),t).valueOf()}});function c(e,t){for(var n=(t=u(e,t,!0))._data,c=e._size[0],l=e._size[1],p=[],h=e._data,d=l-1;d>=0;d--){var f=n[d][0]||0,m=void 0;if(o(f,0))m=0;else{var g=h[d][d];if(o(g,0))throw new Error("Linear system cannot be solved since matrix is singular");m=r(f,g);for(var y=d-1;y>=0;y--)n[y]=[i(n[y][0]||0,a(m,h[y][d]))]}p[d]=[m]}return new s({data:p,size:[c,1]})}})),x$="lsolveAll",w$=ZU(x$,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:n,divideScalar:r,multiplyScalar:a,subtractScalar:i,equalScalar:o,DenseMatrix:s}=e,u=m$({DenseMatrix:s});return t(x$,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var n=[u(e,t,!0)._data.map((e=>e[0]))],c=e._size[0],l=e._size[1],p=e._values,h=e._index,d=e._ptr,f=0;f<l;f++)for(var m=n.length,g=0;g<m;g++){for(var y=n[g],v=[],b=[],x=d[f],w=d[f+1],N=0,S=x;S<w;S++){var k=h[S];k===f?N=p[S]:k>f&&(v.push(p[S]),b.push(k))}if(o(N,0))if(o(y[f],0)){if(0===g){var E=[...y];E[f]=1;for(var C=0,T=b.length;C<T;C++){var D=b[C];E[D]=i(E[D],v[C])}n.push(E)}}else{if(0===g)return[];n.splice(g,1),g-=1,m-=1}else{y[f]=r(y[f],N);for(var I=0,A=b.length;I<A;I++){var F=b[I];y[F]=i(y[F],a(y[f],v[I]))}}}return n.map((e=>new s({data:e.map((e=>[e])),size:[c,1]})))}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return c(e,t)},"Array, Array | Matrix":function(e,t){return c(n(e),t).map((e=>e.valueOf()))}});function c(e,t){for(var n=[u(e,t,!0)._data.map((e=>e[0]))],c=e._data,l=e._size[0],p=e._size[1],h=0;h<p;h++)for(var d=n.length,f=0;f<d;f++){var m=n[f];if(o(c[h][h],0))if(o(m[h],0)){if(0===f){var g=[...m];g[h]=1;for(var y=h+1;y<p;y++)g[y]=i(g[y],c[y][h]);n.push(g)}}else{if(0===f)return[];n.splice(f,1),f-=1,d-=1}else{m[h]=r(m[h],c[h][h]);for(var v=h+1;v<p;v++)m[v]=i(m[v],a(m[h],c[v][h]))}}return n.map((e=>new s({data:e.map((e=>[e])),size:[l,1]})))}})),N$="usolveAll",S$=ZU(N$,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:n,divideScalar:r,multiplyScalar:a,subtractScalar:i,equalScalar:o,DenseMatrix:s}=e,u=m$({DenseMatrix:s});return t(N$,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var n=[u(e,t,!0)._data.map((e=>e[0]))],c=e._size[0],l=e._size[1],p=e._values,h=e._index,d=e._ptr,f=l-1;f>=0;f--)for(var m=n.length,g=0;g<m;g++){for(var y=n[g],v=[],b=[],x=d[f],w=0,N=d[f+1]-1;N>=x;N--){var S=h[N];S===f?w=p[N]:S<f&&(v.push(p[N]),b.push(S))}if(o(w,0))if(o(y[f],0)){if(0===g){var k=[...y];k[f]=1;for(var E=0,C=b.length;E<C;E++){var T=b[E];k[T]=i(k[T],v[E])}n.push(k)}}else{if(0===g)return[];n.splice(g,1),g-=1,m-=1}else{y[f]=r(y[f],w);for(var D=0,I=b.length;D<I;D++){var A=b[D];y[A]=i(y[A],a(y[f],v[D]))}}}return n.map((e=>new s({data:e.map((e=>[e])),size:[c,1]})))}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return c(e,t)},"Array, Array | Matrix":function(e,t){return c(n(e),t).map((e=>e.valueOf()))}});function c(e,t){for(var n=[u(e,t,!0)._data.map((e=>e[0]))],c=e._data,l=e._size[0],p=e._size[1]-1;p>=0;p--)for(var h=n.length,d=0;d<h;d++){var f=n[d];if(o(c[p][p],0))if(o(f[p],0)){if(0===d){var m=[...f];m[p]=1;for(var g=p-1;g>=0;g--)m[g]=i(m[g],c[g][p]);n.push(m)}}else{if(0===d)return[];n.splice(d,1),d-=1,h-=1}else{f[p]=r(f[p],c[p][p]);for(var y=p-1;y>=0;y--)f[y]=i(f[y],a(f[p],c[y][p]))}}return n.map((e=>new s({data:e.map((e=>[e])),size:[l,1]})))}})),k$=ZU("matAlgo08xS0Sid",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return function(e,r,a){var i=e._values,o=e._index,s=e._ptr,u=e._size,c=e._datatype||void 0===e._data?e._datatype:e.getDataType(),l=r._values,p=r._index,h=r._ptr,d=r._size,f=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(u.length!==d.length)throw new PP(u.length,d.length);if(u[0]!==d[0]||u[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+d+")");if(!i||!l)throw new Error("Cannot perform operation on Pattern Sparse Matrices");var m,g=u[0],y=u[1],v=n,b=0,x=a;"string"===typeof c&&c===f&&"mixed"!==c&&(m=c,v=t.find(n,[m,m]),b=t.convert(0,m),x=t.find(a,[m,m]));for(var w,N,S,k,E=[],C=[],T=[],D=[],I=[],A=0;A<y;A++){T[A]=C.length;var F=A+1;for(N=s[A],S=s[A+1],w=N;w<S;w++)I[k=o[w]]=F,D[k]=i[w],C.push(k);for(N=h[A],S=h[A+1],w=N;w<S;w++)I[k=p[w]]===F&&(D[k]=x(D[k],l[w]));for(w=T[A];w<C.length;){var _=D[k=C[w]];v(_,b)?C.splice(w,1):(E.push(_),w++)}}return T[y]=C.length,e.createSparseMatrix({values:E,index:C,ptr:T,size:[g,y],datatype:c===e._datatype&&f===r._datatype?m:void 0})}})),E$=ZU("useMatrixForArrayScalar",["typed","matrix"],(e=>{var{typed:t,matrix:n}=e;return{"Array, number":t.referTo("DenseMatrix, number",(e=>(t,r)=>e(n(t),r).valueOf())),"Array, BigNumber":t.referTo("DenseMatrix, BigNumber",(e=>(t,r)=>e(n(t),r).valueOf())),"number, Array":t.referTo("number, DenseMatrix",(e=>(t,r)=>e(t,n(r)).valueOf())),"BigNumber, Array":t.referTo("BigNumber, DenseMatrix",(e=>(t,r)=>e(t,n(r)).valueOf()))}})),C$="leftShift",T$=ZU(C$,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,zeros:a,DenseMatrix:i,concat:o}=e,s=YH({typed:t}),u=VH({typed:t,equalScalar:r}),c=k$({typed:t,equalScalar:r}),l=ZH({typed:t,DenseMatrix:i}),p=NH({typed:t,equalScalar:r}),h=kH({typed:t}),d=KH({typed:t,matrix:n,concat:o}),f=E$({typed:t,matrix:n});return t(C$,{"number, number":jK,"BigNumber, BigNumber":BK,"bigint, bigint":(e,t)=>e<<t,"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>r(n,0)?t.clone():p(t,n,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>r(n,0)?t.clone():h(t,n,e,!1))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,n)=>r(t,0)?a(n.size(),n.storage()):l(n,t,e,!0))),"number | BigNumber, DenseMatrix":t.referToSelf((e=>(t,n)=>r(t,0)?a(n.size(),n.storage()):h(n,t,e,!0)))},f,d({SS:c,DS:s,SD:u}))})),D$="rightArithShift",I$=ZU(D$,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,zeros:a,DenseMatrix:i,concat:o}=e,s=YH({typed:t}),u=VH({typed:t,equalScalar:r}),c=k$({typed:t,equalScalar:r}),l=ZH({typed:t,DenseMatrix:i}),p=NH({typed:t,equalScalar:r}),h=kH({typed:t}),d=KH({typed:t,matrix:n,concat:o}),f=E$({typed:t,matrix:n});return t(D$,{"number, number":GK,"BigNumber, BigNumber":LK,"bigint, bigint":(e,t)=>e>>t,"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>r(n,0)?t.clone():p(t,n,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>r(n,0)?t.clone():h(t,n,e,!1))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,n)=>r(t,0)?a(n.size(),n.storage()):l(n,t,e,!0))),"number | BigNumber, DenseMatrix":t.referToSelf((e=>(t,n)=>r(t,0)?a(n.size(),n.storage()):h(n,t,e,!0)))},f,d({SS:c,DS:s,SD:u}))})),A$="rightLogShift",F$=ZU(A$,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,zeros:a,DenseMatrix:i,concat:o}=e,s=YH({typed:t}),u=VH({typed:t,equalScalar:r}),c=k$({typed:t,equalScalar:r}),l=ZH({typed:t,DenseMatrix:i}),p=NH({typed:t,equalScalar:r}),h=kH({typed:t}),d=KH({typed:t,matrix:n,concat:o}),f=E$({typed:t,matrix:n});return t(A$,{"number, number":HK,"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>r(n,0)?t.clone():p(t,n,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>r(n,0)?t.clone():h(t,n,e,!1))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,n)=>r(t,0)?a(n.size(),n.storage()):l(n,t,e,!0))),"number | BigNumber, DenseMatrix":t.referToSelf((e=>(t,n)=>r(t,0)?a(n.size(),n.storage()):h(n,t,e,!0)))},f,d({SS:c,DS:s,SD:u}))})),_$=ZU("and",["typed","matrix","equalScalar","zeros","not","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,zeros:a,not:i,concat:o}=e,s=VH({typed:t,equalScalar:r}),u=rK({typed:t,equalScalar:r}),c=NH({typed:t,equalScalar:r}),l=kH({typed:t}),p=KH({typed:t,matrix:n,concat:o});return t("and",{"number, number":pX,"Complex, Complex":function(e,t){return(0!==e.re||0!==e.im)&&(0!==t.re||0!==t.im)},"BigNumber, BigNumber":function(e,t){return!e.isZero()&&!t.isZero()&&!e.isNaN()&&!t.isNaN()},"bigint, bigint":pX,"Unit, Unit":t.referToSelf((e=>(t,n)=>e(t.value||0,n.value||0))),"SparseMatrix, any":t.referToSelf((e=>(t,n)=>i(n)?a(t.size(),t.storage()):c(t,n,e,!1))),"DenseMatrix, any":t.referToSelf((e=>(t,n)=>i(n)?a(t.size(),t.storage()):l(t,n,e,!1))),"any, SparseMatrix":t.referToSelf((e=>(t,n)=>i(t)?a(t.size(),t.storage()):c(n,t,e,!0))),"any, DenseMatrix":t.referToSelf((e=>(t,n)=>i(t)?a(t.size(),t.storage()):l(n,t,e,!0))),"Array, any":t.referToSelf((e=>(t,r)=>e(n(t),r).valueOf())),"any, Array":t.referToSelf((e=>(t,r)=>e(t,n(r)).valueOf()))},p({SS:u,DS:s}))})),M$="compare",O$=ZU(M$,["typed","config","matrix","equalScalar","BigNumber","Fraction","DenseMatrix","concat"],(e=>{var{typed:t,config:n,equalScalar:r,matrix:a,BigNumber:i,Fraction:o,DenseMatrix:s,concat:u}=e,c=qH({typed:t}),l=jH({typed:t,equalScalar:r}),p=SH({typed:t,DenseMatrix:s}),h=KH({typed:t,matrix:a,concat:u}),d=yG({typed:t});return t(M$,R$({typed:t,config:n}),{"boolean, boolean":function(e,t){return e===t?0:e>t?1:-1},"BigNumber, BigNumber":function(e,t){return nG(e,t,n.relTol,n.absTol)?new i(0):new i(e.cmp(t))},"bigint, bigint":function(e,t){return e===t?0n:e>t?1n:-1n},"Fraction, Fraction":function(e,t){return new o(e.compare(t))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},d,h({SS:l,DS:c,Ss:p}))})),R$=ZU(M$,["typed","config"],(e=>{var{typed:t,config:n}=e;return t(M$,{"number, number":function(e,t){return SW(e,t,n.relTol,n.absTol)?0:e>t?1:-1}})})),z$=n(939),B$="compareNatural",L$=ZU(B$,["typed","compare"],(e=>{var{typed:t,compare:n}=e,r=n.signatures["boolean,boolean"];return t(B$,{"any, any":function e(t,o){var s,u=VU(t),c=VU(o);if(("number"===u||"BigNumber"===u||"Fraction"===u)&&("number"===c||"BigNumber"===c||"Fraction"===c))return"0"!==(s=n(t,o)).toString()?s>0?1:-1:z$(u,c);var l=["Array","DenseMatrix","SparseMatrix"];if(l.includes(u)||l.includes(c))return 0!==(s=a(e,t,o))?s:z$(u,c);if(u!==c)return z$(u,c);if("Complex"===u)return function(e,t){if(e.re>t.re)return 1;if(e.re<t.re)return-1;if(e.im>t.im)return 1;if(e.im<t.im)return-1;return 0}(t,o);if("Unit"===u)return t.equalBase(o)?e(t.value,o.value):i(e,t.formatUnits(),o.formatUnits());if("boolean"===u)return r(t,o);if("string"===u)return z$(t,o);if("Object"===u)return function(e,t,n){var r=Object.keys(t),a=Object.keys(n);r.sort(z$),a.sort(z$);var o=i(e,r,a);if(0!==o)return o;for(var s=0;s<r.length;s++){var u=e(t[r[s]],n[a[s]]);if(0!==u)return u}return 0}(e,t,o);if("null"===u)return 0;if("undefined"===u)return 0;throw new TypeError('Unsupported type of value "'+u+'"')}});function a(e,t,n){return cU(t)&&cU(n)?i(e,t.toJSON().values,n.toJSON().values):cU(t)?a(e,t.toArray(),n):cU(n)?a(e,t,n.toArray()):uU(t)?a(e,t.toJSON().data,n):uU(n)?a(e,t,n.toJSON().data):Array.isArray(t)?Array.isArray(n)?i(e,t,n):a(e,t,[n]):a(e,[t],n)}function i(e,t,n){for(var r=0,a=Math.min(t.length,n.length);r<a;r++){var i=e(t[r],n[r]);if(0!==i)return i}return t.length>n.length?1:t.length<n.length?-1:0}}));var P$="compareText",U$=["typed","matrix","concat"];sj.signature="any, any";var W$=ZU(P$,U$,(e=>{var{typed:t,matrix:n,concat:r}=e,a=KH({typed:t,matrix:n,concat:r});return t(P$,sj,a({elop:sj,Ds:!0}))})),V$="equal",q$=ZU(V$,["typed","matrix","equalScalar","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,matrix:n,equalScalar:r,DenseMatrix:a,concat:i,SparseMatrix:o}=e,s=qH({typed:t}),u=JK({typed:t,SparseMatrix:o}),c=SH({typed:t,DenseMatrix:a}),l=KH({typed:t,matrix:n,concat:i});return t(V$,j$({typed:t,equalScalar:r}),l({elop:r,SS:u,DS:s,Ss:c}))})),j$=ZU(V$,["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return t(V$,{"any, any":function(e,t){return null===e?null===t:null===t?null===e:void 0===e?void 0===t:void 0===t?void 0===e:n(e,t)}})})),G$="equalText",H$=ZU(G$,["typed","compareText","isZero"],(e=>{var{typed:t,compareText:n,isZero:r}=e;return t(G$,{"any, any":function(e,t){return r(n(e,t))}})})),K$="smaller",X$=ZU(K$,["typed","config","bignumber","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,config:n,bignumber:r,matrix:a,DenseMatrix:i,concat:o,SparseMatrix:s}=e,u=qH({typed:t}),c=JK({typed:t,SparseMatrix:s}),l=SH({typed:t,DenseMatrix:i}),p=KH({typed:t,matrix:a,concat:o}),h=yG({typed:t});function d(e,t){return e.lt(t)&&!nG(e,t,n.relTol,n.absTol)}return t(K$,Y$({typed:t,config:n}),{"boolean, boolean":(e,t)=>e<t,"BigNumber, BigNumber":d,"bigint, bigint":(e,t)=>e<t,"Fraction, Fraction":(e,t)=>-1===e.compare(t),"Fraction, BigNumber":function(e,t){return d(r(e),t)},"BigNumber, Fraction":function(e,t){return d(e,r(t))},"Complex, Complex":function(e,t){throw new TypeError("No ordering relation is defined for complex numbers")}},h,p({SS:c,DS:u,Ss:l}))})),Y$=ZU(K$,["typed","config"],(e=>{var{typed:t,config:n}=e;return t(K$,{"number, number":function(e,t){return e<t&&!SW(e,t,n.relTol,n.absTol)}})})),$$="smallerEq",Z$=ZU($$,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,config:n,matrix:r,DenseMatrix:a,concat:i,SparseMatrix:o}=e,s=qH({typed:t}),u=JK({typed:t,SparseMatrix:o}),c=SH({typed:t,DenseMatrix:a}),l=KH({typed:t,matrix:r,concat:i}),p=yG({typed:t});return t($$,Q$({typed:t,config:n}),{"boolean, boolean":(e,t)=>e<=t,"BigNumber, BigNumber":function(e,t){return e.lte(t)||nG(e,t,n.relTol,n.absTol)},"bigint, bigint":(e,t)=>e<=t,"Fraction, Fraction":(e,t)=>1!==e.compare(t),"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},p,l({SS:u,DS:s,Ss:c}))})),Q$=ZU($$,["typed","config"],(e=>{var{typed:t,config:n}=e;return t($$,{"number, number":function(e,t){return e<=t||SW(e,t,n.relTol,n.absTol)}})})),J$="larger",eZ=ZU(J$,["typed","config","bignumber","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,config:n,bignumber:r,matrix:a,DenseMatrix:i,concat:o,SparseMatrix:s}=e,u=qH({typed:t}),c=JK({typed:t,SparseMatrix:s}),l=SH({typed:t,DenseMatrix:i}),p=KH({typed:t,matrix:a,concat:o}),h=yG({typed:t});function d(e,t){return e.gt(t)&&!nG(e,t,n.relTol,n.absTol)}return t(J$,tZ({typed:t,config:n}),{"boolean, boolean":(e,t)=>e>t,"BigNumber, BigNumber":d,"bigint, bigint":(e,t)=>e>t,"Fraction, Fraction":(e,t)=>1===e.compare(t),"Fraction, BigNumber":function(e,t){return d(r(e),t)},"BigNumber, Fraction":function(e,t){return d(e,r(t))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},h,p({SS:c,DS:u,Ss:l}))})),tZ=ZU(J$,["typed","config"],(e=>{var{typed:t,config:n}=e;return t(J$,{"number, number":function(e,t){return e>t&&!SW(e,t,n.relTol,n.absTol)}})})),nZ="largerEq",rZ=ZU(nZ,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,config:n,matrix:r,DenseMatrix:a,concat:i,SparseMatrix:o}=e,s=qH({typed:t}),u=JK({typed:t,SparseMatrix:o}),c=SH({typed:t,DenseMatrix:a}),l=KH({typed:t,matrix:r,concat:i}),p=yG({typed:t});return t(nZ,aZ({typed:t,config:n}),{"boolean, boolean":(e,t)=>e>=t,"BigNumber, BigNumber":function(e,t){return e.gte(t)||nG(e,t,n.relTol,n.absTol)},"bigint, bigint":function(e,t){return e>=t},"Fraction, Fraction":(e,t)=>-1!==e.compare(t),"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},p,l({SS:u,DS:s,Ss:c}))})),aZ=ZU(nZ,["typed","config"],(e=>{var{typed:t,config:n}=e;return t(nZ,{"number, number":function(e,t){return e>=t||SW(e,t,n.relTol,n.absTol)}})})),iZ="deepEqual",oZ=ZU(iZ,["typed","equal"],(e=>{var{typed:t,equal:n}=e;return t(iZ,{"any, any":function(e,t){return r(e.valueOf(),t.valueOf())}});function r(e,t){if(Array.isArray(e)){if(Array.isArray(t)){var a=e.length;if(a!==t.length)return!1;for(var i=0;i<a;i++)if(!r(e[i],t[i]))return!1;return!0}return!1}return!Array.isArray(t)&&n(e,t)}})),sZ="unequal",uZ=ZU(sZ,["typed","config","equalScalar","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,config:n,equalScalar:r,matrix:a,DenseMatrix:i,concat:o,SparseMatrix:s}=e,u=qH({typed:t}),c=JK({typed:t,SparseMatrix:s}),l=SH({typed:t,DenseMatrix:i}),p=KH({typed:t,matrix:a,concat:o});return t(sZ,cZ({typed:t,equalScalar:r}),p({elop:function(e,t){return!r(e,t)},SS:c,DS:u,Ss:l}))})),cZ=ZU(sZ,["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return t(sZ,{"any, any":function(e,t){return null===e?null!==t:null===t?null!==e:void 0===e?void 0!==t:void 0===t?void 0!==e:!n(e,t)}})})),lZ="partitionSelect",pZ=ZU(lZ,["typed","isNumeric","isNaN","compare"],(e=>{var{typed:t,isNumeric:n,isNaN:r,compare:a}=e,i=a,o=(e,t)=>-a(e,t);return t(lZ,{"Array | Matrix, number":function(e,t){return s(e,t,i)},"Array | Matrix, number, string":function(e,t,n){if("asc"===n)return s(e,t,i);if("desc"===n)return s(e,t,o);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":s});function s(e,t,n){if(!sW(t)||t<0)throw new Error("k must be a non-negative integer");if(oU(e)){if(e.size().length>1)throw new Error("Only one dimensional matrices supported");return u(e.valueOf(),t,n)}if(Array.isArray(e))return u(e,t,n)}function u(e,t,a){if(t>=e.length)throw new Error("k out of bounds");for(var i=0;i<e.length;i++)if(n(e[i])&&r(e[i]))return e[i];for(var o=0,s=e.length-1;o<s;){for(var u=o,c=s,l=e[Math.floor(Math.random()*(s-o+1))+o];u<c;)if(a(e[u],l)>=0){var p=e[c];e[c]=e[u],e[u]=p,--c}else++u;a(e[u],l)>0&&--u,t<=u?s=u:o=u+1}return e[t]}})),hZ="sort",dZ=ZU(hZ,["typed","matrix","compare","compareNatural"],(e=>{var{typed:t,matrix:n,compare:r,compareNatural:a}=e,i=r,o=(e,t)=>-r(e,t);return t(hZ,{Array:function(e){return u(e),e.sort(i)},Matrix:function(e){return c(e),n(e.toArray().sort(i),e.storage())},"Array, function":function(e,t){return u(e),e.sort(t)},"Matrix, function":function(e,t){return c(e),n(e.toArray().sort(t),e.storage())},"Array, string":function(e,t){return u(e),e.sort(s(t))},"Matrix, string":function(e,t){return c(e),n(e.toArray().sort(s(t)),e.storage())}});function s(e){if("asc"===e)return i;if("desc"===e)return o;if("natural"===e)return a;throw new Error('String "asc", "desc", or "natural" expected')}function u(e){if(1!==uj(e).length)throw new Error("One dimensional array expected")}function c(e){if(1!==e.size().length)throw new Error("One dimensional matrix expected")}})),fZ=ZU("max",["typed","config","numeric","larger"],(e=>{var{typed:t,config:n,numeric:r,larger:a}=e;return t("max",{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(e,t){return Kj(e,t.valueOf(),i)},"...":function(e){if(jj(e))throw new TypeError("Scalar values expected in function max");return o(e)}});function i(e,t){try{return a(e,t)?e:t}catch(r5){throw zY(r5,"max",t)}}function o(e){var t;if(Gj(e,(function(e){try{"number"===typeof e&&isNaN(e)?t=NaN:(void 0===t||a(e,t))&&(t=e)}catch(r5){throw zY(r5,"max",e)}})),void 0===t)throw new Error("Cannot calculate max of an empty array");return"string"===typeof t&&(t=r(t,uW(t,n))),t}})),mZ=ZU("min",["typed","config","numeric","smaller"],(e=>{var{typed:t,config:n,numeric:r,smaller:a}=e;return t("min",{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(e,t){return Kj(e,t.valueOf(),i)},"...":function(e){if(jj(e))throw new TypeError("Scalar values expected in function min");return o(e)}});function i(e,t){try{return a(e,t)?e:t}catch(r5){throw zY(r5,"min",t)}}function o(e){var t;if(Gj(e,(function(e){try{"number"===typeof e&&isNaN(e)?t=NaN:(void 0===t||a(e,t))&&(t=e)}catch(r5){throw zY(r5,"min",e)}})),void 0===t)throw new Error("Cannot calculate min of an empty array");return"string"===typeof t&&(t=r(t,uW(t,n))),t}})),gZ=ZU("ImmutableDenseMatrix",["smaller","DenseMatrix"],(e=>{var{smaller:t,DenseMatrix:n}=e;function r(e,t){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!aU(t))throw new Error("Invalid datatype: "+t);if(oU(e)||iU(e)){var a=new n(e,t);this._data=a._data,this._size=a._size,this._datatype=a._datatype,this._min=null,this._max=null}else if(e&&iU(e.data)&&iU(e.size))this._data=e.data,this._size=e.size,this._datatype=e.datatype,this._min="undefined"!==typeof e.min?e.min:null,this._max="undefined"!==typeof e.max?e.max:null;else{if(e)throw new TypeError("Unsupported type of data ("+VU(e)+")");this._data=[],this._size=[0],this._datatype=t,this._min=null,this._max=null}}return r.prototype=new n,r.prototype.type="ImmutableDenseMatrix",r.prototype.isImmutableDenseMatrix=!0,r.prototype.subset=function(e){switch(arguments.length){case 1:var t=n.prototype.subset.call(this,e);return oU(t)?new r({data:t._data,size:t._size,datatype:t._datatype}):t;case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},r.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},r.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},r.prototype.clone=function(){return new r({data:qU(this._data),size:qU(this._size),datatype:this._datatype})},r.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.fromJSON=function(e){return new r(e)},r.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},r.prototype.min=function(){if(null===this._min){var e=null;this.forEach((function(n){(null===e||t(n,e))&&(e=n)})),this._min=null!==e?e:void 0}return this._min},r.prototype.max=function(){if(null===this._max){var e=null;this.forEach((function(n){(null===e||t(e,n))&&(e=n)})),this._max=null!==e?e:void 0}return this._max},r}),{isClass:!0}),yZ=ZU("Index",["ImmutableDenseMatrix","getMatrixDataType"],(e=>{var{ImmutableDenseMatrix:t,getMatrixDataType:n}=e;function r(e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._sourceSize=[],this._isScalar=!0;for(var t=0,i=arguments.length;t<i;t++){var o=arguments[t],s=iU(o),u=oU(o),c=null;if(lU(o))this._dimensions.push(o),this._isScalar=!1;else if(s||u){var l=void 0;"boolean"===n(o)?(s&&(l=a(vZ(o).valueOf())),u&&(l=a(vZ(o._data).valueOf())),c=o.valueOf().length):l=a(o.valueOf()),this._dimensions.push(l);var p=l.size();1===p.length&&1===p[0]&&null===c||(this._isScalar=!1)}else if("number"===typeof o)this._dimensions.push(a([o]));else{if("string"!==typeof o)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._dimensions.push(o)}this._sourceSize.push(c)}}function a(e){for(var n=0,r=e.length;n<r;n++)if("number"!==typeof e[n]||!sW(e[n]))throw new TypeError("Index parameters must be positive integer numbers");return new t(e)}return r.prototype.type="Index",r.prototype.isIndex=!0,r.prototype.clone=function(){var e=new r;return e._dimensions=qU(this._dimensions),e._isScalar=this._isScalar,e._sourceSize=this._sourceSize,e},r.create=function(e){var t=new r;return r.apply(t,e),t},r.prototype.size=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e[t]="string"===typeof r?1:r.size()[0]}return e},r.prototype.max=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e[t]="string"===typeof r?r:r.max()}return e},r.prototype.min=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e[t]="string"===typeof r?r:r.min()}return e},r.prototype.forEach=function(e){for(var t=0,n=this._dimensions.length;t<n;t++)e(this._dimensions[t],t,this)},r.prototype.dimension=function(e){return"number"!==typeof e?null:this._dimensions[e]||null},r.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&"string"===typeof this._dimensions[0]},r.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},r.prototype.isScalar=function(){return this._isScalar},r.prototype.toArray=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e.push("string"===typeof r?r:r.toArray())}return e},r.prototype.valueOf=r.prototype.toArray,r.prototype.toString=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];"string"===typeof r?e.push(JSON.stringify(r)):e.push(r.toString())}return"["+e.join(", ")+"]"},r.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},r.fromJSON=function(e){return r.create(e.dimensions)},r}),{isClass:!0});function vZ(e){var t=[];return e.forEach(((e,n)=>{e&&t.push(n)})),t}var bZ=ZU("FibonacciHeap",["smaller","larger"],(e=>{var{smaller:t,larger:n}=e,r=1/Math.log((1+Math.sqrt(5))/2);function a(){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}function i(e,t,n){t.left.right=t.right,t.right.left=t.left,n.degree--,n.child===t&&(n.child=t.right),0===n.degree&&(n.child=null),t.left=e,t.right=e.right,e.right=t,t.right.left=t,t.parent=null,t.mark=!1}function o(e,t){var n=t.parent;n&&(t.mark?(i(e,t,n),o(n)):t.mark=!0)}a.prototype.type="FibonacciHeap",a.prototype.isFibonacciHeap=!0,a.prototype.insert=function(e,n){var r={key:e,value:n,degree:0};if(this._minimum){var a=this._minimum;r.left=a,r.right=a.right,a.right=r,r.right.left=r,t(e,a.key)&&(this._minimum=r)}else r.left=r,r.right=r,this._minimum=r;return this._size++,r},a.prototype.size=function(){return this._size},a.prototype.clear=function(){this._minimum=null,this._size=0},a.prototype.isEmpty=function(){return 0===this._size},a.prototype.extractMinimum=function(){var e=this._minimum;if(null===e)return e;for(var a=this._minimum,i=e.degree,o=e.child;i>0;){var u=o.right;o.left.right=o.right,o.right.left=o.left,o.left=a,o.right=a.right,a.right=o,o.right.left=o,o.parent=null,o=u,i--}return e.left.right=e.right,e.right.left=e.left,a=e===e.right?null:function(e,a){var i,o=Math.floor(Math.log(a)*r)+1,u=new Array(o),c=0,l=e;if(l)for(c++,l=l.right;l!==e;)c++,l=l.right;for(;c>0;){for(var p=l.degree,h=l.right;i=u[p];){if(n(l.key,i.key)){var d=i;i=l,l=d}s(i,l),u[p]=null,p++}u[p]=l,l=h,c--}e=null;for(var f=0;f<o;f++)(i=u[f])&&(e?(i.left.right=i.right,i.right.left=i.left,i.left=e,i.right=e.right,e.right=i,i.right.left=i,t(i.key,e.key)&&(e=i)):e=i);return e}(a=e.right,this._size),this._size--,this._minimum=a,e},a.prototype.remove=function(e){this._minimum=function(e,n,r){n.key=r;var a=n.parent;a&&t(n.key,a.key)&&(i(e,n,a),o(e,a));t(n.key,e.key)&&(e=n);return e}(this._minimum,e,-1),this.extractMinimum()};var s=function(e,t){e.left.right=e.right,e.right.left=e.left,e.parent=t,t.child?(e.left=t.child,e.right=t.child.right,t.child.right=e,e.right.left=e):(t.child=e,e.right=e,e.left=e),t.degree++,e.mark=!1};return a}),{isClass:!0}),xZ=ZU("Spa",["addScalar","equalScalar","FibonacciHeap"],(e=>{var{addScalar:t,equalScalar:n,FibonacciHeap:r}=e;function a(){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new r}return a.prototype.type="Spa",a.prototype.isSpa=!0,a.prototype.set=function(e,t){if(this._values[e])this._values[e].value=t;else{var n=this._heap.insert(e,t);this._values[e]=n}},a.prototype.get=function(e){var t=this._values[e];return t?t.value:0},a.prototype.accumulate=function(e,n){var r=this._values[e];r?r.value=t(r.value,n):(r=this._heap.insert(e,n),this._values[e]=r)},a.prototype.forEach=function(e,t,r){var a=this._heap,i=this._values,o=[],s=a.extractMinimum();for(s&&o.push(s);s&&s.key<=t;)s.key>=e&&(n(s.value,0)||r(s.key,s.value,this)),(s=a.extractMinimum())&&o.push(s);for(var u=0;u<o.length;u++){var c=o[u];i[(s=a.insert(c.key,c.value)).key]=s}},a.prototype.swap=function(e,t){var n=this._values[e],r=this._values[t];if(!n&&r)n=this._heap.insert(e,r.value),this._heap.remove(r),this._values[e]=n,this._values[t]=void 0;else if(n&&!r)r=this._heap.insert(t,n.value),this._heap.remove(n),this._values[t]=r,this._values[e]=void 0;else if(n&&r){var a=n.value;n.value=r.value,r.value=a}},a}),{isClass:!0});function wZ(e){var t=0,n=1,r=Object.create(null),a=Object.create(null),i=0,o=function(e){var o=a[e];if(o&&(delete r[o],delete a[e],--t,n===o)){if(!t)return i=0,void(n=1);for(;!Object.prototype.hasOwnProperty.call(r,++n););}};return e=Math.abs(e),{hit:function(s){var u=a[s],c=++i;if(r[c]=s,a[s]=c,!u){if(++t<=e)return;return s=r[n],o(s),s}if(delete r[u],n===u)for(;!Object.prototype.hasOwnProperty.call(r,++n););},delete:o,clear:function(){t=i=0,n=1,r=Object.create(null),a=Object.create(null)}}}function NZ(e){var{hasher:t,limit:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=null==n?Number.POSITIVE_INFINITY:n,t=null==t?JSON.stringify:t,function r(){"object"!==typeof r.cache&&(r.cache={values:new Map,lru:wZ(n||Number.POSITIVE_INFINITY)});for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];var o=t(a);if(r.cache.values.has(o))return r.cache.lru.hit(o),r.cache.values.get(o);var s=e.apply(e,a);return r.cache.values.set(o,s),r.cache.values.delete(r.cache.lru.hit(o)),s}}var SZ=NZ((function(e){return new e(1).exp()}),{hasher:TZ}),kZ=NZ((function(e){return new e(1).plus(new e(5).sqrt()).div(2)}),{hasher:TZ}),EZ=NZ((function(e){return e.acos(-1)}),{hasher:TZ}),CZ=NZ((function(e){return EZ(e).times(2)}),{hasher:TZ});function TZ(e){return e[0].precision}function DZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function IZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?DZ(Object(n),!0).forEach((function(t){SY(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DZ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var AZ=ZU("Unit",["?on","config","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","abs","fix","round","equal","isNumeric","format","number","Complex","BigNumber","Fraction"],(e=>{var t,n,r,{on:a,config:i,addScalar:o,subtractScalar:s,multiplyScalar:u,divideScalar:c,pow:l,abs:p,fix:h,round:d,equal:f,isNumeric:m,format:g,number:y,Complex:v,BigNumber:b,Fraction:x}=e,w=y;function N(e,t){if(!(this instanceof N))throw new Error("Constructor must be called with the new operator");if(null!==e&&void 0!==e&&!m(e)&&!tU(e))throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(this.fixPrefix=!1,this.skipAutomaticSimplification=!0,void 0===t)this.units=[],this.dimensions=M.map((e=>0));else if("string"===typeof t){var n=N.parse(t);this.units=n.units,this.dimensions=n.dimensions}else{if(!rU(t)||null!==t.value)throw new TypeError("Second parameter in Unit constructor must be a string or valueless Unit");this.fixPrefix=t.fixPrefix,this.skipAutomaticSimplification=t.skipAutomaticSimplification,this.dimensions=t.dimensions.slice(0),this.units=t.units.map((e=>zP({},e)))}this.value=this._normalize(e)}function S(){for(;" "===r||"\t"===r;)E()}function k(e){return e>="0"&&e<="9"}function E(){n++,r=t.charAt(n)}function C(e){n=e,r=t.charAt(n)}function T(){var e="",t=n;if("+"===r?E():"-"===r&&(e+=r,E()),!function(e){return e>="0"&&e<="9"||"."===e}(r))return C(t),null;if("."===r){if(e+=r,E(),!k(r))return C(t),null}else{for(;k(r);)e+=r,E();"."===r&&(e+=r,E())}for(;k(r);)e+=r,E();if("E"===r||"e"===r){var a="",i=n;if(a+=r,E(),"+"!==r&&"-"!==r||(a+=r,E()),!k(r))return C(i),e;for(e+=a;k(r);)e+=r,E()}return e}function D(){for(var e="";k(r)||N.isValidAlpha(r);)e+=r,E();var t=e.charAt(0);return N.isValidAlpha(t)?e:null}function I(e){return r===e?(E(),e):null}Object.defineProperty(N,"name",{value:"Unit"}),N.prototype.constructor=N,N.prototype.type="Unit",N.prototype.isUnit=!0,N.parse=function(e,a){if(a=a||{},n=-1,r="","string"!==typeof(t=e))throw new TypeError("Invalid argument in Unit.parse, string expected");var o=new N;o.units=[];var s=1,u=!1;E(),S();var c=T(),l=null;if(c){if("BigNumber"===i.number)l=new b(c);else if("Fraction"===i.number)try{l=new x(c)}catch(r5){l=parseFloat(c)}else l=parseFloat(c);S(),I("*")?(s=1,u=!0):I("/")&&(s=-1,u=!0)}for(var p=[],h=1;;){for(S();"("===r;)p.push(s),h*=s,s=1,E(),S();var d=void 0;if(!r)break;var f=r;if(null===(d=D()))throw new SyntaxError('Unexpected "'+f+'" in "'+t+'" at index '+n.toString());var m=A(d);if(null===m)throw new SyntaxError('Unit "'+d+'" not found.');var g=s*h;if(S(),I("^")){S();var y=T();if(null===y)throw new SyntaxError('In "'+e+'", "^" must be followed by a floating-point number');g*=y}o.units.push({unit:m.unit,prefix:m.prefix,power:g});for(var v=0;v<M.length;v++)o.dimensions[v]+=(m.unit.dimensions[v]||0)*g;for(S();")"===r;){if(0===p.length)throw new SyntaxError('Unmatched ")" in "'+t+'" at index '+n.toString());h/=p.pop(),E(),S()}if(u=!1,I("*")?(s=1,u=!0):I("/")?(s=-1,u=!0):s=1,m.unit.base){var w=m.unit.base.key;U.auto[w]={unit:m.unit,prefix:m.prefix}}}if(S(),r)throw new SyntaxError('Could not parse: "'+e+'"');if(u)throw new SyntaxError('Trailing characters: "'+e+'"');if(0!==p.length)throw new SyntaxError('Unmatched "(" in "'+t+'"');if(0===o.units.length&&!a.allowNoUnits)throw new SyntaxError('"'+e+'" contains no units');return o.value=void 0!==l?o._normalize(l):null,o},N.prototype.clone=function(){var e=new N;e.fixPrefix=this.fixPrefix,e.skipAutomaticSimplification=this.skipAutomaticSimplification,e.value=qU(this.value),e.dimensions=this.dimensions.slice(0),e.units=[];for(var t=0;t<this.units.length;t++)for(var n in e.units[t]={},this.units[t])$U(this.units[t],n)&&(e.units[t][n]=this.units[t][n]);return e},N.prototype.valueType=function(){return VU(this.value)},N.prototype._isDerived=function(){return 0!==this.units.length&&(this.units.length>1||Math.abs(this.units[0].power-1)>1e-15)},N.prototype._normalize=function(e){if(null===e||void 0===e||0===this.units.length)return e;for(var t=e,n=N._getNumberConverter(VU(e)),r=0;r<this.units.length;r++){var a=n(this.units[r].unit.value),i=n(this.units[r].prefix.value),o=n(this.units[r].power);t=u(t,l(u(a,i),o))}return t},N.prototype._denormalize=function(e,t){if(null===e||void 0===e||0===this.units.length)return e;for(var n=e,r=N._getNumberConverter(VU(e)),a=0;a<this.units.length;a++){var i=r(this.units[a].unit.value),o=r(this.units[a].prefix.value),s=r(this.units[a].power);n=c(n,l(u(i,o),s))}return n};var A=NZ((e=>{if($U(B,e)){var t=B[e];return{unit:t,prefix:t.prefixes[""]}}for(var n in B)if($U(B,n)&&tj(e,n)){var r=B[n],a=e.length-n.length,i=e.substring(0,a),o=$U(r.prefixes,i)?r.prefixes[i]:void 0;if(void 0!==o)return{unit:r,prefix:o}}return null}),{hasher:e=>e[0],limit:100});function F(e){return e.equalBase(O.NONE)&&null!==e.value&&!i.predictable?e.value:e}N.isValuelessUnit=function(e){return null!==A(e)},N.prototype.hasBase=function(e){if("string"===typeof e&&(e=O[e]),!e)return!1;for(var t=0;t<M.length;t++)if(Math.abs((this.dimensions[t]||0)-(e.dimensions[t]||0))>1e-12)return!1;return!0},N.prototype.equalBase=function(e){for(var t=0;t<M.length;t++)if(Math.abs((this.dimensions[t]||0)-(e.dimensions[t]||0))>1e-12)return!1;return!0},N.prototype.equals=function(e){return this.equalBase(e)&&f(this.value,e.value)},N.prototype.multiply=function(e){for(var t=this.clone(),n=rU(e)?e:new N(e),r=0;r<M.length;r++)t.dimensions[r]=(this.dimensions[r]||0)+(n.dimensions[r]||0);for(var a=0;a<n.units.length;a++){var i=IZ({},n.units[a]);t.units.push(i)}if(null!==this.value||null!==n.value){var o=null===this.value?this._normalize(1):this.value,s=null===n.value?n._normalize(1):n.value;t.value=u(o,s)}else t.value=null;return rU(e)&&(t.skipAutomaticSimplification=!1),F(t)},N.prototype.divideInto=function(e){return new N(e).divide(this)},N.prototype.divide=function(e){for(var t=this.clone(),n=rU(e)?e:new N(e),r=0;r<M.length;r++)t.dimensions[r]=(this.dimensions[r]||0)-(n.dimensions[r]||0);for(var a=0;a<n.units.length;a++){var i=IZ(IZ({},n.units[a]),{},{power:-n.units[a].power});t.units.push(i)}if(null!==this.value||null!==n.value){var o=null===this.value?this._normalize(1):this.value,s=null===n.value?n._normalize(1):n.value;t.value=c(o,s)}else t.value=null;return rU(e)&&(t.skipAutomaticSimplification=!1),F(t)},N.prototype.pow=function(e){for(var t=this.clone(),n=0;n<M.length;n++)t.dimensions[n]=(this.dimensions[n]||0)*e;for(var r=0;r<t.units.length;r++)t.units[r].power*=e;return null!==t.value?t.value=l(t.value,e):t.value=null,t.skipAutomaticSimplification=!1,F(t)},N.prototype.abs=function(){var e=this.clone();if(null!==e.value)if(e._isDerived()||0===e.units.length||0===e.units[0].unit.offset)e.value=p(e.value);else{var t=e._numberConverter(),n=t(e.units[0].unit.value),r=t(e.units[0].unit.offset),a=u(n,r);e.value=s(p(o(e.value,a)),a)}for(var i in e.units)"VA"!==e.units[i].unit.name&&"VAR"!==e.units[i].unit.name||(e.units[i].unit=B.W);return e},N.prototype.to=function(e){var t,n=null===this.value?this._normalize(1):this.value;if("string"===typeof e)t=N.parse(e);else{if(!rU(e))throw new Error("String or Unit expected as parameter");t=e.clone()}if(!this.equalBase(t))throw new Error("Units do not match ('".concat(t.toString(),"' != '").concat(this.toString(),"')"));if(null!==t.value)throw new Error("Cannot convert to a unit with a value");if(null===this.value||this._isDerived()||0===this.units.length||0===t.units.length||this.units[0].unit.offset===t.units[0].unit.offset)t.value=qU(n);else{var r=N._getNumberConverter(VU(n)),a=this.units[0].unit.value,i=this.units[0].unit.offset,c=u(a,i),l=t.units[0].unit.value,p=t.units[0].unit.offset,h=u(l,p);t.value=o(n,r(s(c,h)))}return t.fixPrefix=!0,t.skipAutomaticSimplification=!0,t},N.prototype.toNumber=function(e){return w(this.toNumeric(e))},N.prototype.toNumeric=function(e){var t;return(t=e?this.to(e):this.clone())._isDerived()||0===t.units.length?t._denormalize(t.value):t._denormalize(t.value,t.units[0].prefix.value)},N.prototype.toString=function(){return this.format()},N.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.units.length>0?this.formatUnits():null,fixPrefix:this.fixPrefix}},N.fromJSON=function(e){var t,n=new N(e.value,null!==(t=e.unit)&&void 0!==t?t:void 0);return n.fixPrefix=e.fixPrefix||!1,n},N.prototype.valueOf=N.prototype.toString,N.prototype.simplify=function(){var e,t,n=this.clone(),r=[];for(var a in W)if($U(W,a)&&n.hasBase(O[a])){e=a;break}if("NONE"===e)n.units=[];else if(e&&$U(W,e)&&(t=W[e]),t)n.units=[{unit:t.unit,prefix:t.prefix,power:1}];else{for(var i=!1,o=0;o<M.length;o++){var s=M[o];Math.abs(n.dimensions[o]||0)>1e-12&&($U(W,s)?r.push({unit:W[s].unit,prefix:W[s].prefix,power:n.dimensions[o]||0}):i=!0)}r.length<n.units.length&&!i&&(n.units=r)}return n},N.prototype.toSI=function(){for(var e=this.clone(),t=[],n=0;n<M.length;n++){var r=M[n];if(Math.abs(e.dimensions[n]||0)>1e-12){if(!$U(U.si,r))throw new Error("Cannot express custom unit "+r+" in SI units");t.push({unit:U.si[r].unit,prefix:U.si[r].prefix,power:e.dimensions[n]||0})}}return e.units=t,e.fixPrefix=!0,e.skipAutomaticSimplification=!0,null!==this.value?(e.value=null,this.to(e)):e},N.prototype.formatUnits=function(){for(var e="",t="",n=0,r=0,a=0;a<this.units.length;a++)this.units[a].power>0?(n++,e+=" "+this.units[a].prefix.name+this.units[a].unit.name,Math.abs(this.units[a].power-1)>1e-15&&(e+="^"+this.units[a].power)):this.units[a].power<0&&r++;if(r>0)for(var i=0;i<this.units.length;i++)this.units[i].power<0&&(n>0?(t+=" "+this.units[i].prefix.name+this.units[i].unit.name,Math.abs(this.units[i].power+1)>1e-15&&(t+="^"+-this.units[i].power)):(t+=" "+this.units[i].prefix.name+this.units[i].unit.name,t+="^"+this.units[i].power));e=e.substr(1),t=t.substr(1),n>1&&r>0&&(e="("+e+")"),r>1&&n>0&&(t="("+t+")");var o=e;return n>0&&r>0&&(o+=" / "),o+=t},N.prototype.format=function(e){var t=this.skipAutomaticSimplification||null===this.value?this.clone():this.simplify(),n=!1;for(var r in"undefined"!==typeof t.value&&null!==t.value&&tU(t.value)&&(n=Math.abs(t.value.re)<1e-14),t.units)$U(t.units,r)&&t.units[r].unit&&("VA"===t.units[r].unit.name&&n?t.units[r].unit=B.VAR:"VAR"!==t.units[r].unit.name||n||(t.units[r].unit=B.VA));1!==t.units.length||t.fixPrefix||Math.abs(t.units[0].power-Math.round(t.units[0].power))<1e-14&&(t.units[0].prefix=t._bestPrefix());var a=t._denormalize(t.value),i=null!==t.value?g(a,e||{}):"",o=t.formatUnits();return t.value&&tU(t.value)&&(i="("+i+")"),o.length>0&&i.length>0&&(i+=" "),i+=o},N.prototype._bestPrefix=function(){if(1!==this.units.length)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var e=null!==this.value?p(this.value):0,t=p(this.units[0].unit.value),n=this.units[0].prefix;if(0===e)return n;var r=this.units[0].power,a=Math.log(e/Math.pow(n.value*t,r))/Math.LN10-1.2;if(a>-2.200001&&a<1.800001)return n;a=Math.abs(a);var i=this.units[0].unit.prefixes;for(var o in i)if($U(i,o)){var s=i[o];if(s.scientific){var u=Math.abs(Math.log(e/Math.pow(s.value*t,r))/Math.LN10-1.2);(u<a||u===a&&s.name.length<n.name.length)&&(n=s,a=u)}}return n},N.prototype.splitUnit=function(e){for(var t=this.clone(),n=[],r=0;r<e.length&&(t=t.to(e[r]),r!==e.length-1);r++){var a=t.toNumeric(),i=d(a),u=new N(f(i,a)?i:h(t.toNumeric()),e[r].toString());n.push(u),t=s(t,u)}for(var c=0,l=0;l<n.length;l++)c=o(c,n[l].value);return f(c,this.value)&&(t.value=0),n.push(t),n};var _={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},R:{name:"R",value:1e27,scientific:!0},Q:{name:"Q",value:1e30,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0},r:{name:"r",value:1e-27,scientific:!0},q:{name:"q",value:1e-30,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},ronna:{name:"ronna",value:1e27,scientific:!0},quetta:{name:"quetta",value:1e30,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0},ronto:{name:"ronto",value:1e-27,scientific:!0},quecto:{name:"quecto",value:1e-30,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},R:{name:"R",value:1e54,scientific:!0},Q:{name:"Q",value:1e60,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0},r:{name:"r",value:1e-54,scientific:!0},q:{name:"q",value:1e-60,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},R:{name:"R",value:1e81,scientific:!0},Q:{name:"Q",value:1e90,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0},r:{name:"r",value:1e-81,scientific:!0},q:{name:"q",value:1e-90,scientific:!0}},BINARY_SHORT_SI:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0}},BINARY_SHORT_IEC:{"":{name:"",value:1,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG_SI:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0}},BINARY_LONG_IEC:{"":{name:"",value:1,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};_.SHORTLONG=zP({},_.SHORT,_.LONG),_.BINARY_SHORT=zP({},_.BINARY_SHORT_SI,_.BINARY_SHORT_IEC),_.BINARY_LONG=zP({},_.BINARY_LONG_SI,_.BINARY_LONG_IEC);var M=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],O={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var R in O)$U(O,R)&&(O[R].key=R);var z={name:"",base:{},value:1,offset:0,dimensions:M.map((e=>0))},B={meter:{name:"meter",base:O.LENGTH,prefixes:_.LONG,value:1,offset:0},inch:{name:"inch",base:O.LENGTH,prefixes:_.NONE,value:.0254,offset:0},foot:{name:"foot",base:O.LENGTH,prefixes:_.NONE,value:.3048,offset:0},yard:{name:"yard",base:O.LENGTH,prefixes:_.NONE,value:.9144,offset:0},mile:{name:"mile",base:O.LENGTH,prefixes:_.NONE,value:1609.344,offset:0},link:{name:"link",base:O.LENGTH,prefixes:_.NONE,value:.201168,offset:0},rod:{name:"rod",base:O.LENGTH,prefixes:_.NONE,value:5.0292,offset:0},chain:{name:"chain",base:O.LENGTH,prefixes:_.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:O.LENGTH,prefixes:_.NONE,value:1e-10,offset:0},m:{name:"m",base:O.LENGTH,prefixes:_.SHORT,value:1,offset:0},in:{name:"in",base:O.LENGTH,prefixes:_.NONE,value:.0254,offset:0},ft:{name:"ft",base:O.LENGTH,prefixes:_.NONE,value:.3048,offset:0},yd:{name:"yd",base:O.LENGTH,prefixes:_.NONE,value:.9144,offset:0},mi:{name:"mi",base:O.LENGTH,prefixes:_.NONE,value:1609.344,offset:0},li:{name:"li",base:O.LENGTH,prefixes:_.NONE,value:.201168,offset:0},rd:{name:"rd",base:O.LENGTH,prefixes:_.NONE,value:5.02921,offset:0},ch:{name:"ch",base:O.LENGTH,prefixes:_.NONE,value:20.1168,offset:0},mil:{name:"mil",base:O.LENGTH,prefixes:_.NONE,value:254e-7,offset:0},m2:{name:"m2",base:O.SURFACE,prefixes:_.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:O.SURFACE,prefixes:_.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:O.SURFACE,prefixes:_.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:O.SURFACE,prefixes:_.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:O.SURFACE,prefixes:_.NONE,value:2589988.110336,offset:0},sqrd:{name:"sqrd",base:O.SURFACE,prefixes:_.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:O.SURFACE,prefixes:_.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:O.SURFACE,prefixes:_.NONE,value:6.4516e-10,offset:0},acre:{name:"acre",base:O.SURFACE,prefixes:_.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:O.SURFACE,prefixes:_.NONE,value:1e4,offset:0},m3:{name:"m3",base:O.VOLUME,prefixes:_.CUBIC,value:1,offset:0},L:{name:"L",base:O.VOLUME,prefixes:_.SHORT,value:.001,offset:0},l:{name:"l",base:O.VOLUME,prefixes:_.SHORT,value:.001,offset:0},litre:{name:"litre",base:O.VOLUME,prefixes:_.LONG,value:.001,offset:0},cuin:{name:"cuin",base:O.VOLUME,prefixes:_.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:O.VOLUME,prefixes:_.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:O.VOLUME,prefixes:_.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:O.VOLUME,prefixes:_.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:O.VOLUME,prefixes:_.NONE,value:15e-6,offset:0},drop:{name:"drop",base:O.VOLUME,prefixes:_.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:O.VOLUME,prefixes:_.NONE,value:5e-8,offset:0},minim:{name:"minim",base:O.VOLUME,prefixes:_.NONE,value:6.1611519921875e-8,offset:0},fluiddram:{name:"fluiddram",base:O.VOLUME,prefixes:_.NONE,value:36966911953125e-19,offset:0},fluidounce:{name:"fluidounce",base:O.VOLUME,prefixes:_.NONE,value:295735295625e-16,offset:0},gill:{name:"gill",base:O.VOLUME,prefixes:_.NONE,value:.00011829411825,offset:0},cc:{name:"cc",base:O.VOLUME,prefixes:_.NONE,value:1e-6,offset:0},cup:{name:"cup",base:O.VOLUME,prefixes:_.NONE,value:.0002365882365,offset:0},pint:{name:"pint",base:O.VOLUME,prefixes:_.NONE,value:.000473176473,offset:0},quart:{name:"quart",base:O.VOLUME,prefixes:_.NONE,value:.000946352946,offset:0},gallon:{name:"gallon",base:O.VOLUME,prefixes:_.NONE,value:.003785411784,offset:0},beerbarrel:{name:"beerbarrel",base:O.VOLUME,prefixes:_.NONE,value:.117347765304,offset:0},oilbarrel:{name:"oilbarrel",base:O.VOLUME,prefixes:_.NONE,value:.158987294928,offset:0},hogshead:{name:"hogshead",base:O.VOLUME,prefixes:_.NONE,value:.238480942392,offset:0},g:{name:"g",base:O.MASS,prefixes:_.SHORT,value:.001,offset:0},gram:{name:"gram",base:O.MASS,prefixes:_.LONG,value:.001,offset:0},ton:{name:"ton",base:O.MASS,prefixes:_.SHORT,value:907.18474,offset:0},t:{name:"t",base:O.MASS,prefixes:_.SHORT,value:1e3,offset:0},tonne:{name:"tonne",base:O.MASS,prefixes:_.LONG,value:1e3,offset:0},grain:{name:"grain",base:O.MASS,prefixes:_.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:O.MASS,prefixes:_.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:O.MASS,prefixes:_.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:O.MASS,prefixes:_.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:O.MASS,prefixes:_.NONE,value:45.359237,offset:0},stick:{name:"stick",base:O.MASS,prefixes:_.NONE,value:.115,offset:0},stone:{name:"stone",base:O.MASS,prefixes:_.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:O.MASS,prefixes:_.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:O.MASS,prefixes:_.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:O.MASS,prefixes:_.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:O.MASS,prefixes:_.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:O.MASS,prefixes:_.NONE,value:45.359237,offset:0},s:{name:"s",base:O.TIME,prefixes:_.SHORT,value:1,offset:0},min:{name:"min",base:O.TIME,prefixes:_.NONE,value:60,offset:0},h:{name:"h",base:O.TIME,prefixes:_.NONE,value:3600,offset:0},second:{name:"second",base:O.TIME,prefixes:_.LONG,value:1,offset:0},sec:{name:"sec",base:O.TIME,prefixes:_.LONG,value:1,offset:0},minute:{name:"minute",base:O.TIME,prefixes:_.NONE,value:60,offset:0},hour:{name:"hour",base:O.TIME,prefixes:_.NONE,value:3600,offset:0},day:{name:"day",base:O.TIME,prefixes:_.NONE,value:86400,offset:0},week:{name:"week",base:O.TIME,prefixes:_.NONE,value:604800,offset:0},month:{name:"month",base:O.TIME,prefixes:_.NONE,value:2629800,offset:0},year:{name:"year",base:O.TIME,prefixes:_.NONE,value:31557600,offset:0},decade:{name:"decade",base:O.TIME,prefixes:_.NONE,value:315576e3,offset:0},century:{name:"century",base:O.TIME,prefixes:_.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:O.TIME,prefixes:_.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:O.FREQUENCY,prefixes:_.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:O.FREQUENCY,prefixes:_.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:O.ANGLE,prefixes:_.SHORT,value:1,offset:0},radian:{name:"radian",base:O.ANGLE,prefixes:_.LONG,value:1,offset:0},deg:{name:"deg",base:O.ANGLE,prefixes:_.SHORT,value:null,offset:0},degree:{name:"degree",base:O.ANGLE,prefixes:_.LONG,value:null,offset:0},grad:{name:"grad",base:O.ANGLE,prefixes:_.SHORT,value:null,offset:0},gradian:{name:"gradian",base:O.ANGLE,prefixes:_.LONG,value:null,offset:0},cycle:{name:"cycle",base:O.ANGLE,prefixes:_.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:O.ANGLE,prefixes:_.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:O.ANGLE,prefixes:_.NONE,value:null,offset:0},A:{name:"A",base:O.CURRENT,prefixes:_.SHORT,value:1,offset:0},ampere:{name:"ampere",base:O.CURRENT,prefixes:_.LONG,value:1,offset:0},K:{name:"K",base:O.TEMPERATURE,prefixes:_.SHORT,value:1,offset:0},degC:{name:"degC",base:O.TEMPERATURE,prefixes:_.SHORT,value:1,offset:273.15},degF:{name:"degF",base:O.TEMPERATURE,prefixes:_.SHORT,value:new x(5,9),offset:459.67},degR:{name:"degR",base:O.TEMPERATURE,prefixes:_.SHORT,value:new x(5,9),offset:0},kelvin:{name:"kelvin",base:O.TEMPERATURE,prefixes:_.LONG,value:1,offset:0},celsius:{name:"celsius",base:O.TEMPERATURE,prefixes:_.LONG,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:O.TEMPERATURE,prefixes:_.LONG,value:new x(5,9),offset:459.67},rankine:{name:"rankine",base:O.TEMPERATURE,prefixes:_.LONG,value:new x(5,9),offset:0},mol:{name:"mol",base:O.AMOUNT_OF_SUBSTANCE,prefixes:_.SHORT,value:1,offset:0},mole:{name:"mole",base:O.AMOUNT_OF_SUBSTANCE,prefixes:_.LONG,value:1,offset:0},cd:{name:"cd",base:O.LUMINOUS_INTENSITY,prefixes:_.SHORT,value:1,offset:0},candela:{name:"candela",base:O.LUMINOUS_INTENSITY,prefixes:_.LONG,value:1,offset:0},N:{name:"N",base:O.FORCE,prefixes:_.SHORT,value:1,offset:0},newton:{name:"newton",base:O.FORCE,prefixes:_.LONG,value:1,offset:0},dyn:{name:"dyn",base:O.FORCE,prefixes:_.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:O.FORCE,prefixes:_.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:O.FORCE,prefixes:_.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:O.FORCE,prefixes:_.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:O.FORCE,prefixes:_.LONG,value:4448.2216,offset:0},kilogramforce:{name:"kilogramforce",base:O.FORCE,prefixes:_.NONE,value:9.80665,offset:0},J:{name:"J",base:O.ENERGY,prefixes:_.SHORT,value:1,offset:0},joule:{name:"joule",base:O.ENERGY,prefixes:_.LONG,value:1,offset:0},erg:{name:"erg",base:O.ENERGY,prefixes:_.SHORTLONG,value:1e-7,offset:0},Wh:{name:"Wh",base:O.ENERGY,prefixes:_.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:O.ENERGY,prefixes:_.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:O.ENERGY,prefixes:_.SHORT,value:1602176565e-28,offset:0},electronvolt:{name:"electronvolt",base:O.ENERGY,prefixes:_.LONG,value:1602176565e-28,offset:0},W:{name:"W",base:O.POWER,prefixes:_.SHORT,value:1,offset:0},watt:{name:"watt",base:O.POWER,prefixes:_.LONG,value:1,offset:0},hp:{name:"hp",base:O.POWER,prefixes:_.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:O.POWER,prefixes:_.SHORT,value:v.I,offset:0},VA:{name:"VA",base:O.POWER,prefixes:_.SHORT,value:1,offset:0},Pa:{name:"Pa",base:O.PRESSURE,prefixes:_.SHORT,value:1,offset:0},psi:{name:"psi",base:O.PRESSURE,prefixes:_.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:O.PRESSURE,prefixes:_.NONE,value:101325,offset:0},bar:{name:"bar",base:O.PRESSURE,prefixes:_.SHORTLONG,value:1e5,offset:0},torr:{name:"torr",base:O.PRESSURE,prefixes:_.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:O.PRESSURE,prefixes:_.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:O.PRESSURE,prefixes:_.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:O.PRESSURE,prefixes:_.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:O.ELECTRIC_CHARGE,prefixes:_.LONG,value:1,offset:0},C:{name:"C",base:O.ELECTRIC_CHARGE,prefixes:_.SHORT,value:1,offset:0},farad:{name:"farad",base:O.ELECTRIC_CAPACITANCE,prefixes:_.LONG,value:1,offset:0},F:{name:"F",base:O.ELECTRIC_CAPACITANCE,prefixes:_.SHORT,value:1,offset:0},volt:{name:"volt",base:O.ELECTRIC_POTENTIAL,prefixes:_.LONG,value:1,offset:0},V:{name:"V",base:O.ELECTRIC_POTENTIAL,prefixes:_.SHORT,value:1,offset:0},ohm:{name:"ohm",base:O.ELECTRIC_RESISTANCE,prefixes:_.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:O.ELECTRIC_INDUCTANCE,prefixes:_.LONG,value:1,offset:0},H:{name:"H",base:O.ELECTRIC_INDUCTANCE,prefixes:_.SHORT,value:1,offset:0},siemens:{name:"siemens",base:O.ELECTRIC_CONDUCTANCE,prefixes:_.LONG,value:1,offset:0},S:{name:"S",base:O.ELECTRIC_CONDUCTANCE,prefixes:_.SHORT,value:1,offset:0},weber:{name:"weber",base:O.MAGNETIC_FLUX,prefixes:_.LONG,value:1,offset:0},Wb:{name:"Wb",base:O.MAGNETIC_FLUX,prefixes:_.SHORT,value:1,offset:0},tesla:{name:"tesla",base:O.MAGNETIC_FLUX_DENSITY,prefixes:_.LONG,value:1,offset:0},T:{name:"T",base:O.MAGNETIC_FLUX_DENSITY,prefixes:_.SHORT,value:1,offset:0},b:{name:"b",base:O.BIT,prefixes:_.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:O.BIT,prefixes:_.BINARY_LONG,value:1,offset:0},B:{name:"B",base:O.BIT,prefixes:_.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:O.BIT,prefixes:_.BINARY_LONG,value:8,offset:0}},L={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fldr:"fluiddram",fluiddrams:"fluiddram",floz:"fluidounce",fluidounces:"fluidounce",gi:"gill",gills:"gill",cp:"cup",cups:"cup",pt:"pint",pints:"pint",qt:"quart",quarts:"quart",gal:"gallon",gallons:"gallon",bbl:"beerbarrel",beerbarrels:"beerbarrel",obl:"oilbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",kgf:"kilogramforce",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",decades:"decade",centuries:"century",millennia:"millennium",hertz:"hertz",radians:"radian",degrees:"degree",gradians:"gradian",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",amps:"ampere",amp:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole",bit:"bits",byte:"bytes"};function P(e){if("BigNumber"===e.number){var t=EZ(b);B.rad.value=new b(1),B.deg.value=t.div(180),B.grad.value=t.div(200),B.cycle.value=t.times(2),B.arcsec.value=t.div(648e3),B.arcmin.value=t.div(10800)}else B.rad.value=1,B.deg.value=Math.PI/180,B.grad.value=Math.PI/200,B.cycle.value=2*Math.PI,B.arcsec.value=Math.PI/648e3,B.arcmin.value=Math.PI/10800;B.radian.value=B.rad.value,B.degree.value=B.deg.value,B.gradian.value=B.grad.value}P(i),a&&a("config",(function(e,t){e.number!==t.number&&P(e)}));var U={si:{NONE:{unit:z,prefix:_.NONE[""]},LENGTH:{unit:B.m,prefix:_.SHORT[""]},MASS:{unit:B.g,prefix:_.SHORT.k},TIME:{unit:B.s,prefix:_.SHORT[""]},CURRENT:{unit:B.A,prefix:_.SHORT[""]},TEMPERATURE:{unit:B.K,prefix:_.SHORT[""]},LUMINOUS_INTENSITY:{unit:B.cd,prefix:_.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:B.mol,prefix:_.SHORT[""]},ANGLE:{unit:B.rad,prefix:_.SHORT[""]},BIT:{unit:B.bits,prefix:_.SHORT[""]},FORCE:{unit:B.N,prefix:_.SHORT[""]},ENERGY:{unit:B.J,prefix:_.SHORT[""]},POWER:{unit:B.W,prefix:_.SHORT[""]},PRESSURE:{unit:B.Pa,prefix:_.SHORT[""]},ELECTRIC_CHARGE:{unit:B.C,prefix:_.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:B.F,prefix:_.SHORT[""]},ELECTRIC_POTENTIAL:{unit:B.V,prefix:_.SHORT[""]},ELECTRIC_RESISTANCE:{unit:B.ohm,prefix:_.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:B.H,prefix:_.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:B.S,prefix:_.SHORT[""]},MAGNETIC_FLUX:{unit:B.Wb,prefix:_.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:B.T,prefix:_.SHORT[""]},FREQUENCY:{unit:B.Hz,prefix:_.SHORT[""]}}};U.cgs=JSON.parse(JSON.stringify(U.si)),U.cgs.LENGTH={unit:B.m,prefix:_.SHORT.c},U.cgs.MASS={unit:B.g,prefix:_.SHORT[""]},U.cgs.FORCE={unit:B.dyn,prefix:_.SHORT[""]},U.cgs.ENERGY={unit:B.erg,prefix:_.NONE[""]},U.us=JSON.parse(JSON.stringify(U.si)),U.us.LENGTH={unit:B.ft,prefix:_.NONE[""]},U.us.MASS={unit:B.lbm,prefix:_.NONE[""]},U.us.TEMPERATURE={unit:B.degF,prefix:_.NONE[""]},U.us.FORCE={unit:B.lbf,prefix:_.NONE[""]},U.us.ENERGY={unit:B.BTU,prefix:_.BTU[""]},U.us.POWER={unit:B.hp,prefix:_.NONE[""]},U.us.PRESSURE={unit:B.psi,prefix:_.NONE[""]},U.auto=JSON.parse(JSON.stringify(U.si));var W=U.auto;for(var V in N.setUnitSystem=function(e){if(!$U(U,e))throw new Error("Unit system "+e+" does not exist. Choices are: "+Object.keys(U).join(", "));W=U[e]},N.getUnitSystem=function(){for(var e in U)if($U(U,e)&&U[e]===W)return e},N.typeConverters={BigNumber:function(e){return null!==e&&void 0!==e&&e.isFraction?new b(String(e.n)).div(String(e.d)).times(String(e.s)):new b(e+"")},Fraction:function(e){return new x(e)},Complex:function(e){return e},number:function(e){return null!==e&&void 0!==e&&e.isFraction?y(e):e}},N.prototype._numberConverter=function(){var e=N.typeConverters[this.valueType()];if(e)return e;throw new TypeError('Unsupported Unit value type "'+this.valueType()+'"')},N._getNumberConverter=function(e){if(!N.typeConverters[e])throw new TypeError('Unsupported type "'+e+'"');return N.typeConverters[e]},B)if($U(B,V)){var q=B[V];q.dimensions=q.base.dimensions}for(var j in L)if($U(L,j)){var G=B[L[j]],H={};for(var K in G)$U(G,K)&&(H[K]=G[K]);H.name=j,B[j]=H}return N.isValidAlpha=function(e){return/^[a-zA-Z]$/.test(e)},N.createUnit=function(e,t){if("object"!==typeof e)throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(t&&t.override)for(var n in e)if($U(e,n)&&N.deleteUnit(n),e[n].aliases)for(var r=0;r<e[n].aliases.length;r++)N.deleteUnit(e[n].aliases[r]);var a;for(var i in e)$U(e,i)&&(a=N.createUnitSingle(i,e[i]));return a},N.createUnitSingle=function(e,t){if("undefined"!==typeof t&&null!==t||(t={}),"string"!==typeof e)throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if($U(B,e))throw new Error('Cannot create unit "'+e+'": a unit with that name already exists');!function(e){for(var t=0;t<e.length;t++){if(r=e.charAt(t),0===t&&!N.isValidAlpha(r))throw new Error('Invalid unit name (must begin with alpha character): "'+e+'"');if(t>0&&!N.isValidAlpha(r)&&!k(r))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+e+'"')}}(e);var n,a,i,o=null,s=[],u=0;if(t&&"Unit"===t.type)o=t.clone();else if("string"===typeof t)""!==t&&(n=t);else{if("object"!==typeof t)throw new TypeError('Cannot create unit "'+e+'" from "'+t.toString()+'": expecting "string" or "Unit" or "Object"');n=t.definition,a=t.prefixes,u=t.offset,i=t.baseName,t.aliases&&(s=t.aliases.valueOf())}if(s)for(var c=0;c<s.length;c++)if($U(B,s[c]))throw new Error('Cannot create alias "'+s[c]+'": a unit with that name already exists');if(n&&"string"===typeof n&&!o)try{o=N.parse(n,{allowNoUnits:!0})}catch(E){throw E.message='Could not create unit "'+e+'" from "'+n+'": '+E.message,E}else n&&"Unit"===n.type&&(o=n.clone());s=s||[],u=u||0,a=a&&a.toUpperCase&&_[a.toUpperCase()]||_.NONE;var l={};if(o){l={name:e,value:o.value,dimensions:o.dimensions.slice(0),prefixes:a,offset:u};var p=!1;for(var h in O)if($U(O,h)){for(var d=!0,f=0;f<M.length;f++)if(Math.abs((l.dimensions[f]||0)-(O[h].dimensions[f]||0))>1e-12){d=!1;break}if(d){p=!0,l.base=O[h];break}}if(!p){i=i||e+"_STUFF";var m={dimensions:o.dimensions.slice(0)};m.key=i,O[i]=m,W[i]={unit:l,prefix:_.NONE[""]},l.base=O[i]}}else{if(i=i||e+"_STUFF",M.indexOf(i)>=0)throw new Error('Cannot create new base unit "'+e+'": a base unit with that name already exists (and cannot be overridden)');for(var g in M.push(i),O)$U(O,g)&&(O[g].dimensions[M.length-1]=0);for(var y={dimensions:[]},v=0;v<M.length;v++)y.dimensions[v]=0;y.dimensions[M.length-1]=1,y.key=i,O[i]=y,l={name:e,value:1,dimensions:O[i].dimensions.slice(0),prefixes:a,offset:u,base:O[i]},W[i]={unit:l,prefix:_.NONE[""]}}N.UNITS[e]=l;for(var b=0;b<s.length;b++){var x=s[b],w={};for(var S in l)$U(l,S)&&(w[S]=l[S]);w.name=x,N.UNITS[x]=w}return delete A.cache,new N(null,e)},N.deleteUnit=function(e){delete N.UNITS[e],delete A.cache},N.PREFIXES=_,N.BASE_DIMENSIONS=M,N.BASE_UNITS=O,N.UNIT_SYSTEMS=U,N.UNITS=B,N}),{isClass:!0}),FZ="unit",_Z=ZU(FZ,["typed","Unit"],(e=>{var{typed:t,Unit:n}=e;return t(FZ,{Unit:function(e){return e.clone()},string:function(e){return n.isValuelessUnit(e)?new n(null,e):n.parse(e,{allowNoUnits:!0})},"number | BigNumber | Fraction | Complex, string | Unit":function(e,t){return new n(e,t)},"number | BigNumber | Fraction":function(e){return new n(e)},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),MZ="sparse",OZ=ZU(MZ,["typed","SparseMatrix"],(e=>{var{typed:t,SparseMatrix:n}=e;return t(MZ,{"":function(){return new n([])},string:function(e){return new n([],e)},"Array | Matrix":function(e){return new n(e)},"Array | Matrix, string":function(e,t){return new n(e,t)}})})),RZ="createUnit",zZ=ZU(RZ,["typed","Unit"],(e=>{var{typed:t,Unit:n}=e;return t(RZ,{"Object, Object":function(e,t){return n.createUnit(e,t)},Object:function(e){return n.createUnit(e,{})},"string, Unit | string | Object, Object":function(e,t,r){var a={};return a[e]=t,n.createUnit(a,r)},"string, Unit | string | Object":function(e,t){var r={};return r[e]=t,n.createUnit(r,{})},string:function(e){var t={};return t[e]={},n.createUnit(t,{})}})})),BZ="acos",LZ=ZU(BZ,["typed","config","Complex"],(e=>{var{typed:t,config:n,Complex:r}=e;return t(BZ,{number:function(e){return e>=-1&&e<=1||n.predictable?Math.acos(e):new r(e,0).acos()},Complex:function(e){return e.acos()},BigNumber:function(e){return e.acos()}})})),PZ="number";function UZ(e){return kW(e)}function WZ(e){return Math.atan(1/e)}function VZ(e){return isFinite(e)?(Math.log((e+1)/e)+Math.log(e/(e-1)))/2:0}function qZ(e){return Math.asin(1/e)}function jZ(e){var t=1/e;return Math.log(t+Math.sqrt(t*t+1))}function GZ(e){return Math.acos(1/e)}function HZ(e){var t=1/e,n=Math.sqrt(t*t-1);return Math.log(n+t)}function KZ(e){return EW(e)}function XZ(e){return CW(e)}function YZ(e){return 1/Math.tan(e)}function $Z(e){var t=Math.exp(2*e);return(t+1)/(t-1)}function ZZ(e){return 1/Math.sin(e)}function QZ(e){return 0===e?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(e)-Math.exp(-e)))*cW(e)}function JZ(e){return 1/Math.cos(e)}function eQ(e){return 2/(Math.exp(e)+Math.exp(-e))}function tQ(e){return DW(e)}UZ.signature=PZ,WZ.signature=PZ,VZ.signature=PZ,qZ.signature=PZ,jZ.signature=PZ,GZ.signature=PZ,HZ.signature=PZ,KZ.signature=PZ,XZ.signature=PZ,YZ.signature=PZ,$Z.signature=PZ,ZZ.signature=PZ,QZ.signature=PZ,JZ.signature=PZ,eQ.signature=PZ,tQ.signature=PZ;var nQ="acosh",rQ=ZU(nQ,["typed","config","Complex"],(e=>{var{typed:t,config:n,Complex:r}=e;return t(nQ,{number:function(e){return e>=1||n.predictable?UZ(e):e<=-1?new r(Math.log(Math.sqrt(e*e-1)-e),Math.PI):new r(e,0).acosh()},Complex:function(e){return e.acosh()},BigNumber:function(e){return e.acosh()}})})),aQ="acot",iQ=ZU(aQ,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t(aQ,{number:WZ,Complex:function(e){return e.acot()},BigNumber:function(e){return new n(1).div(e).atan()}})})),oQ="acoth",sQ=ZU(oQ,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:n,Complex:r,BigNumber:a}=e;return t(oQ,{number:function(e){return e>=1||e<=-1||n.predictable?VZ(e):new r(e,0).acoth()},Complex:function(e){return e.acoth()},BigNumber:function(e){return new a(1).div(e).atanh()}})})),uQ="acsc",cQ=ZU(uQ,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:n,Complex:r,BigNumber:a}=e;return t(uQ,{number:function(e){return e<=-1||e>=1||n.predictable?qZ(e):new r(e,0).acsc()},Complex:function(e){return e.acsc()},BigNumber:function(e){return new a(1).div(e).asin()}})})),lQ="acsch",pQ=ZU(lQ,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t(lQ,{number:jZ,Complex:function(e){return e.acsch()},BigNumber:function(e){return new n(1).div(e).asinh()}})})),hQ="asec",dQ=ZU(hQ,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:n,Complex:r,BigNumber:a}=e;return t(hQ,{number:function(e){return e<=-1||e>=1||n.predictable?GZ(e):new r(e,0).asec()},Complex:function(e){return e.asec()},BigNumber:function(e){return new a(1).div(e).acos()}})})),fQ="asech",mQ=ZU(fQ,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:n,Complex:r,BigNumber:a}=e;return t(fQ,{number:function(e){if(e<=1&&e>=-1||n.predictable){var t=1/e;if(t>0||n.predictable)return HZ(e);var a=Math.sqrt(t*t-1);return new r(Math.log(a-t),Math.PI)}return new r(e,0).asech()},Complex:function(e){return e.asech()},BigNumber:function(e){return new a(1).div(e).acosh()}})})),gQ="asin",yQ=ZU(gQ,["typed","config","Complex"],(e=>{var{typed:t,config:n,Complex:r}=e;return t(gQ,{number:function(e){return e>=-1&&e<=1||n.predictable?Math.asin(e):new r(e,0).asin()},Complex:function(e){return e.asin()},BigNumber:function(e){return e.asin()}})})),vQ=ZU("asinh",["typed"],(e=>{var{typed:t}=e;return t("asinh",{number:KZ,Complex:function(e){return e.asinh()},BigNumber:function(e){return e.asinh()}})})),bQ=ZU("atan",["typed"],(e=>{var{typed:t}=e;return t("atan",{number:function(e){return Math.atan(e)},Complex:function(e){return e.atan()},BigNumber:function(e){return e.atan()}})})),xQ="atan2",wQ=ZU(xQ,["typed","matrix","equalScalar","BigNumber","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,BigNumber:a,DenseMatrix:i,concat:o}=e,s=VH({typed:t,equalScalar:r}),u=qH({typed:t}),c=DK({typed:t,equalScalar:r}),l=NH({typed:t,equalScalar:r}),p=SH({typed:t,DenseMatrix:i}),h=KH({typed:t,matrix:n,concat:o});return t(xQ,{"number, number":Math.atan2,"BigNumber, BigNumber":(e,t)=>a.atan2(e,t)},h({scalar:"number | BigNumber",SS:c,DS:u,SD:s,Ss:l,sS:p}))})),NQ="atanh",SQ=ZU(NQ,["typed","config","Complex"],(e=>{var{typed:t,config:n,Complex:r}=e;return t(NQ,{number:function(e){return e<=1&&e>=-1||n.predictable?XZ(e):new r(e,0).atanh()},Complex:function(e){return e.atanh()},BigNumber:function(e){return e.atanh()}})})),kQ=ZU("trigUnit",["typed"],(e=>{var{typed:t}=e;return{Unit:t.referToSelf((e=>n=>{if(!n.hasBase(n.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return t.find(e,n.valueType())(n.value)}))}})),EQ=ZU("cos",["typed"],(e=>{var{typed:t}=e,n=kQ({typed:t});return t("cos",{number:Math.cos,"Complex | BigNumber":e=>e.cos()},n)})),CQ="cosh",TQ=ZU(CQ,["typed"],(e=>{var{typed:t}=e;return t(CQ,{number:TW,"Complex | BigNumber":e=>e.cosh()})})),DQ=ZU("cot",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t("cot",{number:YZ,Complex:e=>e.cot(),BigNumber:e=>new n(1).div(e.tan())},kQ({typed:t}))})),IQ="coth",AQ=ZU(IQ,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t(IQ,{number:$Z,Complex:e=>e.coth(),BigNumber:e=>new n(1).div(e.tanh())})})),FQ=ZU("csc",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t("csc",{number:ZZ,Complex:e=>e.csc(),BigNumber:e=>new n(1).div(e.sin())},kQ({typed:t}))})),_Q="csch",MQ=ZU(_Q,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t(_Q,{number:QZ,Complex:e=>e.csch(),BigNumber:e=>new n(1).div(e.sinh())})})),OQ=ZU("sec",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t("sec",{number:JZ,Complex:e=>e.sec(),BigNumber:e=>new n(1).div(e.cos())},kQ({typed:t}))})),RQ="sech",zQ=ZU(RQ,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t(RQ,{number:eQ,Complex:e=>e.sech(),BigNumber:e=>new n(1).div(e.cosh())})})),BQ=ZU("sin",["typed"],(e=>{var{typed:t}=e,n=kQ({typed:t});return t("sin",{number:Math.sin,"Complex | BigNumber":e=>e.sin()},n)})),LQ="sinh",PQ=ZU(LQ,["typed"],(e=>{var{typed:t}=e;return t(LQ,{number:tQ,"Complex | BigNumber":e=>e.sinh()})})),UQ=ZU("tan",["typed"],(e=>{var{typed:t}=e,n=kQ({typed:t});return t("tan",{number:Math.tan,"Complex | BigNumber":e=>e.tan()},n)})),WQ=ZU("tanh",["typed"],(e=>{var{typed:t}=e;return t("tanh",{number:IW,"Complex | BigNumber":e=>e.tanh()})})),VQ="setCartesian",qQ=ZU(VQ,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:n,subset:r,compareNatural:a,Index:i,DenseMatrix:o}=e;return t(VQ,{"Array | Matrix, Array | Matrix":function(e,t){var s=[];if(0!==r(n(e),new i(0))&&0!==r(n(t),new i(0))){var u=Sj(Array.isArray(e)?e:e.toArray()).sort(a),c=Sj(Array.isArray(t)?t:t.toArray()).sort(a);s=[];for(var l=0;l<u.length;l++)for(var p=0;p<c.length;p++)s.push([u[l],c[p]])}return Array.isArray(e)&&Array.isArray(t)?s:new o(s)}})})),jQ="setDifference",GQ=ZU(jQ,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:n,subset:r,compareNatural:a,Index:i,DenseMatrix:o}=e;return t(jQ,{"Array | Matrix, Array | Matrix":function(e,t){var s;if(0===r(n(e),new i(0)))s=[];else{if(0===r(n(t),new i(0)))return Sj(e.toArray());var u,c=Dj(Sj(Array.isArray(e)?e:e.toArray()).sort(a)),l=Dj(Sj(Array.isArray(t)?t:t.toArray()).sort(a));s=[];for(var p=0;p<c.length;p++){u=!1;for(var h=0;h<l.length;h++)if(0===a(c[p].value,l[h].value)&&c[p].identifier===l[h].identifier){u=!0;break}u||s.push(c[p])}}return Array.isArray(e)&&Array.isArray(t)?Ij(s):new o(Ij(s))}})})),HQ="setDistinct",KQ=ZU(HQ,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:n,subset:r,compareNatural:a,Index:i,DenseMatrix:o}=e;return t(HQ,{"Array | Matrix":function(e){var t;if(0===r(n(e),new i(0)))t=[];else{var s=Sj(Array.isArray(e)?e:e.toArray()).sort(a);(t=[]).push(s[0]);for(var u=1;u<s.length;u++)0!==a(s[u],s[u-1])&&t.push(s[u])}return Array.isArray(e)?t:new o(t)}})})),XQ="setIntersect",YQ=ZU(XQ,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:n,subset:r,compareNatural:a,Index:i,DenseMatrix:o}=e;return t(XQ,{"Array | Matrix, Array | Matrix":function(e,t){var s;if(0===r(n(e),new i(0))||0===r(n(t),new i(0)))s=[];else{var u=Dj(Sj(Array.isArray(e)?e:e.toArray()).sort(a)),c=Dj(Sj(Array.isArray(t)?t:t.toArray()).sort(a));s=[];for(var l=0;l<u.length;l++)for(var p=0;p<c.length;p++)if(0===a(u[l].value,c[p].value)&&u[l].identifier===c[p].identifier){s.push(u[l]);break}}return Array.isArray(e)&&Array.isArray(t)?Ij(s):new o(Ij(s))}})})),$Q="setIsSubset",ZQ=ZU($Q,["typed","size","subset","compareNatural","Index"],(e=>{var{typed:t,size:n,subset:r,compareNatural:a,Index:i}=e;return t($Q,{"Array | Matrix, Array | Matrix":function(e,t){if(0===r(n(e),new i(0)))return!0;if(0===r(n(t),new i(0)))return!1;for(var o,s=Dj(Sj(Array.isArray(e)?e:e.toArray()).sort(a)),u=Dj(Sj(Array.isArray(t)?t:t.toArray()).sort(a)),c=0;c<s.length;c++){o=!1;for(var l=0;l<u.length;l++)if(0===a(s[c].value,u[l].value)&&s[c].identifier===u[l].identifier){o=!0;break}if(!1===o)return!1}return!0}})})),QQ="setMultiplicity",JQ=ZU(QQ,["typed","size","subset","compareNatural","Index"],(e=>{var{typed:t,size:n,subset:r,compareNatural:a,Index:i}=e;return t(QQ,{"number | BigNumber | Fraction | Complex, Array | Matrix":function(e,t){if(0===r(n(t),new i(0)))return 0;for(var o=Sj(Array.isArray(t)?t:t.toArray()),s=0,u=0;u<o.length;u++)0===a(o[u],e)&&s++;return s}})})),eJ="setPowerset",tJ=ZU(eJ,["typed","size","subset","compareNatural","Index"],(e=>{var{typed:t,size:n,subset:r,compareNatural:a,Index:i}=e;return t(eJ,{"Array | Matrix":function(e){if(0===r(n(e),new i(0)))return[];for(var t=Sj(Array.isArray(e)?e:e.toArray()).sort(a),s=[],u=0;u.toString(2).length<=t.length;)s.push(o(t,u.toString(2).split("").reverse())),u++;return function(e){for(var t=[],n=e.length-1;n>0;n--)for(var r=0;r<n;r++)e[r].length>e[r+1].length&&(t=e[r],e[r]=e[r+1],e[r+1]=t);return e}(s)}});function o(e,t){for(var n=[],r=0;r<t.length;r++)"1"===t[r]&&n.push(e[r]);return n}})),nJ="setSize",rJ=ZU(nJ,["typed","compareNatural"],(e=>{var{typed:t,compareNatural:n}=e;return t(nJ,{"Array | Matrix":function(e){return Array.isArray(e)?Sj(e).length:Sj(e.toArray()).length},"Array | Matrix, boolean":function(e,t){if(!1===t||0===e.length)return Array.isArray(e)?Sj(e).length:Sj(e.toArray()).length;for(var r=Sj(Array.isArray(e)?e:e.toArray()).sort(n),a=1,i=1;i<r.length;i++)0!==n(r[i],r[i-1])&&a++;return a}})})),aJ="setSymDifference",iJ=ZU(aJ,["typed","size","concat","subset","setDifference","Index"],(e=>{var{typed:t,size:n,concat:r,subset:a,setDifference:i,Index:o}=e;return t(aJ,{"Array | Matrix, Array | Matrix":function(e,t){if(0===a(n(e),new o(0)))return Sj(t);if(0===a(n(t),new o(0)))return Sj(e);var s=Sj(e),u=Sj(t);return r(i(s,u),i(u,s))}})})),oJ="setUnion",sJ=ZU(oJ,["typed","size","concat","subset","setIntersect","setSymDifference","Index"],(e=>{var{typed:t,size:n,concat:r,subset:a,setIntersect:i,setSymDifference:o,Index:s}=e;return t(oJ,{"Array | Matrix, Array | Matrix":function(e,t){if(0===a(n(e),new s(0)))return Sj(t);if(0===a(n(t),new s(0)))return Sj(e);var u=Sj(e),c=Sj(t);return r(o(u,c),i(u,c))}})})),uJ=ZU("add",["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],(e=>{var{typed:t,matrix:n,addScalar:r,equalScalar:a,DenseMatrix:i,SparseMatrix:o,concat:s}=e,u=YH({typed:t}),c=$H({typed:t,equalScalar:a}),l=ZH({typed:t,DenseMatrix:i}),p=KH({typed:t,matrix:n,concat:s});return t("add",{"any, any":r,"any, any, ...any":t.referToSelf((e=>(t,n,r)=>{for(var a=e(t,n),i=0;i<r.length;i++)a=e(a,r[i]);return a}))},p({elop:r,DS:u,SS:c,Ss:l}))})),cJ="hypot",lJ=ZU(cJ,["typed","abs","addScalar","divideScalar","multiplyScalar","sqrt","smaller","isPositive"],(e=>{var{typed:t,abs:n,addScalar:r,divideScalar:a,multiplyScalar:i,sqrt:o,smaller:s,isPositive:u}=e;return t(cJ,{"... number | BigNumber":c,Array:c,Matrix:e=>c(Sj(e.toArray()))});function c(e){for(var t=0,c=0,l=0;l<e.length;l++){if(tU(e[l]))throw new TypeError("Unexpected type of argument to hypot");var p=n(e[l]);s(c,p)?(t=i(t,i(a(c,p),a(c,p))),t=r(t,1),c=p):t=r(t,u(p)?i(a(p,c),a(p,c)):p)}return i(c,o(t))}})),pJ="norm",hJ=ZU(pJ,["typed","abs","add","pow","conj","sqrt","multiply","equalScalar","larger","smaller","matrix","ctranspose","eigs"],(e=>{var{typed:t,abs:n,add:r,pow:a,conj:i,sqrt:o,multiply:s,equalScalar:u,larger:c,smaller:l,matrix:p,ctranspose:h,eigs:d}=e;return t(pJ,{number:Math.abs,Complex:function(e){return e.abs()},BigNumber:function(e){return e.abs()},boolean:function(e){return Math.abs(e)},Array:function(e){return g(p(e),2)},Matrix:function(e){return g(e,2)},"Array, number | BigNumber | string":function(e,t){return g(p(e),t)},"Matrix, number | BigNumber | string":function(e,t){return g(e,t)}});function f(e,t){if(t===Number.POSITIVE_INFINITY||"inf"===t)return function(e){var t=0;return e.forEach((function(e){var r=n(e);c(r,t)&&(t=r)}),!0),t}(e);if(t===Number.NEGATIVE_INFINITY||"-inf"===t)return function(e){var t;return e.forEach((function(e){var r=n(e);t&&!l(r,t)||(t=r)}),!0),t||0}(e);if("fro"===t)return g(e,2);if("number"===typeof t&&!isNaN(t)){if(!u(t,0)){var i=0;return e.forEach((function(e){i=r(a(n(e),t),i)}),!0),a(i,1/t)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}function m(e,t){if(1===t)return function(e){var t=[],a=0;return e.forEach((function(e,i){var o=i[1],s=r(t[o]||0,n(e));c(s,a)&&(a=s),t[o]=s}),!0),a}(e);if(t===Number.POSITIVE_INFINITY||"inf"===t)return function(e){var t=[],a=0;return e.forEach((function(e,i){var o=i[0],s=r(t[o]||0,n(e));c(s,a)&&(a=s),t[o]=s}),!0),a}(e);if("fro"===t)return function(e){var t=0;return e.forEach((function(e,n){t=r(t,s(e,i(e)))})),n(o(t))}(e);if(2===t)return function(e){var t=e.size();if(t[0]!==t[1])throw new RangeError("Invalid matrix dimensions");var r=h(e),a=s(r,e),i=d(a).values.toArray(),u=i[i.length-1];return n(o(u))}(e);throw new Error("Unsupported parameter value "+t)}function g(e,t){var n=e.size();if(1===n.length)return f(e,t);if(2===n.length){if(n[0]&&n[1])return m(e,t);throw new RangeError("Invalid matrix dimensions")}}})),dJ=ZU("dot",["typed","addScalar","multiplyScalar","conj","size"],(e=>{var{typed:t,addScalar:n,multiplyScalar:r,conj:a,size:i}=e;return t("dot",{"Array | DenseMatrix, Array | DenseMatrix":function(e,i){var u=o(e,i),c=oU(e)?e._data:e,l=oU(e)?e._datatype||e.getDataType():void 0,p=oU(i)?i._data:i,h=oU(i)?i._datatype||i.getDataType():void 0,d=2===s(e).length,f=2===s(i).length,m=n,g=r;if(l&&h&&l===h&&"string"===typeof l&&"mixed"!==l){var y=l;m=t.find(n,[y,y]),g=t.find(r,[y,y])}if(!d&&!f){for(var v=g(a(c[0]),p[0]),b=1;b<u;b++)v=m(v,g(a(c[b]),p[b]));return v}if(!d&&f){for(var x=g(a(c[0]),p[0][0]),w=1;w<u;w++)x=m(x,g(a(c[w]),p[w][0]));return x}if(d&&!f){for(var N=g(a(c[0][0]),p[0]),S=1;S<u;S++)N=m(N,g(a(c[S][0]),p[S]));return N}if(d&&f){for(var k=g(a(c[0][0]),p[0][0]),E=1;E<u;E++)k=m(k,g(a(c[E][0]),p[E][0]));return k}},"SparseMatrix, SparseMatrix":function(e,t){o(e,t);var a=e._index,i=e._values,s=t._index,u=t._values,c=0,l=n,p=r,h=0,d=0;for(;h<a.length&&d<s.length;){var f=a[h],m=s[d];f<m?h++:f>m?d++:f===m&&(c=l(c,p(i[h],u[d])),h++,d++)}return c}});function o(e,t){var n,r,a=s(e),i=s(t);if(1===a.length)n=a[0];else{if(2!==a.length||1!==a[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+a.join(", ")+")");n=a[0]}if(1===i.length)r=i[0];else{if(2!==i.length||1!==i[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+i.join(", ")+")");r=i[0]}if(n!==r)throw new RangeError("Vectors must have equal length ("+n+" != "+r+")");if(0===n)throw new RangeError("Cannot calculate the dot product of empty vectors");return n}function s(e){return oU(e)?e.size():i(e)}})),fJ=ZU("trace",["typed","matrix","add"],(e=>{var{typed:t,matrix:n,add:r}=e;return t("trace",{Array:function(e){return a(n(e))},SparseMatrix:function(e){var t=e._values,n=e._index,a=e._ptr,i=e._size,o=i[0],s=i[1];if(o===s){var u=0;if(t.length>0)for(var c=0;c<s;c++)for(var l=a[c],p=a[c+1],h=l;h<p;h++){var d=n[h];if(d===c){u=r(u,t[h]);break}if(d>c)break}return u}throw new RangeError("Matrix must be square (size: "+nj(i)+")")},DenseMatrix:a,any:qU});function a(e){var t=e._size,n=e._data;switch(t.length){case 1:if(1===t[0])return qU(n[0]);throw new RangeError("Matrix must be square (size: "+nj(t)+")");case 2:var a=t[0];if(a===t[1]){for(var i=0,o=0;o<a;o++)i=r(i,n[o][o]);return i}throw new RangeError("Matrix must be square (size: "+nj(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+nj(t)+")")}}})),mJ="index",gJ=ZU(mJ,["typed","Index"],(e=>{var{typed:t,Index:n}=e;return t(mJ,{"...number | string | BigNumber | Range | Array | Matrix":function(e){var t=e.map((function(e){return JP(e)?e.toNumber():iU(e)||oU(e)?e.map((function(e){return JP(e)?e.toNumber():e})):e})),r=new n;return n.apply(r,t),r}})})),yJ=new Set(["end"]),vJ=ZU("Node",["mathWithTransform"],(e=>{var{mathWithTransform:t}=e;return class{get type(){return"Node"}get isNode(){return!0}evaluate(e){return this.compile().evaluate(e)}compile(){var e=this._compile(t,{}),n={};return{evaluate:function(t){var r=ZP(t);return function(e){for(var t of[...yJ])if(e.has(t))throw new Error('Scope contains an illegal symbol, "'+t+'" is a reserved keyword')}(r),e(r,n,null)}}}_compile(e,t){throw new Error("Method _compile must be implemented by type "+this.type)}forEach(e){throw new Error("Cannot run forEach on a Node interface")}map(e){throw new Error("Cannot run map on a Node interface")}_ifNode(e){if(!OU(e))throw new TypeError("Callback function must return a Node");return e}traverse(e){e(this,null,null),function e(t,n){t.forEach((function(t,r,a){n(t,r,a),e(t,n)}))}(this,e)}transform(e){return function t(n,r,a){var i=e(n,r,a);return i!==n?i:n.map(t)}(this,null,null)}filter(e){var t=[];return this.traverse((function(n,r,a){e(n,r,a)&&t.push(n)})),t}clone(){throw new Error("Cannot clone a Node interface")}cloneDeep(){return this.map((function(e){return e.cloneDeep()}))}equals(e){return!!e&&(this.type===e.type&&HU(this,e))}toString(e){var t=this._getCustomString(e);return"undefined"!==typeof t?t:this._toString(e)}_toString(){throw new Error("_toString not implemented for "+this.type)}toJSON(){throw new Error("Cannot serialize object: toJSON not implemented by "+this.type)}toHTML(e){var t=this._getCustomString(e);return"undefined"!==typeof t?t:this._toHTML(e)}_toHTML(){throw new Error("_toHTML not implemented for "+this.type)}toTex(e){var t=this._getCustomString(e);return"undefined"!==typeof t?t:this._toTex(e)}_toTex(e){throw new Error("_toTex not implemented for "+this.type)}_getCustomString(e){if(e&&"object"===typeof e)switch(typeof e.handler){case"object":case"undefined":return;case"function":return e.handler(this,e);default:throw new TypeError("Object or function expected as callback")}}getIdentifier(){return this.type}getContent(){return this}}}),{isClass:!0,isNode:!0});function bJ(e){return e&&e.isIndexError?new UP(e.index+1,e.min+1,void 0!==e.max?e.max+1:void 0):e}function xJ(e){var{subset:t}=e;return function(e,n){try{if(Array.isArray(e))return t(e,n);if(e&&"function"===typeof e.subset)return e.subset(n);if("string"===typeof e)return t(e,n);if("object"===typeof e){if(!n.isObjectProperty())throw new TypeError("Cannot apply a numeric index as object property");return WP(e,n.getObjectProperty())}throw new TypeError("Cannot apply index: unsupported type of object")}catch(r5){throw bJ(r5)}}}var wJ="AccessorNode",NJ=ZU(wJ,["subset","Node"],(e=>{var{subset:t,Node:n}=e,r=xJ({subset:t});function a(e){return!(kU(e)||EU(e)||IU(e)||_U(e)||RU(e)||BU(e)||UU(e))}class i extends n{constructor(e,t){if(super(),!OU(e))throw new TypeError('Node expected for parameter "object"');if(!MU(t))throw new TypeError('IndexNode expected for parameter "index"');this.object=e,this.index=t}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return wJ}get isAccessorNode(){return!0}_compile(e,t){var n=this.object._compile(e,t),a=this.index._compile(e,t);if(this.index.isObjectProperty()){var i=this.index.getObjectProperty();return function(e,t,r){return WP(n(e,t,r),i)}}return function(e,t,i){var o=n(e,t,i),s=a(e,t,o);return r(o,s)}}forEach(e){e(this.object,"object",this),e(this.index,"index",this)}map(e){return new i(this._ifNode(e(this.object,"object",this)),this._ifNode(e(this.index,"index",this)))}clone(){return new i(this.object,this.index)}_toString(e){var t=this.object.toString(e);return a(this.object)&&(t="("+t+")"),t+this.index.toString(e)}_toHTML(e){var t=this.object.toHTML(e);return a(this.object)&&(t='<span class="math-parenthesis math-round-parenthesis">(</span>'+t+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+this.index.toHTML(e)}_toTex(e){var t=this.object.toTex(e);return a(this.object)&&(t="\\left(' + object + '\\right)"),t+this.index.toTex(e)}toJSON(){return{mathjs:wJ,object:this.object,index:this.index}}static fromJSON(e){return new i(e.object,e.index)}}return SY(i,"name",wJ),i}),{isClass:!0,isNode:!0}),SJ="ArrayNode",kJ=ZU(SJ,["Node"],(e=>{var{Node:t}=e;class n extends t{constructor(e){if(super(),this.items=e||[],!Array.isArray(this.items)||!this.items.every(OU))throw new TypeError("Array containing Nodes expected")}get type(){return SJ}get isArrayNode(){return!0}_compile(e,t){var n=kj(this.items,(function(n){return n._compile(e,t)}));if("Array"!==e.config.matrix){var r=e.matrix;return function(e,t,a){return r(kj(n,(function(n){return n(e,t,a)})))}}return function(e,t,r){return kj(n,(function(n){return n(e,t,r)}))}}forEach(e){for(var t=0;t<this.items.length;t++){e(this.items[t],"items["+t+"]",this)}}map(e){for(var t=[],r=0;r<this.items.length;r++)t[r]=this._ifNode(e(this.items[r],"items["+r+"]",this));return new n(t)}clone(){return new n(this.items.slice(0))}_toString(e){return"["+this.items.map((function(t){return t.toString(e)})).join(", ")+"]"}toJSON(){return{mathjs:SJ,items:this.items}}static fromJSON(e){return new n(e.items)}_toHTML(e){return'<span class="math-parenthesis math-square-parenthesis">[</span>'+this.items.map((function(t){return t.toHTML(e)})).join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(e){return function t(n,r){var a=n.some(EU)&&!n.every(EU),i=r||a,o=i?"&":"\\\\",s=n.map((function(n){return n.items?t(n.items,!r):n.toTex(e)})).join(o);return a||!i||i&&!r?"\\begin{bmatrix}"+s+"\\end{bmatrix}":s}(this.items,!1)}}return SY(n,"name",SJ),n}),{isClass:!0,isNode:!0});var EJ=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{op:"or",associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{op:"xor",associativity:"left",associativeWith:[]}},{"OperatorNode:and":{op:"and",associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{op:"|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{op:"^|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{op:"&",associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{op:"==",associativity:"left",associativeWith:[]},"OperatorNode:unequal":{op:"!=",associativity:"left",associativeWith:[]},"OperatorNode:smaller":{op:"<",associativity:"left",associativeWith:[]},"OperatorNode:larger":{op:">",associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{op:"<=",associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{op:">=",associativity:"left",associativeWith:[]},RelationalNode:{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{op:"<<",associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{op:">>",associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{op:">>>",associativity:"left",associativeWith:[]}},{"OperatorNode:to":{op:"to",associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{op:"+",associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{op:"-",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{op:"*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{op:"/",associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{op:".*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{op:"./",associativity:"left",associativeWith:[]},"OperatorNode:mod":{op:"mod",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]}},{"OperatorNode:unaryPlus":{op:"+",associativity:"right"},"OperatorNode:unaryMinus":{op:"-",associativity:"right"},"OperatorNode:bitNot":{op:"~",associativity:"right"},"OperatorNode:not":{op:"not",associativity:"right"}},{"OperatorNode:pow":{op:"^",associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{op:".^",associativity:"right",associativeWith:[]}},{"OperatorNode:factorial":{op:"!",associativity:"left"}},{"OperatorNode:ctranspose":{op:"'",associativity:"left"}}];function CJ(e,t){if(!t||"auto"!==t)return e;for(var n=e;BU(n);)n=n.content;return n}function TJ(e,t,n,r){var a=e;"keep"!==t&&(a=e.getContent());for(var i=a.getIdentifier(),o=null,s=0;s<EJ.length;s++)if(i in EJ[s]){o=s;break}if("OperatorNode:multiply"===i&&a.implicit&&"show"!==n){var u=CJ(a.args[0],t);IU(u)&&r&&"OperatorNode:divide"===r.getIdentifier()&&AU(CJ(r.args[0],t))||"OperatorNode:divide"===u.getIdentifier()&&AU(CJ(u.args[0],t))&&IU(CJ(u.args[1]))||(o+=1)}return o}function DJ(e,t){var n=e;"keep"!==t&&(n=e.getContent());var r=n.getIdentifier(),a=TJ(n,t);if(null===a)return null;var i=EJ[a][r];if($U(i,"associativity")){if("left"===i.associativity)return"left";if("right"===i.associativity)return"right";throw Error("'"+r+"' has the invalid associativity '"+i.associativity+"'.")}return null}function IJ(e,t,n){var r="keep"!==n?e.getContent():e,a="keep"!==n?e.getContent():t,i=r.getIdentifier(),o=a.getIdentifier(),s=TJ(r,n);if(null===s)return null;var u=EJ[s][i];if($U(u,"associativeWith")&&u.associativeWith instanceof Array){for(var c=0;c<u.associativeWith.length;c++)if(u.associativeWith[c]===o)return!0;return!1}return null}var AJ="AssignmentNode",FJ=ZU(AJ,["subset","?matrix","Node"],(e=>{var{subset:t,matrix:n,Node:r}=e,a=xJ({subset:t}),i=function(e){var{subset:t,matrix:n}=e;return function(e,r,a){try{if(Array.isArray(e))return n(e).subset(r,a).valueOf().forEach(((t,n)=>{e[n]=t})),e;if(e&&"function"===typeof e.subset)return e.subset(r,a);if("string"===typeof e)return t(e,r,a);if("object"===typeof e){if(!r.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return VP(e,r.getObjectProperty(),a),e}throw new TypeError("Cannot apply index: unsupported type of object")}catch(r5){throw bJ(r5)}}}({subset:t,matrix:n});function o(e,t,n){t||(t="keep");var r=TJ(e,t,n),a=TJ(e.value,t,n);return"all"===t||null!==a&&a<=r}class s extends r{constructor(e,t,n){if(super(),this.object=e,this.index=n?t:null,this.value=n||t,!UU(e)&&!kU(e))throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(UU(e)&&"end"===e.name)throw new Error('Cannot assign to symbol "end"');if(this.index&&!MU(this.index))throw new TypeError('IndexNode expected as "index"');if(!OU(this.value))throw new TypeError('Node expected as "value"')}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return AJ}get isAssignmentNode(){return!0}_compile(e,t){var n=this.object._compile(e,t),r=this.index?this.index._compile(e,t):null,o=this.value._compile(e,t),s=this.object.name;if(this.index){if(this.index.isObjectProperty()){var u=this.index.getObjectProperty();return function(e,t,r){var a=n(e,t,r),i=o(e,t,r);return VP(a,u,i),i}}if(UU(this.object))return function(e,t,a){var u=n(e,t,a),c=o(e,t,a),l=r(e,t,u);return e.set(s,i(u,l,c)),c};var c=this.object.object._compile(e,t);if(this.object.index.isObjectProperty()){var l=this.object.index.getObjectProperty();return function(e,t,n){var a=c(e,t,n),s=WP(a,l),u=r(e,t,s),p=o(e,t,n);return VP(a,l,i(s,u,p)),p}}var p=this.object.index._compile(e,t);return function(e,t,n){var s=c(e,t,n),u=p(e,t,s),l=a(s,u),h=r(e,t,l),d=o(e,t,n);return i(s,u,i(l,h,d)),d}}if(!UU(this.object))throw new TypeError("SymbolNode expected as object");return function(e,t,n){var r=o(e,t,n);return e.set(s,r),r}}forEach(e){e(this.object,"object",this),this.index&&e(this.index,"index",this),e(this.value,"value",this)}map(e){var t=this._ifNode(e(this.object,"object",this)),n=this.index?this._ifNode(e(this.index,"index",this)):null,r=this._ifNode(e(this.value,"value",this));return new s(t,n,r)}clone(){return new s(this.object,this.index,this.value)}_toString(e){var t=this.object.toString(e),n=this.index?this.index.toString(e):"",r=this.value.toString(e);return o(this,e&&e.parenthesis,e&&e.implicit)&&(r="("+r+")"),t+n+" = "+r}toJSON(){return{mathjs:AJ,object:this.object,index:this.index,value:this.value}}static fromJSON(e){return new s(e.object,e.index,e.value)}_toHTML(e){var t=this.object.toHTML(e),n=this.index?this.index.toHTML(e):"",r=this.value.toHTML(e);return o(this,e&&e.parenthesis,e&&e.implicit)&&(r='<span class="math-paranthesis math-round-parenthesis">(</span>'+r+'<span class="math-paranthesis math-round-parenthesis">)</span>'),t+n+'<span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+r}_toTex(e){var t=this.object.toTex(e),n=this.index?this.index.toTex(e):"",r=this.value.toTex(e);return o(this,e&&e.parenthesis,e&&e.implicit)&&(r="\\left(".concat(r,"\\right)")),t+n+"="+r}}return SY(s,"name",AJ),s}),{isClass:!0,isNode:!0}),_J="BlockNode",MJ=ZU(_J,["ResultSet","Node"],(e=>{var{ResultSet:t,Node:n}=e;class r extends n{constructor(e){if(super(),!Array.isArray(e))throw new Error("Array expected");this.blocks=e.map((function(e){var t=e&&e.node,n=!e||void 0===e.visible||e.visible;if(!OU(t))throw new TypeError('Property "node" must be a Node');if("boolean"!==typeof n)throw new TypeError('Property "visible" must be a boolean');return{node:t,visible:n}}))}get type(){return _J}get isBlockNode(){return!0}_compile(e,n){var r=kj(this.blocks,(function(t){return{evaluate:t.node._compile(e,n),visible:t.visible}}));return function(e,n,a){var i=[];return Ej(r,(function(t){var r=t.evaluate(e,n,a);t.visible&&i.push(r)})),new t(i)}}forEach(e){for(var t=0;t<this.blocks.length;t++)e(this.blocks[t].node,"blocks["+t+"].node",this)}map(e){for(var t=[],n=0;n<this.blocks.length;n++){var a=this.blocks[n],i=this._ifNode(e(a.node,"blocks["+n+"].node",this));t[n]={node:i,visible:a.visible}}return new r(t)}clone(){var e=this.blocks.map((function(e){return{node:e.node,visible:e.visible}}));return new r(e)}_toString(e){return this.blocks.map((function(t){return t.node.toString(e)+(t.visible?"":";")})).join("\n")}toJSON(){return{mathjs:_J,blocks:this.blocks}}static fromJSON(e){return new r(e.blocks)}_toHTML(e){return this.blocks.map((function(t){return t.node.toHTML(e)+(t.visible?"":'<span class="math-separator">;</span>')})).join('<span class="math-separator"><br /></span>')}_toTex(e){return this.blocks.map((function(t){return t.node.toTex(e)+(t.visible?"":";")})).join("\\;\\;\n")}}return SY(r,"name",_J),r}),{isClass:!0,isNode:!0}),OJ="ConditionalNode",RJ=ZU(OJ,["Node"],(e=>{var{Node:t}=e;class n extends t{constructor(e,t,n){if(super(),!OU(e))throw new TypeError("Parameter condition must be a Node");if(!OU(t))throw new TypeError("Parameter trueExpr must be a Node");if(!OU(n))throw new TypeError("Parameter falseExpr must be a Node");this.condition=e,this.trueExpr=t,this.falseExpr=n}get type(){return OJ}get isConditionalNode(){return!0}_compile(e,t){var n=this.condition._compile(e,t),r=this.trueExpr._compile(e,t),a=this.falseExpr._compile(e,t);return function(e,t,i){return function(e){if("number"===typeof e||"boolean"===typeof e||"string"===typeof e)return!!e;if(e){if(JP(e))return!e.isZero();if(tU(e))return!(!e.re&&!e.im);if(rU(e))return!!e.value}if(null===e||void 0===e)return!1;throw new TypeError('Unsupported type of condition "'+VU(e)+'"')}(n(e,t,i))?r(e,t,i):a(e,t,i)}}forEach(e){e(this.condition,"condition",this),e(this.trueExpr,"trueExpr",this),e(this.falseExpr,"falseExpr",this)}map(e){return new n(this._ifNode(e(this.condition,"condition",this)),this._ifNode(e(this.trueExpr,"trueExpr",this)),this._ifNode(e(this.falseExpr,"falseExpr",this)))}clone(){return new n(this.condition,this.trueExpr,this.falseExpr)}_toString(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=TJ(this,t,e&&e.implicit),r=this.condition.toString(e),a=TJ(this.condition,t,e&&e.implicit);("all"===t||"OperatorNode"===this.condition.type||null!==a&&a<=n)&&(r="("+r+")");var i=this.trueExpr.toString(e),o=TJ(this.trueExpr,t,e&&e.implicit);("all"===t||"OperatorNode"===this.trueExpr.type||null!==o&&o<=n)&&(i="("+i+")");var s=this.falseExpr.toString(e),u=TJ(this.falseExpr,t,e&&e.implicit);return("all"===t||"OperatorNode"===this.falseExpr.type||null!==u&&u<=n)&&(s="("+s+")"),r+" ? "+i+" : "+s}toJSON(){return{mathjs:OJ,condition:this.condition,trueExpr:this.trueExpr,falseExpr:this.falseExpr}}static fromJSON(e){return new n(e.condition,e.trueExpr,e.falseExpr)}_toHTML(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=TJ(this,t,e&&e.implicit),r=this.condition.toHTML(e),a=TJ(this.condition,t,e&&e.implicit);("all"===t||"OperatorNode"===this.condition.type||null!==a&&a<=n)&&(r='<span class="math-parenthesis math-round-parenthesis">(</span>'+r+'<span class="math-parenthesis math-round-parenthesis">)</span>');var i=this.trueExpr.toHTML(e),o=TJ(this.trueExpr,t,e&&e.implicit);("all"===t||"OperatorNode"===this.trueExpr.type||null!==o&&o<=n)&&(i='<span class="math-parenthesis math-round-parenthesis">(</span>'+i+'<span class="math-parenthesis math-round-parenthesis">)</span>');var s=this.falseExpr.toHTML(e),u=TJ(this.falseExpr,t,e&&e.implicit);return("all"===t||"OperatorNode"===this.falseExpr.type||null!==u&&u<=n)&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),r+'<span class="math-operator math-conditional-operator">?</span>'+i+'<span class="math-operator math-conditional-operator">:</span>'+s}_toTex(e){return"\\begin{cases} {"+this.trueExpr.toTex(e)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(e)+"}\\\\{"+this.falseExpr.toTex(e)+"}, &\\quad{\\text{otherwise}}\\end{cases}"}}return SY(n,"name",OJ),n}),{isClass:!0,isNode:!0}),zJ=n(147),BJ={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},LJ={transpose:"^\\top",ctranspose:"^H",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"\\~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},PJ={abs:{1:"\\left|${args[0]}\\right|"},add:{2:"\\left(${args[0]}".concat(LJ.add,"${args[1]}\\right)")},cbrt:{1:"\\sqrt[3]{${args[0]}}"},ceil:{1:"\\left\\lceil${args[0]}\\right\\rceil"},cube:{1:"\\left(${args[0]}\\right)^3"},divide:{2:"\\frac{${args[0]}}{${args[1]}}"},dotDivide:{2:"\\left(${args[0]}".concat(LJ.dotDivide,"${args[1]}\\right)")},dotMultiply:{2:"\\left(${args[0]}".concat(LJ.dotMultiply,"${args[1]}\\right)")},dotPow:{2:"\\left(${args[0]}".concat(LJ.dotPow,"${args[1]}\\right)")},exp:{1:"\\exp\\left(${args[0]}\\right)"},expm1:"\\left(e".concat(LJ.pow,"{${args[0]}}-1\\right)"),fix:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},floor:{1:"\\left\\lfloor${args[0]}\\right\\rfloor"},gcd:"\\gcd\\left(${args}\\right)",hypot:"\\hypot\\left(${args}\\right)",log:{1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},log10:{1:"\\log_{10}\\left(${args[0]}\\right)"},log1p:{1:"\\ln\\left(${args[0]}+1\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}+1\\right)"},log2:"\\log_{2}\\left(${args[0]}\\right)",mod:{2:"\\left(${args[0]}".concat(LJ.mod,"${args[1]}\\right)")},multiply:{2:"\\left(${args[0]}".concat(LJ.multiply,"${args[1]}\\right)")},norm:{1:"\\left\\|${args[0]}\\right\\|",2:void 0},nthRoot:{2:"\\sqrt[${args[1]}]{${args[0]}}"},nthRoots:{2:"\\{y : $y^{args[1]} = {${args[0]}}\\}"},pow:{2:"\\left(${args[0]}\\right)".concat(LJ.pow,"{${args[1]}}")},round:{1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},sign:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},sqrt:{1:"\\sqrt{${args[0]}}"},square:{1:"\\left(${args[0]}\\right)^2"},subtract:{2:"\\left(${args[0]}".concat(LJ.subtract,"${args[1]}\\right)")},unaryMinus:{1:"".concat(LJ.unaryMinus,"\\left(${args[0]}\\right)")},unaryPlus:{1:"".concat(LJ.unaryPlus,"\\left(${args[0]}\\right)")},bitAnd:{2:"\\left(${args[0]}".concat(LJ.bitAnd,"${args[1]}\\right)")},bitNot:{1:LJ.bitNot+"\\left(${args[0]}\\right)"},bitOr:{2:"\\left(${args[0]}".concat(LJ.bitOr,"${args[1]}\\right)")},bitXor:{2:"\\left(${args[0]}".concat(LJ.bitXor,"${args[1]}\\right)")},leftShift:{2:"\\left(${args[0]}".concat(LJ.leftShift,"${args[1]}\\right)")},rightArithShift:{2:"\\left(${args[0]}".concat(LJ.rightArithShift,"${args[1]}\\right)")},rightLogShift:{2:"\\left(${args[0]}".concat(LJ.rightLogShift,"${args[1]}\\right)")},bellNumbers:{1:"\\mathrm{B}_{${args[0]}}"},catalan:{1:"\\mathrm{C}_{${args[0]}}"},stirlingS2:{2:"\\mathrm{S}\\left(${args}\\right)"},arg:{1:"\\arg\\left(${args[0]}\\right)"},conj:{1:"\\left(${args[0]}\\right)^*"},im:{1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},re:{1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},and:{2:"\\left(${args[0]}".concat(LJ.and,"${args[1]}\\right)")},not:{1:LJ.not+"\\left(${args[0]}\\right)"},or:{2:"\\left(${args[0]}".concat(LJ.or,"${args[1]}\\right)")},xor:{2:"\\left(${args[0]}".concat(LJ.xor,"${args[1]}\\right)")},cross:{2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},ctranspose:{1:"\\left(${args[0]}\\right)".concat(LJ.ctranspose)},det:{1:"\\det\\left(${args[0]}\\right)"},dot:{2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},expm:{1:"\\exp\\left(${args[0]}\\right)"},inv:{1:"\\left(${args[0]}\\right)^{-1}"},pinv:{1:"\\left(${args[0]}\\right)^{+}"},sqrtm:{1:"{${args[0]}}".concat(LJ.pow,"{\\frac{1}{2}}")},trace:{1:"\\mathrm{tr}\\left(${args[0]}\\right)"},transpose:{1:"\\left(${args[0]}\\right)".concat(LJ.transpose)},combinations:{2:"\\binom{${args[0]}}{${args[1]}}"},combinationsWithRep:{2:"\\left(\\!\\!{\\binom{${args[0]}}{${args[1]}}}\\!\\!\\right)"},factorial:{1:"\\left(${args[0]}\\right)".concat(LJ.factorial)},gamma:{1:"\\Gamma\\left(${args[0]}\\right)"},lgamma:{1:"\\ln\\Gamma\\left(${args[0]}\\right)"},equal:{2:"\\left(${args[0]}".concat(LJ.equal,"${args[1]}\\right)")},larger:{2:"\\left(${args[0]}".concat(LJ.larger,"${args[1]}\\right)")},largerEq:{2:"\\left(${args[0]}".concat(LJ.largerEq,"${args[1]}\\right)")},smaller:{2:"\\left(${args[0]}".concat(LJ.smaller,"${args[1]}\\right)")},smallerEq:{2:"\\left(${args[0]}".concat(LJ.smallerEq,"${args[1]}\\right)")},unequal:{2:"\\left(${args[0]}".concat(LJ.unequal,"${args[1]}\\right)")},erf:{1:"erf\\left(${args[0]}\\right)"},max:"\\max\\left(${args}\\right)",min:"\\min\\left(${args}\\right)",variance:"\\mathrm{Var}\\left(${args}\\right)",acos:{1:"\\cos^{-1}\\left(${args[0]}\\right)"},acosh:{1:"\\cosh^{-1}\\left(${args[0]}\\right)"},acot:{1:"\\cot^{-1}\\left(${args[0]}\\right)"},acoth:{1:"\\coth^{-1}\\left(${args[0]}\\right)"},acsc:{1:"\\csc^{-1}\\left(${args[0]}\\right)"},acsch:{1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},asec:{1:"\\sec^{-1}\\left(${args[0]}\\right)"},asech:{1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},asin:{1:"\\sin^{-1}\\left(${args[0]}\\right)"},asinh:{1:"\\sinh^{-1}\\left(${args[0]}\\right)"},atan:{1:"\\tan^{-1}\\left(${args[0]}\\right)"},atan2:{2:"\\mathrm{atan2}\\left(${args}\\right)"},atanh:{1:"\\tanh^{-1}\\left(${args[0]}\\right)"},cos:{1:"\\cos\\left(${args[0]}\\right)"},cosh:{1:"\\cosh\\left(${args[0]}\\right)"},cot:{1:"\\cot\\left(${args[0]}\\right)"},coth:{1:"\\coth\\left(${args[0]}\\right)"},csc:{1:"\\csc\\left(${args[0]}\\right)"},csch:{1:"\\mathrm{csch}\\left(${args[0]}\\right)"},sec:{1:"\\sec\\left(${args[0]}\\right)"},sech:{1:"\\mathrm{sech}\\left(${args[0]}\\right)"},sin:{1:"\\sin\\left(${args[0]}\\right)"},sinh:{1:"\\sinh\\left(${args[0]}\\right)"},tan:{1:"\\tan\\left(${args[0]}\\right)"},tanh:{1:"\\tanh\\left(${args[0]}\\right)"},to:{2:"\\left(${args[0]}".concat(LJ.to,"${args[1]}\\right)")},numeric:function(e,t){return e.args[0].toTex()},number:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},string:{0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},bignumber:{0:"0",1:"\\left(${args[0]}\\right)"},bigint:{0:"0",1:"\\left(${args[0]}\\right)"},complex:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+".concat(BJ.i,"\\cdot\\left(${args[1]}\\right)\\right)")},matrix:{0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},sparse:{0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},unit:{1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"}},UJ={deg:"^\\circ"};function WJ(e){return zJ(e,{preserveFormatting:!0})}function VJ(e,t){return(t="undefined"!==typeof t&&t)?$U(UJ,e)?UJ[e]:"\\mathrm{"+WJ(e)+"}":$U(BJ,e)?BJ[e]:WJ(e)}var qJ="ConstantNode",jJ=ZU(qJ,["Node"],(e=>{var{Node:t}=e;class n extends t{constructor(e){super(),this.value=e}get type(){return qJ}get isConstantNode(){return!0}_compile(e,t){var n=this.value;return function(){return n}}forEach(e){}map(e){return this.clone()}clone(){return new n(this.value)}_toString(e){return nj(this.value,e)}_toHTML(e){var t=this._toString(e);switch(VU(this.value)){case"number":case"bigint":case"BigNumber":case"Fraction":return'<span class="math-number">'+t+"</span>";case"string":return'<span class="math-string">'+t+"</span>";case"boolean":return'<span class="math-boolean">'+t+"</span>";case"null":return'<span class="math-null-symbol">'+t+"</span>";case"undefined":return'<span class="math-undefined">'+t+"</span>";default:return'<span class="math-symbol">'+t+"</span>"}}toJSON(){return{mathjs:qJ,value:this.value}}static fromJSON(e){return new n(e.value)}_toTex(e){var t=this._toString(e),n=VU(this.value);switch(n){case"string":return"\\mathtt{"+WJ(t)+"}";case"number":case"BigNumber":if(!("BigNumber"===n?this.value.isFinite():isFinite(this.value)))return this.value.valueOf()<0?"-\\infty":"\\infty";var r=t.toLowerCase().indexOf("e");return-1!==r?t.substring(0,r)+"\\cdot10^{"+t.substring(r+1)+"}":t;case"bigint":return t.toString();case"Fraction":return this.value.toLatex();default:return t}}}return SY(n,"name",qJ),n}),{isClass:!0,isNode:!0}),GJ="FunctionAssignmentNode",HJ=ZU(GJ,["typed","Node"],(e=>{var{typed:t,Node:n}=e;function r(e,t,n){var r=TJ(e,t,n),a=TJ(e.expr,t,n);return"all"===t||null!==a&&a<=r}class a extends n{constructor(e,t,n){if(super(),"string"!==typeof e)throw new TypeError('String expected for parameter "name"');if(!Array.isArray(t))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!OU(n))throw new TypeError('Node expected for parameter "expr"');if(yJ.has(e))throw new Error('Illegal function name, "'+e+'" is a reserved keyword');var r=new Set;for(var a of t){var i="string"===typeof a?a:a.name;if(r.has(i))throw new Error('Duplicate parameter name "'.concat(i,'"'));r.add(i)}this.name=e,this.params=t.map((function(e){return e&&e.name||e})),this.types=t.map((function(e){return e&&e.type||"any"})),this.expr=n}get type(){return GJ}get isFunctionAssignmentNode(){return!0}_compile(e,n){var r=Object.create(n);Ej(this.params,(function(e){r[e]=!0}));var a=this.expr._compile(e,r),i=this.name,o=this.params,s=Tj(this.types,","),u=i+"("+Tj(this.params,", ")+")";return function(e,n,r){var c={};c[s]=function(){for(var t=Object.create(n),i=0;i<o.length;i++)t[o[i]]=arguments[i];return a(e,t,r)};var l=t(i,c);return l.syntax=u,e.set(i,l),l}}forEach(e){e(this.expr,"expr",this)}map(e){var t=this._ifNode(e(this.expr,"expr",this));return new a(this.name,this.params.slice(0),t)}clone(){return new a(this.name,this.params.slice(0),this.expr)}_toString(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=this.expr.toString(e);return r(this,t,e&&e.implicit)&&(n="("+n+")"),this.name+"("+this.params.join(", ")+") = "+n}toJSON(){var e=this.types;return{mathjs:GJ,name:this.name,params:this.params.map((function(t,n){return{name:t,type:e[n]}})),expr:this.expr}}static fromJSON(e){return new a(e.name,e.params,e.expr)}_toHTML(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",n=[],a=0;a<this.params.length;a++)n.push('<span class="math-symbol math-parameter">'+ij(this.params[a])+"</span>");var i=this.expr.toHTML(e);return r(this,t,e&&e.implicit)&&(i='<span class="math-parenthesis math-round-parenthesis">(</span>'+i+'<span class="math-parenthesis math-round-parenthesis">)</span>'),'<span class="math-function">'+ij(this.name)+'</span><span class="math-parenthesis math-round-parenthesis">(</span>'+n.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-round-parenthesis">)</span><span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+i}_toTex(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=this.expr.toTex(e);return r(this,t,e&&e.implicit)&&(n="\\left(".concat(n,"\\right)")),"\\mathrm{"+this.name+"}\\left("+this.params.map(VJ).join(",")+"\\right)="+n}}return SY(a,"name",GJ),a}),{isClass:!0,isNode:!0}),KJ="IndexNode",XJ=ZU(KJ,["Node","size"],(e=>{var{Node:t,size:n}=e;class r extends t{constructor(e,t){if(super(),this.dimensions=e,this.dotNotation=t||!1,!Array.isArray(e)||!e.every(OU))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties")}get type(){return KJ}get isIndexNode(){return!0}_compile(e,t){var r=kj(this.dimensions,(function(r,a){if(r.filter((e=>e.isSymbolNode&&"end"===e.name)).length>0){var i=Object.create(t);i.end=!0;var o=r._compile(e,i);return function(e,t,r){if(!oU(r)&&!iU(r)&&!aU(r))throw new TypeError('Cannot resolve "end": context must be a Matrix, Array, or string but is '+VU(r));var i=n(r).valueOf(),s=Object.create(t);return s.end=i[a],o(e,s,r)}}return r._compile(e,t)})),a=WP(e,"index");return function(e,t,n){var i=kj(r,(function(r){return r(e,t,n)}));return a(...i)}}forEach(e){for(var t=0;t<this.dimensions.length;t++)e(this.dimensions[t],"dimensions["+t+"]",this)}map(e){for(var t=[],n=0;n<this.dimensions.length;n++)t[n]=this._ifNode(e(this.dimensions[n],"dimensions["+n+"]",this));return new r(t,this.dotNotation)}clone(){return new r(this.dimensions.slice(0),this.dotNotation)}isObjectProperty(){return 1===this.dimensions.length&&IU(this.dimensions[0])&&"string"===typeof this.dimensions[0].value}getObjectProperty(){return this.isObjectProperty()?this.dimensions[0].value:null}_toString(e){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"}toJSON(){return{mathjs:KJ,dimensions:this.dimensions,dotNotation:this.dotNotation}}static fromJSON(e){return new r(e.dimensions,e.dotNotation)}_toHTML(e){for(var t=[],n=0;n<this.dimensions.length;n++)t[n]=this.dimensions[n].toHTML();return this.dotNotation?'<span class="math-operator math-accessor-operator">.</span><span class="math-symbol math-property">'+ij(this.getObjectProperty())+"</span>":'<span class="math-parenthesis math-square-parenthesis">[</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(e){var t=this.dimensions.map((function(t){return t.toTex(e)}));return this.dotNotation?"."+this.getObjectProperty():"_{"+t.join(",")+"}"}}return SY(r,"name",KJ),r}),{isClass:!0,isNode:!0}),YJ="ObjectNode",$J=ZU(YJ,["Node"],(e=>{var{Node:t}=e;class n extends t{constructor(e){if(super(),this.properties=e||{},e&&("object"!==typeof e||!Object.keys(e).every((function(t){return OU(e[t])}))))throw new TypeError("Object containing Nodes expected")}get type(){return YJ}get isObjectNode(){return!0}_compile(e,t){var n={};for(var r in this.properties)if($U(this.properties,r)){var a=rj(r),i=JSON.parse(a),o=WP(this.properties,r);n[i]=o._compile(e,t)}return function(e,t,r){var a={};for(var i in n)$U(n,i)&&(a[i]=n[i](e,t,r));return a}}forEach(e){for(var t in this.properties)$U(this.properties,t)&&e(this.properties[t],"properties["+rj(t)+"]",this)}map(e){var t={};for(var r in this.properties)$U(this.properties,r)&&(t[r]=this._ifNode(e(this.properties[r],"properties["+rj(r)+"]",this)));return new n(t)}clone(){var e={};for(var t in this.properties)$U(this.properties,t)&&(e[t]=this.properties[t]);return new n(e)}_toString(e){var t=[];for(var n in this.properties)$U(this.properties,n)&&t.push(rj(n)+": "+this.properties[n].toString(e));return"{"+t.join(", ")+"}"}toJSON(){return{mathjs:YJ,properties:this.properties}}static fromJSON(e){return new n(e.properties)}_toHTML(e){var t=[];for(var n in this.properties)$U(this.properties,n)&&t.push('<span class="math-symbol math-property">'+ij(n)+'</span><span class="math-operator math-assignment-operator math-property-assignment-operator math-binary-operator">:</span>'+this.properties[n].toHTML(e));return'<span class="math-parenthesis math-curly-parenthesis">{</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-curly-parenthesis">}</span>'}_toTex(e){var t=[];for(var n in this.properties)$U(this.properties,n)&&t.push("\\mathbf{"+n+":} & "+this.properties[n].toTex(e)+"\\\\");return"\\left\\{\\begin{array}{ll}"+t.join("\n")+"\\end{array}\\right\\}"}}return SY(n,"name",YJ),n}),{isClass:!0,isNode:!0});function ZJ(e,t){return new XP(e,new KP(t),new Set(Object.keys(t)))}var QJ="OperatorNode",JJ=ZU(QJ,["Node"],(e=>{var{Node:t}=e;function n(e,t){var r=e;if("auto"===t)for(;BU(r);)r=r.content;return!!IU(r)||!!zU(r)&&n(r.args[0],t)}function r(e,t,r,a,i){var o,s=TJ(e,t,r),u=DJ(e,t);if("all"===t||a.length>2&&"OperatorNode:add"!==e.getIdentifier()&&"OperatorNode:multiply"!==e.getIdentifier())return a.map((function(e){switch(e.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":return!1;default:return!0}}));switch(a.length){case 0:o=[];break;case 1:var c=TJ(a[0],t,r,e);if(i&&null!==c){var l,p;if("keep"===t?(l=a[0].getIdentifier(),p=e.getIdentifier()):(l=a[0].getContent().getIdentifier(),p=e.getContent().getIdentifier()),!1===EJ[s][p].latexLeftParens){o=[!1];break}if(!1===EJ[c][l].latexParens){o=[!1];break}}if(null===c){o=[!1];break}if(c<=s){o=[!0];break}o=[!1];break;case 2:var h,d,f=TJ(a[0],t,r,e),m=IJ(e,a[0],t);h=null!==f&&(f===s&&"right"===u&&!m||f<s);var g,y,v,b=TJ(a[1],t,r,e),x=IJ(e,a[1],t);if(d=null!==b&&(b===s&&"left"===u&&!x||b<s),i)"keep"===t?(g=e.getIdentifier(),y=e.args[0].getIdentifier(),v=e.args[1].getIdentifier()):(g=e.getContent().getIdentifier(),y=e.args[0].getContent().getIdentifier(),v=e.args[1].getContent().getIdentifier()),null!==f&&(!1===EJ[s][g].latexLeftParens&&(h=!1),!1===EJ[f][y].latexParens&&(h=!1)),null!==b&&(!1===EJ[s][g].latexRightParens&&(d=!1),!1===EJ[b][v].latexParens&&(d=!1));o=[h,d];break;default:"OperatorNode:add"!==e.getIdentifier()&&"OperatorNode:multiply"!==e.getIdentifier()||(o=a.map((function(n){var a=TJ(n,t,r,e),i=IJ(e,n,t),o=DJ(n,t);return null!==a&&(s===a&&u===o&&!i||a<s)})))}if(a.length>=2&&"OperatorNode:multiply"===e.getIdentifier()&&e.implicit&&"all"!==t&&"hide"===r)for(var w=1;w<o.length;++w)!n(a[w],t)||o[w-1]||"keep"===t&&BU(a[w-1])||(o[w]=!0);return o}class a extends t{constructor(e,t,n,r,a){if(super(),"string"!==typeof e)throw new TypeError('string expected for parameter "op"');if("string"!==typeof t)throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(n)||!n.every(OU))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=!0===r,this.isPercentage=!0===a,this.op=e,this.fn=t,this.args=n||[]}get type(){return QJ}get isOperatorNode(){return!0}_compile(e,t){if("string"!==typeof this.fn||!jP(e,this.fn))throw e[this.fn]?new Error('No access to function "'+this.fn+'"'):new Error("Function "+this.fn+' missing in provided namespace "math"');var n=WP(e,this.fn),r=kj(this.args,(function(n){return n._compile(e,t)}));if("function"===typeof n&&!0===n.rawArgs){var a=this.args;return function(t,r,i){return n(a,e,ZJ(t,r))}}if(1===r.length){var i=r[0];return function(e,t,r){return n(i(e,t,r))}}if(2===r.length){var o=r[0],s=r[1];return function(e,t,r){return n(o(e,t,r),s(e,t,r))}}return function(e,t,a){return n.apply(null,kj(r,(function(n){return n(e,t,a)})))}}forEach(e){for(var t=0;t<this.args.length;t++)e(this.args[t],"args["+t+"]",this)}map(e){for(var t=[],n=0;n<this.args.length;n++)t[n]=this._ifNode(e(this.args[n],"args["+n+"]",this));return new a(this.op,this.fn,t,this.implicit,this.isPercentage)}clone(){return new a(this.op,this.fn,this.args.slice(0),this.implicit,this.isPercentage)}isUnary(){return 1===this.args.length}isBinary(){return 2===this.args.length}_toString(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=e&&e.implicit?e.implicit:"hide",a=this.args,i=r(this,t,n,a,!1);if(1===a.length){var o=DJ(this,t),s=a[0].toString(e);i[0]&&(s="("+s+")");var u=/[a-zA-Z]+/.test(this.op);return"right"===o?this.op+(u?" ":"")+s:"left"===o?s+(u?" ":"")+this.op:s+this.op}if(2===a.length){var c=a[0].toString(e),l=a[1].toString(e);return i[0]&&(c="("+c+")"),i[1]&&(l="("+l+")"),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?c+" "+l:c+" "+this.op+" "+l}if(a.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var p=a.map((function(t,n){return t=t.toString(e),i[n]&&(t="("+t+")"),t}));return this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?p.join(" "):p.join(" "+this.op+" ")}return this.fn+"("+this.args.join(", ")+")"}toJSON(){return{mathjs:QJ,op:this.op,fn:this.fn,args:this.args,implicit:this.implicit,isPercentage:this.isPercentage}}static fromJSON(e){return new a(e.op,e.fn,e.args,e.implicit,e.isPercentage)}_toHTML(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=e&&e.implicit?e.implicit:"hide",a=this.args,i=r(this,t,n,a,!1);if(1===a.length){var o=DJ(this,t),s=a[0].toHTML(e);return i[0]&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),"right"===o?'<span class="math-operator math-unary-operator math-lefthand-unary-operator">'+ij(this.op)+"</span>"+s:s+'<span class="math-operator math-unary-operator math-righthand-unary-operator">'+ij(this.op)+"</span>"}if(2===a.length){var u=a[0].toHTML(e),c=a[1].toHTML(e);return i[0]&&(u='<span class="math-parenthesis math-round-parenthesis">(</span>'+u+'<span class="math-parenthesis math-round-parenthesis">)</span>'),i[1]&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>'),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?u+'<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'+c:u+'<span class="math-operator math-binary-operator math-explicit-binary-operator">'+ij(this.op)+"</span>"+c}var l=a.map((function(t,n){return t=t.toHTML(e),i[n]&&(t='<span class="math-parenthesis math-round-parenthesis">(</span>'+t+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t}));return a.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())?this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?l.join('<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'):l.join('<span class="math-operator math-binary-operator math-explicit-binary-operator">'+ij(this.op)+"</span>"):'<span class="math-function">'+ij(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+l.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}_toTex(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=e&&e.implicit?e.implicit:"hide",a=this.args,i=r(this,t,n,a,!0),o=LJ[this.fn];if(o="undefined"===typeof o?this.op:o,1===a.length){var s=DJ(this,t),u=a[0].toTex(e);return i[0]&&(u="\\left(".concat(u,"\\right)")),"right"===s?o+u:u+o}if(2===a.length){var c=a[0],l=c.toTex(e);i[0]&&(l="\\left(".concat(l,"\\right)"));var p,h=a[1].toTex(e);switch(i[1]&&(h="\\left(".concat(h,"\\right)")),p="keep"===t?c.getIdentifier():c.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return o+"{"+l+"}{"+h+"}";case"OperatorNode:pow":switch(l="{"+l+"}",h="{"+h+"}",p){case"ConditionalNode":case"OperatorNode:divide":l="\\left(".concat(l,"\\right)")}break;case"OperatorNode:multiply":if(this.implicit&&"hide"===n)return l+"~"+h}return l+o+h}if(a.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var d=a.map((function(t,n){return t=t.toTex(e),i[n]&&(t="\\left(".concat(t,"\\right)")),t}));return"OperatorNode:multiply"===this.getIdentifier()&&this.implicit&&"hide"===n?d.join("~"):d.join(o)}return"\\mathrm{"+this.fn+"}\\left("+a.map((function(t){return t.toTex(e)})).join(",")+"\\right)"}getIdentifier(){return this.type+":"+this.fn}}return SY(a,"name",QJ),a}),{isClass:!0,isNode:!0}),e0="ParenthesisNode",t0=ZU(e0,["Node"],(e=>{var{Node:t}=e;class n extends t{constructor(e){if(super(),!OU(e))throw new TypeError('Node expected for parameter "content"');this.content=e}get type(){return e0}get isParenthesisNode(){return!0}_compile(e,t){return this.content._compile(e,t)}getContent(){return this.content.getContent()}forEach(e){e(this.content,"content",this)}map(e){var t=e(this.content,"content",this);return new n(t)}clone(){return new n(this.content)}_toString(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?"("+this.content.toString(e)+")":this.content.toString(e)}toJSON(){return{mathjs:e0,content:this.content}}static fromJSON(e){return new n(e.content)}_toHTML(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?'<span class="math-parenthesis math-round-parenthesis">(</span>'+this.content.toHTML(e)+'<span class="math-parenthesis math-round-parenthesis">)</span>':this.content.toHTML(e)}_toTex(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?"\\left(".concat(this.content.toTex(e),"\\right)"):this.content.toTex(e)}}return SY(n,"name",e0),n}),{isClass:!0,isNode:!0}),n0="RangeNode",r0=ZU(n0,["Node"],(e=>{var{Node:t}=e;function n(e,t,n){var r=TJ(e,t,n),a={},i=TJ(e.start,t,n);if(a.start=null!==i&&i<=r||"all"===t,e.step){var o=TJ(e.step,t,n);a.step=null!==o&&o<=r||"all"===t}var s=TJ(e.end,t,n);return a.end=null!==s&&s<=r||"all"===t,a}class r extends t{constructor(e,t,n){if(super(),!OU(e))throw new TypeError("Node expected");if(!OU(t))throw new TypeError("Node expected");if(n&&!OU(n))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=e,this.end=t,this.step=n||null}get type(){return n0}get isRangeNode(){return!0}needsEnd(){return this.filter((function(e){return UU(e)&&"end"===e.name})).length>0}_compile(e,t){var n=e.range,r=this.start._compile(e,t),a=this.end._compile(e,t);if(this.step){var i=this.step._compile(e,t);return function(e,t,o){return n(r(e,t,o),a(e,t,o),i(e,t,o))}}return function(e,t,i){return n(r(e,t,i),a(e,t,i))}}forEach(e){e(this.start,"start",this),e(this.end,"end",this),this.step&&e(this.step,"step",this)}map(e){return new r(this._ifNode(e(this.start,"start",this)),this._ifNode(e(this.end,"end",this)),this.step&&this._ifNode(e(this.step,"step",this)))}clone(){return new r(this.start,this.end,this.step&&this.step)}_toString(e){var t,r=n(this,e&&e.parenthesis?e.parenthesis:"keep",e&&e.implicit),a=this.start.toString(e);if(r.start&&(a="("+a+")"),t=a,this.step){var i=this.step.toString(e);r.step&&(i="("+i+")"),t+=":"+i}var o=this.end.toString(e);return r.end&&(o="("+o+")"),t+=":"+o}toJSON(){return{mathjs:n0,start:this.start,end:this.end,step:this.step}}static fromJSON(e){return new r(e.start,e.end,e.step)}_toHTML(e){var t,r=n(this,e&&e.parenthesis?e.parenthesis:"keep",e&&e.implicit),a=this.start.toHTML(e);if(r.start&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t=a,this.step){var i=this.step.toHTML(e);r.step&&(i='<span class="math-parenthesis math-round-parenthesis">(</span>'+i+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+='<span class="math-operator math-range-operator">:</span>'+i}var o=this.end.toHTML(e);return r.end&&(o='<span class="math-parenthesis math-round-parenthesis">(</span>'+o+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+='<span class="math-operator math-range-operator">:</span>'+o}_toTex(e){var t=n(this,e&&e.parenthesis?e.parenthesis:"keep",e&&e.implicit),r=this.start.toTex(e);if(t.start&&(r="\\left(".concat(r,"\\right)")),this.step){var a=this.step.toTex(e);t.step&&(a="\\left(".concat(a,"\\right)")),r+=":"+a}var i=this.end.toTex(e);return t.end&&(i="\\left(".concat(i,"\\right)")),r+=":"+i}}return SY(r,"name",n0),r}),{isClass:!0,isNode:!0}),a0="RelationalNode",i0=ZU(a0,["Node"],(e=>{var{Node:t}=e,n={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="};class r extends t{constructor(e,t){if(super(),!Array.isArray(e))throw new TypeError("Parameter conditionals must be an array");if(!Array.isArray(t))throw new TypeError("Parameter params must be an array");if(e.length!==t.length-1)throw new TypeError("Parameter params must contain exactly one more element than parameter conditionals");this.conditionals=e,this.params=t}get type(){return a0}get isRelationalNode(){return!0}_compile(e,t){var n=this,r=this.params.map((n=>n._compile(e,t)));return function(t,a,i){for(var o,s=r[0](t,a,i),u=0;u<n.conditionals.length;u++){if(o=s,s=r[u+1](t,a,i),!WP(e,n.conditionals[u])(o,s))return!1}return!0}}forEach(e){this.params.forEach(((t,n)=>e(t,"params["+n+"]",this)),this)}map(e){return new r(this.conditionals.slice(),this.params.map(((t,n)=>this._ifNode(e(t,"params["+n+"]",this))),this))}clone(){return new r(this.conditionals,this.params)}_toString(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",r=TJ(this,t,e&&e.implicit),a=this.params.map((function(n,a){var i=TJ(n,t,e&&e.implicit);return"all"===t||null!==i&&i<=r?"("+n.toString(e)+")":n.toString(e)})),i=a[0],o=0;o<this.conditionals.length;o++)i+=" "+n[this.conditionals[o]],i+=" "+a[o+1];return i}toJSON(){return{mathjs:a0,conditionals:this.conditionals,params:this.params}}static fromJSON(e){return new r(e.conditionals,e.params)}_toHTML(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",r=TJ(this,t,e&&e.implicit),a=this.params.map((function(n,a){var i=TJ(n,t,e&&e.implicit);return"all"===t||null!==i&&i<=r?'<span class="math-parenthesis math-round-parenthesis">(</span>'+n.toHTML(e)+'<span class="math-parenthesis math-round-parenthesis">)</span>':n.toHTML(e)})),i=a[0],o=0;o<this.conditionals.length;o++)i+='<span class="math-operator math-binary-operator math-explicit-binary-operator">'+ij(n[this.conditionals[o]])+"</span>"+a[o+1];return i}_toTex(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",n=TJ(this,t,e&&e.implicit),r=this.params.map((function(r,a){var i=TJ(r,t,e&&e.implicit);return"all"===t||null!==i&&i<=n?"\\left("+r.toTex(e)+"\right)":r.toTex(e)})),a=r[0],i=0;i<this.conditionals.length;i++)a+=LJ[this.conditionals[i]]+r[i+1];return a}}return SY(r,"name",a0),r}),{isClass:!0,isNode:!0}),o0=ZU("SymbolNode",["math","?Unit","Node"],(e=>{var{math:t,Unit:n,Node:r}=e;function a(e){return!!n&&n.isValuelessUnit(e)}class i extends r{constructor(e){if(super(),"string"!==typeof e)throw new TypeError('String expected for parameter "name"');this.name=e}get type(){return"SymbolNode"}get isSymbolNode(){return!0}_compile(e,t){var r=this.name;if(!0===t[r])return function(e,t,n){return WP(t,r)};if(r in e)return function(t,n,a){return t.has(r)?t.get(r):WP(e,r)};var o=a(r);return function(e,t,a){return e.has(r)?e.get(r):o?new n(null,r):i.onUndefinedSymbol(r)}}forEach(e){}map(e){return this.clone()}static onUndefinedSymbol(e){throw new Error("Undefined symbol "+e)}clone(){return new i(this.name)}_toString(e){return this.name}_toHTML(e){var t=ij(this.name);return"true"===t||"false"===t?'<span class="math-symbol math-boolean">'+t+"</span>":"i"===t?'<span class="math-symbol math-imaginary-symbol">'+t+"</span>":"Infinity"===t?'<span class="math-symbol math-infinity-symbol">'+t+"</span>":"NaN"===t?'<span class="math-symbol math-nan-symbol">'+t+"</span>":"null"===t?'<span class="math-symbol math-null-symbol">'+t+"</span>":"undefined"===t?'<span class="math-symbol math-undefined-symbol">'+t+"</span>":'<span class="math-symbol">'+t+"</span>"}toJSON(){return{mathjs:"SymbolNode",name:this.name}}static fromJSON(e){return new i(e.name)}_toTex(e){var n=!1;"undefined"===typeof t[this.name]&&a(this.name)&&(n=!0);var r=VJ(this.name,n);return"\\"===r[0]?r:" "+r}}return i}),{isClass:!0,isNode:!0}),s0="FunctionNode",u0=ZU(s0,["math","Node","SymbolNode"],(e=>{var t,{math:n,Node:r,SymbolNode:a}=e,i=e=>nj(e,{truncate:78});function o(e,t,n){for(var r,a="",i=/\$(?:\{([a-z_][a-z_0-9]*)(?:\[([0-9]+)\])?\}|\$)/gi,o=0;null!==(r=i.exec(e));)if(a+=e.substring(o,r.index),o=r.index,"$$"===r[0])a+="$",o++;else{o+=r[0].length;var s=t[r[1]];if(!s)throw new ReferenceError("Template: Property "+r[1]+" does not exist.");if(void 0===r[2])switch(typeof s){case"string":a+=s;break;case"object":if(OU(s))a+=s.toTex(n);else{if(!Array.isArray(s))throw new TypeError("Template: "+r[1]+" has to be a Node, String or array of Nodes");a+=s.map((function(e,t){if(OU(e))return e.toTex(n);throw new TypeError("Template: "+r[1]+"["+t+"] is not a Node.")})).join(",")}break;default:throw new TypeError("Template: "+r[1]+" has to be a Node, String or array of Nodes")}else{if(!OU(s[r[2]]&&s[r[2]]))throw new TypeError("Template: "+r[1]+"["+r[2]+"] is not a Node.");a+=s[r[2]].toTex(n)}}return a+=e.slice(o)}class s extends r{constructor(e,t){if(super(),"string"===typeof e&&(e=new a(e)),!OU(e))throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(t)||!t.every(OU))throw new TypeError('Array containing Nodes expected for parameter "args"');this.fn=e,this.args=t||[]}get name(){return this.fn.name||""}get type(){return s0}get isFunctionNode(){return!0}_compile(e,t){var n=this.args.map((n=>n._compile(e,t)));if(!UU(this.fn)){if(kU(this.fn)&&MU(this.fn.index)&&this.fn.index.isObjectProperty()){var r=this.fn.object._compile(e,t),a=this.fn.index.getObjectProperty(),o=this.args;return function(t,i,s){var u=r(t,i,s),c=function(e,t){if(!jP(e,t))throw new Error('No access to method "'+t+'"');return e[t]}(u,a);if(null!==c&&void 0!==c&&c.rawArgs)return c(o,e,ZJ(t,i));var l=n.map((e=>e(t,i,s)));return c.apply(u,l)}}var u=this.fn.toString(),c=this.fn._compile(e,t),l=this.args;return function(t,r,a){var o=c(t,r,a);if("function"!==typeof o)throw new TypeError("Expression '".concat(u,"' did not evaluate to a function; value is:")+"\n  ".concat(i(o)));if(o.rawArgs)return o(l,e,ZJ(t,r));var s=n.map((e=>e(t,r,a)));return o.apply(o,s)}}var p=this.fn.name;if(t[p]){var h=this.args;return function(t,r,a){var o=WP(r,p);if("function"!==typeof o)throw new TypeError("Argument '".concat(p,"' was not a function; received: ").concat(i(o)));if(o.rawArgs)return o(h,e,ZJ(t,r));var s=n.map((e=>e(t,r,a)));return o.apply(o,s)}}var d=p in e?WP(e,p):void 0,f="function"===typeof d&&!0===d.rawArgs,m=t=>{var n;if(t.has(p))n=t.get(p);else{if(!(p in e))return s.onUndefinedFunction(p);n=WP(e,p)}if("function"===typeof n)return n;throw new TypeError("'".concat(p,"' is not a function; its value is:\n  ").concat(i(n)))};if(f){var g=this.args;return function(t,r,a){var i=m(t);return!0===i.rawArgs?i(g,e,ZJ(t,r)):i(...n.map((e=>e(t,r,a))))}}switch(n.length){case 0:return function(e,t,n){return m(e)()};case 1:return function(e,t,r){return m(e)((0,n[0])(e,t,r))};case 2:return function(e,t,r){var a=m(e),i=n[0],o=n[1];return a(i(e,t,r),o(e,t,r))};default:return function(e,t,r){return m(e)(...n.map((n=>n(e,t,r))))}}}forEach(e){e(this.fn,"fn",this);for(var t=0;t<this.args.length;t++)e(this.args[t],"args["+t+"]",this)}map(e){for(var t=this._ifNode(e(this.fn,"fn",this)),n=[],r=0;r<this.args.length;r++)n[r]=this._ifNode(e(this.args[r],"args["+r+"]",this));return new s(t,n)}clone(){return new s(this.fn,this.args.slice(0))}toString(e){var t,n=this.fn.toString(e);return e&&"object"===typeof e.handler&&$U(e.handler,n)&&(t=e.handler[n](this,e)),"undefined"!==typeof t?t:super.toString(e)}_toString(e){var t=this.args.map((function(t){return t.toString(e)}));return(FU(this.fn)?"("+this.fn.toString(e)+")":this.fn.toString(e))+"("+t.join(", ")+")"}toJSON(){return{mathjs:s0,fn:this.fn,args:this.args}}_toHTML(e){var t=this.args.map((function(t){return t.toHTML(e)}));return'<span class="math-function">'+ij(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}toTex(e){var t;return e&&"object"===typeof e.handler&&$U(e.handler,this.name)&&(t=e.handler[this.name](this,e)),"undefined"!==typeof t?t:super.toTex(e)}_toTex(e){var t,r,a=this.args.map((function(t){return t.toTex(e)}));switch(PJ[this.name]&&(t=PJ[this.name]),!n[this.name]||"function"!==typeof n[this.name].toTex&&"object"!==typeof n[this.name].toTex&&"string"!==typeof n[this.name].toTex||(t=n[this.name].toTex),typeof t){case"function":r=t(this,e);break;case"string":r=o(t,this,e);break;case"object":switch(typeof t[a.length]){case"function":r=t[a.length](this,e);break;case"string":r=o(t[a.length],this,e)}}return"undefined"!==typeof r?r:o("\\mathrm{${name}}\\left(${args}\\right)",this,e)}getIdentifier(){return this.type+":"+this.name}}return t=s,SY(s,"name",s0),SY(s,"onUndefinedFunction",(function(e){throw new Error("Undefined function "+e)})),SY(s,"fromJSON",(function(e){return new t(e.fn,e.args)})),s}),{isClass:!0,isNode:!0}),c0="parse",l0=ZU(c0,["typed","numeric","config","AccessorNode","ArrayNode","AssignmentNode","BlockNode","ConditionalNode","ConstantNode","FunctionAssignmentNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","RangeNode","RelationalNode","SymbolNode"],(e=>{var{typed:t,numeric:n,config:r,AccessorNode:a,ArrayNode:i,AssignmentNode:o,BlockNode:s,ConditionalNode:u,ConstantNode:c,FunctionAssignmentNode:l,FunctionNode:p,IndexNode:h,ObjectNode:d,OperatorNode:f,ParenthesisNode:m,RangeNode:g,RelationalNode:y,SymbolNode:v}=e,b=t(c0,{string:function(e){return z(e,{})},"Array | Matrix":function(e){return x(e,{})},"string, Object":function(e,t){return z(e,void 0!==t.nodes?t.nodes:{})},"Array | Matrix, Object":x});function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=void 0!==t.nodes?t.nodes:{};return Hj(e,(function(e){if("string"!==typeof e)throw new TypeError("String expected");return z(e,n)}))}var w={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},N={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,"'":!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},S={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},k={true:!0,false:!1,null:null,undefined:void 0},E=["NaN","Infinity"],C={'"':'"',"'":"'","\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function T(e,t){return e.expression.substr(e.index,t)}function D(e){return T(e,1)}function I(e){e.index++}function A(e){return e.expression.charAt(e.index-1)}function F(e){return e.expression.charAt(e.index+1)}function _(e){for(e.tokenType=w.NULL,e.token="",e.comment="";;){if("#"===D(e))for(;"\n"!==D(e)&&""!==D(e);)e.comment+=D(e),I(e);if(!b.isWhitespace(D(e),e.nestingLevel))break;I(e)}if(""!==D(e)){if("\n"===D(e)&&!e.nestingLevel)return e.tokenType=w.DELIMITER,e.token=D(e),void I(e);var t=D(e),n=T(e,2),r=T(e,3);if(3===r.length&&N[r])return e.tokenType=w.DELIMITER,e.token=r,I(e),I(e),void I(e);if(2===n.length&&N[n])return e.tokenType=w.DELIMITER,e.token=n,I(e),void I(e);if(N[t])return e.tokenType=w.DELIMITER,e.token=t,void I(e);if(b.isDigitDot(t)){e.tokenType=w.NUMBER;var a=T(e,2);if("0b"===a||"0o"===a||"0x"===a){for(e.token+=D(e),I(e),e.token+=D(e),I(e);b.isHexDigit(D(e));)e.token+=D(e),I(e);if("."===D(e))for(e.token+=".",I(e);b.isHexDigit(D(e));)e.token+=D(e),I(e);else if("i"===D(e))for(e.token+="i",I(e);b.isDigit(D(e));)e.token+=D(e),I(e);return}if("."===D(e)){if(e.token+=D(e),I(e),!b.isDigit(D(e)))return void(e.tokenType=w.DELIMITER)}else{for(;b.isDigit(D(e));)e.token+=D(e),I(e);b.isDecimalMark(D(e),F(e))&&(e.token+=D(e),I(e))}for(;b.isDigit(D(e));)e.token+=D(e),I(e);if("E"===D(e)||"e"===D(e))if(b.isDigit(F(e))||"-"===F(e)||"+"===F(e)){if(e.token+=D(e),I(e),"+"!==D(e)&&"-"!==D(e)||(e.token+=D(e),I(e)),!b.isDigit(D(e)))throw ne(e,'Digit expected, got "'+D(e)+'"');for(;b.isDigit(D(e));)e.token+=D(e),I(e);if(b.isDecimalMark(D(e),F(e)))throw ne(e,'Digit expected, got "'+D(e)+'"')}else if("."===F(e))throw I(e),ne(e,'Digit expected, got "'+D(e)+'"')}else{if(!b.isAlpha(D(e),A(e),F(e))){for(e.tokenType=w.UNKNOWN;""!==D(e);)e.token+=D(e),I(e);throw ne(e,'Syntax error in part "'+e.token+'"')}for(;b.isAlpha(D(e),A(e),F(e))||b.isDigit(D(e));)e.token+=D(e),I(e);$U(S,e.token)?e.tokenType=w.DELIMITER:e.tokenType=w.SYMBOL}}else e.tokenType=w.DELIMITER}function M(e){do{_(e)}while("\n"===e.token)}function O(e){e.nestingLevel++}function R(e){e.nestingLevel--}function z(e,t){var n={extraNodes:{},expression:"",comment:"",index:0,token:"",tokenType:w.NULL,nestingLevel:0,conditionalLevel:null};zP(n,{expression:e,extraNodes:t}),_(n);var r=function(e){var t,n,r=[];""!==e.token&&"\n"!==e.token&&";"!==e.token&&(t=B(e),e.comment&&(t.comment=e.comment));for(;"\n"===e.token||";"===e.token;)0===r.length&&t&&(n=";"!==e.token,r.push({node:t,visible:n})),_(e),"\n"!==e.token&&";"!==e.token&&""!==e.token&&(t=B(e),e.comment&&(t.comment=e.comment),n=";"!==e.token,r.push({node:t,visible:n}));return r.length>0?new s(r):(t||(t=new c(void 0),e.comment&&(t.comment=e.comment)),t)}(n);if(""!==n.token)throw n.tokenType===w.DELIMITER?re(n,"Unexpected operator "+n.token):ne(n,'Unexpected part "'+n.token+'"');return r}function B(e){var t,n,r,a,i=function(e){var t=function(e){var t=L(e);for(;"or"===e.token;)M(e),t=new f("or","or",[t,L(e)]);return t}(e);for(;"?"===e.token;){var n=e.conditionalLevel;e.conditionalLevel=e.nestingLevel,M(e);var r=t,a=B(e);if(":"!==e.token)throw ne(e,"False part of conditional expression expected");e.conditionalLevel=null,M(e);var i=B(e);t=new u(r,a,i),e.conditionalLevel=n}return t}(e);if("="===e.token){if(UU(i))return t=i.name,M(e),r=B(e),new o(new v(t),r);if(kU(i))return M(e),r=B(e),new o(i.object,i.index,r);if(_U(i)&&UU(i.fn)&&(a=!0,n=[],t=i.name,i.args.forEach((function(e,t){UU(e)?n[t]=e.name:a=!1})),a))return M(e),r=B(e),new l(t,n,r);throw ne(e,"Invalid left hand side of assignment operator =")}return i}function L(e){for(var t=P(e);"xor"===e.token;)M(e),t=new f("xor","xor",[t,P(e)]);return t}function P(e){for(var t=U(e);"and"===e.token;)M(e),t=new f("and","and",[t,U(e)]);return t}function U(e){for(var t=W(e);"|"===e.token;)M(e),t=new f("|","bitOr",[t,W(e)]);return t}function W(e){for(var t=V(e);"^|"===e.token;)M(e),t=new f("^|","bitXor",[t,V(e)]);return t}function V(e){for(var t=q(e);"&"===e.token;)M(e),t=new f("&","bitAnd",[t,q(e)]);return t}function q(e){for(var t=[j(e)],n=[],r={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};$U(r,e.token);){var a={name:e.token,fn:r[e.token]};n.push(a),M(e),t.push(j(e))}return 1===t.length?t[0]:2===t.length?new f(n[0].name,n[0].fn,t):new y(n.map((e=>e.fn)),t)}function j(e){var t,n,r,a;t=G(e);for(var i={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};$U(i,e.token);)r=i[n=e.token],M(e),a=[t,G(e)],t=new f(n,r,a);return t}function G(e){var t,n,r,a;t=H(e);for(var i={to:"to",in:"to"};$U(i,e.token);)r=i[n=e.token],M(e),"in"===n&&""===e.token?t=new f("*","multiply",[t,new v("in")],!0):(a=[t,H(e)],t=new f(n,r,a));return t}function H(e){var t,n=[];if(t=":"===e.token?new c(1):K(e),":"===e.token&&e.conditionalLevel!==e.nestingLevel){for(n.push(t);":"===e.token&&n.length<3;)M(e),")"===e.token||"]"===e.token||","===e.token||""===e.token?n.push(new v("end")):n.push(K(e));t=3===n.length?new g(n[0],n[2],n[1]):new g(n[0],n[1])}return t}function K(e){var t,n,r,a;t=X(e);for(var i={"+":"add","-":"subtract"};$U(i,e.token);){r=i[n=e.token],M(e);var o=X(e);a=o.isPercentage?[t,new f("*","multiply",[t,o])]:[t,o],t=new f(n,r,a)}return t}function X(e){var t,n,r,a;n=t=Y(e);for(var i={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};$U(i,e.token);)if(a=i[r=e.token],M(e),"%"===r&&e.tokenType===w.DELIMITER&&"("!==e.token)if(""!==e.token&&i[e.token]){var o=new f("/","divide",[t,new c(100)],!1,!0);a=i[r=e.token],M(e),n=Y(e),t=new f(r,a,[o,n])}else t=new f("/","divide",[t,new c(100)],!1,!0);else n=Y(e),t=new f(r,a,[t,n]);return t}function Y(e){var t,n;for(n=t=$(e);e.tokenType===w.SYMBOL||"in"===e.token&&IU(t)||"in"===e.token&&zU(t)&&"unaryMinus"===t.fn&&IU(t.args[0])||!(e.tokenType!==w.NUMBER||IU(n)||zU(n)&&"!"!==n.op)||"("===e.token;)n=$(e),t=new f("*","multiply",[t,n],!0);return t}function $(e){for(var t=Z(e),n=t,r=[];"/"===e.token&&AU(n);){if(r.push(zP({},e)),M(e),e.tokenType!==w.NUMBER){zP(e,r.pop());break}if(r.push(zP({},e)),M(e),e.tokenType!==w.SYMBOL&&"("!==e.token&&"in"!==e.token){r.pop(),zP(e,r.pop());break}zP(e,r.pop()),r.pop(),n=Z(e),t=new f("/","divide",[t,n])}return t}function Z(e){var t,a,o,s={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"};return $U(s,e.token)?(o=s[e.token],t=e.token,M(e),a=[Z(e)],new f(t,o,a)):function(e){var t,a,o,s;t=function(e){var t,a,o;t=function(e){var t=[];if(e.tokenType===w.SYMBOL&&$U(e.extraNodes,e.token)){var a=e.extraNodes[e.token];if(_(e),"("===e.token){if(t=[],O(e),_(e),")"!==e.token)for(t.push(B(e));","===e.token;)_(e),t.push(B(e));if(")"!==e.token)throw ne(e,"Parenthesis ) expected");R(e),_(e)}return new a(t)}return function(e){var t;if(e.tokenType===w.SYMBOL||e.tokenType===w.DELIMITER&&e.token in S)return t=e.token,_(e),Q(e,$U(k,t)?new c(k[t]):E.includes(t)?new c(n(t,"number")):new v(t));return function(e){var t;if('"'===e.token||"'"===e.token)return t=J(e,e.token),Q(e,new c(t));return function(e){var t,a,o,s;if("["===e.token){if(O(e),_(e),"]"!==e.token){var u=ee(e);if(";"===e.token){for(o=1,a=[u];";"===e.token;)_(e),"]"!==e.token&&(a[o]=ee(e),o++);if("]"!==e.token)throw ne(e,"End of matrix ] expected");R(e),_(e),s=a[0].items.length;for(var l=1;l<o;l++)if(a[l].items.length!==s)throw re(e,"Column dimensions mismatch ("+a[l].items.length+" !== "+s+")");t=new i(a)}else{if("]"!==e.token)throw ne(e,"End of matrix ] expected");R(e),_(e),t=u}}else R(e),_(e),t=new i([]);return Q(e,t)}return function(e){if("{"===e.token){var t;O(e);var a={};do{if(_(e),"}"!==e.token){if('"'===e.token||"'"===e.token)t=J(e,e.token);else{if(!(e.tokenType===w.SYMBOL||e.tokenType===w.DELIMITER&&e.token in S))throw ne(e,"Symbol or string expected as object key");t=e.token,_(e)}if(":"!==e.token)throw ne(e,"Colon : expected after object key");_(e),a[t]=B(e)}}while(","===e.token);if("}"!==e.token)throw ne(e,"Comma , or bracket } expected after object value");R(e),_(e);var i=new d(a);return i=Q(e,i)}return function(e){var t;if(e.tokenType===w.NUMBER){t=e.token,_(e);var a=uW(t,r),i=n(t,a);return new c(i)}return function(e){var t;if("("===e.token){if(O(e),_(e),t=B(e),")"!==e.token)throw ne(e,"Parenthesis ) expected");return R(e),_(e),t=Q(e,t=new m(t))}return function(e){throw""===e.token?ne(e,"Unexpected end of expression"):ne(e,"Value expected")}(e)}(e)}(e)}(e)}(e)}(e)}(e)}(e);var s={"!":"factorial","'":"ctranspose"};for(;$U(s,e.token);)o=s[a=e.token],_(e),t=Q(e,t=new f(a,o,[t]));return t}(e),("^"===e.token||".^"===e.token)&&(o="^"===(a=e.token)?"pow":"dotPow",M(e),s=[t,Z(e)],t=new f(a,o,s));return t}(e)}function Q(e,t,n){for(var r;("("===e.token||"["===e.token||"."===e.token)&&(!n||n.includes(e.token));)if(r=[],"("===e.token){if(!UU(t)&&!kU(t))return t;if(O(e),_(e),")"!==e.token)for(r.push(B(e));","===e.token;)_(e),r.push(B(e));if(")"!==e.token)throw ne(e,"Parenthesis ) expected");R(e),_(e),t=new p(t,r)}else if("["===e.token){if(O(e),_(e),"]"!==e.token)for(r.push(B(e));","===e.token;)_(e),r.push(B(e));if("]"!==e.token)throw ne(e,"Parenthesis ] expected");R(e),_(e),t=new a(t,new h(r))}else{if(_(e),!(e.tokenType===w.SYMBOL||e.tokenType===w.DELIMITER&&e.token in S))throw ne(e,"Property name expected after dot");r.push(new c(e.token)),_(e);t=new a(t,new h(r,!0))}return t}function J(e,t){for(var n="";""!==D(e)&&D(e)!==t;)if("\\"===D(e)){I(e);var r=D(e),a=C[r];if(void 0!==a)n+=a,e.index+=1;else{if("u"!==r)throw ne(e,"Bad escape character \\".concat(r));var i=e.expression.slice(e.index+1,e.index+5);if(!/^[0-9A-Fa-f]{4}$/.test(i))throw ne(e,"Invalid unicode character \\u".concat(i));n+=String.fromCharCode(parseInt(i,16)),e.index+=5}}else n+=D(e),I(e);if(_(e),e.token!==t)throw ne(e,"End of string ".concat(t," expected"));return _(e),n}function ee(e){for(var t=[B(e)],n=1;","===e.token;)_(e),"]"!==e.token&&";"!==e.token&&(t[n]=B(e),n++);return new i(t)}function te(e){return e.index-e.token.length+1}function ne(e,t){var n=te(e),r=new SyntaxError(t+" (char "+n+")");return r.char=n,r}function re(e,t){var n=te(e),r=new SyntaxError(t+" (char "+n+")");return r.char=n,r}return b.isAlpha=function(e,t,n){return b.isValidLatinOrGreek(e)||b.isValidMathSymbol(e,n)||b.isValidMathSymbol(t,e)},b.isValidLatinOrGreek=function(e){return/^[a-zA-Z_$\u00C0-\u02AF\u0370-\u03FF\u2100-\u214F]$/.test(e)},b.isValidMathSymbol=function(e,t){return/^[\uD835]$/.test(e)&&/^[\uDC00-\uDFFF]$/.test(t)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(t)},b.isWhitespace=function(e,t){return" "===e||"\t"===e||"\n"===e&&t>0},b.isDecimalMark=function(e,t){return"."===e&&"/"!==t&&"*"!==t&&"^"!==t},b.isDigitDot=function(e){return e>="0"&&e<="9"||"."===e},b.isDigit=function(e){return e>="0"&&e<="9"},b.isHexDigit=function(e){return e>="0"&&e<="9"||e>="a"&&e<="f"||e>="A"&&e<="F"},t.addConversion({from:"string",to:"Node",convert:b}),b})),p0="compile",h0=ZU(p0,["typed","parse"],(e=>{var{typed:t,parse:n}=e;return t(p0,{string:function(e){return n(e).compile()},"Array | Matrix":function(e){return Hj(e,(function(e){return n(e).compile()}))}})})),d0="evaluate",f0=ZU(d0,["typed","parse"],(e=>{var{typed:t,parse:n}=e;return t(d0,{string:function(e){var t=$P();return n(e).compile().evaluate(t)},"string, Map | Object":function(e,t){return n(e).compile().evaluate(t)},"Array | Matrix":function(e){var t=$P();return Hj(e,(function(e){return n(e).compile().evaluate(t)}))},"Array | Matrix, Map | Object":function(e,t){return Hj(e,(function(e){return n(e).compile().evaluate(t)}))}})})),m0=ZU("Parser",["evaluate","parse"],(e=>{var{evaluate:t,parse:n}=e;function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");Object.defineProperty(this,"scope",{value:$P(),writable:!1})}return r.prototype.type="Parser",r.prototype.isParser=!0,r.prototype.evaluate=function(e){return t(e,this.scope)},r.prototype.get=function(e){if(this.scope.has(e))return this.scope.get(e)},r.prototype.getAll=function(){return function(e){if(e instanceof KP)return e.wrappedObject;var t={};for(var n of e.keys())VP(t,n,e.get(n));return t}(this.scope)},r.prototype.getAllAsMap=function(){return this.scope},r.prototype.set=function(e,t){if(!function(e){if(0===e.length)return!1;for(var t=0;t<e.length;t++){var r=e.charAt(t-1),a=e.charAt(t),i=e.charAt(t+1);if(!(n.isAlpha(a,r,i)||t>0&&n.isDigit(a)))return!1}return!0}(e))throw new Error("Invalid variable name: '".concat(e,"'. Variable names must follow the specified rules."));return this.scope.set(e,t),t},r.prototype.remove=function(e){this.scope.delete(e)},r.prototype.clear=function(){this.scope.clear()},r}),{isClass:!0}),g0="parser",y0=ZU(g0,["typed","Parser"],(e=>{var{typed:t,Parser:n}=e;return t(g0,{"":function(){return new n}})})),v0=ZU("lup",["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtractScalar","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],(e=>{var{typed:t,matrix:n,abs:r,addScalar:a,divideScalar:i,multiplyScalar:o,subtractScalar:s,larger:u,equalScalar:c,unaryMinus:l,DenseMatrix:p,SparseMatrix:h,Spa:d}=e;return t("lup",{DenseMatrix:function(e){return f(e)},SparseMatrix:function(e){return m(e)},Array:function(e){var t=f(n(e));return{L:t.L.valueOf(),U:t.U.valueOf(),p:t.p}}});function f(e){var t,n,l,h=e._size[0],d=e._size[1],f=Math.min(h,d),m=qU(e._data),g=[],y=[h,f],v=[],b=[f,d],x=[];for(t=0;t<h;t++)x[t]=t;for(n=0;n<d;n++){if(n>0)for(t=0;t<h;t++){var w=Math.min(t,n),N=0;for(l=0;l<w;l++)N=a(N,o(m[t][l],m[l][n]));m[t][n]=s(m[t][n],N)}var S=n,k=0,E=0;for(t=n;t<h;t++){var C=m[t][n],T=r(C);u(T,k)&&(S=t,k=T,E=C)}if(n!==S&&(x[n]=[x[S],x[S]=x[n]][0],p._swapRows(n,S,m)),n<h)for(t=n+1;t<h;t++){var D=m[t][n];c(D,0)||(m[t][n]=i(m[t][n],E))}}for(n=0;n<d;n++)for(t=0;t<h;t++)0===n&&(t<d&&(v[t]=[]),g[t]=[]),t<n?(t<d&&(v[t][n]=m[t][n]),n<h&&(g[t][n]=0)):t!==n?(t<d&&(v[t][n]=0),n<h&&(g[t][n]=m[t][n])):(t<d&&(v[t][n]=m[t][n]),n<h&&(g[t][n]=1));var I=new p({data:g,size:y}),A=new p({data:v,size:b}),F=[];for(t=0,f=x.length;t<f;t++)F[x[t]]=t;return{L:I,U:A,p:F,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}function m(e){var t,n,a,s=e._size[0],p=e._size[1],f=Math.min(s,p),m=e._values,g=e._index,y=e._ptr,v=[],b=[],x=[],w=[s,f],N=[],S=[],k=[],E=[f,p],C=[],T=[];for(t=0;t<s;t++)C[t]=t,T[t]=t;var D=function(){var e=new d;n<s&&(x.push(v.length),v.push(1),b.push(n)),k.push(N.length);var p=y[n],f=y[n+1];for(a=p;a<f;a++)t=g[a],e.set(C[t],m[a]);n>0&&e.forEach(0,n-1,(function(t,n){h._forEachRow(t,v,b,x,(function(r,a){r>t&&e.accumulate(r,l(o(a,n)))}))}));var D=n,I=e.get(n),A=r(I);e.forEach(n+1,s-1,(function(e,t){var n=r(t);u(n,A)&&(D=e,A=n,I=t)})),n!==D&&(h._swapRows(n,D,w[1],v,b,x),h._swapRows(n,D,E[1],N,S,k),e.swap(n,D),function(e,t){var n=T[e],r=T[t];C[n]=t,C[r]=e,T[e]=r,T[t]=n}(n,D)),e.forEach(0,s-1,(function(e,t){e<=n?(N.push(t),S.push(e)):(t=i(t,I),c(t,0)||(v.push(t),b.push(e)))}))};for(n=0;n<p;n++)D();return k.push(N.length),x.push(v.length),{L:new h({values:v,index:b,ptr:x,size:w}),U:new h({values:N,index:S,ptr:k,size:E}),p:C,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}})),b0=ZU("qr",["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtractScalar","complex"],(e=>{var{typed:t,matrix:n,zeros:r,identity:a,isZero:i,equal:o,sign:s,sqrt:u,conj:c,unaryMinus:l,addScalar:p,divideScalar:h,multiplyScalar:d,subtractScalar:f,complex:m}=e;return zP(t("qr",{DenseMatrix:function(e){return y(e)},SparseMatrix:function(e){return function(){throw new Error("qr not implemented for sparse matrices yet")}()},Array:function(e){var t=y(n(e));return{Q:t.Q.valueOf(),R:t.R.valueOf()}}}),{_denseQRimpl:g});function g(e){var t,n,m,g=e._size[0],y=e._size[1],v=a([g],"dense"),b=v._data,x=e.clone(),w=x._data,N=r([g],"");for(m=0;m<Math.min(y,g);++m){var S=w[m][m],k=l(o(S,0)?1:s(S)),E=c(k),C=0;for(t=m;t<g;t++)C=p(C,d(w[t][m],c(w[t][m])));var T=d(k,u(C));if(!i(T)){var D=f(S,T);for(N[m]=1,t=m+1;t<g;t++)N[t]=h(w[t][m],D);var I=l(c(h(D,T))),A=void 0;for(n=m;n<y;n++){for(A=0,t=m;t<g;t++)A=p(A,d(c(N[t]),w[t][n]));for(A=d(A,I),t=m;t<g;t++)w[t][n]=d(f(w[t][n],d(N[t],A)),E)}for(t=0;t<g;t++){for(A=0,n=m;n<g;n++)A=p(A,d(b[t][n],N[n]));for(A=d(A,I),n=m;n<g;++n)b[t][n]=h(f(b[t][n],d(A,c(N[n]))),E)}}}return{Q:v,R:x,toString:function(){return"Q: "+this.Q.toString()+"\nR: "+this.R.toString()}}}function y(e){var t=g(e),n=t.R._data;if(e._data.length>0)for(var r="Complex"===n[0][0].type?m(0):0,a=0;a<n.length;++a)for(var i=0;i<a&&i<(n[0]||[]).length;++i)n[a][i]=r;return t}}));function x0(e,t,n,r,a,i,o){var s=0;for(n[o]=e;s>=0;){var u=n[o+s],c=n[r+u];-1===c?(s--,i[t++]=u):(n[r+u]=n[a+c],n[o+ ++s]=c)}return t}function w0(e){return-e-2}var N0=ZU("csAmd",["add","multiply","transpose"],(e=>{var{add:t,multiply:n,transpose:r}=e;return function(e,o){if(!o||e<=0||e>3)return null;var s=o._size,u=s[0],c=s[1],l=0,p=Math.max(16,10*Math.sqrt(c)),h=function(e,a,i,o,s){var u=r(a);if(1===e&&o===i)return t(a,u);if(2===e){for(var c=u._index,l=u._ptr,p=0,h=0;h<i;h++){var d=l[h];if(l[h]=p,!(l[h+1]-d>s))for(var f=l[h+1];d<f;d++)c[p++]=c[d]}return l[i]=p,a=r(u),n(u,a)}return n(u,a)}(e,o,u,c,p=Math.min(c-2,p));!function(e,t,n){for(var r=e._values,a=e._index,i=e._ptr,o=e._size[1],s=0,u=0;u<o;u++){var c=i[u];for(i[u]=s;c<i[u+1];c++)t(a[c],u,r?r[c]:1,n)&&(a[s]=a[c],r&&(r[s]=r[c]),s++)}i[o]=s,a.splice(s,a.length-s),r&&r.splice(s,r.length-s)}(h,i,null);for(var d,f,m,g,y,v,b,x,w,N,S,k,E,C,T,D,I=h._index,A=h._ptr,F=A[c],_=[],M=[],O=c+1,R=2*(c+1),z=3*(c+1),B=4*(c+1),L=5*(c+1),P=6*(c+1),U=7*(c+1),W=_,V=function(e,t,n,r,i,o,s,u,c,l,p,h){for(var d=0;d<e;d++)n[r+d]=t[d+1]-t[d];n[r+e]=0;for(var f=0;f<=e;f++)n[i+f]=-1,o[f]=-1,n[s+f]=-1,n[u+f]=-1,n[c+f]=1,n[l+f]=1,n[p+f]=0,n[h+f]=n[r+f];var m=a(0,0,n,l,e);return n[p+e]=-2,t[e]=-1,n[l+e]=0,m}(c,A,M,0,z,W,R,U,O,P,B,L),q=function(e,t,n,r,a,i,o,s,u,c,l){for(var p=0,h=0;h<e;h++){var d=n[r+h];if(0===d)n[a+h]=-2,p++,t[h]=-1,n[i+h]=0;else if(d>o)n[s+h]=0,n[a+h]=-1,p++,t[h]=w0(e),n[s+e]++;else{var f=n[u+d];-1!==f&&(c[f]=h),n[l+h]=n[u+d],n[u+d]=h}}return p}(c,A,M,L,B,P,p,O,z,W,R),j=0;q<c;){for(m=-1;j<c&&-1===(m=M[z+j]);j++);-1!==M[R+m]&&(W[M[R+m]]=-1),M[z+j]=M[R+m];var G=M[B+m],H=M[O+m];q+=H;var K=0;M[O+m]=-H;var X=A[m],Y=0===G?X:F,$=Y;for(g=1;g<=G+1;g++){for(g>G?(v=m,b=X,x=M[0+m]-G):(b=A[v=I[X++]],x=M[0+v]),y=1;y<=x;y++)(w=M[O+(d=I[b++])])<=0||(K+=w,M[O+d]=-w,I[$++]=d,-1!==M[R+d]&&(W[M[R+d]]=W[d]),-1!==W[d]?M[R+W[d]]=M[R+d]:M[z+M[L+d]]=M[R+d]);v!==m&&(A[v]=w0(m),M[P+v]=0)}for(0!==G&&(F=$),M[L+m]=K,A[m]=Y,M[0+m]=$-Y,M[B+m]=-2,V=a(V,l,M,P,c),N=Y;N<$;N++)if(!((S=M[B+(d=I[N])])<=0)){var Z=V-(w=-M[O+d]);for(X=A[d],k=A[d]+S-1;X<=k;X++)M[P+(v=I[X])]>=V?M[P+v]-=w:0!==M[P+v]&&(M[P+v]=M[L+v]+Z)}for(N=Y;N<$;N++){for(E=(k=A[d=I[N]])+M[B+d]-1,C=k,T=0,D=0,X=k;X<=E;X++)if(0!==M[P+(v=I[X])]){var Q=M[P+v]-V;Q>0?(D+=Q,I[C++]=v,T+=v):(A[v]=w0(m),M[P+v]=0)}M[B+d]=C-k+1;var J=C,ee=k+M[0+d];for(X=E+1;X<ee;X++){var te=M[O+(f=I[X])];te<=0||(D+=te,I[C++]=f,T+=f)}0===D?(A[d]=w0(m),K-=w=-M[O+d],H+=w,q+=w,M[O+d]=0,M[B+d]=-1):(M[L+d]=Math.min(M[L+d],D),I[C]=I[J],I[J]=I[k],I[k]=m,M[0+d]=C-k+1,T=(T<0?-T:T)%c,M[R+d]=M[U+T],M[U+T]=d,W[d]=T)}for(M[L+m]=K,V=a(V+(l=Math.max(l,K)),l,M,P,c),N=Y;N<$;N++)if(!(M[O+(d=I[N])]>=0))for(d=M[U+(T=W[d])],M[U+T]=-1;-1!==d&&-1!==M[R+d];d=M[R+d],V++){for(x=M[0+d],S=M[B+d],X=A[d]+1;X<=A[d]+x-1;X++)M[P+I[X]]=V;var ne=d;for(f=M[R+d];-1!==f;){var re=M[0+f]===x&&M[B+f]===S;for(X=A[f]+1;re&&X<=A[f]+x-1;X++)M[P+I[X]]!==V&&(re=0);re?(A[f]=w0(d),M[O+d]+=M[O+f],M[O+f]=0,M[B+f]=-1,f=M[R+f],M[R+ne]=f):(ne=f,f=M[R+f])}}for(X=Y,N=Y;N<$;N++)(w=-M[O+(d=I[N])])<=0||(M[O+d]=w,D=M[L+d]+K-w,-1!==M[z+(D=Math.min(D,c-q-w))]&&(W[M[z+D]]=d),M[R+d]=M[z+D],W[d]=-1,M[z+D]=d,j=Math.min(j,D),M[L+d]=D,I[X++]=d);M[O+m]=H,0===(M[0+m]=X-Y)&&(A[m]=-1,M[P+m]=0),0!==G&&(F=X)}for(d=0;d<c;d++)A[d]=w0(A[d]);for(f=0;f<=c;f++)M[z+f]=-1;for(f=c;f>=0;f--)M[O+f]>0||(M[R+f]=M[z+A[f]],M[z+A[f]]=f);for(v=c;v>=0;v--)M[O+v]<=0||-1!==A[v]&&(M[R+v]=M[z+A[v]],M[z+A[v]]=v);for(m=0,d=0;d<=c;d++)-1===A[d]&&(m=x0(d,m,M,z,R,_,P));return _.splice(_.length-1,1),_};function a(e,t,n,r,a){if(e<2||e+t<0){for(var i=0;i<a;i++)0!==n[r+i]&&(n[r+i]=1);e=2}return e}function i(e,t){return e!==t}}));function S0(e,t,n,r,a,i,o){var s,u,c,l=0;if(e<=t||n[r+t]<=n[a+e])return-1;n[a+e]=n[r+t];var p=n[i+e];if(n[i+e]=t,-1===p)l=1,c=e;else{for(l=2,c=p;c!==n[o+c];c=n[o+c]);for(s=p;s!==c;s=u)u=n[o+s],n[o+s]=c}return{jleaf:l,q:c}}var k0=ZU("csCounts",["transpose"],(e=>{var{transpose:t}=e;return function(e,n,r,a){if(!e||!n||!r)return null;var i,o,s,u,c,l,p,h=e._size,d=h[0],f=h[1],m=4*f+(a?f+d+1:0),g=[],y=f,v=2*f,b=3*f,x=4*f,w=5*f+1;for(s=0;s<m;s++)g[s]=-1;var N=[],S=t(e),k=S._index,E=S._ptr;for(s=0;s<f;s++)for(N[o=r[s]]=-1===g[b+o]?1:0;-1!==o&&-1===g[b+o];o=n[o])g[b+o]=s;if(a){for(s=0;s<f;s++)g[r[s]]=s;for(i=0;i<d;i++){for(s=f,l=E[i],p=E[i+1],c=l;c<p;c++)s=Math.min(s,g[k[c]]);g[w+i]=g[x+s],g[x+s]=i}}for(i=0;i<f;i++)g[0+i]=i;for(s=0;s<f;s++){for(-1!==n[o=r[s]]&&N[n[o]]--,u=a?g[x+s]:o;-1!==u;u=a?g[w+u]:-1)for(c=E[u];c<E[u+1];c++){var C=S0(i=k[c],o,g,b,y,v,0);C.jleaf>=1&&N[o]++,2===C.jleaf&&N[C.q]--}-1!==n[o]&&(g[0+o]=n[o])}for(o=0;o<f;o++)-1!==n[o]&&(N[n[o]]+=N[o]);return N}})),E0=ZU("csSqr",["add","multiply","transpose"],(e=>{var{add:t,multiply:n,transpose:r}=e,a=N0({add:t,multiply:n,transpose:r}),i=k0({transpose:r});return function(e,t,n){var r,o=t._ptr,s=t._size[1],u={};if(u.q=a(e,t),e&&!u.q)return null;if(n){var c=e?function(e,t,n,r){for(var a=e._values,i=e._index,o=e._ptr,s=e._size,u=e._datatype,c=s[0],l=s[1],p=r&&e._values?[]:null,h=[],d=[],f=0,m=0;m<l;m++){d[m]=f;for(var g=n?n[m]:m,y=o[g],v=o[g+1],b=y;b<v;b++){var x=t?t[i[b]]:i[b];h[f]=x,p&&(p[f]=a[b]),f++}}return d[l]=f,e.createSparseMatrix({values:p,index:h,ptr:d,size:[c,l],datatype:u})}(t,null,u.q,0):t;u.parent=function(e,t){if(!e)return null;var n,r,a=e._index,i=e._ptr,o=e._size,s=o[0],u=o[1],c=[],l=[],p=u;if(t)for(n=0;n<s;n++)l[p+n]=-1;for(var h=0;h<u;h++){c[h]=-1,l[0+h]=-1;for(var d=i[h],f=i[h+1],m=d;m<f;m++){var g=a[m];for(n=t?l[p+g]:g;-1!==n&&n<h;n=r)r=l[0+n],l[0+n]=h,-1===r&&(c[n]=h);t&&(l[p+g]=h)}}return c}(c,1);var l=function(e,t){if(!e)return null;var n,r=0,a=[],i=[],o=t,s=2*t;for(n=0;n<t;n++)i[0+n]=-1;for(n=t-1;n>=0;n--)-1!==e[n]&&(i[o+n]=i[0+e[n]],i[0+e[n]]=n);for(n=0;n<t;n++)-1===e[n]&&(r=x0(n,r,i,0,o,a,s));return a}(u.parent,s);if(u.cp=i(c,u.parent,l,1),c&&u.parent&&u.cp&&function(e,t){var n=e._ptr,r=e._index,a=e._size,i=a[0],o=a[1];t.pinv=[],t.leftmost=[];var s,u,c,l,p,h=t.parent,d=t.pinv,f=t.leftmost,m=[],g=0,y=i,v=i+o,b=i+2*o;for(u=0;u<o;u++)m[y+u]=-1,m[v+u]=-1,m[b+u]=0;for(s=0;s<i;s++)f[s]=-1;for(u=o-1;u>=0;u--)for(l=n[u],p=n[u+1],c=l;c<p;c++)f[r[c]]=u;for(s=i-1;s>=0;s--)d[s]=-1,-1!==(u=f[s])&&(0===m[b+u]++&&(m[v+u]=s),m[g+s]=m[y+u],m[y+u]=s);for(t.lnz=0,t.m2=i,u=0;u<o;u++)if(s=m[y+u],t.lnz++,s<0&&(s=t.m2++),d[s]=u,!(--b[u]<=0)){t.lnz+=m[b+u];var x=h[u];-1!==x&&(0===m[b+x]&&(m[v+x]=m[v+u]),m[g+m[v+u]]=m[y+x],m[y+x]=m[g+s],m[b+x]+=m[b+u])}for(s=0;s<i;s++)d[s]<0&&(d[s]=u++);return!0}(c,u))for(u.unz=0,r=0;r<s;r++)u.unz+=u.cp[r]}else u.unz=4*o[s]+s,u.lnz=u.unz;return u}}));function C0(e,t){return e[t]<0}function T0(e,t){e[t]=w0(e[t])}function D0(e){return e<0?w0(e):e}function I0(e,t,n,r,a){var i,o,s,u=t._index,c=t._ptr,l=t._size[1],p=0;for(r[0]=e;p>=0;){e=r[p];var h=a?a[e]:e;C0(c,e)||(T0(c,e),r[l+p]=h<0?0:D0(c[h]));var d=1;for(o=r[l+p],s=h<0?0:D0(c[h+1]);o<s;o++)if(!C0(c,i=u[o])){r[l+p]=o,r[++p]=i,d=0;break}d&&(p--,r[--n]=e)}return n}var A0=ZU("csSpsolve",["divideScalar","multiply","subtract"],(e=>{var{divideScalar:t,multiply:n,subtract:r}=e;return function(e,a,i,o,s,u,c){var l,p,h,d,f=e._values,m=e._index,g=e._ptr,y=e._size[1],v=a._values,b=a._index,x=a._ptr,w=function(e,t,n,r,a){var i,o,s,u=e._ptr,c=e._size,l=t._index,p=t._ptr,h=c[1],d=h;for(o=p[n],s=p[n+1],i=o;i<s;i++){var f=l[i];C0(u,f)||(d=I0(f,e,d,r,a))}for(i=d;i<h;i++)T0(u,r[i]);return d}(e,a,i,o,u);for(l=w;l<y;l++)s[o[l]]=0;for(p=x[i],h=x[i+1],l=p;l<h;l++)s[b[l]]=v[l];for(var N=w;N<y;N++){var S=o[N],k=u?u[S]:S;if(!(k<0))for(p=g[k],h=g[k+1],s[S]=t(s[S],f[c?p:h-1]),l=c?p+1:p,d=c?h:h-1;l<d;l++){var E=m[l];s[E]=r(s[E],n(f[l],s[S]))}}return w}})),F0=ZU("csLu",["abs","divideScalar","multiply","subtract","larger","largerEq","SparseMatrix"],(e=>{var{abs:t,divideScalar:n,multiply:r,subtract:a,larger:i,largerEq:o,SparseMatrix:s}=e,u=A0({divideScalar:n,multiply:r,subtract:a});return function(e,a,c){if(!e)return null;var l,p=e._size[1],h=100,d=100;a&&(l=a.q,h=a.lnz||h,d=a.unz||d);var f,m,g=[],y=[],v=[],b=new s({values:g,index:y,ptr:v,size:[p,p]}),x=[],w=[],N=[],S=new s({values:x,index:w,ptr:N,size:[p,p]}),k=[],E=[],C=[];for(f=0;f<p;f++)E[f]=0,k[f]=-1,v[f+1]=0;h=0,d=0;for(var T=0;T<p;T++){v[T]=h,N[T]=d;var D=l?l[T]:T,I=u(b,e,D,C,E,k,1),A=-1,F=-1;for(m=I;m<p;m++)if(k[f=C[m]]<0){var _=t(E[f]);i(_,F)&&(F=_,A=f)}else w[d]=k[f],x[d++]=E[f];if(-1===A||F<=0)return null;k[D]<0&&o(t(E[D]),r(F,c))&&(A=D);var M=E[A];for(w[d]=T,x[d++]=M,k[A]=T,y[h]=A,g[h++]=1,m=I;m<p;m++)k[f=C[m]]<0&&(y[h]=f,g[h++]=n(E[f],M)),E[f]=0}for(v[p]=h,N[p]=d,m=0;m<h;m++)y[m]=k[y[m]];return g.splice(h,g.length-h),y.splice(h,y.length-h),x.splice(d,x.length-d),w.splice(d,w.length-d),{L:b,U:S,pinv:k}}})),_0=ZU("slu",["typed","abs","add","multiply","transpose","divideScalar","subtract","larger","largerEq","SparseMatrix"],(e=>{var{typed:t,abs:n,add:r,multiply:a,transpose:i,divideScalar:o,subtract:s,larger:u,largerEq:c,SparseMatrix:l}=e,p=E0({add:r,multiply:a,transpose:i}),h=F0({abs:n,divideScalar:o,multiply:a,subtract:s,larger:u,largerEq:c,SparseMatrix:l});return t("slu",{"SparseMatrix, number, number":function(e,t,n){if(!sW(t)||t<0||t>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(n<0||n>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var r=p(t,e,!1),a=h(e,r,n);return{L:a.L,U:a.U,p:a.pinv,q:r.q,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\np: "+this.p.toString()+(this.q?"\nq: "+this.q.toString():"")+"\n"}}}})}));function M0(e,t){var n,r=t.length,a=[];if(e)for(n=0;n<r;n++)a[e[n]]=t[n];else for(n=0;n<r;n++)a[n]=t[n];return a}var O0="lusolve",R0=["typed","matrix","lup","slu","usolve","lsolve","DenseMatrix"],z0=ZU(O0,R0,(e=>{var{typed:t,matrix:n,lup:r,slu:a,usolve:i,lsolve:o,DenseMatrix:s}=e,u=m$({DenseMatrix:s});return t(O0,{"Array, Array | Matrix":function(e,t){e=n(e);var a=r(e);return l(a.L,a.U,a.p,null,t).valueOf()},"DenseMatrix, Array | Matrix":function(e,t){var n=r(e);return l(n.L,n.U,n.p,null,t)},"SparseMatrix, Array | Matrix":function(e,t){var n=r(e);return l(n.L,n.U,n.p,null,t)},"SparseMatrix, Array | Matrix, number, number":function(e,t,n,r){var i=a(e,n,r);return l(i.L,i.U,i.p,i.q,t)},"Object, Array | Matrix":function(e,t){return l(e.L,e.U,e.p,e.q,t)}});function c(e){if(oU(e))return e;if(iU(e))return n(e);throw new TypeError("Invalid Matrix LU decomposition")}function l(e,t,n,r,a){e=c(e),t=c(t),n&&((a=u(e,a,!0))._data=M0(n,a._data));var s=o(e,a),l=i(t,s);return r&&(l._data=M0(r,l._data)),l}})),B0="polynomialRoot",L0=["typed","isZero","equalScalar","add","subtract","multiply","divide","sqrt","unaryMinus","cbrt","typeOf","im","re"],P0=ZU(B0,L0,(e=>{var{typed:t,isZero:n,equalScalar:r,add:a,subtract:i,multiply:o,divide:s,sqrt:u,unaryMinus:c,cbrt:l,typeOf:p,im:h,re:d}=e;return t(B0,{"number|Complex, ...number|Complex":(e,t)=>{for(var f=[e,...t];f.length>0&&n(f[f.length-1]);)f.pop();if(f.length<2)throw new RangeError("Polynomial [".concat(e,", ").concat(t,"] must have a non-zero non-constant coefficient"));switch(f.length){case 2:return[c(s(f[0],f[1]))];case 3:var[m,g,y]=f,v=o(2,y),b=o(g,g),x=o(4,y,m);if(r(b,x))return[s(c(g),v)];var w=u(i(b,x));return[s(i(w,g),v),s(i(c(w),g),v)];case 4:var[N,S,k,E]=f,C=c(o(3,E)),T=o(k,k),D=o(3,E,S),I=a(o(2,k,k,k),o(27,E,E,N)),A=o(9,E,k,S);if(r(T,D)&&r(I,A))return[s(k,C)];var F,_=i(T,D),M=i(I,A),O=a(o(18,E,k,S,N),o(k,k,S,S)),R=a(o(4,k,k,k,N),o(4,E,S,S,S),o(27,E,E,N,N));if(r(O,R))return[s(i(o(4,E,k,S),a(o(9,E,E,N),o(k,k,k))),o(E,_)),s(i(o(9,E,N),o(k,S)),o(2,_))];F=r(T,D)?M:s(a(M,u(i(o(M,M),o(4,_,_,_)))),2);return l(F,!0).toArray().map((e=>s(a(k,e,s(_,e)),C))).map((e=>"Complex"===p(e)&&r(d(e),d(e)+h(e))?d(e):e));default:throw new RangeError("only implemented for cubic or lower-order polynomials, not ".concat(f))}}})})),U0=["evaluate"],W0=ZU("Help",U0,(e=>{var{evaluate:t}=e;function n(e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!e)throw new Error('Argument "doc" missing');this.doc=e}return n.prototype.type="Help",n.prototype.isHelp=!0,n.prototype.toString=function(){var e=this.doc||{},n="\n";if(e.name&&(n+="Name: "+e.name+"\n\n"),e.category&&(n+="Category: "+e.category+"\n\n"),e.description&&(n+="Description:\n    "+e.description+"\n\n"),e.syntax&&(n+="Syntax:\n    "+e.syntax.join("\n    ")+"\n\n"),e.examples){n+="Examples:\n";for(var r=!1,a=t("config()"),i={config:e=>(r=!0,t("config(newConfig)",{newConfig:e}))},o=0;o<e.examples.length;o++){var s=e.examples[o];n+="    "+s+"\n";var u=void 0;try{u=t(s,i)}catch(Z2){u=Z2}void 0===u||fU(u)||(n+="        "+nj(u,{precision:14})+"\n")}n+="\n",r&&t("config(originalConfig)",{originalConfig:a})}return e.mayThrow&&e.mayThrow.length&&(n+="Throws: "+e.mayThrow.join(", ")+"\n\n"),e.seealso&&e.seealso.length&&(n+="See also: "+e.seealso.join(", ")+"\n"),n},n.prototype.toJSON=function(){var e=qU(this.doc);return e.mathjs="Help",e},n.fromJSON=function(e){var t={};return Object.keys(e).filter((e=>"mathjs"!==e)).forEach((n=>{t[n]=e[n]})),new n(t)},n.prototype.valueOf=n.prototype.toString,n}),{isClass:!0}),V0=["?on","math","typed"],q0=ZU("Chain",V0,(e=>{var{on:t,math:n,typed:r}=e;function a(e){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");WU(e)?this.value=e.value:this.value=e}function i(e,t){YU(a.prototype,e,(function(){var e=t();if("function"===typeof e)return o(e)}))}function o(e){return function(){if(0===arguments.length)return new a(e(this.value));for(var t=[this.value],n=0;n<arguments.length;n++)t[n+1]=arguments[n];if(r.isTypedFunction(e)){var i=r.resolve(e,t);if(1===i.params.length)throw new Error("chain function "+e.name+" cannot match rest parameter between chain value and additional arguments.");return new a(i.implementation.apply(e,t))}return new a(e.apply(e,t))}}a.prototype.type="Chain",a.prototype.isChain=!0,a.prototype.done=function(){return this.value},a.prototype.valueOf=function(){return this.value},a.prototype.toString=function(){return nj(this.value)},a.prototype.toJSON=function(){return{mathjs:"Chain",value:this.value}},a.fromJSON=function(e){return new a(e.value)},a.createProxy=function(e,t){if("string"===typeof e)!function(e,t){"function"===typeof t&&(a.prototype[e]=o(t))}(e,t);else{var n=function(t){$U(e,t)&&void 0===s[t]&&i(t,(()=>e[t]))};for(var r in e)n(r)}};var s={expression:!0,docs:!0,type:!0,classes:!0,json:!0,error:!0,isChain:!0};return a.createProxy(n),t&&t("import",(function(e,t,n){n||i(e,t)})),a}),{isClass:!0}),j0={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]},G0={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]},H0={bignumber:{name:"bignumber",category:"Construction",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","bigint","complex","fraction","index","matrix","string","unit"]},bigint:{name:"bigint",category:"Construction",syntax:["bigint(x)"],description:"Create a bigint, an integer with an arbitrary number of digits, from a number or string.",examples:["123123123123123123 # a large number will lose digits",'bigint("123123123123123123")','bignumber(["1", "3", "5"])'],seealso:["boolean","bignumber","number","complex","fraction","index","matrix","string","unit"]},boolean:{name:"boolean",category:"Construction",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]},complex:{name:"complex",category:"Construction",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]},createUnit:{name:"createUnit",category:"Construction",syntax:["createUnit(definitions)","createUnit(name, definition)"],description:"Create a user-defined unit and register it with the Unit type.",examples:['createUnit("foo")','createUnit("knot", {definition: "0.514444444 m/s", aliases: ["knots", "kt", "kts"]})','createUnit("mph", "1 mile/hour")'],seealso:["unit","splitUnit"]},fraction:{name:"fraction",category:"Construction",syntax:["fraction(num)","fraction(matrix)","fraction(num,den)","fraction({n: num, d: den})"],description:"Create a fraction from a number or from integer numerator and denominator.",examples:["fraction(0.125)","fraction(1, 3) + fraction(2, 5)","fraction({n: 333, d: 53})","fraction([sqrt(9), sqrt(10), sqrt(11)])"],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]},index:{name:"index",category:"Construction",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[1:2, 1:2] = 1","B = [1, 2, 3]","B[B>1 and B<3]"],seealso:["bignumber","boolean","complex","matrix,","number","range","string","unit"]},matrix:{name:"matrix",category:"Construction",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()",'matrix("dense")',"matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])",'matrix([3, 4; 5, 6], "sparse")','matrix([3, 4; 5, 6], "sparse", "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","sparse"]},number:{name:"number",category:"Construction",syntax:["x","number(x)","number(unit, valuelessUnit)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number(unit("52cm"), "m")'],seealso:["bignumber","bigint","boolean","complex","fraction","index","matrix","string","unit"]},sparse:{name:"sparse",category:"Construction",syntax:["sparse()","sparse([a1, b1, ...; a1, b2, ...])",'sparse([a1, b1, ...; a1, b2, ...], "number")'],description:"Create a sparse matrix.",examples:["sparse()","sparse([3, 4; 5, 6])",'sparse([3, 0; 5, 0], "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","matrix"]},splitUnit:{name:"splitUnit",category:"Construction",syntax:["splitUnit(unit: Unit, parts: Unit[])"],description:"Split a unit in an array of units whose sum is equal to the original unit.",examples:['splitUnit(1 m, ["feet", "inch"])'],seealso:["unit","createUnit"]},string:{name:"string",category:"Construction",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]},unit:{name:"unit",category:"Construction",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]},e:j0,E:j0,false:{name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]},i:{name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]},Infinity:{name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]},LN2:{name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]},LN10:{name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]},LOG2E:{name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]},LOG10E:{name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]},NaN:{name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]},null:{name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]},pi:G0,PI:G0,phi:{name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["phi"],seealso:[]},SQRT1_2:{name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]},SQRT2:{name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]},tau:{name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]},true:{name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]},version:{name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]},speedOfLight:{description:"Speed of light in vacuum",examples:["speedOfLight"]},gravitationConstant:{description:"Newtonian constant of gravitation",examples:["gravitationConstant"]},planckConstant:{description:"Planck constant",examples:["planckConstant"]},reducedPlanckConstant:{description:"Reduced Planck constant",examples:["reducedPlanckConstant"]},magneticConstant:{description:"Magnetic constant (vacuum permeability)",examples:["magneticConstant"]},electricConstant:{description:"Electric constant (vacuum permeability)",examples:["electricConstant"]},vacuumImpedance:{description:"Characteristic impedance of vacuum",examples:["vacuumImpedance"]},coulomb:{description:"Coulomb's constant",examples:["coulomb"]},elementaryCharge:{description:"Elementary charge",examples:["elementaryCharge"]},bohrMagneton:{description:"Bohr magneton",examples:["bohrMagneton"]},conductanceQuantum:{description:"Conductance quantum",examples:["conductanceQuantum"]},inverseConductanceQuantum:{description:"Inverse conductance quantum",examples:["inverseConductanceQuantum"]},magneticFluxQuantum:{description:"Magnetic flux quantum",examples:["magneticFluxQuantum"]},nuclearMagneton:{description:"Nuclear magneton",examples:["nuclearMagneton"]},klitzing:{description:"Von Klitzing constant",examples:["klitzing"]},bohrRadius:{description:"Bohr radius",examples:["bohrRadius"]},classicalElectronRadius:{description:"Classical electron radius",examples:["classicalElectronRadius"]},electronMass:{description:"Electron mass",examples:["electronMass"]},fermiCoupling:{description:"Fermi coupling constant",examples:["fermiCoupling"]},fineStructure:{description:"Fine-structure constant",examples:["fineStructure"]},hartreeEnergy:{description:"Hartree energy",examples:["hartreeEnergy"]},protonMass:{description:"Proton mass",examples:["protonMass"]},deuteronMass:{description:"Deuteron Mass",examples:["deuteronMass"]},neutronMass:{description:"Neutron mass",examples:["neutronMass"]},quantumOfCirculation:{description:"Quantum of circulation",examples:["quantumOfCirculation"]},rydberg:{description:"Rydberg constant",examples:["rydberg"]},thomsonCrossSection:{description:"Thomson cross section",examples:["thomsonCrossSection"]},weakMixingAngle:{description:"Weak mixing angle",examples:["weakMixingAngle"]},efimovFactor:{description:"Efimov factor",examples:["efimovFactor"]},atomicMass:{description:"Atomic mass constant",examples:["atomicMass"]},avogadro:{description:"Avogadro's number",examples:["avogadro"]},boltzmann:{description:"Boltzmann constant",examples:["boltzmann"]},faraday:{description:"Faraday constant",examples:["faraday"]},firstRadiation:{description:"First radiation constant",examples:["firstRadiation"]},loschmidt:{description:"Loschmidt constant at T=273.15 K and p=101.325 kPa",examples:["loschmidt"]},gasConstant:{description:"Gas constant",examples:["gasConstant"]},molarPlanckConstant:{description:"Molar Planck constant",examples:["molarPlanckConstant"]},molarVolume:{description:"Molar volume of an ideal gas at T=273.15 K and p=101.325 kPa",examples:["molarVolume"]},sackurTetrode:{description:"Sackur-Tetrode constant at T=1 K and p=101.325 kPa",examples:["sackurTetrode"]},secondRadiation:{description:"Second radiation constant",examples:["secondRadiation"]},stefanBoltzmann:{description:"Stefan-Boltzmann constant",examples:["stefanBoltzmann"]},wienDisplacement:{description:"Wien displacement law constant",examples:["wienDisplacement"]},molarMass:{description:"Molar mass constant",examples:["molarMass"]},molarMassC12:{description:"Molar mass constant of carbon-12",examples:["molarMassC12"]},gravity:{description:"Standard acceleration of gravity (standard acceleration of free-fall on Earth)",examples:["gravity"]},planckLength:{description:"Planck length",examples:["planckLength"]},planckMass:{description:"Planck mass",examples:["planckMass"]},planckTime:{description:"Planck time",examples:["planckTime"]},planckCharge:{description:"Planck charge",examples:["planckCharge"]},planckTemperature:{description:"Planck temperature",examples:["planckTemperature"]},derivative:{name:"derivative",category:"Algebra",syntax:["derivative(expr, variable)","derivative(expr, variable, {simplify: boolean})"],description:"Takes the derivative of an expression expressed in parser Nodes. The derivative will be taken over the supplied variable in the second parameter. If there are multiple variables in the expression, it will return a partial derivative.",examples:['derivative("2x^3", "x")','derivative("2x^3", "x", {simplify: false})','derivative("2x^2 + 3x + 4", "x")','derivative("sin(2x)", "x")','f = parse("x^2 + x")','x = parse("x")',"df = derivative(f, x)","df.evaluate({x: 3})"],seealso:["simplify","parse","evaluate"]},lsolve:{name:"lsolve",category:"Algebra",syntax:["x=lsolve(L, b)"],description:"Finds one solution of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolveAll","lup","lusolve","usolve","matrix","sparse"]},lsolveAll:{name:"lsolveAll",category:"Algebra",syntax:["x=lsolveAll(L, b)"],description:"Finds all solutions of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolve","lup","lusolve","usolve","matrix","sparse"]},lup:{name:"lup",category:"Algebra",syntax:["lup(m)"],description:"Calculate the Matrix LU decomposition with partial pivoting. Matrix A is decomposed in three matrices (L, U, P) where P * A = L * U",examples:["lup([[2, 1], [1, 4]])","lup(matrix([[2, 1], [1, 4]]))","lup(sparse([[2, 1], [1, 4]]))"],seealso:["lusolve","lsolve","usolve","matrix","sparse","slu","qr"]},lusolve:{name:"lusolve",category:"Algebra",syntax:["x=lusolve(A, b)","x=lusolve(lu, b)"],description:"Solves the linear system A * x = b where A is an [n x n] matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lusolve(a, b)"],seealso:["lup","slu","lsolve","usolve","matrix","sparse"]},leafCount:{name:"leafCount",category:"Algebra",syntax:["leafCount(expr)"],description:"Computes the number of leaves in the parse tree of the given expression",examples:['leafCount("e^(i*pi)-1")','leafCount(parse("{a: 22/7, b: 10^(1/2)}"))'],seealso:["simplify"]},polynomialRoot:{name:"polynomialRoot",category:"Algebra",syntax:["x=polynomialRoot(-6, 3)","x=polynomialRoot(4, -4, 1)","x=polynomialRoot(-8, 12, -6, 1)"],description:"Finds the roots of a univariate polynomial given by its coefficients starting from constant, linear, and so on, increasing in degree.",examples:["a = polynomialRoot(-6, 11, -6, 1)"],seealso:["cbrt","sqrt"]},resolve:{name:"resolve",category:"Algebra",syntax:["resolve(node, scope)"],description:"Recursively substitute variables in an expression tree.",examples:['resolve(parse("1 + x"), { x: 7 })','resolve(parse("size(text)"), { text: "Hello World" })','resolve(parse("x + y"), { x: parse("3z") })','resolve(parse("3x"), { x: parse("y+z"), z: parse("w^y") })'],seealso:["simplify","evaluate"],mayThrow:["ReferenceError"]},simplify:{name:"simplify",category:"Algebra",syntax:["simplify(expr)","simplify(expr, rules)"],description:"Simplify an expression tree.",examples:['simplify("3 + 2 / 4")','simplify("2x + x")','f = parse("x * (x + 2 + x)")',"simplified = simplify(f)","simplified.evaluate({x: 2})"],seealso:["simplifyCore","derivative","evaluate","parse","rationalize","resolve"]},simplifyConstant:{name:"simplifyConstant",category:"Algebra",syntax:["simplifyConstant(expr)","simplifyConstant(expr, options)"],description:"Replace constant subexpressions of node with their values.",examples:['simplifyConstant("(3-3)*x")','simplifyConstant(parse("z-cos(tau/8)"))'],seealso:["simplify","simplifyCore","evaluate"]},simplifyCore:{name:"simplifyCore",category:"Algebra",syntax:["simplifyCore(node)"],description:"Perform simple one-pass simplifications on an expression tree.",examples:['simplifyCore(parse("0*x"))','simplifyCore(parse("(x+0)*2"))'],seealso:["simplify","simplifyConstant","evaluate"]},symbolicEqual:{name:"symbolicEqual",category:"Algebra",syntax:["symbolicEqual(expr1, expr2)","symbolicEqual(expr1, expr2, options)"],description:"Returns true if the difference of the expressions simplifies to 0",examples:['symbolicEqual("x*y","y*x")','symbolicEqual("abs(x^2)", "x^2")','symbolicEqual("abs(x)", "x", {context: {abs: {trivial: true}}})'],seealso:["simplify","evaluate"]},rationalize:{name:"rationalize",category:"Algebra",syntax:["rationalize(expr)","rationalize(expr, scope)","rationalize(expr, scope, detailed)"],description:"Transform a rationalizable expression in a rational fraction. If rational fraction is one variable polynomial then converts the numerator and denominator in canonical form, with decreasing exponents, returning the coefficients of numerator.",examples:['rationalize("2x/y - y/(x+1)")','rationalize("2x/y - y/(x+1)", true)'],seealso:["simplify"]},slu:{name:"slu",category:"Algebra",syntax:["slu(A, order, threshold)"],description:"Calculate the Matrix LU decomposition with full pivoting. Matrix A is decomposed in two matrices (L, U) and two permutation vectors (pinv, q) where P * A * Q = L * U",examples:["slu(sparse([4.5, 0, 3.2, 0; 3.1, 2.9, 0, 0.9; 0, 1.7, 3, 0; 3.5, 0.4, 0, 1]), 1, 0.001)"],seealso:["lusolve","lsolve","usolve","matrix","sparse","lup","qr"]},usolve:{name:"usolve",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds one solution of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolveAll","lup","lusolve","lsolve","matrix","sparse"]},usolveAll:{name:"usolveAll",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds all solutions of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolve","lup","lusolve","lsolve","matrix","sparse"]},qr:{name:"qr",category:"Algebra",syntax:["qr(A)"],description:"Calculates the Matrix QR decomposition. Matrix `A` is decomposed in two matrices (`Q`, `R`) where `Q` is an orthogonal matrix and `R` is an upper triangular matrix.",examples:["qr([[1, -1,  4], [1,  4, -2], [1,  4,  2], [1,  -1, 0]])"],seealso:["lup","slu","matrix"]},abs:{name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]},add:{name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i","3 cm + 2 inch",'"2.3" + "4"'],seealso:["subtract"]},cbrt:{name:"cbrt",category:"Arithmetic",syntax:["cbrt(x)","cbrt(x, allRoots)"],description:"Compute the cubic root value. If x = y * y * y, then y is the cubic root of x. When `x` is a number or complex number, an optional second argument `allRoots` can be provided to return all three cubic roots. If not provided, the principal root is returned",examples:["cbrt(64)","cube(4)","cbrt(-8)","cbrt(2 + 3i)","cbrt(8i)","cbrt(8i, true)","cbrt(27 m^3)"],seealso:["square","sqrt","cube","multiply"]},ceil:{name:"ceil",category:"Arithmetic",syntax:["ceil(x)","ceil(x, n)","ceil(unit, valuelessUnit)","ceil(unit, n, valuelessUnit)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)","ceil(3.241cm, cm)","ceil(3.241cm, 2, cm)"],seealso:["floor","fix","round"]},cube:{name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]},divide:{name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]},dotDivide:{name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]},dotMultiply:{name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]},dotPow:{name:"dotPow",category:"Operators",syntax:["x .^ y","dotPow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]},exp:{name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["expm","expm1","pow","log"]},expm:{name:"expm",category:"Arithmetic",syntax:["exp(x)"],description:"Compute the matrix exponential, expm(A) = e^A. The matrix must be square. Not to be confused with exp(a), which performs element-wise exponentiation.",examples:["expm([[0,2],[0,0]])"],seealso:["exp"]},expm1:{name:"expm1",category:"Arithmetic",syntax:["expm1(x)"],description:"Calculate the value of subtracting 1 from the exponential value.",examples:["expm1(2)","pow(e, 2) - 1","log(expm1(2) + 1)"],seealso:["exp","pow","log"]},fix:{name:"fix",category:"Arithmetic",syntax:["fix(x)","fix(x, n)","fix(unit, valuelessUnit)","fix(unit, n, valuelessUnit)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)","fix(3.241cm, cm)","fix(3.241cm, 2, cm)"],seealso:["ceil","floor","round"]},floor:{name:"floor",category:"Arithmetic",syntax:["floor(x)","floor(x, n)","floor(unit, valuelessUnit)","floor(unit, n, valuelessUnit)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)","floor(3.241cm, cm)","floor(3.241cm, 2, cm)"],seealso:["ceil","fix","round"]},gcd:{name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]},hypot:{name:"hypot",category:"Arithmetic",syntax:["hypot(a, b, c, ...)","hypot([a, b, c, ...])"],description:"Calculate the hypotenuse of a list with values.",examples:["hypot(3, 4)","sqrt(3^2 + 4^2)","hypot(-2)","hypot([3, 4, 5])"],seealso:["abs","norm"]},lcm:{name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]},log:{name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log1p","log2","log10"]},log2:{name:"log2",category:"Arithmetic",syntax:["log2(x)"],description:"Calculate the 2-base of a value. This is the same as calculating `log(x, 2)`.",examples:["log2(0.03125)","log2(16)","log2(16) / log2(2)","pow(2, 4)"],seealso:["exp","log1p","log","log10"]},log1p:{name:"log1p",category:"Arithmetic",syntax:["log1p(x)","log1p(x, base)"],description:"Calculate the logarithm of a `value+1`",examples:["log1p(2.5)","exp(log1p(1.4))","pow(10, 4)","log1p(9999, 10)","log1p(9999) / log(10)"],seealso:["exp","log","log2","log10"]},log10:{name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]},mod:{name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]},multiply:{name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]},norm:{name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i)","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)",'norm([[1, 2], [3, 4]], "inf")','norm([[1, 2], [3, 4]], "fro")']},nthRoot:{name:"nthRoot",category:"Arithmetic",syntax:["nthRoot(a)","nthRoot(a, root)"],description:'Calculate the nth root of a value. The principal nth root of a positive real number A, is the positive real solution of the equation "x^root = A".',examples:["4 ^ 3","nthRoot(64, 3)","nthRoot(9, 2)","sqrt(9)"],seealso:["nthRoots","pow","sqrt"]},nthRoots:{name:"nthRoots",category:"Arithmetic",syntax:["nthRoots(A)","nthRoots(A, root)"],description:'Calculate the nth roots of a value. An nth root of a positive real number A, is a positive real solution of the equation "x^root = A". This function returns an array of complex values.',examples:["nthRoots(1)","nthRoots(1, 3)"],seealso:["sqrt","pow","nthRoot"]},pow:{name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3","2*2*2","1 + e ^ (pi * i)","pow([[1, 2], [4, 3]], 2)","pow([[1, 2], [4, 3]], -1)"],seealso:["multiply","nthRoot","nthRoots","sqrt"]},round:{name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)","round(unit, valuelessUnit)","round(unit, n, valuelessUnit)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)","round(3.241cm, 2, cm)","round([3.2, 3.8, -4.7])"],seealso:["ceil","floor","fix"]},sign:{name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>0, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]},sqrt:{name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","sqrtm","multiply","nthRoot","nthRoots","pow"]},sqrtm:{name:"sqrtm",category:"Arithmetic",syntax:["sqrtm(x)"],description:"Calculate the principal square root of a square matrix. The principal square root matrix `X` of another matrix `A` is such that `X * X = A`.",examples:["sqrtm([[33, 24], [48, 57]])"],seealso:["sqrt","abs","square","multiply"]},square:{name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]},subtract:{name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]},unaryMinus:{name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]},unaryPlus:{name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]},xgcd:{name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values. The result is an array [d, x, y] with 3 entries, where d is the greatest common divisor, and d = x * a + y * b.",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]},invmod:{name:"invmod",category:"Arithmetic",syntax:["invmod(a, b)"],description:"Calculate the (modular) multiplicative inverse of a modulo b. Solution to the equation ax \u2263 1 (mod b)",examples:["invmod(8, 12)","invmod(7, 13)","invmod(15151, 15122)"],seealso:["gcd","xgcd"]},bitAnd:{name:"bitAnd",category:"Bitwise",syntax:["x & y","bitAnd(x, y)"],description:"Bitwise AND operation. Performs the logical AND operation on each pair of the corresponding bits of the two given values by multiplying them. If both bits in the compared position are 1, the bit in the resulting binary representation is 1, otherwise, the result is 0",examples:["5 & 3","bitAnd(53, 131)","[1, 12, 31] & 42"],seealso:["bitNot","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitNot:{name:"bitNot",category:"Bitwise",syntax:["~x","bitNot(x)"],description:"Bitwise NOT operation. Performs a logical negation on each bit of the given value. Bits that are 0 become 1, and those that are 1 become 0.",examples:["~1","~2","bitNot([2, -3, 4])"],seealso:["bitAnd","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitOr:{name:"bitOr",category:"Bitwise",syntax:["x | y","bitOr(x, y)"],description:"Bitwise OR operation. Performs the logical inclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if the first bit is 1 or the second bit is 1 or both bits are 1, otherwise, the result is 0.",examples:["5 | 3","bitOr([1, 2, 3], 4)"],seealso:["bitAnd","bitNot","bitXor","leftShift","rightArithShift","rightLogShift"]},bitXor:{name:"bitXor",category:"Bitwise",syntax:["bitXor(x, y)"],description:"Bitwise XOR operation, exclusive OR. Performs the logical exclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.",examples:["bitOr(1, 2)","bitXor([2, 3, 4], 4)"],seealso:["bitAnd","bitNot","bitOr","leftShift","rightArithShift","rightLogShift"]},leftShift:{name:"leftShift",category:"Bitwise",syntax:["x << y","leftShift(x, y)"],description:"Bitwise left logical shift of a value x by y number of bits.",examples:["4 << 1","8 >> 1"],seealso:["bitAnd","bitNot","bitOr","bitXor","rightArithShift","rightLogShift"]},rightArithShift:{name:"rightArithShift",category:"Bitwise",syntax:["x >> y","rightArithShift(x, y)"],description:"Bitwise right arithmetic shift of a value x by y number of bits.",examples:["8 >> 1","4 << 1","-12 >> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightLogShift"]},rightLogShift:{name:"rightLogShift",category:"Bitwise",syntax:["x >>> y","rightLogShift(x, y)"],description:"Bitwise right logical shift of a value x by y number of bits.",examples:["8 >>> 1","4 << 1","-12 >>> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightArithShift"]},bellNumbers:{name:"bellNumbers",category:"Combinatorics",syntax:["bellNumbers(n)"],description:"The Bell Numbers count the number of partitions of a set. A partition is a pairwise disjoint subset of S whose union is S. `bellNumbers` only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["bellNumbers(3)","bellNumbers(8)"],seealso:["stirlingS2"]},catalan:{name:"catalan",category:"Combinatorics",syntax:["catalan(n)"],description:"The Catalan Numbers enumerate combinatorial structures of many different types. catalan only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["catalan(3)","catalan(8)"],seealso:["bellNumbers"]},composition:{name:"composition",category:"Combinatorics",syntax:["composition(n, k)"],description:"The composition counts of n into k parts. composition only takes integer arguments. The following condition must be enforced: k <= n.",examples:["composition(5, 3)"],seealso:["combinations"]},stirlingS2:{name:"stirlingS2",category:"Combinatorics",syntax:["stirlingS2(n, k)"],description:"he Stirling numbers of the second kind, counts the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. `stirlingS2` only takes integer arguments. The following condition must be enforced: k <= n. If n = k or k = 1, then s(n,k) = 1.",examples:["stirlingS2(5, 3)"],seealso:["bellNumbers"]},config:{name:"config",category:"Core",syntax:["config()","config(options)"],description:"Get configuration or change configuration.",examples:["config()","1/3 + 1/4",'config({number: "Fraction"})',"1/3 + 1/4"],seealso:[]},import:{name:"import",category:"Core",syntax:["import(functions)","import(functions, options)"],description:"Import functions or constants from an object.",examples:["import({myFn: f(x)=x^2, myConstant: 32 })","myFn(2)","myConstant"],seealso:[]},typed:{name:"typed",category:"Core",syntax:["typed(signatures)","typed(name, signatures)"],description:"Create a typed function.",examples:['double = typed({ "number": f(x)=x+x, "string": f(x)=concat(x,x) })',"double(2)",'double("hello")'],seealso:[]},arg:{name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]},conj:{name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]},re:{name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]},im:{name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]},evaluate:{name:"evaluate",category:"Expression",syntax:["evaluate(expression)","evaluate(expression, scope)","evaluate([expr1, expr2, expr3, ...])","evaluate([expr1, expr2, expr3, ...], scope)"],description:"Evaluate an expression or an array with expressions.",examples:['evaluate("2 + 3")','evaluate("sqrt(16)")','evaluate("2 inch to cm")','evaluate("sin(x * pi)", { "x": 1/2 })','evaluate(["width=2", "height=4","width*height"])'],seealso:[]},help:{name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]},distance:{name:"distance",category:"Geometry",syntax:["distance([x1, y1], [x2, y2])","distance([[x1, y1], [x2, y2]])"],description:"Calculates the Euclidean distance between two points.",examples:["distance([0,0], [4,4])","distance([[0,0], [4,4]])"],seealso:[]},intersect:{name:"intersect",category:"Geometry",syntax:["intersect(expr1, expr2, expr3, expr4)","intersect(expr1, expr2, expr3)"],description:"Computes the intersection point of lines and/or planes.",examples:["intersect([0, 0], [10, 10], [10, 0], [0, 10])","intersect([1, 0, 1],  [4, -2, 2], [1, 1, 1, 6])"],seealso:[]},and:{name:"and",category:"Logical",syntax:["x and y","and(x, y)"],description:"Logical and. Test whether two values are both defined with a nonzero/nonempty value.",examples:["true and false","true and true","2 and 4"],seealso:["not","or","xor"]},not:{name:"not",category:"Logical",syntax:["not x","not(x)"],description:"Logical not. Flips the boolean value of given argument.",examples:["not true","not false","not 2","not 0"],seealso:["and","or","xor"]},or:{name:"or",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical or. Test if at least one value is defined with a nonzero/nonempty value.",examples:["true or false","false or false","0 or 4"],seealso:["not","and","xor"]},xor:{name:"xor",category:"Logical",syntax:["x xor y","xor(x, y)"],description:"Logical exclusive or, xor. Test whether one and only one value is defined with a nonzero/nonempty value.",examples:["true xor false","false xor false","true xor true","0 xor 4"],seealso:["not","and","or"]},concat:{name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},count:{name:"count",category:"Matrix",syntax:["count(x)"],description:"Count the number of elements of a matrix, array or string.",examples:["a = [1, 2; 3, 4; 5, 6]","count(a)","size(a)",'count("hello world")'],seealso:["size"]},cross:{name:"cross",category:"Matrix",syntax:["cross(A, B)"],description:"Calculate the cross product for two vectors in three dimensional space.",examples:["cross([1, 1, 0],  [0, 1, 1])","cross([3, -3, 1], [4, 9, 2])","cross([2, 3, 4],  [5, 6, 7])"],seealso:["multiply","dot"]},column:{name:"column",category:"Matrix",syntax:["column(x, index)"],description:"Return a column from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","column(A, 1)","column(A, 2)"],seealso:["row","matrixFromColumns"]},ctranspose:{name:"ctranspose",category:"Matrix",syntax:["x'","ctranspose(x)"],description:"Complex Conjugate and Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","ctranspose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},det:{name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},diag:{name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},diff:{name:"diff",category:"Matrix",syntax:["diff(arr)","diff(arr, dim)"],description:["Create a new matrix or array with the difference of the passed matrix or array.","Dim parameter is optional and used to indicate the dimension of the array/matrix to apply the difference","If no dimension parameter is passed it is assumed as dimension 0","Dimension is zero-based in javascript and one-based in the parser","Arrays must be 'rectangular' meaning arrays like [1, 2]","If something is passed as a matrix it will be returned as a matrix but other than that all matrices are converted to arrays"],examples:["A = [1, 2, 4, 7, 0]","diff(A)","diff(A, 1)","B = [[1, 2], [3, 4]]","diff(B)","diff(B, 1)","diff(B, 2)","diff(B, bignumber(2))","diff([[1, 2], matrix([3, 4])], 2)"],seealso:["subtract","partitionSelect"]},dot:{name:"dot",category:"Matrix",syntax:["dot(A, B)","A * B"],description:"Calculate the dot product of two vectors. The dot product of A = [a1, a2, a3, ..., an] and B = [b1, b2, b3, ..., bn] is defined as dot(A, B) = a1 * b1 + a2 * b2 + a3 * b3 + ... + an * bn",examples:["dot([2, 4, 1], [2, 2, 3])","[2, 4, 1] * [2, 2, 3]"],seealso:["multiply","cross"]},getMatrixDataType:{name:"getMatrixDataType",category:"Matrix",syntax:["getMatrixDataType(x)"],description:'Find the data type of all elements in a matrix or array, for example "number" if all items are a number and "Complex" if all values are complex numbers. If a matrix contains more than one data type, it will return "mixed".',examples:["getMatrixDataType([1, 2, 3])","getMatrixDataType([[5 cm], [2 inch]])",'getMatrixDataType([1, "text"])',"getMatrixDataType([1, bignumber(4)])"],seealso:["matrix","sparse","typeOf"]},identity:{name:"identity",category:"Matrix",syntax:["identity(n)","identity(m, n)","identity([m, n])"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",examples:["identity(3)","identity(3, 5)","a = [1, 2, 3; 4, 5, 6]","identity(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},filter:{name:"filter",category:"Matrix",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]},flatten:{name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]},forEach:{name:"forEach",category:"Matrix",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["numberOfPets = {}","addPet(n) = numberOfPets[n] = (numberOfPets[n] ? numberOfPets[n]:0 ) + 1;",'forEach(["Dog","Cat","Cat"], addPet)',"numberOfPets"],seealso:["map","sort","filter"]},inv:{name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","identity","ones","range","size","squeeze","subset","trace","transpose","zeros"]},pinv:{name:"pinv",category:"Matrix",syntax:["pinv(x)"],description:"Calculate the Moore\u2013Penrose inverse of a matrix",examples:["pinv([1, 2; 3, 4])","pinv([[1, 0], [0, 1], [0, 1]])","pinv(4)"],seealso:["inv"]},eigs:{name:"eigs",category:"Matrix",syntax:["eigs(x)"],description:"Calculate the eigenvalues and optionally eigenvectors of a square matrix",examples:["eigs([[5, 2.3], [2.3, 1]])","eigs([[1, 2, 3], [4, 5, 6], [7, 8, 9]], { precision: 1e-6, eigenvectors: false })"],seealso:["inv"]},kron:{name:"kron",category:"Matrix",syntax:["kron(x, y)"],description:"Calculates the Kronecker product of 2 matrices or vectors.",examples:["kron([[1, 0], [0, 1]], [[1, 2], [3, 4]])","kron([1,1], [2,3,4])"],seealso:["multiply","dot","cross"]},matrixFromFunction:{name:"matrixFromFunction",category:"Matrix",syntax:["matrixFromFunction(size, fn)","matrixFromFunction(size, fn, format)","matrixFromFunction(size, fn, format, datatype)","matrixFromFunction(size, format, fn)","matrixFromFunction(size, format, datatype, fn)"],description:"Create a matrix by evaluating a generating function at each index.",examples:["f(I) = I[1] - I[2]","matrixFromFunction([3,3], f)","g(I) = I[1] - I[2] == 1 ? 4 : 0",'matrixFromFunction([100, 100], "sparse", g)',"matrixFromFunction([5], random)"],seealso:["matrix","matrixFromRows","matrixFromColumns","zeros"]},matrixFromRows:{name:"matrixFromRows",category:"Matrix",syntax:["matrixFromRows(...arr)","matrixFromRows(row1, row2)","matrixFromRows(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual rows.",examples:["matrixFromRows([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromColumns","matrixFromFunction","zeros"]},matrixFromColumns:{name:"matrixFromColumns",category:"Matrix",syntax:["matrixFromColumns(...arr)","matrixFromColumns(row1, row2)","matrixFromColumns(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual columns.",examples:["matrixFromColumns([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromRows","matrixFromFunction","zeros"]},map:{name:"map",category:"Matrix",syntax:["map(x, callback)","map(x, y, ..., callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array or the matrices/arrays.",examples:["map([1, 2, 3], square)","map([1, 2], [3, 4], f(a,b) = a + b)"],seealso:["filter","forEach"]},ones:{name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","identity","inv","range","size","squeeze","subset","trace","transpose","zeros"]},partitionSelect:{name:"partitionSelect",category:"Matrix",syntax:["partitionSelect(x, k)","partitionSelect(x, k, compare)"],description:"Partition-based selection of an array or 1D matrix. Will find the kth smallest value, and mutates the input array. Uses Quickselect.",examples:["partitionSelect([5, 10, 1], 2)",'partitionSelect(["C", "B", "A", "D"], 1, compareText)',"arr = [5, 2, 1]","partitionSelect(arr, 0) # returns 1, arr is now: [1, 2, 5]","arr","partitionSelect(arr, 1, 'desc') # returns 2, arr is now: [5, 2, 1]","arr"],seealso:["sort"]},range:{name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"range(1m, 1m, 3m)","a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","identity","inv","ones","size","squeeze","subset","trace","transpose","zeros"]},resize:{name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze","reshape"]},reshape:{name:"reshape",category:"Matrix",syntax:["reshape(x, sizes)"],description:"Reshape a multi dimensional array to fit the specified dimensions.",examples:["reshape([1, 2, 3, 4, 5, 6], [2, 3])","reshape([[1, 2], [3, 4]], [1, 4])","reshape([[1, 2], [3, 4]], [4])","reshape([1, 2, 3, 4], [-1, 2])"],seealso:["size","squeeze","resize"]},rotate:{name:"rotate",category:"Matrix",syntax:["rotate(w, theta)","rotate(w, theta, v)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotate([1, 0], pi / 2)",'rotate(matrix([1, 0]), unit("35deg"))','rotate([1, 0, 0], unit("90deg"), [0, 0, 1])','rotate(matrix([1, 0, 0]), unit("90deg"), matrix([0, 0, 1]))'],seealso:["matrix","rotationMatrix"]},rotationMatrix:{name:"rotationMatrix",category:"Matrix",syntax:["rotationMatrix(theta)","rotationMatrix(theta, v)","rotationMatrix(theta, v, format)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotationMatrix(pi / 2)",'rotationMatrix(unit("45deg"), [0, 0, 1])','rotationMatrix(1, matrix([0, 0, 1]), "sparse")'],seealso:["cos","sin"]},row:{name:"row",category:"Matrix",syntax:["row(x, index)"],description:"Return a row from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","row(A, 1)","row(A, 2)"],seealso:["column","matrixFromRows"]},size:{name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","count","det","diag","identity","inv","ones","range","squeeze","subset","trace","transpose","zeros"]},sort:{name:"sort",category:"Matrix",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc", "desc", "natural", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"], "natural")',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)','sort(["10", "1", "2"], "natural")'],seealso:["map","filter","forEach"]},squeeze:{name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","identity","inv","ones","range","size","subset","trace","transpose","zeros"]},subset:{name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of the entries of a matrix or characters of a string. Indexes are one-based. There should be one index specification for each dimension of the target. Each specification can be a single index, a list of indices, or a range in colon notation `l:u`. In a range, both the lower bound l and upper bound u are included; and if a bound is omitted it defaults to the most extreme valid value. The cartesian product of the indices specified in each dimension determines the target of the operation.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]","f[[1,2], [1,3]] = [9, 10; 11, 12]","f"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","trace","transpose","zeros"]},trace:{name:"trace",category:"Matrix",syntax:["trace(A)"],description:"Calculate the trace of a matrix: the sum of the elements on the main diagonal of a square matrix.",examples:["A = [1, 2, 3; -1, 2, 3; 2, 0, 3]","trace(A)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","transpose","zeros"]},transpose:{name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},zeros:{name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose"]},fft:{name:"fft",category:"Matrix",syntax:["fft(x)"],description:"Calculate N-dimensional Fourier transform",examples:["fft([[1, 0], [1, 0]])"],seealso:["ifft"]},ifft:{name:"ifft",category:"Matrix",syntax:["ifft(x)"],description:"Calculate N-dimensional inverse Fourier transform",examples:["ifft([[2, 2], [0, 0]])"],seealso:["fft"]},sylvester:{name:"sylvester",category:"Algebra",syntax:["sylvester(A,B,C)"],description:"Solves the real-valued Sylvester equation AX+XB=C for X",examples:["sylvester([[-1, -2], [1, 1]], [[-2, 1], [-1, 2]], [[-3, 2], [3, 0]])","A = [[-1, -2], [1, 1]]; B = [[2, -1], [1, -2]]; C = [[-3, 2], [3, 0]]","sylvester(A, B, C)"],seealso:["schur","lyap"]},schur:{name:"schur",category:"Algebra",syntax:["schur(A)"],description:"Performs a real Schur decomposition of the real matrix A = UTU'",examples:["schur([[1, 0], [-4, 3]])","A = [[1, 0], [-4, 3]]","schur(A)"],seealso:["lyap","sylvester"]},lyap:{name:"lyap",category:"Algebra",syntax:["lyap(A,Q)"],description:"Solves the Continuous-time Lyapunov equation AP+PA'+Q=0 for P",examples:["lyap([[-2, 0], [1, -4]], [[3, 1], [1, 3]])","A = [[-2, 0], [1, -4]]","Q = [[3, 1], [1, 3]]","lyap(A,Q)"],seealso:["schur","sylvester"]},solveODE:{name:"solveODE",category:"Numeric",syntax:["solveODE(func, tspan, y0)","solveODE(func, tspan, y0, options)"],description:"Numerical Integration of Ordinary Differential Equations.",examples:["f(t,y) = y","tspan = [0, 4]","solveODE(f, tspan, 1)","solveODE(f, tspan, [1, 2])",'solveODE(f, tspan, 1, { method:"RK23", maxStep:0.1 })'],seealso:["derivative","simplifyCore"]},combinations:{name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["combinationsWithRep","permutations","factorial"]},combinationsWithRep:{name:"combinationsWithRep",category:"Probability",syntax:["combinationsWithRep(n, k)"],description:"Compute the number of combinations of n items taken k at a time with replacements.",examples:["combinationsWithRep(7, 5)"],seealso:["combinations","permutations","factorial"]},factorial:{name:"factorial",category:"Probability",syntax:["n!","factorial(n)"],description:"Compute the factorial of a value",examples:["5!","5 * 4 * 3 * 2 * 1","3!"],seealso:["combinations","combinationsWithRep","permutations","gamma"]},gamma:{name:"gamma",category:"Probability",syntax:["gamma(n)"],description:"Compute the gamma function. For small values, the Lanczos approximation is used, and for large values the extended Stirling approximation.",examples:["gamma(4)","3!","gamma(1/2)","sqrt(pi)"],seealso:["factorial"]},kldivergence:{name:"kldivergence",category:"Probability",syntax:["kldivergence(x, y)"],description:"Calculate the Kullback-Leibler (KL) divergence  between two distributions.",examples:["kldivergence([0.7,0.5,0.4], [0.2,0.9,0.5])"],seealso:[]},lgamma:{name:"lgamma",category:"Probability",syntax:["lgamma(n)"],description:"Logarithm of the gamma function for real, positive numbers and complex numbers, using Lanczos approximation for numbers and Stirling series for complex numbers.",examples:["lgamma(4)","lgamma(1/2)","lgamma(i)","lgamma(complex(1.1, 2))"],seealso:["gamma"]},multinomial:{name:"multinomial",category:"Probability",syntax:["multinomial(A)"],description:"Multinomial Coefficients compute the number of ways of picking a1, a2, ..., ai unordered outcomes from `n` possibilities. multinomial takes one array of integers as an argument. The following condition must be enforced: every ai > 0.",examples:["multinomial([1, 2, 1])"],seealso:["combinations","factorial"]},permutations:{name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","combinationsWithRep","factorial"]},pickRandom:{name:"pickRandom",category:"Probability",syntax:["pickRandom(array)","pickRandom(array, number)","pickRandom(array, weights)","pickRandom(array, number, weights)","pickRandom(array, weights, number)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])","pickRandom([1, 3, 1, 6], 2)","pickRandom([1, 3, 1, 6], [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], 2, [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], [2, 3, 2, 1], 2)"],seealso:["random","randomInt"]},random:{name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]},randomInt:{name:"randomInt",category:"Probability",syntax:["randomInt(max)","randomInt(min, max)","randomInt(size)","randomInt(size, max)","randomInt(size, min, max)"],description:"Return a random integer number",examples:["randomInt(10, 20)","randomInt([2, 3], 10)"],seealso:["pickRandom","random"]},compare:{name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compareNatural","compareText"]},compareNatural:{name:"compareNatural",category:"Relational",syntax:["compareNatural(x, y)"],description:"Compare two values of any type in a deterministic, natural way. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compareNatural(2, 3)","compareNatural(3, 2)","compareNatural(2, 2)","compareNatural(5cm, 40mm)",'compareNatural("2", "10")',"compareNatural(2 + 3i, 2 + 4i)","compareNatural([1, 2, 4], [1, 2, 3])","compareNatural([1, 5], [1, 2, 3])","compareNatural([1, 2], [1, 2])","compareNatural({a: 2}, {a: 4})"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare","compareText"]},compareText:{name:"compareText",category:"Relational",syntax:["compareText(x, y)"],description:"Compare two strings lexically. Comparison is case sensitive. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:['compareText("B", "A")','compareText("A", "B")','compareText("A", "A")','compareText("2", "10")','compare("2", "10")',"compare(2, 10)",'compareNatural("2", "10")','compareText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural"]},deepEqual:{name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["deepEqual([1,3,4], [1,3,4])","deepEqual([1,3,4], [1,3])"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]},equal:{name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual","equalText"]},equalText:{name:"equalText",category:"Relational",syntax:["equalText(x, y)"],description:"Check equality of two strings. Comparison is case sensitive. Returns true if the values are equal, and false if not.",examples:['equalText("Hello", "Hello")','equalText("a", "A")','equal("2e3", "2000")','equalText("2e3", "2000")','equalText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural","compareText","equal"]},larger:{name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]},largerEq:{name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 >= 1+1","2 > 1+1","a = 3.2","b = 6-2.8","(a >= b)"],seealso:["equal","unequal","smallerEq","smaller","compare"]},smaller:{name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]},smallerEq:{name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 <= 1+1","2 < 1+1","a = 3.2","b = 6-2.8","(a <= b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]},unequal:{name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]},setCartesian:{name:"setCartesian",category:"Set",syntax:["setCartesian(set1, set2)"],description:"Create the cartesian product of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays and the values will be sorted in ascending order before the operation.",examples:["setCartesian([1, 2], [3, 4])"],seealso:["setUnion","setIntersect","setDifference","setPowerset"]},setDifference:{name:"setDifference",category:"Set",syntax:["setDifference(set1, set2)"],description:"Create the difference of two (multi)sets: every element of set1, that is not the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setDifference([1, 2, 3, 4], [3, 4, 5, 6])","setDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setSymDifference"]},setDistinct:{name:"setDistinct",category:"Set",syntax:["setDistinct(set)"],description:"Collect the distinct elements of a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setDistinct([1, 1, 1, 2, 2, 3])"],seealso:["setMultiplicity"]},setIntersect:{name:"setIntersect",category:"Set",syntax:["setIntersect(set1, set2)"],description:"Create the intersection of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIntersect([1, 2, 3, 4], [3, 4, 5, 6])","setIntersect([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setDifference"]},setIsSubset:{name:"setIsSubset",category:"Set",syntax:["setIsSubset(set1, set2)"],description:"Check whether a (multi)set is a subset of another (multi)set: every element of set1 is the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIsSubset([1, 2], [3, 4, 5, 6])","setIsSubset([3, 4], [3, 4, 5, 6])"],seealso:["setUnion","setIntersect","setDifference"]},setMultiplicity:{name:"setMultiplicity",category:"Set",syntax:["setMultiplicity(element, set)"],description:"Count the multiplicity of an element in a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setMultiplicity(1, [1, 2, 2, 4])","setMultiplicity(2, [1, 2, 2, 4])"],seealso:["setDistinct","setSize"]},setPowerset:{name:"setPowerset",category:"Set",syntax:["setPowerset(set)"],description:"Create the powerset of a (multi)set: the powerset contains very possible subsets of a (multi)set. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setPowerset([1, 2, 3])"],seealso:["setCartesian"]},setSize:{name:"setSize",category:"Set",syntax:["setSize(set)","setSize(set, unique)"],description:'Count the number of elements of a (multi)set. When the second parameter "unique" is true, count only the unique values. A multi-dimension array will be converted to a single-dimension array before the operation.',examples:["setSize([1, 2, 2, 4])","setSize([1, 2, 2, 4], true)"],seealso:["setUnion","setIntersect","setDifference"]},setSymDifference:{name:"setSymDifference",category:"Set",syntax:["setSymDifference(set1, set2)"],description:"Create the symmetric difference of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setSymDifference([1, 2, 3, 4], [3, 4, 5, 6])","setSymDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setDifference"]},setUnion:{name:"setUnion",category:"Set",syntax:["setUnion(set1, set2)"],description:"Create the union of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setUnion([1, 2, 3, 4], [3, 4, 5, 6])","setUnion([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setIntersect","setDifference"]},zpk2tf:{name:"zpk2tf",category:"Signal",syntax:["zpk2tf(z, p, k)"],description:"Compute the transfer function of a zero-pole-gain model.",examples:["zpk2tf([1, 2], [-1, -2], 1)","zpk2tf([1, 2], [-1, -2])","zpk2tf([1 - 3i, 2 + 2i], [-1, -2])"],seealso:[]},freqz:{name:"freqz",category:"Signal",syntax:["freqz(b, a)","freqz(b, a, w)"],description:"Calculates the frequency response of a filter given its numerator and denominator coefficients.",examples:["freqz([1, 2], [1, 2, 3])","freqz([1, 2], [1, 2, 3], [0, 1])","freqz([1, 2], [1, 2, 3], 512)"],seealso:[]},erf:{name:"erf",category:"Special",syntax:["erf(x)"],description:"Compute the erf function of a value using a rational Chebyshev approximations for different intervals of x",examples:["erf(0.2)","erf(-0.5)","erf(4)"],seealso:[]},zeta:{name:"zeta",category:"Special",syntax:["zeta(s)"],description:"Compute the Riemann Zeta Function using an infinite series and Riemann's Functional Equation for the entire complex plane",examples:["zeta(0.2)","zeta(-0.5)","zeta(4)"],seealso:[]},cumsum:{name:"cumsum",category:"Statistics",syntax:["cumsum(a, b, c, ...)","cumsum(A)"],description:"Compute the cumulative sum of all values.",examples:["cumsum(2, 3, 4, 1)","cumsum([2, 3, 4, 1])","cumsum([1, 2; 3, 4])","cumsum([1, 2; 3, 4], 1)","cumsum([1, 2; 3, 4], 2)"],seealso:["max","mean","median","min","prod","std","sum","variance"]},mad:{name:"mad",category:"Statistics",syntax:["mad(a, b, c, ...)","mad(A)"],description:"Compute the median absolute deviation of a matrix or a list with values. The median absolute deviation is defined as the median of the absolute deviations from the median.",examples:["mad(10, 20, 30)","mad([1, 2, 3])"],seealso:["mean","median","std","abs"]},max:{name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dimension)"],description:"Compute the maximum value of a list of values.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3])","max([2, 5; 4, 3], 1)","max([2, 5; 4, 3], 2)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","variance"]},mean:{name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dimension)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3])","mean([2, 5; 4, 3], 1)","mean([2, 5; 4, 3], 2)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","variance"]},median:{name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","variance","quantileSeq"]},min:{name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dimension)"],description:"Compute the minimum value of a list of values.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3])","min([2, 5; 4, 3], 1)","min([2, 5; 4, 3], 2)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","variance"]},mode:{name:"mode",category:"Statistics",syntax:["mode(a, b, c, ...)","mode(A)","mode(A, a, b, B, c, ...)"],description:"Computes the mode of all values as an array. In case mode being more than one, multiple values are returned in an array.",examples:["mode(2, 1, 4, 3, 1)","mode([1, 2.7, 3.2, 4, 2.7])","mode(1, 4, 6, 1, 6)"],seealso:["max","mean","min","median","prod","std","sum","variance"]},prod:{name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],seealso:["max","mean","min","median","min","std","sum","variance"]},quantileSeq:{name:"quantileSeq",category:"Statistics",syntax:["quantileSeq(A, prob[, sorted])","quantileSeq(A, [prob1, prob2, ...][, sorted])","quantileSeq(A, N[, sorted])"],description:"Compute the prob order quantile of a matrix or a list with values. The sequence is sorted and the middle value is returned. Supported types of sequence values are: Number, BigNumber, Unit Supported types of probability are: Number, BigNumber. \n\nIn case of a (multi dimensional) array or matrix, the prob order quantile of all elements will be calculated.",examples:["quantileSeq([3, -1, 5, 7], 0.5)","quantileSeq([3, -1, 5, 7], [1/3, 2/3])","quantileSeq([3, -1, 5, 7], 2)","quantileSeq([-1, 3, 5, 7], 0.5, true)"],seealso:["mean","median","min","max","prod","std","sum","variance"]},std:{name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, dimension)","std(A, normalization)","std(A, dimension, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(variance(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","prod","sum","variance"]},sum:{name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)","sum(A, dimension)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","sum","variance"]},variance:{name:"variance",category:"Statistics",syntax:["variance(a, b, c, ...)","variance(A)","variance(A, dimension)","variance(A, normalization)","variance(A, dimension, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["variance(2, 4, 6)","variance([2, 4, 6, 8])",'variance([2, 4, 6, 8], "uncorrected")','variance([2, 4, 6, 8], "biased")',"variance([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]},corr:{name:"corr",category:"Statistics",syntax:["corr(A,B)"],description:"Compute the correlation coefficient of a two list with values, For matrices, the matrix correlation coefficient is calculated.",examples:["corr([2, 4, 6, 8],[1, 2, 3, 6])","corr(matrix([[1, 2.2, 3, 4.8, 5], [1, 2, 3, 4, 5]]), matrix([[4, 5.3, 6.6, 7, 8], [1, 2, 3, 4, 5]]))"],seealso:["max","mean","min","median","min","prod","std","sum"]},acos:{name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]},acosh:{name:"acosh",category:"Trigonometry",syntax:["acosh(x)"],description:"Calculate the hyperbolic arccos of a value, defined as `acosh(x) = ln(sqrt(x^2 - 1) + x)`.",examples:["acosh(1.5)"],seealso:["cosh","asinh","atanh"]},acot:{name:"acot",category:"Trigonometry",syntax:["acot(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acot(0.5)","acot(cot(0.5))","acot(2)"],seealso:["cot","atan"]},acoth:{name:"acoth",category:"Trigonometry",syntax:["acoth(x)"],description:"Calculate the inverse hyperbolic tangent of a value, defined as `acoth(x) = (ln((x+1)/x) + ln(x/(x-1))) / 2`.",examples:["acoth(2)","acoth(0.5)"],seealso:["acsch","asech"]},acsc:{name:"acsc",category:"Trigonometry",syntax:["acsc(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acsc(2)","acsc(csc(0.5))","acsc(0.5)"],seealso:["csc","asin","asec"]},acsch:{name:"acsch",category:"Trigonometry",syntax:["acsch(x)"],description:"Calculate the inverse hyperbolic cosecant of a value, defined as `acsch(x) = ln(1/x + sqrt(1/x^2 + 1))`.",examples:["acsch(0.5)"],seealso:["asech","acoth"]},asec:{name:"asec",category:"Trigonometry",syntax:["asec(x)"],description:"Calculate the inverse secant of a value.",examples:["asec(0.5)","asec(sec(0.5))","asec(2)"],seealso:["acos","acot","acsc"]},asech:{name:"asech",category:"Trigonometry",syntax:["asech(x)"],description:"Calculate the inverse secant of a value.",examples:["asech(0.5)"],seealso:["acsch","acoth"]},asin:{name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(0.5))"],seealso:["sin","acos","atan"]},asinh:{name:"asinh",category:"Trigonometry",syntax:["asinh(x)"],description:"Calculate the hyperbolic arcsine of a value, defined as `asinh(x) = ln(x + sqrt(x^2 + 1))`.",examples:["asinh(0.5)"],seealso:["acosh","atanh"]},atan:{name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(0.5))"],seealso:["tan","acos","asin"]},atanh:{name:"atanh",category:"Trigonometry",syntax:["atanh(x)"],description:"Calculate the hyperbolic arctangent of a value, defined as `atanh(x) = ln((1 + x)/(1 - x)) / 2`.",examples:["atanh(0.5)"],seealso:["acosh","asinh"]},atan2:{name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]},cos:{name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]},cosh:{name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]},cot:{name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]},coth:{name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]},csc:{name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]},csch:{name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]},sec:{name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]},sech:{name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]},sin:{name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]},sinh:{name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]},tan:{name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]},tanh:{name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]},to:{name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]},clone:{name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables, and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]},format:{name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]},bin:{name:"bin",category:"Utils",syntax:["bin(value)"],description:"Format a number as binary",examples:["bin(2)"],seealso:["oct","hex"]},oct:{name:"oct",category:"Utils",syntax:["oct(value)"],description:"Format a number as octal",examples:["oct(56)"],seealso:["bin","hex"]},hex:{name:"hex",category:"Utils",syntax:["hex(value)"],description:"Format a number as hexadecimal",examples:["hex(240)"],seealso:["bin","oct"]},isNaN:{name:"isNaN",category:"Utils",syntax:["isNaN(x)"],description:"Test whether a value is NaN (not a number)",examples:["isNaN(2)","isNaN(0 / 0)","isNaN(NaN)","isNaN(Infinity)"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isInteger:{name:"isInteger",category:"Utils",syntax:["isInteger(x)"],description:"Test whether a value is an integer number.",examples:["isInteger(2)","isInteger(3.5)","isInteger([3, 0.5, -2])"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isNegative:{name:"isNegative",category:"Utils",syntax:["isNegative(x)"],description:"Test whether a value is negative: smaller than zero.",examples:["isNegative(2)","isNegative(0)","isNegative(-4)","isNegative([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isPositive","isZero"]},isNumeric:{name:"isNumeric",category:"Utils",syntax:["isNumeric(x)"],description:"Test whether a value is a numeric value. Returns true when the input is a number, BigNumber, Fraction, or boolean.",examples:["isNumeric(2)",'isNumeric("2")','hasNumericValue("2")',"isNumeric(0)","isNumeric(bignumber(500))","isNumeric(fraction(0.125))","isNumeric(2 + 3i)",'isNumeric([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","hasNumericValue"]},hasNumericValue:{name:"hasNumericValue",category:"Utils",syntax:["hasNumericValue(x)"],description:"Test whether a value is an numeric value. In case of a string, true is returned if the string contains a numeric value.",examples:["hasNumericValue(2)",'hasNumericValue("2")','isNumeric("2")',"hasNumericValue(0)","hasNumericValue(bignumber(500))","hasNumericValue(fraction(0.125))","hasNumericValue(2 + 3i)",'hasNumericValue([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","isNumeric"]},isPositive:{name:"isPositive",category:"Utils",syntax:["isPositive(x)"],description:"Test whether a value is positive: larger than zero.",examples:["isPositive(2)","isPositive(0)","isPositive(-4)","isPositive([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isPrime:{name:"isPrime",category:"Utils",syntax:["isPrime(x)"],description:"Test whether a value is prime: has no divisors other than itself and one.",examples:["isPrime(3)","isPrime(-2)","isPrime([2, 17, 100])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isZero:{name:"isZero",category:"Utils",syntax:["isZero(x)"],description:"Test whether a value is zero.",examples:["isZero(2)","isZero(0)","isZero(-4)","isZero([3, 0, -2, 0])"],seealso:["isInteger","isNumeric","isNegative","isPositive"]},print:{name:"print",category:"Utils",syntax:["print(template, values)","print(template, values, precision)"],description:"Interpolate values into a string template.",examples:['print("Lucy is $age years old", {age: 5})','print("The value of pi is $pi", {pi: pi}, 3)','print("Hello, $user.name!", {user: {name: "John"}})','print("Values: $1, $2, $3", [6, 9, 4])'],seealso:["format"]},typeOf:{name:"typeOf",category:"Utils",syntax:["typeOf(x)"],description:"Get the type of a variable.",examples:["typeOf(3.5)","typeOf(2 - 4i)","typeOf(45 deg)",'typeOf("hello world")'],seealso:["getMatrixDataType"]},numeric:{name:"numeric",category:"Utils",syntax:["numeric(x)"],description:"Convert a numeric input to a specific numeric type: number, BigNumber, bigint, or Fraction.",examples:['numeric("4")','numeric("4", "number")','numeric("4", "bigint")','numeric("4", "BigNumber")','numeric("4", "Fraction")','numeric(4, "Fraction")','numeric(fraction(2, 5), "number")'],seealso:["number","bigint","fraction","bignumber","string","format"]}},K0="help",X0=ZU(K0,["typed","mathWithTransform","Help"],(e=>{var{typed:t,mathWithTransform:n,Help:r}=e;return t(K0,{any:function(e){var t,a=e;if("string"!==typeof e)for(t in n)if($U(n,t)&&e===n[t]){a=t;break}var i=WP(H0,a);if(!i){var o="function"===typeof a?a.name:a;throw new Error('No documentation found on "'+o+'"')}return new r(i)}})})),Y0="chain",$0=ZU(Y0,["typed","Chain"],(e=>{var{typed:t,Chain:n}=e;return t(Y0,{"":function(){return new n},any:function(e){return new n(e)}})})),Z0=ZU("det",["typed","matrix","subtractScalar","multiply","divideScalar","isZero","unaryMinus"],(e=>{var{typed:t,matrix:n,subtractScalar:r,multiply:a,divideScalar:i,isZero:o,unaryMinus:s}=e;return t("det",{any:function(e){return qU(e)},"Array | Matrix":function(e){var t;switch((t=oU(e)?e.size():Array.isArray(e)?(e=n(e)).size():[]).length){case 0:return qU(e);case 1:if(1===t[0])return qU(e.valueOf()[0]);if(0===t[0])return 1;throw new RangeError("Matrix must be square (size: "+nj(t)+")");case 2:var u=t[0],c=t[1];if(u===c)return function(e,t){if(1===t)return qU(e[0][0]);if(2===t)return r(a(e[0][0],e[1][1]),a(e[1][0],e[0][1]));for(var n=!1,u=new Array(t).fill(0).map(((e,t)=>t)),c=0;c<t;c++){var l=u[c];if(o(e[l][c])){var p=void 0;for(p=c+1;p<t;p++)if(!o(e[u[p]][c])){l=u[p],u[p]=u[c],u[c]=l,n=!n;break}if(p===t)return e[l][c]}for(var h=e[l][c],d=0===c?1:e[u[c-1]][c-1],f=c+1;f<t;f++)for(var m=u[f],g=c+1;g<t;g++)e[m][g]=i(r(a(e[m][g],h),a(e[m][c],e[l][g])),d)}var y=e[u[t-1]][t-1];return n?s(y):y}(e.clone().valueOf(),u);if(0===c)return 1;throw new RangeError("Matrix must be square (size: "+nj(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+nj(t)+")")}}})})),Q0=ZU("inv",["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],(e=>{var{typed:t,matrix:n,divideScalar:r,addScalar:a,multiply:i,unaryMinus:o,det:s,identity:u,abs:c}=e;return t("inv",{"Array | Matrix":function(e){var t=oU(e)?e.size():uj(e);switch(t.length){case 1:if(1===t[0])return oU(e)?n([r(1,e.valueOf()[0])]):[r(1,e[0])];throw new RangeError("Matrix must be square (size: "+nj(t)+")");case 2:var a=t[0],i=t[1];if(a===i)return oU(e)?n(l(e.valueOf(),a,i),e.storage()):l(e,a,i);throw new RangeError("Matrix must be square (size: "+nj(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+nj(t)+")")}},any:function(e){return r(1,e)}});function l(e,t,n){var l,p,h,d,f;if(1===t){if(0===(d=e[0][0]))throw Error("Cannot calculate inverse, determinant is zero");return[[r(1,d)]]}if(2===t){var m=s(e);if(0===m)throw Error("Cannot calculate inverse, determinant is zero");return[[r(e[1][1],m),r(o(e[0][1]),m)],[r(o(e[1][0]),m),r(e[0][0],m)]]}var g=e.concat();for(l=0;l<t;l++)g[l]=g[l].concat();for(var y=u(t).valueOf(),v=0;v<n;v++){var b=c(g[v][v]),x=v;for(l=v+1;l<t;)c(g[l][v])>b&&(b=c(g[l][v]),x=l),l++;if(0===b)throw Error("Cannot calculate inverse, determinant is zero");(l=x)!==v&&(f=g[v],g[v]=g[l],g[l]=f,f=y[v],y[v]=y[l],y[l]=f);var w=g[v],N=y[v];for(l=0;l<t;l++){var S=g[l],k=y[l];if(l!==v){if(0!==S[v]){for(h=r(o(S[v]),w[v]),p=v;p<n;p++)S[p]=a(S[p],i(h,w[p]));for(p=0;p<n;p++)k[p]=a(k[p],i(h,N[p]))}}else{for(h=w[v],p=v;p<n;p++)S[p]=r(S[p],h);for(p=0;p<n;p++)k[p]=r(k[p],h)}}}return y}})),J0="pinv",e1=ZU(J0,["typed","matrix","inv","deepEqual","equal","dotDivide","dot","ctranspose","divideScalar","multiply","add","Complex"],(e=>{var{typed:t,matrix:n,inv:r,deepEqual:a,equal:i,dotDivide:o,dot:s,ctranspose:u,divideScalar:c,multiply:l,add:p,Complex:h}=e;return t(J0,{"Array | Matrix":function(e){var t=oU(e)?e.size():uj(e);switch(t.length){case 1:return m(e)?u(e):1===t[0]?r(e):o(u(e),s(e,e));case 2:if(m(e))return u(e);var a=t[0],i=t[1];if(a===i)try{return r(e)}catch(r5){if(!(r5 instanceof Error&&r5.message.match(/Cannot calculate inverse, determinant is zero/)))throw r5}return oU(e)?n(d(e.valueOf(),a,i),e.storage()):d(e,a,i);default:throw new RangeError("Matrix must be two dimensional (size: "+nj(t)+")")}},any:function(e){return i(e,0)?qU(e):c(1,e)}});function d(e,t,n){var{C:a,F:i}=function(e,t,n){var r=function(e,t,n){for(var r=qU(e),a=0,i=0;i<t;i++){if(n<=a)return r;for(var s=i;f(r[s][a]);)if(t===++s&&(s=i,n===++a))return r;[r[s],r[i]]=[r[i],r[s]];for(var u=r[i][a],c=0;c<n;c++)r[i][c]=o(r[i][c],u);for(var h=0;h<t;h++)if(h!==i){u=r[h][a];for(var d=0;d<n;d++)r[h][d]=p(r[h][d],l(-1,l(u,r[i][d])))}a++}return r}(e,t,n),a=e.map(((e,n)=>e.filter(((e,n)=>n<t&&!f(s(r[n],r[n])))))),i=r.filter(((e,t)=>!f(s(r[t],r[t]))));return{C:a,F:i}}(e,t,n),c=l(r(l(u(a),a)),u(a)),h=l(u(i),r(l(i,u(i))));return l(h,c)}function f(e){return i(p(e,h(1,1)),p(0,h(1,1)))}function m(e){return a(p(e,h(1,1)),p(l(e,0),h(1,1)))}}));function t1(e){var{addScalar:t,subtract:n,flatten:r,multiply:a,multiplyScalar:i,divideScalar:o,sqrt:s,abs:u,bignumber:c,diag:l,size:p,reshape:h,inv:d,qr:f,usolve:m,usolveAll:g,equal:y,complex:v,larger:b,smaller:x,matrixFromColumns:w,dot:N}=e;function S(e,r,a,o){var u=t(e,o),c=n(i(e,o),i(r,a)),l=i(u,.5),p=i(s(n(i(u,u),i(4,c))),.5);return[t(l,p),n(l,p)]}function k(e,t,r,a,i,o,s,l){var p="BigNumber"===l,h="Complex"===l,d=p?c(0):h?v(0):0,f=p?c(1):h?v(1):1;if(x(u(r),s))return[[f,d],[d,f]];if(b(u(n(i,o)),s))return[[n(i,a),n(o,a)],[r,r]];var m=n(e,i),g=n(a,i);return x(u(t),s)&&x(u(g),s)?[[m,f],[r,d]]:[[t,d],[g,f]]}function E(e,t){for(var n=0;n<e.length;n++)e[n].push(...Array(t-e[n].length).fill(0));for(var r=e.length;r<t;r++)e.push(Array(t).fill(0)),e[r][r]=1;return e}function C(e,t,n){for(var r=0;r<e.length;r++)if(n(e[r],t))return r;return-1}function T(e,t,n,r,a){for(var i,o="BigNumber"===a?c(1e3):1e3,s=0;s<5;++s){i=D(t,n,a);try{i=m(e,i)}catch(l){continue}if(b(A(i),o))break}if(s>=5)return null;for(s=0;;){var u=m(e,i);if(x(A(I(i,[u])),r))break;if(++s>=10)return null;i=F(u)}return i}function D(e,t,n){var r="BigNumber"===n,a="Complex"===n,i=Array(e).fill(0).map((e=>2*Math.random()-1));return r&&(i=i.map((e=>c(e)))),a&&(i=i.map((e=>v(e)))),F(i=I(i,t),n)}function I(e,t){var r=p(e);for(var i of t)i=h(i,r),e=n(e,a(o(N(i,e),N(i,i)),i));return e}function A(e){return u(s(N(e,e)))}function F(e,t){var n="Complex"===t,r="BigNumber"===t?c(1):n?v(1):1;return a(o(r,A(e)),e)}return function(e,s,p,h){var m=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],w=function(e,n,r,a,s){var p,h="BigNumber"===a,d="Complex"===a,f=h?c(0):0,m=h?c(1):d?v(1):1,g=h?c(1):1,w=h?c(10):2,N=i(w,w);s&&(p=Array(n).fill(m));var S=!1;for(;!S;){S=!0;for(var k=0;k<n;k++){for(var E=f,C=f,T=0;T<n;T++)k!==T&&(E=t(E,u(e[T][k])),C=t(C,u(e[k][T])));if(!y(E,0)&&!y(C,0)){for(var D=g,I=E,A=o(C,w),F=i(C,w);x(I,A);)I=i(I,N),D=i(D,w);for(;b(I,F);)I=o(I,N),D=o(D,w);if(x(o(t(I,C),D),i(t(E,C),.95))){S=!1;for(var _=o(1,D),M=0;M<n;M++)k!==M&&(e[k][M]=i(e[k][M],_),e[M][k]=i(e[M][k],D));s&&(p[k]=i(p[k],_))}}}}return s?l(p):null}(e,s,0,h,m);!function(e,r,a,s,l,p){var h="BigNumber"===s,d="Complex"===s,f=h?c(0):d?v(0):0;h&&(a=c(a));for(var m=0;m<r-2;m++){for(var g=0,y=f,b=m+1;b<r;b++){var w=e[b][m];x(u(y),u(w))&&(y=w,g=b)}if(!x(u(y),a)){if(g!==m+1){var N=e[g];e[g]=e[m+1],e[m+1]=N;for(var S=0;S<r;S++){var k=e[S][g];e[S][g]=e[S][m+1],e[S][m+1]=k}if(l){var E=p[g];p[g]=p[m+1],p[m+1]=E}}for(var C=m+2;C<r;C++){var T=o(e[C][m],y);if(0!==T){for(var D=0;D<r;D++)e[C][D]=n(e[C][D],i(T,e[m+1][D]));for(var I=0;I<r;I++)e[I][m+1]=t(e[I][m+1],i(T,e[I][C]));if(l)for(var A=0;A<r;A++)p[C][A]=n(p[C][A],i(T,p[m+1][A]))}}}}}(e,s,p,h,m,w);var{values:N,C:D}=function(e,r,i,o,s){var p="BigNumber"===o,h="Complex"===o,d=p?c(1):h?v(1):1;p&&(i=c(i));var m=qU(e),g=[],y=r,b=[],w=s?l(Array(r).fill(d)):void 0,N=s?l(Array(y).fill(d)):void 0,C=0;for(;C<=100;){C+=1;for(var T=m[y-1][y-1],D=0;D<y;D++)m[D][D]=n(m[D][D],T);var{Q:I,R:A}=f(m);m=a(A,I);for(var F=0;F<y;F++)m[F][F]=t(m[F][F],T);if(s&&(N=a(N,I)),1===y||x(u(m[y-1][y-2]),i)){C=0,g.push(m[y-1][y-1]),s&&(b.unshift([[1]]),E(N,r),w=a(w,N),y>1&&(N=l(Array(y-1).fill(d)))),y-=1,m.pop();for(var _=0;_<y;_++)m[_].pop()}else if(2===y||x(u(m[y-2][y-3]),i)){C=0;var M=S(m[y-2][y-2],m[y-2][y-1],m[y-1][y-2],m[y-1][y-1]);g.push(...M),s&&(b.unshift(k(m[y-2][y-2],m[y-2][y-1],m[y-1][y-2],m[y-1][y-1],M[0],M[1],i,o)),E(N,r),w=a(w,N),y>2&&(N=l(Array(y-2).fill(d)))),y-=2,m.pop(),m.pop();for(var O=0;O<y;O++)m[O].pop(),m[O].pop()}if(0===y)break}if(g.sort(((e,t)=>+n(u(e),u(t)))),C>100){var R=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+g.join(", "));throw R.values=g,R.vectors=[],R}var z=s?a(w,function(e,t){for(var n=[],r=0;r<t;r++)n[r]=Array(t).fill(0);var a=0;for(var i of e){for(var o=i.length,s=0;s<o;s++)for(var u=0;u<o;u++)n[a+s][a+u]=i[s][u];a+=o}return n}(b,r)):void 0;return{values:g,C:z}}(e,s,p,h,m);if(m){var I=function(e,t,i,o,s,u,p){var h=d(i),f=a(h,e,i),m="BigNumber"===p,b="Complex"===p,x=m?c(0):b?v(0):0,w=m?c(1):b?v(1):1,N=[],S=[];for(var k of s){var E=C(N,k,y);-1===E?(N.push(k),S.push(1)):S[E]+=1}for(var D=[],I=N.length,A=Array(t).fill(x),F=l(Array(t).fill(w)),_=function(){var e=N[M],s=n(f,a(e,F)),c=g(s,A);for(c.shift();c.length<S[M];){var l=T(s,t,c,u,p);if(null===l)break;c.push(l)}var h=a(d(o),i);c=c.map((e=>a(h,e))),D.push(...c.map((t=>({value:e,vector:r(t)}))))},M=0;M<I;M++)_();return D}(e,s,D,w,N,p,h);return{values:N,eigenvectors:I}}return{values:N}}}function n1(e){var{config:t,addScalar:n,subtract:r,abs:a,atan:i,cos:o,sin:s,multiplyScalar:u,inv:c,bignumber:l,multiply:p,add:h}=e;function d(e,n,r){var a=n-e;return Math.abs(a)<=t.relTol?Math.PI/4:.5*Math.atan(2*r/(n-e))}function f(e,n,o){var s=r(n,e);return a(s)<=t.relTol?l(-1).acos().div(4):u(.5,i(p(2,o,c(s))))}function m(e,t,n,r){for(var a=e.length,i=Math.cos(t),o=Math.sin(t),s=Array(a).fill(0),u=Array(a).fill(0),c=0;c<a;c++)s[c]=i*e[c][n]-o*e[c][r],u[c]=o*e[c][n]+i*e[c][r];for(var l=0;l<a;l++)e[l][n]=s[l],e[l][r]=u[l];return e}function g(e,t,a,i){for(var c=e.length,p=o(t),h=s(t),d=Array(c).fill(l(0)),f=Array(c).fill(l(0)),m=0;m<c;m++)d[m]=r(u(p,e[m][a]),u(h,e[m][i])),f[m]=n(u(h,e[m][a]),u(p,e[m][i]));for(var g=0;g<c;g++)e[g][a]=d[g],e[g][i]=f[g];return e}function y(e,t,a,i){for(var c=e.length,d=l(o(t)),f=l(s(t)),m=u(d,d),g=u(f,f),y=Array(c).fill(l(0)),v=Array(c).fill(l(0)),b=p(l(2),d,f,e[a][i]),x=n(r(u(m,e[a][a]),b),u(g,e[i][i])),w=h(u(g,e[a][a]),b,u(m,e[i][i])),N=0;N<c;N++)y[N]=r(u(d,e[a][N]),u(f,e[i][N])),v[N]=n(u(f,e[a][N]),u(d,e[i][N]));e[a][a]=x,e[i][i]=w,e[a][i]=l(0),e[i][a]=l(0);for(var S=0;S<c;S++)S!==a&&S!==i&&(e[a][S]=y[S],e[S][a]=y[S],e[i][S]=v[S],e[S][i]=v[S]);return e}function v(e,t,n,r){for(var a=e.length,i=Math.cos(t),o=Math.sin(t),s=i*i,u=o*o,c=Array(a).fill(0),l=Array(a).fill(0),p=s*e[n][n]-2*i*o*e[n][r]+u*e[r][r],h=u*e[n][n]+2*i*o*e[n][r]+s*e[r][r],d=0;d<a;d++)c[d]=i*e[n][d]-o*e[r][d],l[d]=o*e[n][d]+i*e[r][d];e[n][n]=p,e[r][r]=h,e[n][r]=0,e[r][n]=0;for(var f=0;f<a;f++)f!==n&&f!==r&&(e[n][f]=c[f],e[f][n]=c[f],e[r][f]=l[f],e[f][r]=l[f]);return e}function b(e){for(var t=e.length,n=0,r=[0,1],a=0;a<t;a++)for(var i=a+1;i<t;i++)Math.abs(n)<Math.abs(e[a][i])&&(n=Math.abs(e[a][i]),r=[a,i]);return[r,n]}function x(e){for(var t=e.length,n=0,r=[0,1],i=0;i<t;i++)for(var o=i+1;o<t;o++)a(n)<a(e[i][o])&&(n=a(e[i][o]),r=[i,o]);return[r,n]}function w(e,t,n){var r,i=e.length,o=Array(i);if(n){r=Array(i);for(var s=0;s<i;s++)r[s]=Array(i)}for(var u=0;u<i;u++){for(var c=0,l=e[0],p=0;p<e.length;p++)a(e[p])<a(l)&&(l=e[c=p]);if(o[u]=e.splice(c,1)[0],n)for(var h=0;h<i;h++)r[u][h]=t[h][c],t[h].splice(c,1)}if(!n)return{values:o};var d=r.map(((e,t)=>({value:o[t],vector:e})));return{values:o,eigenvectors:d}}return function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.relTol,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if("number"===i)return function(e,t,n){var r,a,i=e.length,o=Math.abs(t/i);if(n){a=new Array(i);for(var s=0;s<i;s++)a[s]=Array(i).fill(0),a[s][s]=1}var u=b(e);for(;Math.abs(u[1])>=Math.abs(o);){var c=u[0][0],l=u[0][1];e=v(e,r=d(e[c][c],e[l][l],e[c][l]),c,l),n&&(a=m(a,r,c,l)),u=b(e)}for(var p=Array(i).fill(0),h=0;h<i;h++)p[h]=e[h][h];return w(qU(p),a,n)}(e,r,o);if("BigNumber"===i)return function(e,t,n){var r,i,o=e.length,s=a(t/o);if(n){i=new Array(o);for(var u=0;u<o;u++)i[u]=Array(o).fill(0),i[u][u]=1}var c=x(e);for(;a(c[1])>=a(s);){var l=c[0][0],p=c[0][1];e=y(e,r=f(e[l][l],e[p][p],e[l][p]),l,p),n&&(i=g(i,r,l,p)),c=x(e)}for(var h=Array(o).fill(0),d=0;d<o;d++)h[d]=e[d][d];return w(qU(h),i,n)}(e,r,o);throw TypeError("Unsupported data type: "+i)}}var r1=ZU("eigs",["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","size","reshape","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],(e=>{var{config:t,typed:n,matrix:r,addScalar:a,subtract:i,equal:o,abs:s,atan:u,cos:c,sin:l,multiplyScalar:p,divideScalar:h,inv:d,bignumber:f,multiply:m,add:g,larger:y,column:v,flatten:b,number:x,complex:w,sqrt:N,diag:S,size:k,reshape:E,qr:C,usolve:T,usolveAll:D,im:I,re:A,smaller:F,matrixFromColumns:_,dot:M}=e,O=n1({config:t,addScalar:a,subtract:i,column:v,flatten:b,equal:o,abs:s,atan:u,cos:c,sin:l,multiplyScalar:p,inv:d,bignumber:f,complex:w,multiply:m,add:g}),R=t1({config:t,addScalar:a,subtract:i,multiply:m,multiplyScalar:p,flatten:b,divideScalar:h,sqrt:N,abs:s,bignumber:f,diag:S,size:k,reshape:E,qr:C,inv:d,usolve:T,usolveAll:D,equal:o,complex:w,larger:y,smaller:F,matrixFromColumns:_,dot:M});return n("eigs",{Array:function(e){return z(r(e))},"Array, number|BigNumber":function(e,t){return z(r(e),{precision:t})},"Array, Object":(e,t)=>z(r(e),t),Matrix:function(e){return z(e,{matricize:!0})},"Matrix, number|BigNumber":function(e,t){return z(e,{precision:t,matricize:!0})},"Matrix, Object":function(e,t){var n={matricize:!0};return zP(n,t),z(e,n)}});function z(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!("eigenvectors"in a)||a.eigenvectors,u=function(e,t,n){var r=e.toArray(),a=e.size();if(2!==a.length||a[0]!==a[1])throw new RangeError("Matrix must be square (size: ".concat(nj(a),")"));var o=a[0];if(function(e,t,n){for(var r=0;r<t;r++)for(var a=0;a<t;a++)if(y(f(s(I(e[r][a]))),n))return!1;return!0}(r,o,t)&&(function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)e[n][r]=A(e[n][r])}(r,o),function(e,t,n){for(var r=0;r<t;r++)for(var a=r;a<t;a++)if(y(f(s(i(e[r][a],e[a][r]))),n))return!1;return!0}(r,o,t))){var u=B(e,r,o);return O(r,o,t,u,n)}var c=B(e,r,o);return R(r,o,t,c,n)}(e,null!==(n=a.precision)&&void 0!==n?n:t.relTol,o);return a.matricize&&(u.values=r(u.values),o&&(u.eigenvectors=u.eigenvectors.map((e=>{var{value:t,vector:n}=e;return{value:t,vector:r(n)}})))),o&&Object.defineProperty(u,"vectors",{enumerable:!1,get:()=>{throw new Error("eigs(M).vectors replaced with eigs(M).eigenvectors")}}),u}function B(e,t,n){var r=e.datatype();if("number"===r||"BigNumber"===r||"Complex"===r)return r;for(var a=!1,i=!1,o=!1,s=0;s<n;s++)for(var u=0;u<n;u++){var c=t[s][u];if(QP(c)||nU(c))a=!0;else if(JP(c))i=!0;else{if(!tU(c))throw TypeError("Unsupported type in Matrix: "+VU(c));o=!0}}if(i&&o&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),o){for(var l=0;l<n;l++)for(var p=0;p<n;p++)t[l][p]=w(t[l][p]);return"Complex"}if(i){for(var h=0;h<n;h++)for(var d=0;d<n;d++)t[h][d]=f(t[h][d]);return"BigNumber"}if(a){for(var m=0;m<n;m++)for(var g=0;g<n;g++)t[m][g]=x(t[m][g]);return"number"}throw TypeError("Matrix contains unsupported types only.")}})),a1="expm",i1=ZU(a1,["typed","abs","add","identity","inv","multiply"],(e=>{var{typed:t,abs:n,add:r,identity:a,inv:i,multiply:o}=e;return t(a1,{Matrix:function(e){var t=e.size();if(2!==t.length||t[0]!==t[1])throw new RangeError("Matrix must be square (size: "+nj(t)+")");for(var u=t[0],c=function(e){for(var t=e.size()[0],r=0,a=0;a<t;a++){for(var i=0,o=0;o<t;o++)i+=n(e.get([a,o]));r=Math.max(i,r)}return r}(e),l=function(e,t){for(var n=30,r=0;r<n;r++)for(var a=0;a<=r;a++){var i=r-a;if(s(e,a,i)<t)return{q:a,j:i}}throw new Error("Could not find acceptable parameters to compute the matrix exponential (try increasing maxSearchSize in expm.js)")}(c,1e-15),p=l.q,h=l.j,d=o(e,Math.pow(2,-h)),f=a(u),m=a(u),g=1,y=d,v=-1,b=1;b<=p;b++)b>1&&(y=o(y,d),v=-v),f=r(f,o(g=g*(p-b+1)/((2*p-b+1)*b),y)),m=r(m,o(g*v,y));for(var x=o(i(m),f),w=0;w<h;w++)x=o(x,x);return cU(e)?e.createSparseMatrix(x):x}});function s(e,t,n){for(var r=1,a=2;a<=t;a++)r*=a;for(var i=r,o=t+1;o<=2*t;o++)i*=o;var s=i*(2*t+1);return 8*Math.pow(e/Math.pow(2,n),2*t)*r*r/(i*s)}})),o1="sqrtm",s1=ZU(o1,["typed","abs","add","multiply","map","sqrt","subtract","inv","size","max","identity"],(e=>{var{typed:t,abs:n,add:r,multiply:a,map:i,sqrt:o,subtract:s,inv:u,size:c,max:l,identity:p}=e,h=1e-6;function d(e){var t,i=0,o=e,d=p(c(e));do{var f=o;if(o=a(.5,r(f,u(d))),d=a(.5,r(d,u(f))),(t=l(n(s(o,f))))>h&&++i>1e3)throw new Error("computing square root of matrix: iterative method could not converge")}while(t>h);return o}return t(o1,{"Array | Matrix":function(e){var t=oU(e)?e.size():uj(e);switch(t.length){case 1:if(1===t[0])return i(e,o);throw new RangeError("Matrix must be square (size: "+nj(t)+")");case 2:if(t[0]===t[1])return d(e);throw new RangeError("Matrix must be square (size: "+nj(t)+")");default:throw new RangeError("Matrix must be at most two dimensional (size: "+nj(t)+")")}}})})),u1="sylvester",c1=ZU(u1,["typed","schur","matrixFromColumns","matrix","multiply","range","concat","transpose","index","subset","add","subtract","identity","lusolve","abs"],(e=>{var{typed:t,schur:n,matrixFromColumns:r,matrix:a,multiply:i,range:o,concat:s,transpose:u,index:c,subset:l,add:p,subtract:h,identity:d,lusolve:f,abs:m}=e;return t(u1,{"Matrix, Matrix, Matrix":g,"Array, Matrix, Matrix":function(e,t,n){return g(a(e),t,n)},"Array, Array, Matrix":function(e,t,n){return g(a(e),a(t),n)},"Array, Matrix, Array":function(e,t,n){return g(a(e),t,a(n))},"Matrix, Array, Matrix":function(e,t,n){return g(e,a(t),n)},"Matrix, Array, Array":function(e,t,n){return g(e,a(t),a(n))},"Matrix, Matrix, Array":function(e,t,n){return g(e,t,a(n))},"Array, Array, Array":function(e,t,n){return g(a(e),a(t),a(n)).toArray()}});function g(e,t,g){for(var y=t.size()[0],v=e.size()[0],b=n(e),x=b.T,w=b.U,N=n(i(-1,t)),S=N.T,k=N.U,E=i(i(u(w),g),k),C=o(0,v),T=[],D=(e,t)=>s(e,t,1),I=(e,t)=>s(e,t,0),A=0;A<y;A++)if(A<y-1&&m(l(S,c(A+1,A)))>1e-5){for(var F=I(l(E,c(C,A)),l(E,c(C,A+1))),_=0;_<A;_++)F=p(F,I(i(T[_],l(S,c(_,A))),i(T[_],l(S,c(_,A+1)))));var M=i(d(v),i(-1,l(S,c(A,A)))),O=i(d(v),i(-1,l(S,c(A+1,A)))),R=i(d(v),i(-1,l(S,c(A,A+1)))),z=i(d(v),i(-1,l(S,c(A+1,A+1)))),B=I(D(p(x,M),O),D(R,p(x,z))),L=f(B,F);T[A]=L.subset(c(o(0,v),0)),T[A+1]=L.subset(c(o(v,2*v),0)),A++}else{for(var P=l(E,c(C,A)),U=0;U<A;U++)P=p(P,i(T[U],l(S,c(U,A))));var W=l(S,c(A,A)),V=h(x,i(W,d(v)));T[A]=f(V,P)}var q=a(r(...T));return i(w,i(q,u(k)))}})),l1="schur",p1=ZU(l1,["typed","matrix","identity","multiply","qr","norm","subtract"],(e=>{var{typed:t,matrix:n,identity:r,multiply:a,qr:i,norm:o,subtract:s}=e;return t(l1,{Array:function(e){var t=u(n(e));return{U:t.U.valueOf(),T:t.T.valueOf()}},Matrix:function(e){return u(e)}});function u(e){var t,n=e.size()[0],u=e,c=r(n),l=0;do{t=u;var p=i(u),h=p.Q,d=p.R;if(u=a(d,h),c=a(c,h),l++>100)break}while(o(s(u,t))>1e-4);return{U:c,T:u}}})),h1="lyap",d1=ZU(h1,["typed","matrix","sylvester","multiply","transpose"],(e=>{var{typed:t,matrix:n,sylvester:r,multiply:a,transpose:i}=e;return t(h1,{"Matrix, Matrix":function(e,t){return r(e,i(e),a(-1,t))},"Array, Matrix":function(e,t){return r(n(e),i(n(e)),a(-1,t))},"Matrix, Array":function(e,t){return r(e,i(n(e)),n(a(-1,t)))},"Array, Array":function(e,t){return r(n(e),i(n(e)),n(a(-1,t))).toArray()}})})),f1=ZU("divide",["typed","matrix","multiply","equalScalar","divideScalar","inv"],(e=>{var{typed:t,matrix:n,multiply:r,equalScalar:a,divideScalar:i,inv:o}=e,s=NH({typed:t,equalScalar:a}),u=kH({typed:t});return t("divide",jU({"Array | Matrix, Array | Matrix":function(e,t){return r(e,o(t))},"DenseMatrix, any":function(e,t){return u(e,t,i,!1)},"SparseMatrix, any":function(e,t){return s(e,t,i,!1)},"Array, any":function(e,t){return u(n(e),t,i,!1).valueOf()},"any, Array | Matrix":function(e,t){return r(e,o(t))}},i.signatures))})),m1="distance",g1=ZU(m1,["typed","addScalar","subtractScalar","divideScalar","multiplyScalar","deepEqual","sqrt","abs"],(e=>{var{typed:t,addScalar:n,subtractScalar:r,multiplyScalar:a,divideScalar:i,deepEqual:o,sqrt:s,abs:u}=e;return t(m1,{"Array, Array, Array":function(e,t,n){if(2===e.length&&2===t.length&&2===n.length){if(!l(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!l(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!l(n))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(o(t,n))throw new TypeError("LinePoint1 should not be same with LinePoint2");var i=r(n[1],t[1]),s=r(t[0],n[0]),u=r(a(n[0],t[1]),a(t[0],n[1]));return m(e[0],e[1],i,s,u)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(e,t,n){if(2===Object.keys(e).length&&2===Object.keys(t).length&&2===Object.keys(n).length){if(!l(e))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!l(t))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers or BigNumbers");if(!l(n))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers or BigNumbers");if(o(f(t),f(n)))throw new TypeError("LinePoint1 should not be same with LinePoint2");if("pointX"in e&&"pointY"in e&&"lineOnePtX"in t&&"lineOnePtY"in t&&"lineTwoPtX"in n&&"lineTwoPtY"in n){var i=r(n.lineTwoPtY,t.lineOnePtY),s=r(t.lineOnePtX,n.lineTwoPtX),u=r(a(n.lineTwoPtX,t.lineOnePtY),a(t.lineOnePtX,n.lineTwoPtY));return m(e.pointX,e.pointY,i,s,u)}throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(e,t){if(2===e.length&&3===t.length){if(!l(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!p(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");return m(e[0],e[1],t[0],t[1],t[2])}if(3===e.length&&6===t.length){if(!p(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!d(t))throw new TypeError("Array with 6 numbers or BigNumbers expected for second argument");return g(e[0],e[1],e[2],t[0],t[1],t[2],t[3],t[4],t[5])}if(e.length===t.length&&e.length>0){if(!h(e))throw new TypeError("All values of an array should be numbers or BigNumbers");if(!h(t))throw new TypeError("All values of an array should be numbers or BigNumbers");return y(e,t)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(e,t){if(2===Object.keys(e).length&&3===Object.keys(t).length){if(!l(e))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!p(t))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers or BigNumbers");if("pointX"in e&&"pointY"in e&&"xCoeffLine"in t&&"yCoeffLine"in t&&"constant"in t)return m(e.pointX,e.pointY,t.xCoeffLine,t.yCoeffLine,t.constant);throw new TypeError("Key names do not match")}if(3===Object.keys(e).length&&6===Object.keys(t).length){if(!p(e))throw new TypeError("Values of pointX, pointY and pointZ should be numbers or BigNumbers");if(!d(t))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers or BigNumbers");if("pointX"in e&&"pointY"in e&&"x0"in t&&"y0"in t&&"z0"in t&&"a"in t&&"b"in t&&"c"in t)return g(e.pointX,e.pointY,e.pointZ,t.x0,t.y0,t.z0,t.a,t.b,t.c);throw new TypeError("Key names do not match")}if(2===Object.keys(e).length&&2===Object.keys(t).length){if(!l(e))throw new TypeError("Values of pointOneX and pointOneY should be numbers or BigNumbers");if(!l(t))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers or BigNumbers");if("pointOneX"in e&&"pointOneY"in e&&"pointTwoX"in t&&"pointTwoY"in t)return y([e.pointOneX,e.pointOneY],[t.pointTwoX,t.pointTwoY]);throw new TypeError("Key names do not match")}if(3===Object.keys(e).length&&3===Object.keys(t).length){if(!p(e))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers or BigNumbers");if(!p(t))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers or BigNumbers");if("pointOneX"in e&&"pointOneY"in e&&"pointOneZ"in e&&"pointTwoX"in t&&"pointTwoY"in t&&"pointTwoZ"in t)return y([e.pointOneX,e.pointOneY,e.pointOneZ],[t.pointTwoX,t.pointTwoY,t.pointTwoZ]);throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},Array:function(e){if(!function(e){if(2===e[0].length&&c(e[0][0])&&c(e[0][1])){if(e.some((e=>2!==e.length||!c(e[0])||!c(e[1]))))return!1}else{if(!(3===e[0].length&&c(e[0][0])&&c(e[0][1])&&c(e[0][2])))return!1;if(e.some((e=>3!==e.length||!c(e[0])||!c(e[1])||!c(e[2]))))return!1}return!0}(e))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return function(e){for(var t=[],n=[],r=[],a=0;a<e.length-1;a++)for(var i=a+1;i<e.length;i++)2===e[0].length?(n=[e[a][0],e[a][1]],r=[e[i][0],e[i][1]]):3===e[0].length&&(n=[e[a][0],e[a][1],e[a][2]],r=[e[i][0],e[i][1],e[i][2]]),t.push(y(n,r));return t}(e)}});function c(e){return"number"===typeof e||JP(e)}function l(e){return e.constructor!==Array&&(e=f(e)),c(e[0])&&c(e[1])}function p(e){return e.constructor!==Array&&(e=f(e)),c(e[0])&&c(e[1])&&c(e[2])}function h(e){return Array.isArray(e)||(e=f(e)),e.every(c)}function d(e){return e.constructor!==Array&&(e=f(e)),c(e[0])&&c(e[1])&&c(e[2])&&c(e[3])&&c(e[4])&&c(e[5])}function f(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;r++)n.push(e[t[r]]);return n}function m(e,t,r,o,c){var l=u(n(n(a(r,e),a(o,t)),c)),p=s(n(a(r,r),a(o,o)));return i(l,p)}function g(e,t,o,u,c,l,p,h,d){var f=[r(a(r(c,t),d),a(r(l,o),h)),r(a(r(l,o),p),a(r(u,e),d)),r(a(r(u,e),h),a(r(c,t),p))];f=s(n(n(a(f[0],f[0]),a(f[1],f[1])),a(f[2],f[2])));var m=s(n(n(a(p,p),a(h,h)),a(d,d)));return i(f,m)}function y(e,t){for(var i=e.length,o=0,u=0,c=0;c<i;c++)u=r(e[c],t[c]),o=n(a(u,u),o);return s(o)}})),y1=ZU("intersect",["typed","config","abs","add","addScalar","matrix","multiply","multiplyScalar","divideScalar","subtract","smaller","equalScalar","flatten","isZero","isNumeric"],(e=>{var{typed:t,config:n,abs:r,add:a,addScalar:i,matrix:o,multiply:s,multiplyScalar:u,divideScalar:c,subtract:l,smaller:p,equalScalar:h,flatten:d,isZero:f,isNumeric:m}=e;return t("intersect",{"Array, Array, Array":g,"Array, Array, Array, Array":y,"Matrix, Matrix, Matrix":function(e,t,n){var r=g(e.valueOf(),t.valueOf(),n.valueOf());return null===r?null:o(r)},"Matrix, Matrix, Matrix, Matrix":function(e,t,n,r){var a=y(e.valueOf(),t.valueOf(),n.valueOf(),r.valueOf());return null===a?null:o(a)}});function g(e,t,n){if(e=v(e),t=v(t),n=v(n),!x(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!x(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!function(e){return 4===e.length&&m(e[0])&&m(e[1])&&m(e[2])&&m(e[3])}(n))throw new TypeError("Array with 4 numbers expected as third argument");return function(e,t,n,r,a,o,s,p,h,d){var f=u(e,s),m=u(r,s),g=u(t,p),y=u(a,p),v=u(n,h),b=u(o,h),x=l(l(l(d,f),g),v),w=l(l(l(i(i(m,y),b),f),g),v),N=c(x,w),S=i(e,u(N,l(r,e))),k=i(t,u(N,l(a,t))),E=i(n,u(N,l(o,n)));return[S,k,E]}(e[0],e[1],e[2],t[0],t[1],t[2],n[0],n[1],n[2],n[3])}function y(e,t,o,d){if(e=v(e),t=v(t),o=v(o),d=v(d),2===e.length){if(!b(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!b(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!b(o))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(!b(d))throw new TypeError("Array with 2 numbers or BigNumbers expected for fourth argument");return function(e,t,o,h){var d=e,m=o,g=l(d,t),y=l(m,h),v=l(u(g[0],y[1]),u(y[0],g[1]));if(f(v))return null;if(p(r(v),n.relTol))return null;var b=u(y[0],d[1]),x=u(y[1],d[0]),w=u(y[0],m[1]),N=u(y[1],m[0]),S=c(i(l(l(b,x),w),N),v);return a(s(g,S),d)}(e,t,o,d)}if(3===e.length){if(!x(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!x(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!x(o))throw new TypeError("Array with 3 numbers or BigNumbers expected for third argument");if(!x(d))throw new TypeError("Array with 3 numbers or BigNumbers expected for fourth argument");return function(e,t,n,r,a,o,s,p,d,m,g,y){var v=w(e,s,m,s,t,p,g,p,n,d,y,d),b=w(m,s,r,e,g,p,a,t,y,d,o,n),x=w(e,s,r,e,t,p,a,t,n,d,o,n),N=w(m,s,m,s,g,p,g,p,y,d,y,d),S=w(r,e,r,e,a,t,a,t,o,n,o,n),k=l(u(v,b),u(x,N)),E=l(u(S,N),u(b,b));if(f(E))return null;var C=c(k,E),T=c(i(v,u(C,b)),N),D=i(e,u(C,l(r,e))),I=i(t,u(C,l(a,t))),A=i(n,u(C,l(o,n))),F=i(s,u(T,l(m,s))),_=i(p,u(T,l(g,p))),M=i(d,u(T,l(y,d)));return h(D,F)&&h(I,_)&&h(A,M)?[D,I,A]:null}(e[0],e[1],e[2],t[0],t[1],t[2],o[0],o[1],o[2],d[0],d[1],d[2])}throw new TypeError("Arrays with two or thee dimensional points expected")}function v(e){return 1===e.length?e[0]:e.length>1&&Array.isArray(e[0])&&e.every((e=>Array.isArray(e)&&1===e.length))?d(e):e}function b(e){return 2===e.length&&m(e[0])&&m(e[1])}function x(e){return 3===e.length&&m(e[0])&&m(e[1])&&m(e[2])}function w(e,t,n,r,a,o,s,c,p,h,d,f){var m=u(l(e,t),l(n,r)),g=u(l(a,o),l(s,c)),y=u(l(p,h),l(d,f));return i(i(m,g),y)}})),v1=ZU("sum",["typed","config","add","numeric"],(e=>{var{typed:t,config:n,add:r,numeric:a}=e;return t("sum",{"Array | Matrix":i,"Array | Matrix, number | BigNumber":function(e,t){try{return Kj(e,t,r)}catch(r5){throw zY(r5,"sum")}},"...":function(e){if(jj(e))throw new TypeError("Scalar values expected in function sum");return i(e)}});function i(e){var t;return Gj(e,(function(e){try{t=void 0===t?e:r(t,e)}catch(r5){throw zY(r5,"sum",e)}})),void 0===t&&(t=a(0,n.number)),"string"===typeof t&&(t=a(t,uW(t,n))),t}})),b1="cumsum",x1=ZU(b1,["typed","add","unaryPlus"],(e=>{var{typed:t,add:n,unaryPlus:r}=e;return t(b1,{Array:a,Matrix:function(e){return e.create(a(e.valueOf(),e.datatype()))},"Array, number | BigNumber":o,"Matrix, number | BigNumber":function(e,t){return e.create(o(e.valueOf(),t),e.datatype())},"...":function(e){if(jj(e))throw new TypeError("All values expected to be scalar in function cumsum");return a(e)}});function a(e){try{return i(e)}catch(r5){throw zY(r5,b1)}}function i(e){if(0===e.length)return[];for(var t=[r(e[0])],a=1;a<e.length;++a)t.push(n(t[a-1],e[a]));return t}function o(e,t){var n=uj(e);if(t<0||t>=n.length)throw new UP(t,n.length);try{return s(e,t)}catch(r5){throw zY(r5,b1)}}function s(e,t){var n,r,a;if(t<=0){var o=e[0][0];if(Array.isArray(o)){for(a=qj(e),r=[],n=0;n<a.length;n++)r[n]=s(a[n],t-1);return r}return i(e)}for(r=[],n=0;n<e.length;n++)r[n]=s(e[n],t-1);return r}})),w1="mean",N1=ZU(w1,["typed","add","divide"],(e=>{var{typed:t,add:n,divide:r}=e;return t(w1,{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(e,t){try{var a=Kj(e,t,n),i=Array.isArray(e)?uj(e):e.size();return r(a,i[t])}catch(r5){throw zY(r5,"mean")}},"...":function(e){if(jj(e))throw new TypeError("Scalar values expected in function mean");return a(e)}});function a(e){var t,a=0;if(Gj(e,(function(e){try{t=void 0===t?e:n(t,e),a++}catch(r5){throw zY(r5,"mean",e)}})),0===a)throw new Error("Cannot calculate the mean of an empty array");return r(t,a)}})),S1="median",k1=ZU(S1,["typed","add","divide","compare","partitionSelect"],(e=>{var{typed:t,add:n,divide:r,compare:a,partitionSelect:i}=e;function o(e){try{var t=(e=Sj(e.valueOf())).length;if(0===t)throw new Error("Cannot calculate median of an empty array");if(t%2===0){for(var n=t/2-1,r=i(e,n+1),o=e[n],c=0;c<n;++c)a(e[c],o)>0&&(o=e[c]);return u(o,r)}var l=i(e,(t-1)/2);return s(l)}catch(r5){throw zY(r5,"median")}}var s=t({"number | BigNumber | Complex | Unit":function(e){return e}}),u=t({"number | BigNumber | Complex | Unit, number | BigNumber | Complex | Unit":function(e,t){return r(n(e,t),2)}});return t(S1,{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(e,t){throw new Error("median(A, dim) is not yet supported")},"...":function(e){if(jj(e))throw new TypeError("Scalar values expected in function median");return o(e)}})})),E1=ZU("mad",["typed","abs","map","median","subtract"],(e=>{var{typed:t,abs:n,map:r,median:a,subtract:i}=e;return t("mad",{"Array | Matrix":o,"...":function(e){return o(e)}});function o(e){if(0===(e=Sj(e.valueOf())).length)throw new Error("Cannot calculate median absolute deviation (mad) of an empty array");try{var t=a(e);return a(r(e,(function(e){return n(i(e,t))})))}catch(r5){throw r5 instanceof TypeError&&r5.message.includes("median")?new TypeError(r5.message.replace("median","mad")):zY(r5,"mad")}}})),C1="unbiased",T1="variance",D1=ZU(T1,["typed","add","subtract","multiply","divide","apply","isNaN"],(e=>{var{typed:t,add:n,subtract:r,multiply:a,divide:i,apply:o,isNaN:s}=e;return t(T1,{"Array | Matrix":function(e){return u(e,C1)},"Array | Matrix, string":u,"Array | Matrix, number | BigNumber":function(e,t){return c(e,t,C1)},"Array | Matrix, number | BigNumber, string":c,"...":function(e){return u(e,C1)}});function u(e,t){var o,u=0;if(0===e.length)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");if(Gj(e,(function(e){try{o=void 0===o?e:n(o,e),u++}catch(r5){throw zY(r5,"variance",e)}})),0===u)throw new Error("Cannot calculate variance of an empty array");var c=i(o,u);if(o=void 0,Gj(e,(function(e){var t=r(e,c);o=void 0===o?a(t,t):n(o,a(t,t))})),s(o))return o;switch(t){case"uncorrected":return i(o,u);case"biased":return i(o,u+1);case"unbiased":var l=JP(o)?o.mul(0):0;return 1===u?l:i(o,u-1);default:throw new Error('Unknown normalization "'+t+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}function c(e,t,n){try{if(0===e.length)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");return o(e,t,(e=>u(e,n)))}catch(r5){throw zY(r5,"variance")}}})),I1="quantileSeq",A1=ZU(I1,["typed","?bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger"],(e=>{var{typed:t,bignumber:n,add:r,subtract:a,divide:i,multiply:o,partitionSelect:s,compare:u,isInteger:c,smaller:l,smallerEq:p,larger:h}=e,d=fH({typed:t,isInteger:c});return t(I1,{"Array | Matrix, number | BigNumber":(e,t)=>m(e,t,!1),"Array | Matrix, number | BigNumber, number":(e,t,n)=>f(e,t,!1,n,m),"Array | Matrix, number | BigNumber, boolean":m,"Array | Matrix, number | BigNumber, boolean, number":(e,t,n,r)=>f(e,t,n,r,m),"Array | Matrix, Array | Matrix":(e,t)=>g(e,t,!1),"Array | Matrix, Array | Matrix, number":(e,t,n)=>f(e,t,!1,n,g),"Array | Matrix, Array | Matrix, boolean":g,"Array | Matrix, Array | Matrix, boolean, number":(e,t,n,r)=>f(e,t,n,r,g)});function f(e,t,n,r,a){return d(e,r,(e=>a(e,t,n)))}function m(e,t,a){var o,s=e.valueOf();if(l(t,0))throw new Error("N/prob must be non-negative");if(p(t,1))return QP(t)?y(s,t,a):n(y(s,t,a));if(h(t,1)){if(!c(t))throw new Error("N must be a positive integer");if(h(t,4294967295))throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var u=r(t,1);o=[];for(var d=0;l(d,t);d++){var f=i(d+1,u);o.push(y(s,f,a))}return QP(t)?o:n(o)}}function g(e,t,n){for(var r=e.valueOf(),a=t.valueOf(),i=[],o=0;o<a.length;++o)i.push(y(r,a[o],n));return i}function y(e,t,n){var i=Sj(e),l=i.length;if(0===l)throw new Error("Cannot calculate quantile of an empty sequence");var p,h,d=QP(t)?t*(l-1):t.times(l-1),f=QP(t)?Math.floor(d):d.floor().toNumber(),m=QP(t)?d%1:d.minus(f);if(c(d))return n?i[d]:s(i,QP(t)?d:d.valueOf());if(n)p=i[f],h=i[f+1];else{h=s(i,f+1),p=i[f];for(var g=0;g<f;++g)u(i[g],p)>0&&(p=i[g])}return r(o(p,a(1,m)),o(h,m))}})),F1=ZU("std",["typed","map","sqrt","variance"],(e=>{var{typed:t,map:n,sqrt:r,variance:a}=e;return t("std",{"Array | Matrix":i,"Array | Matrix, string":i,"Array | Matrix, number | BigNumber":i,"Array | Matrix, number | BigNumber, string":i,"...":function(e){return i(e)}});function i(e,t){if(0===e.length)throw new SyntaxError("Function std requires one or more parameters (0 provided)");try{var i=a.apply(null,arguments);return sU(i)?n(i,r):r(i)}catch(r5){throw r5 instanceof TypeError&&r5.message.includes(" variance")?new TypeError(r5.message.replace(" variance"," std")):r5}}})),_1="corr",M1=ZU(_1,["typed","matrix","mean","sqrt","sum","add","subtract","multiply","pow","divide"],(e=>{var{typed:t,matrix:n,sqrt:r,sum:a,add:i,subtract:o,multiply:s,pow:u,divide:c}=e;return t(_1,{"Array, Array":function(e,t){return l(e,t)},"Matrix, Matrix":function(e,t){var r=l(e.toArray(),t.toArray());return Array.isArray(r)?n(r):r}});function l(e,t){var n=[];if(Array.isArray(e[0])&&Array.isArray(t[0])){if(e.length!==t.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same length.");for(var r=0;r<e.length;r++){if(e[r].length!==t[r].length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");n.push(p(e[r],t[r]))}return n}if(e.length!==t.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");return p(e,t)}function p(e,t){var n=e.length,l=a(e),p=a(t),h=e.reduce(((e,n,r)=>i(e,s(n,t[r]))),0),d=a(e.map((e=>u(e,2)))),f=a(t.map((e=>u(e,2)))),m=o(s(n,h),s(l,p)),g=r(s(o(s(n,d),u(l,2)),o(s(n,f),u(p,2))));return c(m,g)}}));function O1(e,t){if(t<e)return 1;if(t===e)return t;var n=t+e>>1;return O1(e,n)*O1(n+1,t)}function R1(e,t){if(!sW(e)||e<0)throw new TypeError("Positive integer value expected in function combinations");if(!sW(t)||t<0)throw new TypeError("Positive integer value expected in function combinations");if(t>e)throw new TypeError("k must be less than or equal to n");for(var n=e-t,r=1,a=2,i=t<n?t:n,o=t<n?n+1:t+1;o<=e;++o)for(r*=o;a<=i&&r%a===0;)r/=a,++a;return a<=i&&(r/=O1(a,i)),r}R1.signature="number, number";var z1="combinations",B1=ZU(z1,["typed"],(e=>{var{typed:t}=e;return t(z1,{"number, number":R1,"BigNumber, BigNumber":function(e,t){var n,r,a=e.constructor,i=e.minus(t),o=new a(1);if(!L1(e)||!L1(t))throw new TypeError("Positive integer value expected in function combinations");if(t.gt(e))throw new TypeError("k must be less than n in function combinations");if(n=o,t.lt(i))for(r=o;r.lte(i);r=r.plus(o))n=n.times(t.plus(r)).dividedBy(r);else for(r=o;r.lte(t);r=r.plus(o))n=n.times(i.plus(r)).dividedBy(r);return n}})}));function L1(e){return e.isInteger()&&e.gte(0)}var P1="combinationsWithRep",U1=ZU(P1,["typed"],(e=>{var{typed:t}=e;return t(P1,{"number, number":function(e,t){if(!sW(e)||e<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(!sW(t)||t<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(e<1)throw new TypeError("k must be less than or equal to n + k - 1");return t<e-1?O1(e,e+t-1)/O1(1,t):O1(t+1,e+t-1)/O1(1,e-1)},"BigNumber, BigNumber":function(e,t){var n,r,a=new(0,e.constructor)(1),i=e.minus(a);if(!W1(e)||!W1(t))throw new TypeError("Positive integer value expected in function combinationsWithRep");if(e.lt(a))throw new TypeError("k must be less than or equal to n + k - 1 in function combinationsWithRep");if(n=a,t.lt(i))for(r=a;r.lte(i);r=r.plus(a))n=n.times(t.plus(r)).dividedBy(r);else for(r=a;r.lte(t);r=r.plus(a))n=n.times(i.plus(r)).dividedBy(r);return n}})}));function W1(e){return e.isInteger()&&e.gte(0)}function V1(e){var t;if(sW(e))return e<=0?isFinite(e)?1/0:NaN:e>171?1/0:O1(1,e-1);if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*V1(1-e));if(e>=171.35)return 1/0;if(e>85){var n=e*e,r=n*e,a=r*e,i=a*e;return Math.sqrt(2*Math.PI/e)*Math.pow(e/Math.E,e)*(1+1/(12*e)+1/(288*n)-139/(51840*r)-571/(2488320*a)+163879/(209018880*i)+5246819/(75246796800*i*e))}--e,t=j1[0];for(var o=1;o<j1.length;++o)t+=j1[o]/(e+o);var s=e+q1+.5;return Math.sqrt(2*Math.PI)*Math.pow(s,e+.5)*Math.exp(-s)*t}V1.signature="number";var q1=4.7421875,j1=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],G1=.9189385332046728,H1=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];function K1(e){if(e<0)return NaN;if(0===e)return 1/0;if(!isFinite(e))return e;if(e<.5)return Math.log(Math.PI/Math.sin(Math.PI*e))-K1(1-e);for(var t=(e-=1)+5+.5,n=H1[0],r=6;r>=1;r--)n+=H1[r]/(e+r);return G1+(e+.5)*Math.log(t)-t+Math.log(n)}K1.signature="number";var X1="gamma",Y1=ZU(X1,["typed","config","multiplyScalar","pow","BigNumber","Complex"],(e=>{var{typed:t,config:n,multiplyScalar:r,pow:a,BigNumber:i,Complex:o}=e;return t(X1,{number:V1,Complex:function e(t){if(0===t.im)return V1(t.re);if(t.re<.5){var n=new o(1-t.re,-t.im),r=new o(Math.PI*t.re,Math.PI*t.im);return new o(Math.PI).div(r.sin()).div(e(n))}t=new o(t.re-1,t.im);for(var a=new o(j1[0],0),i=1;i<j1.length;++i){var s=new o(j1[i],0);a=a.add(s.div(t.add(i)))}var u=new o(t.re+q1+.5,t.im),c=Math.sqrt(2*Math.PI),l=u.pow(t.add(.5)),p=u.neg().exp();return a.mul(c).mul(l).mul(p)},BigNumber:function(e){if(e.isInteger())return e.isNegative()||e.isZero()?new i(1/0):s(e.minus(1));if(!e.isFinite())return new i(e.isNegative()?NaN:1/0);throw new Error("Integer BigNumber expected")}});function s(e){if(e<8)return new i([1,1,2,6,24,120,720,5040][e]);var t=n.precision+(0|Math.log(e.toNumber())),r=i.clone({precision:t});if(e%2===1)return e.times(s(new i(e-1)));for(var a=e,o=new r(e),u=e.toNumber();a>2;)u+=a-=2,o=o.times(u);return new i(o.toPrecision(i.precision))}})),$1="lgamma",Z1=ZU($1,["Complex","typed"],(e=>{var{Complex:t,typed:n}=e,r=[-.029550653594771242,.00641025641025641,-.0019175269175269176,.0008417508417508417,-.0005952380952380953,.0007936507936507937,-.002777777777777778,.08333333333333333];return n($1,{number:K1,Complex:function e(n){if(n.isNaN())return new t(NaN,NaN);if(0===n.im)return new t(K1(n.re),0);if(n.re>=7||Math.abs(n.im)>=7)return a(n);if(n.re<=.1){var r=(u=6.283185307179586,c=n.im,((u>0||!(u<0)&&1/u===1/0)^(c>0||!(c<0)&&1/c===1/0)?-u:u)*Math.floor(.5*n.re+.25)),o=n.mul(Math.PI).sin().log(),s=e(new t(1-n.re,-n.im));return new t(1.1447298858494002,r).sub(o).sub(s)}return n.im>=0?i(n):i(n.conjugate()).conjugate();var u,c},BigNumber:function(){throw new Error("mathjs doesn't yet provide an implementation of the algorithm lgamma for BigNumber")}});function a(e){for(var n=e.sub(.5).mul(e.log()).sub(e).add(G1),a=new t(1,0).div(e),i=a.div(e),o=r[0],s=r[1],u=2*i.re,c=i.re*i.re+i.im*i.im,l=2;l<8;l++){var p=s;s=-c*o+r[l],o=u*o+p}var h=a.mul(i.mul(o).add(s));return n.add(h)}function i(e){var n=0,r=0,i=e;for(e=e.add(1);e.re<=7;){var o=(i=i.mul(e)).im<0?1:0;0!==o&&0===r&&n++,r=o,e=e.add(1)}return a(e).sub(i.log()).sub(new t(0,2*n*Math.PI*1))}})),Q1="factorial",J1=ZU(Q1,["typed","gamma"],(e=>{var{typed:t,gamma:n}=e;return t(Q1,{number:function(e){if(e<0)throw new Error("Value must be non-negative");return n(e+1)},BigNumber:function(e){if(e.isNegative())throw new Error("Value must be non-negative");return n(e.plus(1))},"Array | Matrix":t.referToSelf((e=>t=>Hj(t,e)))})})),e2="kldivergence",t2=ZU(e2,["typed","matrix","divide","sum","multiply","map","dotDivide","log","isNumeric"],(e=>{var{typed:t,matrix:n,divide:r,sum:a,multiply:i,map:o,dotDivide:s,log:u,isNumeric:c}=e;return t(e2,{"Array, Array":function(e,t){return l(n(e),n(t))},"Matrix, Array":function(e,t){return l(e,n(t))},"Array, Matrix":function(e,t){return l(n(e),t)},"Matrix, Matrix":function(e,t){return l(e,t)}});function l(e,t){var n=t.size().length,l=e.size().length;if(n>1)throw new Error("first object must be one dimensional");if(l>1)throw new Error("second object must be one dimensional");if(n!==l)throw new Error("Length of two vectors must be equal");if(0===a(e))throw new Error("Sum of elements in first object must be non zero");if(0===a(t))throw new Error("Sum of elements in second object must be non zero");var p=r(e,a(e)),h=r(t,a(t)),d=a(i(p,o(s(p,h),(e=>u(e)))));return c(d)?d:Number.NaN}})),n2="multinomial",r2=ZU(n2,["typed","add","divide","multiply","factorial","isInteger","isPositive"],(e=>{var{typed:t,add:n,divide:r,multiply:a,factorial:i,isInteger:o,isPositive:s}=e;return t(n2,{"Array | Matrix":function(e){var t=0,u=1;return Gj(e,(function(e){if(!o(e)||!s(e))throw new TypeError("Positive integer value expected in function multinomial");t=n(t,e),u=a(u,i(e))})),r(i(t),u)}})})),a2="permutations",i2=ZU(a2,["typed","factorial"],(e=>{var{typed:t,factorial:n}=e;return t(a2,{"number | BigNumber":n,"number, number":function(e,t){if(!sW(e)||e<0)throw new TypeError("Positive integer value expected in function permutations");if(!sW(t)||t<0)throw new TypeError("Positive integer value expected in function permutations");if(t>e)throw new TypeError("second argument k must be less than or equal to first argument n");return O1(e-t+1,e)},"BigNumber, BigNumber":function(e,t){var n,r;if(!o2(e)||!o2(t))throw new TypeError("Positive integer value expected in function permutations");if(t.gt(e))throw new TypeError("second argument k must be less than or equal to first argument n");for(n=e.mul(0).add(1),r=e.minus(t).plus(1);r.lte(e);r=r.plus(1))n=n.times(r);return n}})}));function o2(e){return e.isInteger()&&e.gte(0)}var s2=Ol(Date.now());function u2(e){var t,n;return t=null===(n=e)?s2:Ol(String(n)),function(){return t()}}var c2="pickRandom",l2=ZU(c2,["typed","config","?on"],(e=>{var{typed:t,config:n,on:r}=e,a=u2(n.randomSeed);return r&&r("config",(function(e,t){e.randomSeed!==t.randomSeed&&(a=u2(e.randomSeed))})),t(c2,{"Array | Matrix":function(e){return i(e,{})},"Array | Matrix, Object":function(e,t){return i(e,t)},"Array | Matrix, number":function(e,t){return i(e,{number:t})},"Array | Matrix, Array | Matrix":function(e,t){return i(e,{weights:t})},"Array | Matrix, Array | Matrix, number":function(e,t,n){return i(e,{number:n,weights:t})},"Array | Matrix, number, Array | Matrix":function(e,t,n){return i(e,{number:t,weights:n})}});function i(e,t){var{number:n,weights:r,elementWise:i=!0}=t,o="undefined"===typeof n;o&&(n=1);var s=oU(e)?e.create:oU(r)?r.create:null;e=e.valueOf(),r&&(r=r.valueOf()),!0===i&&(e=Sj(e),r=Sj(r));var u=0;if("undefined"!==typeof r){if(r.length!==e.length)throw new Error("Weights must have the same length as possibles");for(var c=0,l=r.length;c<l;c++){if(!QP(r[c])||r[c]<0)throw new Error("Weights must be an array of positive numbers");u+=r[c]}}for(var p,h=e.length,d=[];d.length<n;){if("undefined"===typeof r)p=e[Math.floor(a()*h)];else for(var f=a()*u,m=0,g=e.length;m<g;m++)if((f-=r[m])<0){p=e[m];break}d.push(p)}return o?d[0]:s?s(d):d}}));function p2(e,t){var n=[];if((e=e.slice(0)).length>1)for(var r=0,a=e.shift();r<a;r++)n.push(p2(e,t));else for(var i=0,o=e.shift();i<o;i++)n.push(t());return n}var h2="random",d2=ZU(h2,["typed","config","?on"],(e=>{var{typed:t,config:n,on:r}=e,a=u2(n.randomSeed);return r&&r("config",(function(e,t){e.randomSeed!==t.randomSeed&&(a=u2(e.randomSeed))})),t(h2,{"":()=>o(0,1),number:e=>o(0,e),"number, number":(e,t)=>o(e,t),"Array | Matrix":e=>i(e,0,1),"Array | Matrix, number":(e,t)=>i(e,0,t),"Array | Matrix, number, number":(e,t,n)=>i(e,t,n)});function i(e,t,n){var r=p2(e.valueOf(),(()=>o(t,n)));return oU(e)?e.create(r,"number"):r}function o(e,t){return e+a()*(t-e)}})),f2="randomInt",m2=2n**30n,g2=ZU(f2,["typed","config","log2","?on"],(e=>{var{typed:t,config:n,log2:r,on:a}=e,i=u2(n.randomSeed);return a&&a("config",(function(e,t){e.randomSeed!==t.randomSeed&&(i=u2(e.randomSeed))})),t(f2,{"":()=>s(0,2),number:e=>s(0,e),"number, number":(e,t)=>s(e,t),bigint:e=>u(0n,e),"bigint, bigint":u,"Array | Matrix":e=>o(e,0,1),"Array | Matrix, number":(e,t)=>o(e,0,t),"Array | Matrix, number, number":(e,t,n)=>o(e,t,n)});function o(e,t,n){var r=p2(e.valueOf(),(()=>s(t,n)));return oU(e)?e.create(r,"number"):r}function s(e,t){return Math.floor(e+i()*(t-e))}function u(e,t){var n=t-e;if(n<=m2)return e+BigInt(s(0,Number(n)));for(var a=r(n),o=n;o>=n;){o=0n;for(var u=0;u<a;++u)o=2n*o+(i()<.5?0n:1n)}return e+o}})),y2="stirlingS2",v2=ZU(y2,["typed","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","factorial","combinations","isNegative","isInteger","number","?bignumber","larger"],(e=>{var{typed:t,addScalar:n,subtractScalar:r,multiplyScalar:a,divideScalar:i,pow:o,factorial:s,combinations:u,isNegative:c,isInteger:l,number:p,bignumber:h,larger:d}=e,f=[],m=[];return t(y2,{"number | BigNumber, number | BigNumber":function(e,t){if(!l(e)||c(e)||!l(t)||c(t))throw new TypeError("Non-negative integer value expected in function stirlingS2");if(d(t,e))throw new TypeError("k must be less than or equal to n in function stirlingS2");var r=!(QP(e)&&QP(t)),i=r?m:f,o=r?h:p,s=p(e),u=p(t);if(i[s]&&i[s].length>u)return i[s][u];for(var g=0;g<=s;++g)if(i[g]||(i[g]=[o(0===g?1:0)]),0!==g)for(var y=i[g],v=i[g-1],b=y.length;b<=g&&b<=u;++b)y[b]=b===g?1:n(a(o(b),v[b]),v[b-1]);return i[s][u]}})})),b2="bellNumbers",x2=ZU(b2,["typed","addScalar","isNegative","isInteger","stirlingS2"],(e=>{var{typed:t,addScalar:n,isNegative:r,isInteger:a,stirlingS2:i}=e;return t(b2,{"number | BigNumber":function(e){if(!a(e)||r(e))throw new TypeError("Non-negative integer value expected in function bellNumbers");for(var t=0,o=0;o<=e;o++)t=n(t,i(e,o));return t}})})),w2="catalan",N2=ZU(w2,["typed","addScalar","divideScalar","multiplyScalar","combinations","isNegative","isInteger"],(e=>{var{typed:t,addScalar:n,divideScalar:r,multiplyScalar:a,combinations:i,isNegative:o,isInteger:s}=e;return t(w2,{"number | BigNumber":function(e){if(!s(e)||o(e))throw new TypeError("Non-negative integer value expected in function catalan");return r(i(a(e,2),e),n(e,1))}})})),S2="composition",k2=ZU(S2,["typed","addScalar","combinations","isNegative","isPositive","isInteger","larger"],(e=>{var{typed:t,addScalar:n,combinations:r,isPositive:a,isNegative:i,isInteger:o,larger:s}=e;return t(S2,{"number | BigNumber, number | BigNumber":function(e,t){if(!(o(e)&&a(e)&&o(t)&&a(t)))throw new TypeError("Positive integer value expected in function composition");if(s(t,e))throw new TypeError("k must be less than or equal to n in function composition");return r(n(e,-1),n(t,-1))}})})),E2="leafCount",C2=ZU(E2,["parse","typed"],(e=>{var{parse:t,typed:n}=e;function r(e){var t=0;return e.forEach((e=>{t+=r(e)})),t||1}return n(E2,{Node:function(e){return r(e)}})}));function T2(e){return IU(e)||zU(e)&&e.isUnary()&&IU(e.args[0])}function D2(e){return!!IU(e)||(!(!_U(e)&&!zU(e)||!e.args.every(D2))||!(!BU(e)||!D2(e.content)))}function I2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I2(Object(n),!0).forEach((function(t){SY(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I2(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F2=ZU("simplifyUtil",["FunctionNode","OperatorNode","SymbolNode"],(e=>{var{FunctionNode:t,OperatorNode:n,SymbolNode:r}=e,a=!0,i=!1,o="defaultF",s={add:{trivial:a,total:a,commutative:a,associative:a},unaryPlus:{trivial:a,total:a,commutative:a,associative:a},subtract:{trivial:i,total:a,commutative:i,associative:i},multiply:{trivial:a,total:a,commutative:a,associative:a},divide:{trivial:i,total:a,commutative:i,associative:i},paren:{trivial:a,total:a,commutative:a,associative:i},defaultF:{trivial:i,total:a,commutative:i,associative:i}};function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s,r=o;if("string"===typeof e?r=e:zU(e)?r=e.fn.toString():_U(e)?r=e.name:BU(e)&&(r="paren"),$U(n,r)){var a=n[r];if($U(a,t))return a[t];if($U(s,r))return s[r][t]}if($U(n,o)){var i=n[o];return $U(i,t)?i[t]:s[o][t]}if($U(s,r)){var u=s[r];if($U(u,t))return u[t]}return s[o][t]}function c(e){return u(e,"associative",arguments.length>1&&void 0!==arguments[1]?arguments[1]:s)}function l(e,t){var n,r=[],a=function(e){for(var t=0;t<e.args.length;t++){var i=e.args[t];zU(i)&&n===i.op?a(i):r.push(i)}};return c(e,t)?(n=e.op,a(e),r):e.args}function p(e){return zU(e)?function(t){try{return new n(e.op,e.fn,t,e.implicit)}catch(r5){return console.error(r5),[]}}:function(n){return new t(new r(e.name),n)}}return{createMakeNodeFunction:p,hasProperty:u,isCommutative:function(e){return u(e,"commutative",arguments.length>1&&void 0!==arguments[1]?arguments[1]:s)},isAssociative:c,mergeContext:function(e,t){var n=A2({},e);for(var r in t)$U(e,r)?n[r]=A2(A2({},t[r]),e[r]):n[r]=t[r];return n},flatten:function e(t,n){if(!t.args||0===t.args.length)return t;t.args=l(t,n);for(var r=0;r<t.args.length;r++)e(t.args[r],n)},allChildren:l,unflattenr:function e(t,n){if(t.args&&0!==t.args.length){for(var r=p(t),a=t.args.length,i=0;i<a;i++)e(t.args[i],n);if(a>2&&c(t,n)){for(var o=t.args.pop();t.args.length>0;)o=r([t.args.pop(),o]);t.args=o.args}}},unflattenl:function e(t,n){if(t.args&&0!==t.args.length){for(var r=p(t),a=t.args.length,i=0;i<a;i++)e(t.args[i],n);if(a>2&&c(t,n)){for(var o=t.args.shift();t.args.length>0;)o=r([o,t.args.shift()]);t.args=o.args}}},defaultContext:s,realContext:{divide:{total:i},log:{total:i}},positiveContext:{subtract:{total:i},abs:{trivial:a},log:{total:a}}}})),_2=ZU("simplify",["typed","parse","equal","resolve","simplifyConstant","simplifyCore","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode","replacer"],(e=>{var{typed:t,parse:n,equal:r,resolve:a,simplifyConstant:i,simplifyCore:o,AccessorNode:s,ArrayNode:u,ConstantNode:c,FunctionNode:l,IndexNode:p,ObjectNode:h,OperatorNode:d,ParenthesisNode:f,SymbolNode:m,replacer:g}=e,{hasProperty:y,isCommutative:v,isAssociative:b,mergeContext:x,flatten:w,unflattenr:N,unflattenl:S,createMakeNodeFunction:k,defaultContext:E,realContext:C,positiveContext:T}=F2({FunctionNode:l,OperatorNode:d,SymbolNode:m});t.addConversion({from:"Object",to:"Map",convert:ZP});var D=t("simplify",{Node:O,"Node, Map":(e,t)=>O(e,!1,t),"Node, Map, Object":(e,t,n)=>O(e,!1,t,n),"Node, Array":O,"Node, Array, Map":O,"Node, Array, Map, Object":O});function I(e){return e.transform((function(e){return BU(e)?I(e.content):e}))}t.removeConversion({from:"Object",to:"Map",convert:ZP}),D.defaultContext=E,D.realContext=C,D.positiveContext=T;var A={true:!0,false:!0,e:!0,i:!0,Infinity:!0,LN2:!0,LN10:!0,LOG2E:!0,LOG10E:!0,NaN:!0,phi:!0,pi:!0,SQRT1_2:!0,SQRT2:!0,tau:!0};function F(e,t){var r={};if(e.s){var a=e.s.split("->");if(2!==a.length)throw SyntaxError("Could not parse rule: "+e.s);r.l=a[0],r.r=a[1]}else r.l=e.l,r.r=e.r;for(var i of(r.l=I(n(r.l)),r.r=I(n(r.r)),["imposeContext","repeat","assuming"]))i in e&&(r[i]=e[i]);if(e.evaluate&&(r.evaluate=n(e.evaluate)),b(r.l,t)){var o,s=!v(r.l,t);s&&(o=M());var u=k(r.l),c=M();r.expanded={},r.expanded.l=u([r.l,c]),w(r.expanded.l,t),N(r.expanded.l,t),r.expanded.r=u([r.r,c]),s&&(r.expandedNC1={},r.expandedNC1.l=u([o,r.l]),r.expandedNC1.r=u([o,r.r]),r.expandedNC2={},r.expandedNC2.l=u([o,r.expanded.l]),r.expandedNC2.r=u([o,r.expanded.r]))}return r}D.rules=[o,{l:"log(e)",r:"1"},{s:"n-n1 -> n+-n1",assuming:{subtract:{total:!0}}},{s:"n-n -> 0",assuming:{subtract:{total:!1}}},{s:"-(cl*v) -> v * (-cl)",assuming:{multiply:{commutative:!0},subtract:{total:!0}}},{s:"-(cl*v) -> (-cl) * v",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{s:"-(v*cl) -> v * (-cl)",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{l:"-(n1/n2)",r:"-n1/n2"},{l:"-v",r:"v * (-1)"},{l:"(n1 + n2)*(-1)",r:"n1*(-1) + n2*(-1)",repeat:!0},{l:"n/n1^n2",r:"n*n1^-n2"},{l:"n/n1",r:"n*n1^-1"},{s:"(n1*n2)^n3 -> n1^n3 * n2^n3",assuming:{multiply:{commutative:!0}}},{s:"(n1*n2)^(-1) -> n2^(-1) * n1^(-1)",assuming:{multiply:{commutative:!1}}},{s:"(n ^ n1) ^ n2 -> n ^ (n1 * n2)",assuming:{divide:{total:!0}}},{l:" vd   * ( vd   * n1 + n2)",r:"vd^2       * n1 +  vd   * n2"},{s:" vd   * (vd^n4 * n1 + n2)   ->  vd^(1+n4)  * n1 +  vd   * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * ( vd   * n1 + n2)   ->  vd^(n3+1)  * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * (vd^n4 * n1 + n2)   ->  vd^(n3+n4) * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{l:"n*n",r:"n^2"},{s:"n * n^n1 -> n^(n1+1)",assuming:{divide:{total:!0}}},{s:"n^n1 * n^n2 -> n^(n1+n2)",assuming:{divide:{total:!0}}},i,{s:"n+n -> 2*n",assuming:{add:{total:!0}}},{l:"n+-n",r:"0"},{l:"vd*n + vd",r:"vd*(n+1)"},{l:"n3*n1 + n3*n2",r:"n3*(n1+n2)"},{l:"n3^(-n4)*n1 +   n3  * n2",r:"n3^(-n4)*(n1 + n3^(n4+1) *n2)"},{l:"n3^(-n4)*n1 + n3^n5 * n2",r:"n3^(-n4)*(n1 + n3^(n4+n5)*n2)"},{s:"n*vd + vd -> (n+1)*vd",assuming:{multiply:{commutative:!1}}},{s:"vd + n*vd -> (1+n)*vd",assuming:{multiply:{commutative:!1}}},{s:"n1*n3 + n2*n3 -> (n1+n2)*n3",assuming:{multiply:{commutative:!1}}},{s:"n^n1 * n -> n^(n1+1)",assuming:{divide:{total:!0},multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3    -> (n1 + n2*n3^(n4 +  1))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3^n5 -> (n1 + n2*n3^(n4 + n5))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{l:"n*cd + cd",r:"(n+1)*cd"},{s:"cd*n + cd -> cd*(n+1)",assuming:{multiply:{commutative:!1}}},{s:"cd + cd*n -> cd*(1+n)",assuming:{multiply:{commutative:!1}}},i,{s:"(-n)*n1 -> -(n*n1)",assuming:{subtract:{total:!0}}},{s:"n1*(-n) -> -(n1*n)",assuming:{subtract:{total:!0},multiply:{commutative:!1}}},{s:"ce+ve -> ve+ce",assuming:{add:{commutative:!0}},imposeContext:{add:{commutative:!1}}},{s:"vd*cd -> cd*vd",assuming:{multiply:{commutative:!0}},imposeContext:{multiply:{commutative:!1}}},{l:"n+-n1",r:"n-n1"},{l:"n+-(n1)",r:"n-(n1)"},{s:"n*(n1^-1) -> n/n1",assuming:{multiply:{commutative:!0}}},{s:"n*n1^-n2 -> n/n1^n2",assuming:{multiply:{commutative:!0}}},{s:"n^-1 -> 1/n",assuming:{multiply:{commutative:!0}}},{l:"n^1",r:"n"},{s:"n*(n1/n2) -> (n*n1)/n2",assuming:{multiply:{associative:!0}}},{s:"n-(n1+n2) -> n-n1-n2",assuming:{addition:{associative:!0,commutative:!0}}},{l:"1*n",r:"n",imposeContext:{multiply:{commutative:!0}}},{s:"n1/(n2/n3) -> (n1*n3)/n2",assuming:{multiply:{associative:!0}}},{l:"n1/(-n2)",r:"-n1/n2"}];var _=0;function M(){return new m("_p"+_++)}function O(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$P(),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.consoleDebug;t=function(e,t){for(var n=[],r=0;r<e.length;r++){var a=e[r],i=void 0,o=typeof a;switch(o){case"string":a={s:a};case"object":i=F(a,t);break;case"function":i=a;break;default:throw TypeError("Unsupported type of rule: "+o)}n.push(i)}return n}(t||D.rules,r.context);for(var o=a(e,n),s={},u=(o=I(o)).toString({parenthesis:"all"});!s[u];){s[u]=!0,_=0;var c=u;i&&console.log("Working on: ",u);for(var l=0;l<t.length;l++){var p="";if("function"===typeof t[l]?(o=t[l](o,r),i&&(p=t[l].name)):(w(o,r.context),o=z(o,t[l],r.context),i&&(p="".concat(t[l].l.toString()," -> ").concat(t[l].r.toString()))),i){var h=o.toString({parenthesis:"all"});h!==c&&(console.log("Applying",p,"produced",h),c=h)}S(o,r.context)}u=o.toString({parenthesis:"all"})}return o}function R(e,t,n){var r=e;if(e)for(var a=0;a<e.length;++a){var i=z(e[a],t,n);i!==e[a]&&(r===e&&(r=e.slice()),r[a]=i)}return r}function z(e,t,n){if(t.assuming)for(var r in t.assuming)for(var a in t.assuming[r])if(y(r,a,n)!==t.assuming[r][a])return e;var i=x(t.imposeContext,n),o=e;if(o instanceof d||o instanceof l){var c=R(o.args,t,n);c!==o.args&&((o=o.clone()).args=c)}else if(o instanceof f){if(o.content){var m=z(o.content,t,n);m!==o.content&&(o=new f(m))}}else if(o instanceof u){var g=R(o.items,t,n);g!==o.items&&(o=new u(g))}else if(o instanceof s){var v=o.object;o.object&&(v=z(o.object,t,n));var b=o.index;o.index&&(b=z(o.index,t,n)),v===o.object&&b===o.index||(o=new s(v,b))}else if(o instanceof p){var w=R(o.dimensions,t,n);w!==o.dimensions&&(o=new p(w))}else if(o instanceof h){var N=!1,S={};for(var k in o.properties)S[k]=z(o.properties[k],t,n),S[k]!==o.properties[k]&&(N=!0);N&&(o=new h(S))}var E=t.r,C=P(t.l,o,i)[0];if(!C&&t.expanded&&(E=t.expanded.r,C=P(t.expanded.l,o,i)[0]),!C&&t.expandedNC1&&(E=t.expandedNC1.r,(C=P(t.expandedNC1.l,o,i)[0])||(E=t.expandedNC2.r,C=P(t.expandedNC2.l,o,i)[0])),C){var T=o.implicit;o=E.clone(),T&&"implicit"in E&&(o.implicit=!0),o=o.transform((function(e){return e.isSymbolNode&&$U(C.placeholders,e.name)?C.placeholders[e.name].clone():e}))}return t.repeat&&o!==e&&(o=z(o,t,n)),o}function B(e,t){var n={placeholders:{}};if(!e.placeholders&&!t.placeholders)return n;if(!e.placeholders)return t;if(!t.placeholders)return e;for(var r in e.placeholders)if($U(e.placeholders,r)&&(n.placeholders[r]=e.placeholders[r],$U(t.placeholders,r)&&!U(e.placeholders[r],t.placeholders[r])))return null;for(var a in t.placeholders)$U(t.placeholders,a)&&(n.placeholders[a]=t.placeholders[a]);return n}function L(e,t){var n,r=[];if(0===e.length||0===t.length)return r;for(var a=0;a<e.length;a++)for(var i=0;i<t.length;i++)(n=B(e[a],t[i]))&&r.push(n);return r}function P(e,t,n,a){var i=[{placeholders:{}}];if(e instanceof d&&t instanceof d||e instanceof l&&t instanceof l){if(e instanceof d){if(e.op!==t.op||e.fn!==t.fn)return[]}else if(e instanceof l&&e.name!==t.name)return[];if(!(1===t.args.length&&1===e.args.length||!b(t,n)&&t.args.length===e.args.length||a)){if(t.args.length>=2&&2===e.args.length){for(var o=function(e,t){var n,r,a=[],i=k(e);if(v(e,t))for(var o=0;o<e.args.length;o++)(r=e.args.slice(0)).splice(o,1),n=1===r.length?r[0]:i(r),a.push(i([e.args[o],n]));else for(var s=1;s<e.args.length;s++){var u=e.args[0];s>1&&(u=i(e.args.slice(0,s))),n=1===(r=e.args.slice(s)).length?r[0]:i(r),a.push(i([u,n]))}return a}(t,n),s=[],u=0;u<o.length;u++){var p=P(e,o[u],n,!0);s=s.concat(p)}return s}if(e.args.length>2)throw Error("Unexpected non-binary associative function: "+e.toString());return[]}for(var h=[],f=0;f<e.args.length;f++){var y=P(e.args[f],t.args[f],n);if(0===y.length)break;h.push(y)}if(h.length!==e.args.length){if(!v(t,n)||1===e.args.length)return[];if(e.args.length>2)throw new Error("permuting >2 commutative non-associative rule arguments not yet implemented");var x=P(e.args[0],t.args[1],n);if(0===x.length)return[];var w=P(e.args[1],t.args[0],n);if(0===w.length)return[];h=[x,w]}i=function(e){if(0===e.length)return e;for(var t=e.reduce(L),n=[],r={},a=0;a<t.length;a++){var i=JSON.stringify(t[a],g);r[i]||(r[i]=!0,n.push(t[a]))}return n}(h)}else if(e instanceof m){if(0===e.name.length)throw new Error("Symbol in rule has 0 length...!?");if(A[e.name]){if(e.name!==t.name)return[]}else switch(e.name[1]>="a"&&e.name[1]<="z"?e.name.substring(0,2):e.name[0]){case"n":case"_p":i[0].placeholders[e.name]=t;break;case"c":case"cl":if(!IU(t))return[];i[0].placeholders[e.name]=t;break;case"v":if(IU(t))return[];i[0].placeholders[e.name]=t;break;case"vl":if(!UU(t))return[];i[0].placeholders[e.name]=t;break;case"cd":if(!T2(t))return[];i[0].placeholders[e.name]=t;break;case"vd":if(T2(t))return[];i[0].placeholders[e.name]=t;break;case"ce":if(!D2(t))return[];i[0].placeholders[e.name]=t;break;case"ve":if(D2(t))return[];i[0].placeholders[e.name]=t;break;default:throw new Error("Invalid symbol in rule: "+e.name)}}else{if(!(e instanceof c))return[];if(!r(e.value,t.value))return[]}return i}function U(e,t){if(e instanceof c&&t instanceof c){if(!r(e.value,t.value))return!1}else if(e instanceof m&&t instanceof m){if(e.name!==t.name)return!1}else{if(!(e instanceof d&&t instanceof d||e instanceof l&&t instanceof l))return!1;if(e instanceof d){if(e.op!==t.op||e.fn!==t.fn)return!1}else if(e instanceof l&&e.name!==t.name)return!1;if(e.args.length!==t.args.length)return!1;for(var n=0;n<e.args.length;n++)if(!U(e.args[n],t.args[n]))return!1}return!0}return D})),M2=ZU("simplifyConstant",["typed","config","mathWithTransform","matrix","?fraction","?bignumber","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode"],(e=>{var{typed:t,config:n,mathWithTransform:r,matrix:a,fraction:i,bignumber:o,AccessorNode:s,ArrayNode:u,ConstantNode:c,FunctionNode:l,IndexNode:p,ObjectNode:h,OperatorNode:d,SymbolNode:f}=e,{isCommutative:m,isAssociative:g,allChildren:y,createMakeNodeFunction:v}=F2({FunctionNode:l,OperatorNode:d,SymbolNode:f}),b=t("simplifyConstant",{Node:e=>S(D(e,{})),"Node, Object":function(e,t){return S(D(e,t))}});function x(e){return nU(e)?e.valueOf():e instanceof Array?e.map(x):oU(e)?a(x(e.valueOf())):e}function w(e,t,n){try{return r[e].apply(null,t)}catch(a){return t=t.map(x),E(r[e].apply(null,t),n)}}var N=t({Fraction:function(e){var t=e=>"BigNumber"===n.number&&o?o(e):Number(e),r=e.s*e.n,a=r<0n?new d("-","unaryMinus",[new c(-t(r))]):new c(t(r));return 1n===e.d?a:new d("/","divide",[a,new c(t(e.d))])},number:function(e){return e<0?C(new c(-e)):new c(e)},BigNumber:function(e){return e<0?C(new c(-e)):new c(e)},bigint:function(e){return e<0n?C(new c(-e)):new c(e)},Complex:function(e){throw new Error("Cannot convert Complex number to Node")},string:function(e){return new c(e)},Matrix:function(e){return new u(e.valueOf().map((e=>N(e))))}});function S(e){return OU(e)?e:N(e)}function k(e,t){if(t&&!1!==t.exactFractions&&isFinite(e)&&i){var n=i(e),r=t&&"number"===typeof t.fractionsLimit?t.fractionsLimit:1/0;if(n.valueOf()===e&&n.n<r&&n.d<r)return n}return e}var E=t({"string, Object":function(e,t){var r=uW(e,n);return"BigNumber"===r?(void 0===o&&qX(),o(e)):"bigint"===r?BigInt(e):"Fraction"===r?(void 0===i&&jX(),i(e)):k(parseFloat(e),t)},"Fraction, Object":function(e,t){return e},"BigNumber, Object":function(e,t){return e},"number, Object":function(e,t){return k(e,t)},"bigint, Object":function(e,t){return e},"Complex, Object":function(e,t){return 0!==e.im?e:k(e.re,t)},"Matrix, Object":function(e,t){return a(k(e.valueOf()))},"Array, Object":function(e,t){return e.map(k)}});function C(e){return new d("-","unaryMinus",[e])}function T(e,t,n,r){var a=t.shift(),i=t.reduce(((t,a)=>{if(!OU(a)){var i=t.pop();if(OU(i))return[i,a];try{return t.push(w(e,[i,a],r)),t}catch(s){t.push(i)}}t.push(S(t.pop()));var o=1===t.length?t[0]:n(t);return[n([o,S(a)])]}),[a]);return 1===i.length?i[0]:n([i[0],N(i[1])])}function D(e,t){switch(e.type){case"SymbolNode":return e;case"ConstantNode":switch(typeof e.value){case"number":case"bigint":return E(e.value,t);case"string":return e.value;default:if(!isNaN(e.value))return E(e.value,t)}return e;case"FunctionNode":if(r[e.name]&&r[e.name].rawArgs)return e;if(!["add","multiply"].includes(e.name)){var n=e.args.map((e=>D(e,t)));if(!n.some(OU))try{return w(e.name,n,t)}catch(M){}if("size"===e.name&&1===n.length&&EU(n[0])){for(var i=[],o=n[0];EU(o);)i.push(o.items.length),o=o.items[0];return a(i)}return new l(e.name,n.map(S))}case"OperatorNode":var d,f,x=e.fn.toString(),N=v(e);if(zU(e)&&e.isUnary())f=OU((d=[D(e.args[0],t)])[0])?N(d):w(x,d,t);else if(g(e,t.context))if(d=(d=y(e,t.context)).map((e=>D(e,t))),m(x,t.context)){for(var k=[],C=[],I=0;I<d.length;I++)OU(d[I])?C.push(d[I]):k.push(d[I]);k.length>1?(f=T(x,k,N,t),C.unshift(f),f=T(x,C,N,t)):f=T(x,d,N,t)}else f=T(x,d,N,t);else f=T(x,d=e.args.map((e=>D(e,t))),N,t);return f;case"ParenthesisNode":return D(e.content,t);case"AccessorNode":return function(e,t,n){if(!MU(t))return new s(S(e),S(t));if(EU(e)||oU(e)){for(var r=Array.from(t.dimensions);r.length>0;)if(IU(r[0])&&"string"!==typeof r[0].value){var i=E(r.shift().value,n);EU(e)?e=e.items[i-1]:(e=e.valueOf()[i-1])instanceof Array&&(e=a(e))}else{if(!(r.length>1&&IU(r[1])&&"string"!==typeof r[1].value))break;var o=E(r[1].value,n),l=[],h=EU(e)?e.items:e.valueOf();for(var d of h)if(EU(d))l.push(d.items[o-1]);else{if(!oU(e))break;l.push(d[o-1])}if(l.length!==h.length)break;e=EU(e)?new u(l):a(l),r.splice(1,1)}return r.length===t.dimensions.length?new s(S(e),t):r.length>0?(t=new p(r),new s(S(e),t)):e}if(RU(e)&&1===t.dimensions.length&&IU(t.dimensions[0])){var f=t.dimensions[0].value;return f in e.properties?e.properties[f]:new c}return new s(S(e),t)}(D(e.object,t),D(e.index,t),t);case"ArrayNode":var A=e.items.map((e=>D(e,t)));return A.some(OU)?new u(A.map(S)):a(A);case"IndexNode":return new p(e.dimensions.map((e=>b(e,t))));case"ObjectNode":var F={};for(var _ in e.properties)F[_]=b(e.properties[_],t);return new h(F);default:throw new Error("Unimplemented node type in simplifyConstant: ".concat(e.type))}}return b})),O2="simplifyCore",R2=ZU(O2,["typed","parse","equal","isZero","add","subtract","multiply","divide","pow","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode"],(e=>{var{typed:t,parse:n,equal:r,isZero:a,add:i,subtract:o,multiply:s,divide:u,pow:c,AccessorNode:l,ArrayNode:p,ConstantNode:h,FunctionNode:d,IndexNode:f,ObjectNode:m,OperatorNode:g,ParenthesisNode:y,SymbolNode:v}=e,b=new h(0),x=new h(1),w=new h(!0),N=new h(!1);function S(e){return zU(e)&&["and","not","or"].includes(e.op)}var{hasProperty:k,isCommutative:E}=F2({FunctionNode:d,OperatorNode:g,SymbolNode:v});function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t?t.context:void 0;if(k(e,"trivial",n)){if(_U(e)&&1===e.args.length)return C(e.args[0],t);var i=!1,o=0;if(e.forEach((e=>{1===++o&&(i=C(e,t))})),1===o)return i}var s=e;if(_U(s)){var u=function(e){var t="OperatorNode:"+e;for(var n of EJ)if(t in n)return n[t].op;return null}(s.name);if(!u)return new d(C(s.fn),s.args.map((e=>C(e,t))));if(s.args.length>2&&k(s,"associative",n))for(;s.args.length>2;){var c=s.args.pop(),h=s.args.pop();s.args.push(new g(u,s.name,[c,h]))}s=new g(u,s.name,s.args)}if(zU(s)&&s.isUnary()){var y=C(s.args[0],t);if("~"===s.op&&zU(y)&&y.isUnary()&&"~"===y.op)return y.args[0];if("not"===s.op&&zU(y)&&y.isUnary()&&"not"===y.op&&S(y.args[0]))return y.args[0];var v=!0;if("-"===s.op&&zU(y)&&(y.isBinary()&&"subtract"===y.fn&&(s=new g("-","subtract",[y.args[1],y.args[0]]),v=!1),y.isUnary()&&"-"===y.op))return y.args[0];if(v)return new g(s.op,s.fn,[y])}if(zU(s)&&s.isBinary()){var T=C(s.args[0],t),D=C(s.args[1],t);if("+"===s.op){if(IU(T)&&a(T.value))return D;if(IU(D)&&a(D.value))return T;zU(D)&&D.isUnary()&&"-"===D.op&&(D=D.args[0],s=new g("-","subtract",[T,D]))}if("-"===s.op)return zU(D)&&D.isUnary()&&"-"===D.op?C(new g("+","add",[T,D.args[0]]),t):IU(T)&&a(T.value)?C(new g("-","unaryMinus",[D])):IU(D)&&a(D.value)?T:new g(s.op,s.fn,[T,D]);if("*"===s.op){if(IU(T)){if(a(T.value))return b;if(r(T.value,1))return D}if(IU(D)){if(a(D.value))return b;if(r(D.value,1))return T;if(E(s,n))return new g(s.op,s.fn,[D,T],s.implicit)}return new g(s.op,s.fn,[T,D],s.implicit)}if("/"===s.op)return IU(T)&&a(T.value)?b:IU(D)&&r(D.value,1)?T:new g(s.op,s.fn,[T,D]);if("^"===s.op&&IU(D)){if(a(D.value))return x;if(r(D.value,1))return T}if("and"===s.op){if(IU(T)){if(!T.value)return N;if(S(D))return D;if(IU(D))return D.value?w:N}if(IU(D)){if(!D.value)return N;if(S(T))return T}}if("or"===s.op){if(IU(T)){if(T.value)return w;if(S(D))return D}if(IU(D)){if(D.value)return w;if(S(T))return T}}return new g(s.op,s.fn,[T,D])}if(zU(s))return new g(s.op,s.fn,s.args.map((e=>C(e,t))));if(EU(s))return new p(s.items.map((e=>C(e,t))));if(kU(s))return new l(C(s.object,t),C(s.index,t));if(MU(s))return new f(s.dimensions.map((e=>C(e,t))));if(RU(s)){var I={};for(var A in s.properties)I[A]=C(s.properties[A],t);return new m(I)}return s}return t(O2,{Node:C,"Node,Object":C})})),z2=ZU("resolve",["typed","parse","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode"],(e=>{var{typed:t,parse:n,ConstantNode:r,FunctionNode:a,OperatorNode:i,ParenthesisNode:o}=e;function s(e,t){var u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;if(!t)return e;if(UU(e)){if(u.has(e.name)){var c=Array.from(u).join(", ");throw new ReferenceError("recursive loop of variable definitions among {".concat(c,"}"))}var l=t.get(e.name);if(OU(l)){var p=new Set(u);return p.add(e.name),s(l,t,p)}return"number"===typeof l?n(String(l)):void 0!==l?new r(l):e}if(zU(e)){var h=e.args.map((function(e){return s(e,t,u)}));return new i(e.op,e.fn,h,e.implicit)}if(BU(e))return new o(s(e.content,t,u));if(_U(e)){var d=e.args.map((function(e){return s(e,t,u)}));return new a(e.name,d)}return e.map((e=>s(e,t,u)))}return t("resolve",{Node:s,"Node, Map | null | undefined":s,"Node, Object":(e,t)=>s(e,ZP(t)),"Array | Matrix":t.referToSelf((e=>t=>t.map((t=>e(t))))),"Array | Matrix, null | undefined":t.referToSelf((e=>t=>t.map((t=>e(t))))),"Array, Object":t.referTo("Array,Map",(e=>(t,n)=>e(t,ZP(n)))),"Matrix, Object":t.referTo("Matrix,Map",(e=>(t,n)=>e(t,ZP(n)))),"Array | Matrix, Map":t.referToSelf((e=>(t,n)=>t.map((t=>e(t,n)))))})})),B2="symbolicEqual",L2=ZU(B2,["parse","simplify","typed","OperatorNode"],(e=>{var{parse:t,simplify:n,typed:r,OperatorNode:a}=e;function i(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=new a("-","subtract",[e,t]),o=n(i,{},r);return IU(o)&&!o.value}return r(B2,{"Node, Node":i,"Node, Node, Object":i})})),P2="derivative",U2=ZU(P2,["typed","config","parse","simplify","equal","isZero","numeric","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode","SymbolNode"],(e=>{var{typed:t,config:n,parse:r,simplify:a,equal:i,isZero:o,numeric:s,ConstantNode:u,FunctionNode:c,OperatorNode:l,ParenthesisNode:p,SymbolNode:h}=e;function d(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{simplify:!0},r=new Map,i=t.name;var o=v(e,(function e(t){var n=r.get(t);if(void 0!==n)return n;var a=y(e,t,i);return r.set(t,a),a}));return n.simplify?a(o):o}function f(e){var t=r(e);if(!t.isSymbolNode)throw new TypeError("Invalid variable. "+"Cannot parse ".concat(JSON.stringify(e)," into a variable in function derivative"));return t}var m=t(P2,{"Node, SymbolNode":d,"Node, SymbolNode, Object":d,"Node, string":(e,t)=>d(e,f(t)),"Node, string, Object":(e,t,n)=>d(e,f(t),n)});m._simplify=!0,m.toTex=function(e){return g.apply(null,e.args)};var g=t("_derivTex",{"Node, SymbolNode":function(e,t){return IU(e)&&"string"===VU(e.value)?g(r(e.value).toString(),t.toString(),1):g(e.toTex(),t.toString(),1)},"Node, ConstantNode":function(e,t){if("string"===VU(t.value))return g(e,r(t.value));throw new Error("The second parameter to 'derivative' is a non-string constant")},"Node, SymbolNode, ConstantNode":function(e,t,n){return g(e.toString(),t.name,n.value)},"string, string, number":function(e,t,n){return(1===n?"{d\\over d"+t+"}":"{d^{"+n+"}\\over d"+t+"^{"+n+"}}")+"\\left[".concat(e,"\\right]")}}),y=t("_isConst",{"function, ConstantNode, string":function(){return!0},"function, SymbolNode, string":function(e,t,n){return t.name!==n},"function, ParenthesisNode, string":function(e,t,n){return e(t.content,n)},"function, FunctionAssignmentNode, string":function(e,t,n){return!t.params.includes(n)||e(t.expr,n)},"function, FunctionNode | OperatorNode, string":function(e,t,n){return t.args.every((t=>e(t,n)))}}),v=t("_derivative",{"ConstantNode, function":function(){return b(0)},"SymbolNode, function":function(e,t){return t(e)?b(0):b(1)},"ParenthesisNode, function":function(e,t){return new p(v(e.content,t))},"FunctionAssignmentNode, function":function(e,t){return t(e)?b(0):v(e.expr,t)},"FunctionNode, function":function(e,t){if(t(e))return b(0);var n,r,a,i,o=e.args[0],s=!1,u=!1;switch(e.name){case"cbrt":s=!0,r=new l("*","multiply",[b(3),new l("^","pow",[o,new l("/","divide",[b(2),b(3)])])]);break;case"sqrt":case"nthRoot":if(1===e.args.length)s=!0,r=new l("*","multiply",[b(2),new c("sqrt",[o])]);else if(2===e.args.length)return n=new l("/","divide",[b(1),e.args[1]]),v(new l("^","pow",[o,n]),t);break;case"log10":n=b(10);case"log":if(n||1!==e.args.length){if(1===e.args.length&&n||2===e.args.length&&t(e.args[1]))r=new l("*","multiply",[o.clone(),new c("log",[n||e.args[1]])]),s=!0;else if(2===e.args.length)return v(new l("/","divide",[new c("log",[o]),new c("log",[e.args[1]])]),t)}else r=o.clone(),s=!0;break;case"pow":if(2===e.args.length)return v(new l("^","pow",[o,e.args[1]]),t);break;case"exp":r=new c("exp",[o.clone()]);break;case"sin":r=new c("cos",[o.clone()]);break;case"cos":r=new l("-","unaryMinus",[new c("sin",[o.clone()])]);break;case"tan":r=new l("^","pow",[new c("sec",[o.clone()]),b(2)]);break;case"sec":r=new l("*","multiply",[e,new c("tan",[o.clone()])]);break;case"csc":u=!0,r=new l("*","multiply",[e,new c("cot",[o.clone()])]);break;case"cot":u=!0,r=new l("^","pow",[new c("csc",[o.clone()]),b(2)]);break;case"asin":s=!0,r=new c("sqrt",[new l("-","subtract",[b(1),new l("^","pow",[o.clone(),b(2)])])]);break;case"acos":s=!0,u=!0,r=new c("sqrt",[new l("-","subtract",[b(1),new l("^","pow",[o.clone(),b(2)])])]);break;case"atan":s=!0,r=new l("+","add",[new l("^","pow",[o.clone(),b(2)]),b(1)]);break;case"asec":s=!0,r=new l("*","multiply",[new c("abs",[o.clone()]),new c("sqrt",[new l("-","subtract",[new l("^","pow",[o.clone(),b(2)]),b(1)])])]);break;case"acsc":s=!0,u=!0,r=new l("*","multiply",[new c("abs",[o.clone()]),new c("sqrt",[new l("-","subtract",[new l("^","pow",[o.clone(),b(2)]),b(1)])])]);break;case"acot":s=!0,u=!0,r=new l("+","add",[new l("^","pow",[o.clone(),b(2)]),b(1)]);break;case"sinh":r=new c("cosh",[o.clone()]);break;case"cosh":r=new c("sinh",[o.clone()]);break;case"tanh":r=new l("^","pow",[new c("sech",[o.clone()]),b(2)]);break;case"sech":u=!0,r=new l("*","multiply",[e,new c("tanh",[o.clone()])]);break;case"csch":u=!0,r=new l("*","multiply",[e,new c("coth",[o.clone()])]);break;case"coth":u=!0,r=new l("^","pow",[new c("csch",[o.clone()]),b(2)]);break;case"asinh":s=!0,r=new c("sqrt",[new l("+","add",[new l("^","pow",[o.clone(),b(2)]),b(1)])]);break;case"acosh":s=!0,r=new c("sqrt",[new l("-","subtract",[new l("^","pow",[o.clone(),b(2)]),b(1)])]);break;case"atanh":s=!0,r=new l("-","subtract",[b(1),new l("^","pow",[o.clone(),b(2)])]);break;case"asech":s=!0,u=!0,r=new l("*","multiply",[o.clone(),new c("sqrt",[new l("-","subtract",[b(1),new l("^","pow",[o.clone(),b(2)])])])]);break;case"acsch":s=!0,u=!0,r=new l("*","multiply",[new c("abs",[o.clone()]),new c("sqrt",[new l("+","add",[new l("^","pow",[o.clone(),b(2)]),b(1)])])]);break;case"acoth":s=!0,u=!0,r=new l("-","subtract",[b(1),new l("^","pow",[o.clone(),b(2)])]);break;case"abs":r=new l("/","divide",[new c(new h("abs"),[o.clone()]),o.clone()]);break;default:throw new Error('Cannot process function "'+e.name+'" in derivative: the function is not supported, undefined, or the number of arguments passed to it are not supported')}s?(a="/",i="divide"):(a="*",i="multiply");var p=v(o,t);return u&&(p=new l("-","unaryMinus",[p])),new l(a,i,[p,r])},"OperatorNode, function":function(e,t){if(t(e))return b(0);if("+"===e.op)return new l(e.op,e.fn,e.args.map((function(e){return v(e,t)})));if("-"===e.op){if(e.isUnary())return new l(e.op,e.fn,[v(e.args[0],t)]);if(e.isBinary())return new l(e.op,e.fn,[v(e.args[0],t),v(e.args[1],t)])}if("*"===e.op){var n=e.args.filter((function(e){return t(e)}));if(n.length>0){var r=e.args.filter((function(e){return!t(e)})),a=1===r.length?r[0]:new l("*","multiply",r),s=n.concat(v(a,t));return new l("*","multiply",s)}return new l("+","add",e.args.map((function(n){return new l("*","multiply",e.args.map((function(e){return e===n?v(e,t):e.clone()})))})))}if("/"===e.op&&e.isBinary()){var u=e.args[0],p=e.args[1];return t(p)?new l("/","divide",[v(u,t),p]):t(u)?new l("*","multiply",[new l("-","unaryMinus",[u]),new l("/","divide",[v(p,t),new l("^","pow",[p.clone(),b(2)])])]):new l("/","divide",[new l("-","subtract",[new l("*","multiply",[v(u,t),p.clone()]),new l("*","multiply",[u.clone(),v(p,t)])]),new l("^","pow",[p.clone(),b(2)])])}if("^"===e.op&&e.isBinary()){var h=e.args[0],d=e.args[1];if(t(h))return IU(h)&&(o(h.value)||i(h.value,1))?b(0):new l("*","multiply",[e,new l("*","multiply",[new c("log",[h.clone()]),v(d.clone(),t)])]);if(t(d)){if(IU(d)){if(o(d.value))return b(0);if(i(d.value,1))return v(h,t)}var f=new l("^","pow",[h.clone(),new l("-","subtract",[d,b(1)])]);return new l("*","multiply",[d.clone(),new l("*","multiply",[v(h,t),f])])}return new l("*","multiply",[new l("^","pow",[h.clone(),d.clone()]),new l("+","add",[new l("*","multiply",[v(h,t),new l("/","divide",[d.clone(),h.clone()])]),new l("*","multiply",[v(d,t),new c("log",[h.clone()])])])])}throw new Error('Cannot process operator "'+e.op+'" in derivative: the operator is not supported, undefined, or the number of arguments passed to it are not supported')}});function b(e,t){return new u(s(e,t||uW(String(e),n)))}return m})),W2="rationalize",V2=ZU(W2,["config","typed","equal","isZero","add","subtract","multiply","divide","pow","parse","simplifyConstant","simplifyCore","simplify","?bignumber","?fraction","mathWithTransform","matrix","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode","ParenthesisNode"],(e=>{var{config:t,typed:n,equal:r,isZero:a,add:i,subtract:o,multiply:s,divide:u,pow:c,parse:l,simplifyConstant:p,simplifyCore:h,simplify:d,fraction:f,bignumber:m,mathWithTransform:g,matrix:y,AccessorNode:v,ArrayNode:b,ConstantNode:x,FunctionNode:w,IndexNode:N,ObjectNode:S,OperatorNode:k,SymbolNode:E,ParenthesisNode:C}=e;function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(){var e=[h,{l:"n+n",r:"2*n"},{l:"n+-n",r:"0"},p,{l:"n*(n1^-1)",r:"n/n1"},{l:"n*n1^-n2",r:"n/n1^n2"},{l:"n1^-1",r:"1/n1"},{l:"n*(n1/n2)",r:"(n*n1)/n2"},{l:"1*n",r:"n"}],t=[{l:"(-n1)/(-n2)",r:"n1/n2"},{l:"(-n1)*(-n2)",r:"n1*n2"},{l:"n1--n2",r:"n1+n2"},{l:"n1-n2",r:"n1+(-n2)"},{l:"(n1+n2)*n3",r:"(n1*n3 + n2*n3)"},{l:"n1*(n2+n3)",r:"(n1*n2+n1*n3)"},{l:"c1*n + c2*n",r:"(c1+c2)*n"},{l:"c1*n + n",r:"(c1+1)*n"},{l:"c1*n - c2*n",r:"(c1-c2)*n"},{l:"c1*n - n",r:"(c1-1)*n"},{l:"v/c",r:"(1/c)*v"},{l:"v/-c",r:"-(1/c)*v"},{l:"-v*-c",r:"c*v"},{l:"-v*c",r:"-c*v"},{l:"v*-c",r:"-c*v"},{l:"v*c",r:"c*v"},{l:"-(-n1*n2)",r:"(n1*n2)"},{l:"-(n1*n2)",r:"(-n1*n2)"},{l:"-(-n1+n2)",r:"(n1-n2)"},{l:"-(n1+n2)",r:"(-n1-n2)"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"},{l:"-(-n1/n2)",r:"(n1/n2)"},{l:"-(n1/n2)",r:"(-n1/n2)"}],n=[{l:"(n1/n2 + n3/n4)",r:"((n1*n4 + n3*n2)/(n2*n4))"},{l:"(n1/n2 + n3)",r:"((n1 + n3*n2)/n2)"},{l:"(n1 + n2/n3)",r:"((n1*n3 + n2)/n3)"}],r=[{l:"(n1/(n2/n3))",r:"((n1*n3)/n2)"},{l:"(n1/n2/n3)",r:"(n1/(n2*n3))"}],a={};return a.firstRules=e.concat(t,r),a.distrDivRules=n,a.sucDivRules=r,a.firstRulesAgain=e.concat(t),a.finalRules=[h,{l:"n*-n",r:"-n^2"},{l:"n*n",r:"n^2"},p,{l:"n*-n^n1",r:"-n^(n1+1)"},{l:"n*n^n1",r:"n^(n1+1)"},{l:"n^n1*-n^n2",r:"-n^(n1+n2)"},{l:"n^n1*n^n2",r:"n^(n1+n2)"},{l:"n^n1*-n",r:"-n^(n1+1)"},{l:"n^n1*n",r:"n^(n1+1)"},{l:"n^n1/-n",r:"-n^(n1-1)"},{l:"n^n1/n",r:"n^(n1-1)"},{l:"n/-n^n1",r:"-n^(1-n1)"},{l:"n/n^n1",r:"n^(1-n1)"},{l:"n^n1/-n^n2",r:"n^(n1-n2)"},{l:"n^n1/n^n2",r:"n^(n1-n2)"},{l:"n1+(-n2*n3)",r:"n1-n2*n3"},{l:"v*(-c)",r:"-c*v"},{l:"n1+-n2",r:"n1-n2"},{l:"v*c",r:"c*v"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"}],a}(),a=function(e,t,n,r){var a=[],i=d(e,r,t,{exactFractions:!1}),o="+-*"+((n=!!n)?"/":"");u(i);var s={};return s.expression=i,s.variables=a,s;function u(e){var t=e.type;if("FunctionNode"===t)throw new Error("There is an unsolved function call");if("OperatorNode"===t)if("^"===e.op){if("ConstantNode"!==e.args[1].type||!sW(parseFloat(e.args[1].value)))throw new Error("There is a non-integer exponent");u(e.args[0])}else{if(!o.includes(e.op))throw new Error("Operator "+e.op+" invalid in polynomial expression");for(var n=0;n<e.args.length;n++)u(e.args[n])}else if("SymbolNode"===t){var r=e.name;-1===a.indexOf(r)&&a.push(r)}else if("ParenthesisNode"===t)u(e.content);else if("ConstantNode"!==t)throw new Error("type "+t+" is not allowed in polynomial expression")}}(e,t,!0,r.firstRules),i=a.variables.length,o={exactFractions:!1},s={exactFractions:!0};if(e=a.expression,i>=1){var u,c;e=D(e);var l,f=!0,m=!1;for(e=d(e,r.firstRules,{},o);c=f?r.distrDivRules:r.sucDivRules,f=!f,(l=(e=d(e,c,{},s)).toString())!==u;)m=!0,u=l;m&&(e=d(e,r.firstRulesAgain,{},o)),e=d(e,r.finalRules,{},o)}var g=[],y={};return"OperatorNode"===e.type&&e.isBinary()&&"/"===e.op?(1===i&&(e.args[0]=I(e.args[0],g),e.args[1]=I(e.args[1])),n&&(y.numerator=e.args[0],y.denominator=e.args[1])):(1===i&&(e=I(e,g)),n&&(y.numerator=e,y.denominator=null)),n?(y.coefficients=g,y.variables=a.variables,y.expression=e,y):e}return n(W2,{Node:T,"Node, boolean":(e,t)=>T(e,{},t),"Node, Object":T,"Node, Object, boolean":T});function D(e,t,n){var r=e.type,a=arguments.length>1;if("OperatorNode"===r&&e.isBinary()){var i,o=!1;if("^"===e.op&&("ParenthesisNode"!==e.args[0].type&&"OperatorNode"!==e.args[0].type||"ConstantNode"!==e.args[1].type||(o=(i=parseFloat(e.args[1].value))>=2&&sW(i))),o){if(i>2){var s=e.args[0],u=new k("^","pow",[e.args[0].cloneDeep(),new x(i-1)]);e=new k("*","multiply",[s,u])}else e=new k("*","multiply",[e.args[0],e.args[0].cloneDeep()]);a&&("content"===n?t.content=e:t.args[n]=e)}}if("ParenthesisNode"===r)D(e.content,e,"content");else if("ConstantNode"!==r&&"SymbolNode"!==r)for(var c=0;c<e.args.length;c++)D(e.args[c],e,c);if(!a)return e}function I(e,t){void 0===t&&(t=[]),t[0]=0;var n={cte:1,oper:"+",fire:""},r=0,a="";!function e(n,i,o){var s=n.type;if("FunctionNode"===s)throw new Error("There is an unsolved function call");if("OperatorNode"===s){if(!"+-*^".includes(n.op))throw new Error("Operator "+n.op+" invalid");if(null!==i){if(("unaryMinus"===n.fn||"pow"===n.fn)&&"add"!==i.fn&&"subtract"!==i.fn&&"multiply"!==i.fn)throw new Error("Invalid "+n.op+" placing");if(("subtract"===n.fn||"add"===n.fn||"multiply"===n.fn)&&"add"!==i.fn&&"subtract"!==i.fn)throw new Error("Invalid "+n.op+" placing");if(("subtract"===n.fn||"add"===n.fn||"unaryMinus"===n.fn)&&0!==o.noFil)throw new Error("Invalid "+n.op+" placing")}"^"!==n.op&&"*"!==n.op||(o.fire=n.op);for(var u=0;u<n.args.length;u++)"unaryMinus"===n.fn&&(o.oper="-"),"+"!==n.op&&"subtract"!==n.fn||(o.fire="",o.cte=1,o.oper=0===u?"+":n.op),o.noFil=u,e(n.args[u],n,o)}else if("SymbolNode"===s){if(n.name!==a&&""!==a)throw new Error("There is more than one variable");if(a=n.name,null===i)return void(t[1]=1);if("^"===i.op&&0!==o.noFil)throw new Error("In power the variable should be the first parameter");if("*"===i.op&&1!==o.noFil)throw new Error("In multiply the variable should be the second parameter");""!==o.fire&&"*"!==o.fire||(r<1&&(t[1]=0),t[1]+=o.cte*("+"===o.oper?1:-1),r=Math.max(1,r))}else{if("ConstantNode"!==s)throw new Error("Type "+s+" is not allowed");var c=parseFloat(n.value);if(null===i)return void(t[0]=c);if("^"===i.op){if(1!==o.noFil)throw new Error("Constant cannot be powered");if(!sW(c)||c<=0)throw new Error("Non-integer exponent is not allowed");for(var l=r+1;l<c;l++)t[l]=0;return c>r&&(t[c]=0),t[c]+=o.cte*("+"===o.oper?1:-1),void(r=Math.max(c,r))}o.cte=c,""===o.fire&&(t[0]+=o.cte*("+"===o.oper?1:-1))}}(e,null,n);for(var i,o=!0,s=r=t.length-1;s>=0;s--)if(0!==t[s]){var u=new x(o?t[s]:Math.abs(t[s])),c=t[s]<0?"-":"+";if(s>0){var l=new E(a);if(s>1){var p=new x(s);l=new k("^","pow",[l,p])}u=-1===t[s]&&o?new k("-","unaryMinus",[l]):1===Math.abs(t[s])?l:new k("*","multiply",[u,l])}i=o?u:"+"===c?new k("+","add",[i,u]):new k("-","subtract",[i,u]),o=!1}return o?new x(0):i}})),q2="zpk2tf",j2=ZU(q2,["typed","add","multiply","Complex","number"],(e=>{var{typed:t,add:n,multiply:r,Complex:a,number:i}=e;return t(q2,{"Array,Array,number":function(e,t,n){return o(e,t,n)},"Array,Array":function(e,t){return o(e,t,1)},"Matrix,Matrix,number":function(e,t,n){return o(e.valueOf(),t.valueOf(),n)},"Matrix,Matrix":function(e,t){return o(e.valueOf(),t.valueOf(),1)}});function o(e,t,n){e.some((e=>"BigNumber"===e.type))&&(e=e.map((e=>i(e)))),t.some((e=>"BigNumber"===e.type))&&(t=t.map((e=>i(e))));for(var o=[a(1,0)],u=[a(1,0)],c=0;c<e.length;c++){var l=e[c];"number"===typeof l&&(l=a(l,0)),o=s(o,[a(1,0),a(-l.re,-l.im)])}for(var p=0;p<t.length;p++){var h=t[p];"number"===typeof h&&(h=a(h,0)),u=s(u,[a(1,0),a(-h.re,-h.im)])}for(var d=0;d<o.length;d++)o[d]=r(o[d],n);return[o,u]}function s(e,t){for(var i=[],o=0;o<e.length+t.length-1;o++){i[o]=a(0,0);for(var s=0;s<e.length;s++)o-s>=0&&o-s<t.length&&(i[o]=n(i[o],r(e[s],t[o-s])))}return i}})),G2="freqz",H2=ZU(G2,["typed","add","multiply","Complex","divide","matrix"],(e=>{var{typed:t,add:n,multiply:r,Complex:a,divide:i,matrix:o}=e;return t(G2,{"Array, Array":function(e,t){return s(e,t,u(512))},"Array, Array, Array":function(e,t,n){return s(e,t,n)},"Array, Array, number":function(e,t,n){if(n<0)throw new Error("w must be a positive number");return s(e,t,u(n))},"Matrix, Matrix":function(e,t){var n=u(512),{w:r,h:a}=s(e.valueOf(),t.valueOf(),n);return{w:o(r),h:o(a)}},"Matrix, Matrix, Matrix":function(e,t,n){var{h:r}=s(e.valueOf(),t.valueOf(),n.valueOf());return{h:o(r),w:o(n)}},"Matrix, Matrix, number":function(e,t,n){if(n<0)throw new Error("w must be a positive number");var r=u(n),{h:a}=s(e.valueOf(),t.valueOf(),r);return{h:o(a),w:o(r)}}});function s(e,t,o){for(var s=[],u=[],c=0;c<o.length;c++){for(var l=a(0,0),p=a(0,0),h=0;h<e.length;h++)l=n(l,r(e[h],a(Math.cos(-h*o[c]),Math.sin(-h*o[c]))));for(var d=0;d<t.length;d++)p=n(p,r(t[d],a(Math.cos(-d*o[c]),Math.sin(-d*o[c]))));s.push(l),u.push(p)}for(var f=[],m=0;m<s.length;m++)f.push(i(s[m],u[m]));return{h:f,w:o}}function u(e){for(var t=[],n=0;n<e;n++)t.push(n/e*Math.PI);return t}})),K2=ZU("reviver",["classes"],(e=>{var{classes:t}=e;return function(e,n){var r=t[n&&n.mathjs];return r&&"function"===typeof r.fromJSON?r.fromJSON(n):n}})),X2=ZU("replacer",[],(()=>function(e,t){return"number"!==typeof t||isFinite(t)&&!isNaN(t)?"bigint"===typeof t?{mathjs:"bigint",value:String(t)}:t:{mathjs:"number",value:String(t)}})),Y2=Math.PI,$2=2*Math.PI,Z2=Math.E,Q2=ZU("true",[],(()=>!0)),J2=ZU("false",[],(()=>!1)),e3=ZU("null",[],(()=>null)),t3=y3("Infinity",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(1/0):1/0})),n3=y3("NaN",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(NaN):NaN})),r3=y3("pi",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?EZ(n):Y2})),a3=y3("tau",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?CZ(n):$2})),i3=y3("e",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?SZ(n):Z2})),o3=y3("phi",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?kZ(n):1.618033988749895})),s3=y3("LN2",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(2).ln():Math.LN2})),u3=y3("LN10",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(10).ln():Math.LN10})),c3=y3("LOG2E",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(1).div(new n(2).ln()):Math.LOG2E})),l3=y3("LOG10E",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(1).div(new n(10).ln()):Math.LOG10E})),p3=y3("SQRT1_2",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n("0.5").sqrt():Math.SQRT1_2})),h3=y3("SQRT2",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(2).sqrt():Math.SQRT2})),d3=y3("i",["Complex"],(e=>{var{Complex:t}=e;return t.I})),f3=ZU("PI",["pi"],(e=>{var{pi:t}=e;return t})),m3=ZU("E",["e"],(e=>{var{e:t}=e;return t})),g3=ZU("version",[],(()=>"14.1.0"));function y3(e,t,n){return ZU(e,t,n,{recreateOnConfigChange:!0})}var v3=f4("speedOfLight","299792458","m s^-1"),b3=f4("gravitationConstant","6.67430e-11","m^3 kg^-1 s^-2"),x3=f4("planckConstant","6.62607015e-34","J s"),w3=f4("reducedPlanckConstant","1.0545718176461565e-34","J s"),N3=f4("magneticConstant","1.25663706212e-6","N A^-2"),S3=f4("electricConstant","8.8541878128e-12","F m^-1"),k3=f4("vacuumImpedance","376.730313667","ohm"),E3=f4("coulomb","8.987551792261171e9","N m^2 C^-2"),C3=f4("elementaryCharge","1.602176634e-19","C"),T3=f4("bohrMagneton","9.2740100783e-24","J T^-1"),D3=f4("conductanceQuantum","7.748091729863649e-5","S"),I3=f4("inverseConductanceQuantum","12906.403729652257","ohm"),A3=f4("magneticFluxQuantum","2.0678338484619295e-15","Wb"),F3=f4("nuclearMagneton","5.0507837461e-27","J T^-1"),_3=f4("klitzing","25812.807459304513","ohm"),M3=f4("bohrRadius","5.29177210903e-11","m"),O3=f4("classicalElectronRadius","2.8179403262e-15","m"),R3=f4("electronMass","9.1093837015e-31","kg"),z3=f4("fermiCoupling","1.1663787e-5","GeV^-2"),B3=m4("fineStructure",.0072973525693),L3=f4("hartreeEnergy","4.3597447222071e-18","J"),P3=f4("protonMass","1.67262192369e-27","kg"),U3=f4("deuteronMass","3.3435830926e-27","kg"),W3=f4("neutronMass","1.6749271613e-27","kg"),V3=f4("quantumOfCirculation","3.6369475516e-4","m^2 s^-1"),q3=f4("rydberg","10973731.568160","m^-1"),j3=f4("thomsonCrossSection","6.6524587321e-29","m^2"),G3=m4("weakMixingAngle",.2229),H3=m4("efimovFactor",22.7),K3=f4("atomicMass","1.66053906660e-27","kg"),X3=f4("avogadro","6.02214076e23","mol^-1"),Y3=f4("boltzmann","1.380649e-23","J K^-1"),$3=f4("faraday","96485.33212331001","C mol^-1"),Z3=f4("firstRadiation","3.7417718521927573e-16","W m^2"),Q3=f4("loschmidt","2.686780111798444e25","m^-3"),J3=f4("gasConstant","8.31446261815324","J K^-1 mol^-1"),e4=f4("molarPlanckConstant","3.990312712893431e-10","J s mol^-1"),t4=f4("molarVolume","0.022413969545014137","m^3 mol^-1"),n4=m4("sackurTetrode",-1.16487052358),r4=f4("secondRadiation","0.014387768775039337","m K"),a4=f4("stefanBoltzmann","5.67037441918443e-8","W m^-2 K^-4"),i4=f4("wienDisplacement","2.897771955e-3","m K"),o4=f4("molarMass","0.99999999965e-3","kg mol^-1"),s4=f4("molarMassC12","11.9999999958e-3","kg mol^-1"),u4=f4("gravity","9.80665","m s^-2"),c4=f4("planckLength","1.616255e-35","m"),l4=f4("planckMass","2.176435e-8","kg"),p4=f4("planckTime","5.391245e-44","s"),h4=f4("planckCharge","1.87554603778e-18","C"),d4=f4("planckTemperature","1.416785e+32","K");function f4(e,t,n){return ZU(e,["config","Unit","BigNumber"],(e=>{var{config:r,Unit:a,BigNumber:i}=e,o=new a("BigNumber"===r.number?new i(t):parseFloat(t),n);return o.fixPrefix=!0,o}))}function m4(e,t){return ZU(e,["config","BigNumber"],(e=>{var{config:n,BigNumber:r}=e;return"BigNumber"===n.number?new r(t):t}))}var g4=ZU("apply",["typed","isInteger"],(e=>{var{typed:t,isInteger:n}=e,r=fH({typed:t,isInteger:n});return t("apply",{"...any":function(e){var t=e[1];QP(t)?e[1]=t-1:JP(t)&&(e[1]=t.minus(1));try{return r.apply(null,e)}catch(r5){throw bJ(r5)}}})}),{isTransformFunction:!0}),y4=ZU("column",["typed","Index","matrix","range"],(e=>{var{typed:t,Index:n,matrix:r,range:a}=e,i=vX({typed:t,Index:n,matrix:r,range:a});return t("column",{"...any":function(e){var t=e.length-1,n=e[t];QP(n)&&(e[t]=n-1);try{return i.apply(null,e)}catch(r5){throw bJ(r5)}}})}),{isTransformFunction:!0});function v4(e,t,n){var r=e.filter((function(e){return UU(e)&&!(e.name in t)&&!n.has(e.name)}))[0];if(!r)throw new Error('No undefined variable found in inline expression "'+e+'"');var a=r.name,i=new Map,o=new XP(n,i,new Set([a])),s=e.compile();return function(e){return i.set(a,e),s.evaluate(o)}}var b4=ZU("transformCallback",["typed"],(e=>{var{typed:t}=e;return function(e,r){return t.isTypedFunction(e)?n(e,r):x4(e,e.length,r)};function n(e,r){var a=Object.fromEntries(Object.entries(e.signatures).map((e=>{var[a,i]=e,o=a.split(",").length;return t.isTypedFunction(i)?[a,n(i,r)]:[a,x4(i,o,r)]})));return"string"===typeof e.name?t(e.name,a):t(a)}}));function x4(e,t,n){return t===n?e:t===n+1?function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var i=r.slice(0,n),o=w4(r[n]);return e(...i,o)}:t>n+1?function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var i=r.slice(0,n),o=w4(r[n]),s=r.slice(n+1);return e(...i,o,...s)}:e}function w4(e){return e.map((e=>e+1))}var N4=ZU("filter",["typed"],(e=>{var{typed:t}=e;function n(e,n,a){var i=EX({typed:t}),o=b4({typed:t});if(0===e.length)return i();var s=e[0];if(1===e.length)return i(s);var u=e.length-1,c=e[u];return s&&(s=r(s,a)),c&&(c=UU(c)||FU(c)?r(c,a):v4(c,n,a)),i(s,o(c,u))}function r(e,t){return e.compile().evaluate(t)}return n.rawArgs=!0,n}),{isTransformFunction:!0}),S4=ZU("forEach",["typed"],(e=>{var{typed:t}=e,n=AX({typed:t}),r=b4({typed:t});function a(e,t,a){if(0===e.length)return n();var o=e[0];if(1===e.length)return n(o);var s=e.length-1,u=e[s];return o&&(o=i(o,a)),u&&(u=UU(u)||FU(u)?i(u,a):v4(u,t,a)),n(o,r(u,s))}function i(e,t){return e.compile().evaluate(t)}return a.rawArgs=!0,a}),{isTransformFunction:!0}),k4=ZU("index",["Index","getMatrixDataType"],(e=>{var{Index:t,getMatrixDataType:n}=e;return function(){for(var e=[],r=0,a=arguments.length;r<a;r++){var i=arguments[r];if(lU(i))i.start--,i.end-=i.step>0?0:2;else if(i&&!0===i.isSet)i=i.map((function(e){return e-1}));else if(iU(i)||oU(i))"boolean"!==n(i)&&(i=i.map((function(e){return e-1})));else if(QP(i))i--;else if(JP(i))i=i.toNumber()-1;else if("string"!==typeof i)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");e[r]=i}var o=new t;return t.apply(o,e),o}}),{isTransformFunction:!0}),E4=ZU("map",["typed"],(e=>{var{typed:t}=e,n=PX({typed:t}),r=b4({typed:t});function a(e,t,a){if(0===e.length)return n();if(1===e.length)return n(e[0]);var i=e.length-1,o=e.slice(0,i),s=e[i];return o=o.map((e=>u(e,a))),s&&(s=UU(s)||FU(s)?u(s,a):v4(s,t,a)),n(...o,r(s,i));function u(e,t){return e.compile().evaluate(t)}}return a.rawArgs=!0,a}),{isTransformFunction:!0});function C4(e){if(2===e.length&&sU(e[0])){var t=(e=e.slice())[1];(QP(n=t)||JP(n))&&(e[1]=function(e){return QP(e)?e-1:JP(e)?e.minus(1):e}(t))}var n;return e}var T4=ZU("max",["typed","config","numeric","larger"],(e=>{var{typed:t,config:n,numeric:r,larger:a}=e,i=fZ({typed:t,config:n,numeric:r,larger:a});return t("max",{"...any":function(e){e=C4(e);try{return i.apply(null,e)}catch(r5){throw bJ(r5)}}})}),{isTransformFunction:!0}),D4=ZU("mean",["typed","add","divide"],(e=>{var{typed:t,add:n,divide:r}=e,a=N1({typed:t,add:n,divide:r});return t("mean",{"...any":function(e){e=C4(e);try{return a.apply(null,e)}catch(r5){throw bJ(r5)}}})}),{isTransformFunction:!0}),I4=ZU("min",["typed","config","numeric","smaller"],(e=>{var{typed:t,config:n,numeric:r,smaller:a}=e,i=mZ({typed:t,config:n,numeric:r,smaller:a});return t("min",{"...any":function(e){e=C4(e);try{return i.apply(null,e)}catch(r5){throw bJ(r5)}}})}),{isTransformFunction:!0}),A4=ZU("range",["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],(e=>{var{typed:t,config:n,matrix:r,bignumber:a,smaller:i,smallerEq:o,larger:s,largerEq:u,add:c,isPositive:l}=e,p=KX({typed:t,config:n,matrix:r,bignumber:a,smaller:i,smallerEq:o,larger:s,largerEq:u,add:c,isPositive:l});return t("range",{"...any":function(e){return"boolean"!==typeof e[e.length-1]&&e.push(!0),p.apply(null,e)}})}),{isTransformFunction:!0}),F4=ZU("row",["typed","Index","matrix","range"],(e=>{var{typed:t,Index:n,matrix:r,range:a}=e,i=tY({typed:t,Index:n,matrix:r,range:a});return t("row",{"...any":function(e){var t=e.length-1,n=e[t];QP(n)&&(e[t]=n-1);try{return i.apply(null,e)}catch(r5){throw bJ(r5)}}})}),{isTransformFunction:!0}),_4=ZU("subset",["typed","matrix","zeros","add"],(e=>{var{typed:t,matrix:n,zeros:r,add:a}=e,i=sY({typed:t,matrix:n,zeros:r,add:a});return t("subset",{"...any":function(e){try{return i.apply(null,e)}catch(r5){throw bJ(r5)}}})}),{isTransformFunction:!0}),M4=ZU("concat",["typed","matrix","isInteger"],(e=>{var{typed:t,matrix:n,isInteger:r}=e,a=gX({typed:t,matrix:n,isInteger:r});return t("concat",{"...any":function(e){var t=e.length-1,n=e[t];QP(n)?e[t]=n-1:JP(n)&&(e[t]=n.minus(1));try{return a.apply(null,e)}catch(r5){throw bJ(r5)}}})}),{isTransformFunction:!0}),O4="diff",R4=ZU(O4,["typed","matrix","subtract","number","bignumber"],(e=>{var{typed:t,matrix:n,subtract:r,number:a,bignumber:i}=e,o=WX({typed:t,matrix:n,subtract:r,number:a,bignumber:i});return t(O4,{"...any":function(e){e=C4(e);try{return o.apply(null,e)}catch(r5){throw bJ(r5)}}})}),{isTransformFunction:!0}),z4=ZU("std",["typed","map","sqrt","variance"],(e=>{var{typed:t,map:n,sqrt:r,variance:a}=e,i=F1({typed:t,map:n,sqrt:r,variance:a});return t("std",{"...any":function(e){e=C4(e);try{return i.apply(null,e)}catch(r5){throw bJ(r5)}}})}),{isTransformFunction:!0}),B4=ZU("sum",["typed","config","add","numeric"],(e=>{var{typed:t,config:n,add:r,numeric:a}=e,i=v1({typed:t,config:n,add:r,numeric:a});return t("sum",{"...any":function(e){e=C4(e);try{return i.apply(null,e)}catch(r5){throw bJ(r5)}}})}),{isTransformFunction:!0}),L4=ZU("quantileSeq",["typed","bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger"],(e=>{var{typed:t,bignumber:n,add:r,subtract:a,divide:i,multiply:o,partitionSelect:s,compare:u,isInteger:c,smaller:l,smallerEq:p,larger:h}=e,d=A1({typed:t,bignumber:n,add:r,subtract:a,divide:i,multiply:o,partitionSelect:s,compare:u,isInteger:c,smaller:l,smallerEq:p,larger:h});return t("quantileSeq",{"Array | Matrix, number | BigNumber":d,"Array | Matrix, number | BigNumber, number":(e,t,n)=>d(e,t,f(n)),"Array | Matrix, number | BigNumber, boolean":d,"Array | Matrix, number | BigNumber, boolean, number":(e,t,n,r)=>d(e,t,n,f(r)),"Array | Matrix, Array | Matrix":d,"Array | Matrix, Array | Matrix, number":(e,t,n)=>d(e,t,f(n)),"Array | Matrix, Array | Matrix, boolean":d,"Array | Matrix, Array | Matrix, boolean, number":(e,t,n,r)=>d(e,t,n,f(r))});function f(e){return C4([[],e])[1]}}),{isTransformFunction:!0}),P4="cumsum",U4=ZU(P4,["typed","add","unaryPlus"],(e=>{var{typed:t,add:n,unaryPlus:r}=e,a=x1({typed:t,add:n,unaryPlus:r});return t(P4,{"...any":function(e){if(2===e.length&&sU(e[0])){var t=e[1];QP(t)?e[1]=t-1:JP(t)&&(e[1]=t.minus(1))}try{return a.apply(null,e)}catch(r5){throw bJ(r5)}}})}),{isTransformFunction:!0}),W4="variance",V4=ZU(W4,["typed","add","subtract","multiply","divide","apply","isNaN"],(e=>{var{typed:t,add:n,subtract:r,multiply:a,divide:i,apply:o,isNaN:s}=e,u=D1({typed:t,add:n,subtract:r,multiply:a,divide:i,apply:o,isNaN:s});return t(W4,{"...any":function(e){e=C4(e);try{return u.apply(null,e)}catch(r5){throw bJ(r5)}}})}),{isTransformFunction:!0}),q4="print",j4=ZU(q4,["typed","matrix","zeros","add"],(e=>{var{typed:t,matrix:n,zeros:r,add:a}=e,i=HY({typed:t,matrix:n,zeros:r,add:a});return t(q4,{"string, Object | Array":function(e,t){return i(o(e),t)},"string, Object | Array, number | Object":function(e,t,n){return i(o(e),t,n)}});function o(e){return e.replace(jY,(e=>"$"+e.slice(1).split(".").map((function(e){return!isNaN(e)&&e.length>0?parseInt(e)-1:e})).join(".")))}}),{isTransformFunction:!0}),G4=ZU("and",["typed","matrix","zeros","add","equalScalar","not","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,zeros:a,not:i,concat:o}=e,s=_$({typed:t,matrix:n,equalScalar:r,zeros:a,not:i,concat:o});function u(e,t,n){var r=e[0].compile().evaluate(n);if(!sU(r)&&!s(r,!0))return!1;var a=e[1].compile().evaluate(n);return s(r,a)}return u.rawArgs=!0,u}),{isTransformFunction:!0}),H4=ZU("or",["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,DenseMatrix:a,concat:i}=e,o=dX({typed:t,matrix:n,equalScalar:r,DenseMatrix:a,concat:i});function s(e,t,n){var r=e[0].compile().evaluate(n);if(!sU(r)&&o(r,!1))return!0;var a=e[1].compile().evaluate(n);return o(r,a)}return s.rawArgs=!0,s}),{isTransformFunction:!0}),K4=ZU("bitAnd",["typed","matrix","zeros","add","equalScalar","not","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,zeros:a,not:i,concat:o}=e,s=XK({typed:t,matrix:n,equalScalar:r,zeros:a,not:i,concat:o});function u(e,t,n){var r=e[0].compile().evaluate(n);if(!sU(r)){if(isNaN(r))return NaN;if(0===r||!1===r)return 0}var a=e[1].compile().evaluate(n);return s(r,a)}return u.rawArgs=!0,u}),{isTransformFunction:!0}),X4=ZU("bitOr",["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,DenseMatrix:a,concat:i}=e,o=QK({typed:t,matrix:n,equalScalar:r,DenseMatrix:a,concat:i});function s(e,t,n){var r=e[0].compile().evaluate(n);if(!sU(r)){if(isNaN(r))return NaN;if(-1===r)return-1;if(!0===r)return 1}var a=e[1].compile().evaluate(n);return o(r,a)}return s.rawArgs=!0,s}),{isTransformFunction:!0});const Y4=function e(t,n){var r=zP({},tW,n);if("function"!==typeof Object.create)throw new Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var a=function(e){var t=new eW;return e.on=t.on.bind(t),e.off=t.off.bind(t),e.once=t.once.bind(t),e.emit=t.emit.bind(t),e}({isNumber:QP,isComplex:tU,isBigNumber:JP,isBigInt:eU,isFraction:nU,isUnit:rU,isString:aU,isArray:iU,isMatrix:oU,isCollection:sU,isDenseMatrix:uU,isSparseMatrix:cU,isRange:lU,isIndex:pU,isBoolean:hU,isResultSet:dU,isHelp:fU,isFunction:mU,isDate:gU,isRegExp:yU,isObject:vU,isMap:bU,isPartitionedMap:xU,isObjectWrappingMap:wU,isNull:NU,isUndefined:SU,isAccessorNode:kU,isArrayNode:EU,isAssignmentNode:CU,isBlockNode:TU,isConditionalNode:DU,isConstantNode:IU,isFunctionAssignmentNode:FU,isFunctionNode:_U,isIndexNode:MU,isNode:OU,isObjectNode:RU,isOperatorNode:zU,isParenthesisNode:BU,isRangeNode:LU,isRelationalNode:PU,isSymbolNode:UU,isChain:WU});a.config=aW(r,a.emit),a.expression={transform:{},mathWithTransform:{config:a.config}};var i={};function o(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.typed.apply(a.typed,t)}o.isTypedFunction=BP.isTypedFunction;var s=oW(o,0,a,i);return a.import=s,a.on("config",(()=>{Object.values(i).forEach((e=>{e&&e.meta&&e.meta.recreateOnConfigChange&&s(e,{override:!0})}))})),a.create=e.bind(null,t),a.factory=ZU,a.import(Object.values(KU(t))),a.ArgumentsError=LP,a.DimensionError=PP,a.IndexError=UP,a}(T);class $4{constructor(e,t){var n,r,a,i;this.tfModel=void 0,this.modelWidth=void 0,this.modelHeight=void 0,this.categories=void 0,this.tfModel=e;const o=null===(n=this.tfModel.inputs)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.shape;this.modelWidth=null!==(a=null===o||void 0===o?void 0:o[1])&&void 0!==a?a:320,this.modelHeight=null!==(i=null===o||void 0===o?void 0:o[2])&&void 0!==i?i:320,this.categories=t}preProcess(e){let[t,n,r,a,i]=pi((()=>{let t=Es(e),[n,r]=t.shape.slice(0,2),a=Math.max(n,r),i=t.pad([[0,a-n],[0,a-r],[0,0]]);return[od.resizeNearestNeighbor(i,[this.modelWidth,this.modelHeight]).div(255).expandDims(0),r,n,a/r,a/n]}));return[t,n,r,a,i]}calculateMaxScores(e,t,n){const r=[],a=[];for(let i=0;i<t;i++){let t=Number.MIN_VALUE,o=-1;for(let r=0;r<n;r++)e[i*n+r]>t&&(t=e[i*n+r],o=r);r[i]=t,a[i]=o}return[r,a]}buildDetectedObjects(e,t,n,r,a,i,o,s){const u=o.length,c=[];for(let l=0;l<u;l++){const u=[];for(let e=0;e<4;e++)u[e]=a[4*o[l]+e];const p=Y4.max(0,u[0]*n*r),h=Y4.max(0,u[1]*e*t),d=Y4.min(n,u[2]*n*r),f=Y4.min(e,u[3]*e*t);c.push({x:h,y:p,width:f-h,height:d-p,score:i[o[l]],classId:s[o[l]],class:this.categories[s[o[l]]]})}return c}detect(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,[n,r,a,i,o]=this.preProcess(e),s=this.tfModel.execute(n);hi(n);const u=s,c=u[0],l=u[1],p=c.dataSync(),h=l.dataSync();n instanceof ka&&n.dispose();const[d,f]=this.calculateMaxScores(h,l.shape[1],l.shape[2]),m=mi();"webgl"===mi()&&fi("cpu");const g=pi((()=>{const e=kp(p,[c.shape[1],c.shape[2]]);return od.nonMaxSuppression(e,d,100,.6,t)}));hi(s);const y=g.dataSync();g.dispose(),m!==mi()&&fi(m);const v=this.buildDetectedObjects(r instanceof ka?r.dataSync()[0]:r,i instanceof ka?i.dataSync()[0]:i,a instanceof ka?a.dataSync()[0]:a,o instanceof ka?o.dataSync()[0]:o,p,d,y,f);return hi(s),v}}async function Z4(e){const t=e.source,n=await GO(t);ye().set("PROD",!0);const r=n.inputs[0].shape;if(!r)throw new Error("Input shape is undefined");n.execute(ul(r));return new $4(n,e.classNames)}var Q4=n(579);const J4={source:"./best_web_prune_06_model_int8_320x320/model.json",classNames:["sli_side_turn_light","tyre","alloy_wheel","hli_head_light","hood","fwi_windshield","flp_front_license_plate","door","mirror","handle","qpa_quarter_panel","fender","grille","fbu_front_bumper","rocker_panel","rbu_rear_bumper","pillar","roof","blp_back_license_plate","window","rwi_rear_windshield","tail_gate","tli_tail_light","fbe_fog_light_bezel","fli_fog_light","fuel_tank_door","lli_low_bumper_tail_light","car"]};const e5=function(){const[e,t]=(0,D.useState)(null),[n,r]=(0,D.useState)(null),[a,i]=(0,D.useState)([]),[o,s]=(0,D.useState)(null),u=(0,D.useRef)(null),c=(0,D.useRef)(null);(0,D.useEffect)((()=>{Z4(J4).then((e=>{t(e)})).catch((e=>{console.log("Error loading model:",e)}))}),[]);const l=(e,t,n,r)=>{e.clearRect(0,0,e.canvas.width,e.canvas.height),u.current?e.drawImage(u.current,0,0,n,r):console.error("imageRef.current is null, cannot draw image"),t.forEach((t=>{const[n,r,a,i]=[t.x,t.y,t.width,t.height];e.strokeStyle="red",e.lineWidth=2,e.strokeRect(n,r,a,i);const o="Class ".concat(t.classId," (").concat((100*t.score).toFixed(2),"%)");e.fillStyle="red",e.font="16px Arial",e.fillText(o,n,r>10?r-10:r+20)}))};return(0,Q4.jsxs)("div",{children:[(0,Q4.jsx)("h1",{children:"Object Detection with TensorFlow.js"}),(0,Q4.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n){const e=URL.createObjectURL(n);r(e),i([]),s(null)}}}),n&&(0,Q4.jsxs)("div",{style:{position:"relative"},children:[(0,Q4.jsx)("img",{src:n,alt:"Uploaded",ref:u,style:{maxWidth:"1500px",maxHeight:"1500px"},onLoad:async()=>{if(!e||!u.current)return void console.log("Model not loaded or no image selected.");const t=u.current,n=c.current;if(!n)return void console.error("Canvas element is not available");n.width=t.width,n.height=t.height;const r=null===n||void 0===n?void 0:n.getContext("2d");if(!r)return void console.error("Canvas context not available");n.width=t.width,n.height=t.height,r.drawImage(t,0,0,t.width,t.height);const a=performance.now(),o=await e.detect(t,.3),p=performance.now();s(p-a),i(o),l(r,o,t.width,t.height)}}),(0,Q4.jsx)("canvas",{ref:c,style:{position:"absolute",top:0,left:0,pointerEvents:"none"},width:0,height:0})]}),a.length>0&&(0,Q4.jsxs)("div",{children:[(0,Q4.jsx)("h2",{children:"Predictions:"}),(0,Q4.jsx)("ul",{children:a.map(((e,t)=>(0,Q4.jsxs)("li",{children:["Class: ",e.class,", Score:"," ",(100*e.score).toFixed(2),"%"]},t)))})]}),null!==o&&(0,Q4.jsx)("div",{children:(0,Q4.jsxs)("h2",{children:["Inference Time: ",o.toFixed(2)," ms"]})})]})};const t5=function(){return(0,Q4.jsx)("div",{className:"App",children:(0,Q4.jsx)("header",{className:"App-header",children:(0,Q4.jsx)(e5,{})})})},n5=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:r,getFCP:a,getLCP:i,getTTFB:o}=t;n(e),r(e),a(e),i(e),o(e)}))};I.createRoot(document.getElementById("root")).render((0,Q4.jsx)(D.StrictMode,{children:(0,Q4.jsx)(t5,{})})),n5()})()})();
//# sourceMappingURL=main.038a2619.js.map